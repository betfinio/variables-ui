function X6(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in n)){const l=Object.getOwnPropertyDescriptor(r,o);l&&Object.defineProperty(n,o,l.get?l:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function ha(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Vg={exports:{}},kl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv;function Q6(){if(Xv)return kl;Xv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var f in o)f!=="key"&&(l[f]=o[f])}else l=o;return o=l.ref,{$$typeof:n,type:r,key:u,ref:o!==void 0?o:null,props:l}}return kl.Fragment=e,kl.jsx=t,kl.jsxs=t,kl}var Qv;function J6(){return Qv||(Qv=1,Vg.exports=Q6()),Vg.exports}var K=J6(),$g={exports:{}},Ce={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function W6(){if(Jv)return Ce;Jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=y&&A[y]||A["@@iterator"],typeof A=="function"?A:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,k={};function _(A,$,W){this.props=A,this.context=$,this.refs=k,this.updater=W||E}_.prototype.isReactComponent={},_.prototype.setState=function(A,$){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,$,"setState")},_.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function R(){}R.prototype=_.prototype;function j(A,$,W){this.props=A,this.context=$,this.refs=k,this.updater=W||E}var C=j.prototype=new R;C.constructor=j,x(C,_.prototype),C.isPureReactComponent=!0;var Z=Array.isArray,Q={H:null,A:null,T:null,S:null,V:null},re=Object.prototype.hasOwnProperty;function oe(A,$,W,ne,se,ue){return W=ue.ref,{$$typeof:n,type:A,key:$,ref:W!==void 0?W:null,props:ue}}function H(A,$){return oe(A.type,$,void 0,void 0,void 0,A.props)}function B(A){return typeof A=="object"&&A!==null&&A.$$typeof===n}function G(A){var $={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(W){return $[W]})}var te=/\/+/g;function Y(A,$){return typeof A=="object"&&A!==null&&A.key!=null?G(""+A.key):$.toString(36)}function U(){}function M(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(U,U):(A.status="pending",A.then(function($){A.status==="pending"&&(A.status="fulfilled",A.value=$)},function($){A.status==="pending"&&(A.status="rejected",A.reason=$)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function D(A,$,W,ne,se){var ue=typeof A;(ue==="undefined"||ue==="boolean")&&(A=null);var fe=!1;if(A===null)fe=!0;else switch(ue){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(A.$$typeof){case n:case e:fe=!0;break;case m:return fe=A._init,D(fe(A._payload),$,W,ne,se)}}if(fe)return se=se(A),fe=ne===""?"."+Y(A,0):ne,Z(se)?(W="",fe!=null&&(W=fe.replace(te,"$&/")+"/"),D(se,$,W,"",function(Ie){return Ie})):se!=null&&(B(se)&&(se=H(se,W+(se.key==null||A&&A.key===se.key?"":(""+se.key).replace(te,"$&/")+"/")+fe)),$.push(se)),1;fe=0;var ve=ne===""?".":ne+":";if(Z(A))for(var ke=0;ke<A.length;ke++)ne=A[ke],ue=ve+Y(ne,ke),fe+=D(ne,$,W,ue,se);else if(ke=b(A),typeof ke=="function")for(A=ke.call(A),ke=0;!(ne=A.next()).done;)ne=ne.value,ue=ve+Y(ne,ke++),fe+=D(ne,$,W,ue,se);else if(ue==="object"){if(typeof A.then=="function")return D(M(A),$,W,ne,se);throw $=String(A),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return fe}function S(A,$,W){if(A==null)return A;var ne=[],se=0;return D(A,ne,"","",function(ue){return $.call(W,ue,se++)}),ne}function I(A){if(A._status===-1){var $=A._result;$=$(),$.then(function(W){(A._status===0||A._status===-1)&&(A._status=1,A._result=W)},function(W){(A._status===0||A._status===-1)&&(A._status=2,A._result=W)}),A._status===-1&&(A._status=0,A._result=$)}if(A._status===1)return A._result.default;throw A._result}var L=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function ie(){}return Ce.Children={map:S,forEach:function(A,$,W){S(A,function(){$.apply(this,arguments)},W)},count:function(A){var $=0;return S(A,function(){$++}),$},toArray:function(A){return S(A,function($){return $})||[]},only:function(A){if(!B(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Ce.Component=_,Ce.Fragment=t,Ce.Profiler=o,Ce.PureComponent=j,Ce.StrictMode=r,Ce.Suspense=h,Ce.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Q,Ce.__COMPILER_RUNTIME={__proto__:null,c:function(A){return Q.H.useMemoCache(A)}},Ce.cache=function(A){return function(){return A.apply(null,arguments)}},Ce.cloneElement=function(A,$,W){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var ne=x({},A.props),se=A.key,ue=void 0;if($!=null)for(fe in $.ref!==void 0&&(ue=void 0),$.key!==void 0&&(se=""+$.key),$)!re.call($,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&$.ref===void 0||(ne[fe]=$[fe]);var fe=arguments.length-2;if(fe===1)ne.children=W;else if(1<fe){for(var ve=Array(fe),ke=0;ke<fe;ke++)ve[ke]=arguments[ke+2];ne.children=ve}return oe(A.type,se,void 0,void 0,ue,ne)},Ce.createContext=function(A){return A={$$typeof:u,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:l,_context:A},A},Ce.createElement=function(A,$,W){var ne,se={},ue=null;if($!=null)for(ne in $.key!==void 0&&(ue=""+$.key),$)re.call($,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(se[ne]=$[ne]);var fe=arguments.length-2;if(fe===1)se.children=W;else if(1<fe){for(var ve=Array(fe),ke=0;ke<fe;ke++)ve[ke]=arguments[ke+2];se.children=ve}if(A&&A.defaultProps)for(ne in fe=A.defaultProps,fe)se[ne]===void 0&&(se[ne]=fe[ne]);return oe(A,ue,void 0,void 0,null,se)},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(A){return{$$typeof:f,render:A}},Ce.isValidElement=B,Ce.lazy=function(A){return{$$typeof:m,_payload:{_status:-1,_result:A},_init:I}},Ce.memo=function(A,$){return{$$typeof:p,type:A,compare:$===void 0?null:$}},Ce.startTransition=function(A){var $=Q.T,W={};Q.T=W;try{var ne=A(),se=Q.S;se!==null&&se(W,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(ie,L)}catch(ue){L(ue)}finally{Q.T=$}},Ce.unstable_useCacheRefresh=function(){return Q.H.useCacheRefresh()},Ce.use=function(A){return Q.H.use(A)},Ce.useActionState=function(A,$,W){return Q.H.useActionState(A,$,W)},Ce.useCallback=function(A,$){return Q.H.useCallback(A,$)},Ce.useContext=function(A){return Q.H.useContext(A)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(A,$){return Q.H.useDeferredValue(A,$)},Ce.useEffect=function(A,$,W){var ne=Q.H;if(typeof W=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(A,$)},Ce.useId=function(){return Q.H.useId()},Ce.useImperativeHandle=function(A,$,W){return Q.H.useImperativeHandle(A,$,W)},Ce.useInsertionEffect=function(A,$){return Q.H.useInsertionEffect(A,$)},Ce.useLayoutEffect=function(A,$){return Q.H.useLayoutEffect(A,$)},Ce.useMemo=function(A,$){return Q.H.useMemo(A,$)},Ce.useOptimistic=function(A,$){return Q.H.useOptimistic(A,$)},Ce.useReducer=function(A,$,W){return Q.H.useReducer(A,$,W)},Ce.useRef=function(A){return Q.H.useRef(A)},Ce.useState=function(A){return Q.H.useState(A)},Ce.useSyncExternalStore=function(A,$,W){return Q.H.useSyncExternalStore(A,$,W)},Ce.useTransition=function(){return Q.H.useTransition()},Ce.version="19.1.1",Ce}var Wv;function Im(){return Wv||(Wv=1,$g.exports=W6()),$g.exports}var ae=Im();const Ti=ha(ae),Tx=X6({__proto__:null,default:Ti},[ae]);var Hg={exports:{}},Cl={},qg={exports:{}},Fg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function e4(){return e1||(e1=1,(function(n){function e(S,I){var L=S.length;S.push(I);e:for(;0<L;){var ie=L-1>>>1,A=S[ie];if(0<o(A,I))S[ie]=I,S[L]=A,L=ie;else break e}}function t(S){return S.length===0?null:S[0]}function r(S){if(S.length===0)return null;var I=S[0],L=S.pop();if(L!==I){S[0]=L;e:for(var ie=0,A=S.length,$=A>>>1;ie<$;){var W=2*(ie+1)-1,ne=S[W],se=W+1,ue=S[se];if(0>o(ne,L))se<A&&0>o(ue,ne)?(S[ie]=ue,S[se]=L,ie=se):(S[ie]=ne,S[W]=L,ie=W);else if(se<A&&0>o(ue,L))S[ie]=ue,S[se]=L,ie=se;else break e}}return I}function o(S,I){var L=S.sortIndex-I.sortIndex;return L!==0?L:S.id-I.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var h=[],p=[],m=1,y=null,b=3,E=!1,x=!1,k=!1,_=!1,R=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function Z(S){for(var I=t(p);I!==null;){if(I.callback===null)r(p);else if(I.startTime<=S)r(p),I.sortIndex=I.expirationTime,e(h,I);else break;I=t(p)}}function Q(S){if(k=!1,Z(S),!x)if(t(h)!==null)x=!0,re||(re=!0,Y());else{var I=t(p);I!==null&&D(Q,I.startTime-S)}}var re=!1,oe=-1,H=5,B=-1;function G(){return _?!0:!(n.unstable_now()-B<H)}function te(){if(_=!1,re){var S=n.unstable_now();B=S;var I=!0;try{e:{x=!1,k&&(k=!1,j(oe),oe=-1),E=!0;var L=b;try{t:{for(Z(S),y=t(h);y!==null&&!(y.expirationTime>S&&G());){var ie=y.callback;if(typeof ie=="function"){y.callback=null,b=y.priorityLevel;var A=ie(y.expirationTime<=S);if(S=n.unstable_now(),typeof A=="function"){y.callback=A,Z(S),I=!0;break t}y===t(h)&&r(h),Z(S)}else r(h);y=t(h)}if(y!==null)I=!0;else{var $=t(p);$!==null&&D(Q,$.startTime-S),I=!1}}break e}finally{y=null,b=L,E=!1}I=void 0}}finally{I?Y():re=!1}}}var Y;if(typeof C=="function")Y=function(){C(te)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,M=U.port2;U.port1.onmessage=te,Y=function(){M.postMessage(null)}}else Y=function(){R(te,0)};function D(S,I){oe=R(function(){S(n.unstable_now())},I)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(S){S.callback=null},n.unstable_forceFrameRate=function(S){0>S||125<S?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<S?Math.floor(1e3/S):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(S){switch(b){case 1:case 2:case 3:var I=3;break;default:I=b}var L=b;b=I;try{return S()}finally{b=L}},n.unstable_requestPaint=function(){_=!0},n.unstable_runWithPriority=function(S,I){switch(S){case 1:case 2:case 3:case 4:case 5:break;default:S=3}var L=b;b=S;try{return I()}finally{b=L}},n.unstable_scheduleCallback=function(S,I,L){var ie=n.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?ie+L:ie):L=ie,S){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=L+A,S={id:m++,callback:I,priorityLevel:S,startTime:L,expirationTime:A,sortIndex:-1},L>ie?(S.sortIndex=L,e(p,S),t(h)===null&&S===t(p)&&(k?(j(oe),oe=-1):k=!0,D(Q,L-ie))):(S.sortIndex=A,e(h,S),x||E||(x=!0,re||(re=!0,Y()))),S},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(S){var I=b;return function(){var L=b;b=I;try{return S.apply(this,arguments)}finally{b=L}}}})(Fg)),Fg}var t1;function t4(){return t1||(t1=1,qg.exports=e4()),qg.exports}var Kg={exports:{}},Ht={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function n4(){if(n1)return Ht;n1=1;var n=Im();function e(h){var p="https://react.dev/errors/"+h;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)p+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(h,p,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:y==null?null:""+y,children:h,containerInfo:p,implementation:m}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(h,p){if(h==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Ht.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ht.createPortal=function(h,p){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(h,p,null,m)},Ht.flushSync=function(h){var p=u.T,m=r.p;try{if(u.T=null,r.p=2,h)return h()}finally{u.T=p,r.p=m,r.d.f()}},Ht.preconnect=function(h,p){typeof h=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(h,p))},Ht.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Ht.preinit=function(h,p){if(typeof h=="string"&&p&&typeof p.as=="string"){var m=p.as,y=f(m,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,E=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;m==="style"?r.d.S(h,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:E}):m==="script"&&r.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:E,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Ht.preinitModule=function(h,p){if(typeof h=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var m=f(p.as,p.crossOrigin);r.d.M(h,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(h)},Ht.preload=function(h,p){if(typeof h=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var m=p.as,y=f(m,p.crossOrigin);r.d.L(h,m,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Ht.preloadModule=function(h,p){if(typeof h=="string")if(p){var m=f(p.as,p.crossOrigin);r.d.m(h,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(h)},Ht.requestFormReset=function(h){r.d.r(h)},Ht.unstable_batchedUpdates=function(h,p){return h(p)},Ht.useFormState=function(h,p,m){return u.H.useFormState(h,p,m)},Ht.useFormStatus=function(){return u.H.useHostTransitionStatus()},Ht.version="19.1.1",Ht}var r1;function kx(){if(r1)return Kg.exports;r1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Kg.exports=n4(),Kg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function r4(){if(i1)return Cl;i1=1;var n=t4(),e=Im(),t=kx();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var s=i,a=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(a=s.return),i=s.return;while(i)}return s.tag===3?a:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function f(i){if(l(i)!==i)throw Error(r(188))}function h(i){var s=i.alternate;if(!s){if(s=l(i),s===null)throw Error(r(188));return s!==i?null:i}for(var a=i,c=s;;){var d=a.return;if(d===null)break;var g=d.alternate;if(g===null){if(c=d.return,c!==null){a=c;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===a)return f(d),i;if(g===c)return f(d),s;g=g.sibling}throw Error(r(188))}if(a.return!==c.return)a=d,c=g;else{for(var w=!1,v=d.child;v;){if(v===a){w=!0,a=d,c=g;break}if(v===c){w=!0,c=d,a=g;break}v=v.sibling}if(!w){for(v=g.child;v;){if(v===a){w=!0,a=g,c=d;break}if(v===c){w=!0,c=g,a=d;break}v=v.sibling}if(!w)throw Error(r(189))}}if(a.alternate!==c)throw Error(r(190))}if(a.tag!==3)throw Error(r(188));return a.stateNode.current===a?i:s}function p(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=p(i),s!==null)return s;i=i.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),j=Symbol.for("react.consumer"),C=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function Y(i){return i===null||typeof i!="object"?null:(i=te&&i[te]||i["@@iterator"],typeof i=="function"?i:null)}var U=Symbol.for("react.client.reference");function M(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===U?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case x:return"Fragment";case _:return"Profiler";case k:return"StrictMode";case Q:return"Suspense";case re:return"SuspenseList";case B:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case C:return(i.displayName||"Context")+".Provider";case j:return(i._context.displayName||"Context")+".Consumer";case Z:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case oe:return s=i.displayName||null,s!==null?s:M(i.type)||"Memo";case H:s=i._payload,i=i._init;try{return M(i(s))}catch{}}return null}var D=Array.isArray,S=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},ie=[],A=-1;function $(i){return{current:i}}function W(i){0>A||(i.current=ie[A],ie[A]=null,A--)}function ne(i,s){A++,ie[A]=i.current,i.current=s}var se=$(null),ue=$(null),fe=$(null),ve=$(null);function ke(i,s){switch(ne(fe,s),ne(ue,i),ne(se,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?Av(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=Av(s),i=_v(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}W(se),ne(se,i)}function Ie(){W(se),W(ue),W(fe)}function Je(i){i.memoizedState!==null&&ne(ve,i);var s=se.current,a=_v(s,i.type);s!==a&&(ne(ue,i),ne(se,a))}function an(i){ue.current===i&&(W(se),W(ue)),ve.current===i&&(W(ve),xl._currentValue=L)}var In=Object.prototype.hasOwnProperty,zs=n.unstable_scheduleCallback,Cd=n.unstable_cancelCallback,Ck=n.unstable_shouldYield,Nk=n.unstable_requestPaint,Jn=n.unstable_now,Bk=n.unstable_getCurrentPriorityLevel,i0=n.unstable_ImmediatePriority,s0=n.unstable_UserBlockingPriority,Nc=n.unstable_NormalPriority,Dk=n.unstable_LowPriority,o0=n.unstable_IdlePriority,Rk=n.log,Mk=n.unstable_setDisableYieldValue,Ba=null,ln=null;function Gr(i){if(typeof Rk=="function"&&Mk(i),ln&&typeof ln.setStrictMode=="function")try{ln.setStrictMode(Ba,i)}catch{}}var cn=Math.clz32?Math.clz32:Lk,Ik=Math.log,Ok=Math.LN2;function Lk(i){return i>>>=0,i===0?32:31-(Ik(i)/Ok|0)|0}var Bc=256,Dc=4194304;function Vi(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Rc(i,s,a){var c=i.pendingLanes;if(c===0)return 0;var d=0,g=i.suspendedLanes,w=i.pingedLanes;i=i.warmLanes;var v=c&134217727;return v!==0?(c=v&~g,c!==0?d=Vi(c):(w&=v,w!==0?d=Vi(w):a||(a=v&~i,a!==0&&(d=Vi(a))))):(v=c&~g,v!==0?d=Vi(v):w!==0?d=Vi(w):a||(a=c&~i,a!==0&&(d=Vi(a)))),d===0?0:s!==0&&s!==d&&(s&g)===0&&(g=d&-d,a=s&-s,g>=a||g===32&&(a&4194048)!==0)?s:d}function Da(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Uk(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function a0(){var i=Bc;return Bc<<=1,(Bc&4194048)===0&&(Bc=256),i}function l0(){var i=Dc;return Dc<<=1,(Dc&62914560)===0&&(Dc=4194304),i}function Nd(i){for(var s=[],a=0;31>a;a++)s.push(i);return s}function Ra(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Pk(i,s,a,c,d,g){var w=i.pendingLanes;i.pendingLanes=a,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=a,i.entangledLanes&=a,i.errorRecoveryDisabledLanes&=a,i.shellSuspendCounter=0;var v=i.entanglements,T=i.expirationTimes,V=i.hiddenUpdates;for(a=w&~a;0<a;){var X=31-cn(a),ee=1<<X;v[X]=0,T[X]=-1;var q=V[X];if(q!==null)for(V[X]=null,X=0;X<q.length;X++){var F=q[X];F!==null&&(F.lane&=-536870913)}a&=~ee}c!==0&&c0(i,c,0),g!==0&&d===0&&i.tag!==0&&(i.suspendedLanes|=g&~(w&~s))}function c0(i,s,a){i.pendingLanes|=s,i.suspendedLanes&=~s;var c=31-cn(s);i.entangledLanes|=s,i.entanglements[c]=i.entanglements[c]|1073741824|a&4194090}function u0(i,s){var a=i.entangledLanes|=s;for(i=i.entanglements;a;){var c=31-cn(a),d=1<<c;d&s|i[c]&s&&(i[c]|=s),a&=~d}}function Bd(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Dd(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function f0(){var i=I.p;return i!==0?i:(i=window.event,i===void 0?32:Fv(i.type))}function zk(i,s){var a=I.p;try{return I.p=i,s()}finally{I.p=a}}var Yr=Math.random().toString(36).slice(2),Vt="__reactFiber$"+Yr,Jt="__reactProps$"+Yr,Vs="__reactContainer$"+Yr,Rd="__reactEvents$"+Yr,Vk="__reactListeners$"+Yr,$k="__reactHandles$"+Yr,d0="__reactResources$"+Yr,Ma="__reactMarker$"+Yr;function Md(i){delete i[Vt],delete i[Jt],delete i[Rd],delete i[Vk],delete i[$k]}function $s(i){var s=i[Vt];if(s)return s;for(var a=i.parentNode;a;){if(s=a[Vs]||a[Vt]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(i=Nv(i);i!==null;){if(a=i[Vt])return a;i=Nv(i)}return s}i=a,a=i.parentNode}return null}function Hs(i){if(i=i[Vt]||i[Vs]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function Ia(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function qs(i){var s=i[d0];return s||(s=i[d0]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function At(i){i[Ma]=!0}var h0=new Set,g0={};function $i(i,s){Fs(i,s),Fs(i+"Capture",s)}function Fs(i,s){for(g0[i]=s,i=0;i<s.length;i++)h0.add(s[i])}var Hk=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),p0={},m0={};function qk(i){return In.call(m0,i)?!0:In.call(p0,i)?!1:Hk.test(i)?m0[i]=!0:(p0[i]=!0,!1)}function Mc(i,s,a){if(qk(s))if(a===null)i.removeAttribute(s);else{switch(typeof a){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+a)}}function Ic(i,s,a){if(a===null)i.removeAttribute(s);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+a)}}function hr(i,s,a,c){if(c===null)i.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttributeNS(s,a,""+c)}}var Id,y0;function Ks(i){if(Id===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);Id=s&&s[1]||"",y0=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Id+i+y0}var Od=!1;function Ld(i,s){if(!i||Od)return"";Od=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var ee=function(){throw Error()};if(Object.defineProperty(ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ee,[])}catch(F){var q=F}Reflect.construct(i,[],ee)}else{try{ee.call()}catch(F){q=F}i.call(ee.prototype)}}else{try{throw Error()}catch(F){q=F}(ee=i())&&typeof ee.catch=="function"&&ee.catch(function(){})}}catch(F){if(F&&q&&typeof F.stack=="string")return[F.stack,q.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),w=g[0],v=g[1];if(w&&v){var T=w.split(`
`),V=v.split(`
`);for(d=c=0;c<T.length&&!T[c].includes("DetermineComponentFrameRoot");)c++;for(;d<V.length&&!V[d].includes("DetermineComponentFrameRoot");)d++;if(c===T.length||d===V.length)for(c=T.length-1,d=V.length-1;1<=c&&0<=d&&T[c]!==V[d];)d--;for(;1<=c&&0<=d;c--,d--)if(T[c]!==V[d]){if(c!==1||d!==1)do if(c--,d--,0>d||T[c]!==V[d]){var X=`
`+T[c].replace(" at new "," at ");return i.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",i.displayName)),X}while(1<=c&&0<=d);break}}}finally{Od=!1,Error.prepareStackTrace=a}return(a=i?i.displayName||i.name:"")?Ks(a):""}function Fk(i){switch(i.tag){case 26:case 27:case 5:return Ks(i.type);case 16:return Ks("Lazy");case 13:return Ks("Suspense");case 19:return Ks("SuspenseList");case 0:case 15:return Ld(i.type,!1);case 11:return Ld(i.type.render,!1);case 1:return Ld(i.type,!0);case 31:return Ks("Activity");default:return""}}function b0(i){try{var s="";do s+=Fk(i),i=i.return;while(i);return s}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}function xn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function w0(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Kk(i){var s=w0(i)?"checked":"value",a=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),c=""+i[s];if(!i.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,g=a.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return d.call(this)},set:function(w){c=""+w,g.call(this,w)}}),Object.defineProperty(i,s,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Oc(i){i._valueTracker||(i._valueTracker=Kk(i))}function v0(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var a=s.getValue(),c="";return i&&(c=w0(i)?i.checked?"true":"false":i.value),i=c,i!==a?(s.setValue(i),!0):!1}function Lc(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var jk=/[\n"\\]/g;function Sn(i){return i.replace(jk,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ud(i,s,a,c,d,g,w,v){i.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?i.type=w:i.removeAttribute("type"),s!=null?w==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+xn(s)):i.value!==""+xn(s)&&(i.value=""+xn(s)):w!=="submit"&&w!=="reset"||i.removeAttribute("value"),s!=null?Pd(i,w,xn(s)):a!=null?Pd(i,w,xn(a)):c!=null&&i.removeAttribute("value"),d==null&&g!=null&&(i.defaultChecked=!!g),d!=null&&(i.checked=d&&typeof d!="function"&&typeof d!="symbol"),v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?i.name=""+xn(v):i.removeAttribute("name")}function E0(i,s,a,c,d,g,w,v){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(i.type=g),s!=null||a!=null){if(!(g!=="submit"&&g!=="reset"||s!=null))return;a=a!=null?""+xn(a):"",s=s!=null?""+xn(s):a,v||s===i.value||(i.value=s),i.defaultValue=s}c=c??d,c=typeof c!="function"&&typeof c!="symbol"&&!!c,i.checked=v?i.checked:!!c,i.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.name=w)}function Pd(i,s,a){s==="number"&&Lc(i.ownerDocument)===i||i.defaultValue===""+a||(i.defaultValue=""+a)}function js(i,s,a,c){if(i=i.options,s){s={};for(var d=0;d<a.length;d++)s["$"+a[d]]=!0;for(a=0;a<i.length;a++)d=s.hasOwnProperty("$"+i[a].value),i[a].selected!==d&&(i[a].selected=d),d&&c&&(i[a].defaultSelected=!0)}else{for(a=""+xn(a),s=null,d=0;d<i.length;d++){if(i[d].value===a){i[d].selected=!0,c&&(i[d].defaultSelected=!0);return}s!==null||i[d].disabled||(s=i[d])}s!==null&&(s.selected=!0)}}function x0(i,s,a){if(s!=null&&(s=""+xn(s),s!==i.value&&(i.value=s),a==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=a!=null?""+xn(a):""}function S0(i,s,a,c){if(s==null){if(c!=null){if(a!=null)throw Error(r(92));if(D(c)){if(1<c.length)throw Error(r(93));c=c[0]}a=c}a==null&&(a=""),s=a}a=xn(s),i.defaultValue=a,c=i.textContent,c===a&&c!==""&&c!==null&&(i.value=c)}function Gs(i,s){if(s){var a=i.firstChild;if(a&&a===i.lastChild&&a.nodeType===3){a.nodeValue=s;return}}i.textContent=s}var Gk=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function A0(i,s,a){var c=s.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":c?i.setProperty(s,a):typeof a!="number"||a===0||Gk.has(s)?s==="float"?i.cssFloat=a:i[s]=(""+a).trim():i[s]=a+"px"}function _0(i,s,a){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="");for(var d in s)c=s[d],s.hasOwnProperty(d)&&a[d]!==c&&A0(i,d,c)}else for(var g in s)s.hasOwnProperty(g)&&A0(i,g,s[g])}function zd(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zk=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Uc(i){return Zk.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Vd=null;function $d(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ys=null,Zs=null;function T0(i){var s=Hs(i);if(s&&(i=s.stateNode)){var a=i[Jt]||null;e:switch(i=s.stateNode,s.type){case"input":if(Ud(i,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),s=a.name,a.type==="radio"&&s!=null){for(a=i;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Sn(""+s)+'"][type="radio"]'),s=0;s<a.length;s++){var c=a[s];if(c!==i&&c.form===i.form){var d=c[Jt]||null;if(!d)throw Error(r(90));Ud(c,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(s=0;s<a.length;s++)c=a[s],c.form===i.form&&v0(c)}break e;case"textarea":x0(i,a.value,a.defaultValue);break e;case"select":s=a.value,s!=null&&js(i,!!a.multiple,s,!1)}}}var Hd=!1;function k0(i,s,a){if(Hd)return i(s,a);Hd=!0;try{var c=i(s);return c}finally{if(Hd=!1,(Ys!==null||Zs!==null)&&(xu(),Ys&&(s=Ys,i=Zs,Zs=Ys=null,T0(s),i)))for(s=0;s<i.length;s++)T0(i[s])}}function Oa(i,s){var a=i.stateNode;if(a===null)return null;var c=a[Jt]||null;if(c===null)return null;a=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(i=i.type,c=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!c;break e;default:i=!1}if(i)return null;if(a&&typeof a!="function")throw Error(r(231,s,typeof a));return a}var gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qd=!1;if(gr)try{var La={};Object.defineProperty(La,"passive",{get:function(){qd=!0}}),window.addEventListener("test",La,La),window.removeEventListener("test",La,La)}catch{qd=!1}var Zr=null,Fd=null,Pc=null;function C0(){if(Pc)return Pc;var i,s=Fd,a=s.length,c,d="value"in Zr?Zr.value:Zr.textContent,g=d.length;for(i=0;i<a&&s[i]===d[i];i++);var w=a-i;for(c=1;c<=w&&s[a-c]===d[g-c];c++);return Pc=d.slice(i,1<c?1-c:void 0)}function zc(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Vc(){return!0}function N0(){return!1}function Wt(i){function s(a,c,d,g,w){this._reactName=a,this._targetInst=d,this.type=c,this.nativeEvent=g,this.target=w,this.currentTarget=null;for(var v in i)i.hasOwnProperty(v)&&(a=i[v],this[v]=a?a(g):g[v]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Vc:N0,this.isPropagationStopped=N0,this}return m(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Vc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Vc)},persist:function(){},isPersistent:Vc}),s}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$c=Wt(Hi),Ua=m({},Hi,{view:0,detail:0}),Xk=Wt(Ua),Kd,jd,Pa,Hc=m({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yd,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Pa&&(Pa&&i.type==="mousemove"?(Kd=i.screenX-Pa.screenX,jd=i.screenY-Pa.screenY):jd=Kd=0,Pa=i),Kd)},movementY:function(i){return"movementY"in i?i.movementY:jd}}),B0=Wt(Hc),Qk=m({},Hc,{dataTransfer:0}),Jk=Wt(Qk),Wk=m({},Ua,{relatedTarget:0}),Gd=Wt(Wk),eC=m({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),tC=Wt(eC),nC=m({},Hi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),rC=Wt(nC),iC=m({},Hi,{data:0}),D0=Wt(iC),sC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lC(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=aC[i])?!!s[i]:!1}function Yd(){return lC}var cC=m({},Ua,{key:function(i){if(i.key){var s=sC[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=zc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?oC[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yd,charCode:function(i){return i.type==="keypress"?zc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?zc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),uC=Wt(cC),fC=m({},Hc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R0=Wt(fC),dC=m({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yd}),hC=Wt(dC),gC=m({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),pC=Wt(gC),mC=m({},Hc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),yC=Wt(mC),bC=m({},Hi,{newState:0,oldState:0}),wC=Wt(bC),vC=[9,13,27,32],Zd=gr&&"CompositionEvent"in window,za=null;gr&&"documentMode"in document&&(za=document.documentMode);var EC=gr&&"TextEvent"in window&&!za,M0=gr&&(!Zd||za&&8<za&&11>=za),I0=" ",O0=!1;function L0(i,s){switch(i){case"keyup":return vC.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function U0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Xs=!1;function xC(i,s){switch(i){case"compositionend":return U0(s);case"keypress":return s.which!==32?null:(O0=!0,I0);case"textInput":return i=s.data,i===I0&&O0?null:i;default:return null}}function SC(i,s){if(Xs)return i==="compositionend"||!Zd&&L0(i,s)?(i=C0(),Pc=Fd=Zr=null,Xs=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return M0&&s.locale!=="ko"?null:s.data;default:return null}}var AC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P0(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!AC[i.type]:s==="textarea"}function z0(i,s,a,c){Ys?Zs?Zs.push(c):Zs=[c]:Ys=c,s=Cu(s,"onChange"),0<s.length&&(a=new $c("onChange","change",null,a,c),i.push({event:a,listeners:s}))}var Va=null,$a=null;function _C(i){wv(i,0)}function qc(i){var s=Ia(i);if(v0(s))return i}function V0(i,s){if(i==="change")return s}var $0=!1;if(gr){var Xd;if(gr){var Qd="oninput"in document;if(!Qd){var H0=document.createElement("div");H0.setAttribute("oninput","return;"),Qd=typeof H0.oninput=="function"}Xd=Qd}else Xd=!1;$0=Xd&&(!document.documentMode||9<document.documentMode)}function q0(){Va&&(Va.detachEvent("onpropertychange",F0),$a=Va=null)}function F0(i){if(i.propertyName==="value"&&qc($a)){var s=[];z0(s,$a,i,$d(i)),k0(_C,s)}}function TC(i,s,a){i==="focusin"?(q0(),Va=s,$a=a,Va.attachEvent("onpropertychange",F0)):i==="focusout"&&q0()}function kC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return qc($a)}function CC(i,s){if(i==="click")return qc(s)}function NC(i,s){if(i==="input"||i==="change")return qc(s)}function BC(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var un=typeof Object.is=="function"?Object.is:BC;function Ha(i,s){if(un(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var a=Object.keys(i),c=Object.keys(s);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var d=a[c];if(!In.call(s,d)||!un(i[d],s[d]))return!1}return!0}function K0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function j0(i,s){var a=K0(i);i=0;for(var c;a;){if(a.nodeType===3){if(c=i+a.textContent.length,i<=s&&c>=s)return{node:a,offset:s-i};i=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=K0(a)}}function G0(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?G0(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Y0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Lc(i.document);s instanceof i.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)i=s.contentWindow;else break;s=Lc(i.document)}return s}function Jd(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var DC=gr&&"documentMode"in document&&11>=document.documentMode,Qs=null,Wd=null,qa=null,eh=!1;function Z0(i,s,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;eh||Qs==null||Qs!==Lc(c)||(c=Qs,"selectionStart"in c&&Jd(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),qa&&Ha(qa,c)||(qa=c,c=Cu(Wd,"onSelect"),0<c.length&&(s=new $c("onSelect","select",null,s,a),i.push({event:s,listeners:c}),s.target=Qs)))}function qi(i,s){var a={};return a[i.toLowerCase()]=s.toLowerCase(),a["Webkit"+i]="webkit"+s,a["Moz"+i]="moz"+s,a}var Js={animationend:qi("Animation","AnimationEnd"),animationiteration:qi("Animation","AnimationIteration"),animationstart:qi("Animation","AnimationStart"),transitionrun:qi("Transition","TransitionRun"),transitionstart:qi("Transition","TransitionStart"),transitioncancel:qi("Transition","TransitionCancel"),transitionend:qi("Transition","TransitionEnd")},th={},X0={};gr&&(X0=document.createElement("div").style,"AnimationEvent"in window||(delete Js.animationend.animation,delete Js.animationiteration.animation,delete Js.animationstart.animation),"TransitionEvent"in window||delete Js.transitionend.transition);function Fi(i){if(th[i])return th[i];if(!Js[i])return i;var s=Js[i],a;for(a in s)if(s.hasOwnProperty(a)&&a in X0)return th[i]=s[a];return i}var Q0=Fi("animationend"),J0=Fi("animationiteration"),W0=Fi("animationstart"),RC=Fi("transitionrun"),MC=Fi("transitionstart"),IC=Fi("transitioncancel"),eb=Fi("transitionend"),tb=new Map,nh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nh.push("scrollEnd");function On(i,s){tb.set(i,s),$i(s,[i])}var nb=new WeakMap;function An(i,s){if(typeof i=="object"&&i!==null){var a=nb.get(i);return a!==void 0?a:(s={value:i,source:s,stack:b0(s)},nb.set(i,s),s)}return{value:i,source:s,stack:b0(s)}}var _n=[],Ws=0,rh=0;function Fc(){for(var i=Ws,s=rh=Ws=0;s<i;){var a=_n[s];_n[s++]=null;var c=_n[s];_n[s++]=null;var d=_n[s];_n[s++]=null;var g=_n[s];if(_n[s++]=null,c!==null&&d!==null){var w=c.pending;w===null?d.next=d:(d.next=w.next,w.next=d),c.pending=d}g!==0&&rb(a,d,g)}}function Kc(i,s,a,c){_n[Ws++]=i,_n[Ws++]=s,_n[Ws++]=a,_n[Ws++]=c,rh|=c,i.lanes|=c,i=i.alternate,i!==null&&(i.lanes|=c)}function ih(i,s,a,c){return Kc(i,s,a,c),jc(i)}function eo(i,s){return Kc(i,null,null,s),jc(i)}function rb(i,s,a){i.lanes|=a;var c=i.alternate;c!==null&&(c.lanes|=a);for(var d=!1,g=i.return;g!==null;)g.childLanes|=a,c=g.alternate,c!==null&&(c.childLanes|=a),g.tag===22&&(i=g.stateNode,i===null||i._visibility&1||(d=!0)),i=g,g=g.return;return i.tag===3?(g=i.stateNode,d&&s!==null&&(d=31-cn(a),i=g.hiddenUpdates,c=i[d],c===null?i[d]=[s]:c.push(s),s.lane=a|536870912),g):null}function jc(i){if(50<gl)throw gl=0,ug=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var to={};function OC(i,s,a,c){this.tag=i,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fn(i,s,a,c){return new OC(i,s,a,c)}function sh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function pr(i,s){var a=i.alternate;return a===null?(a=fn(i.tag,s,i.key,i.mode),a.elementType=i.elementType,a.type=i.type,a.stateNode=i.stateNode,a.alternate=i,i.alternate=a):(a.pendingProps=s,a.type=i.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=i.flags&65011712,a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,s=i.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=i.sibling,a.index=i.index,a.ref=i.ref,a.refCleanup=i.refCleanup,a}function ib(i,s){i.flags&=65011714;var a=i.alternate;return a===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,s=a.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Gc(i,s,a,c,d,g){var w=0;if(c=i,typeof i=="function")sh(i)&&(w=1);else if(typeof i=="string")w=U6(i,a,se.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case B:return i=fn(31,a,s,d),i.elementType=B,i.lanes=g,i;case x:return Ki(a.children,d,g,s);case k:w=8,d|=24;break;case _:return i=fn(12,a,s,d|2),i.elementType=_,i.lanes=g,i;case Q:return i=fn(13,a,s,d),i.elementType=Q,i.lanes=g,i;case re:return i=fn(19,a,s,d),i.elementType=re,i.lanes=g,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case R:case C:w=10;break e;case j:w=9;break e;case Z:w=11;break e;case oe:w=14;break e;case H:w=16,c=null;break e}w=29,a=Error(r(130,i===null?"null":typeof i,"")),c=null}return s=fn(w,a,s,d),s.elementType=i,s.type=c,s.lanes=g,s}function Ki(i,s,a,c){return i=fn(7,i,c,s),i.lanes=a,i}function oh(i,s,a){return i=fn(6,i,null,s),i.lanes=a,i}function ah(i,s,a){return s=fn(4,i.children!==null?i.children:[],i.key,s),s.lanes=a,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var no=[],ro=0,Yc=null,Zc=0,Tn=[],kn=0,ji=null,mr=1,yr="";function Gi(i,s){no[ro++]=Zc,no[ro++]=Yc,Yc=i,Zc=s}function sb(i,s,a){Tn[kn++]=mr,Tn[kn++]=yr,Tn[kn++]=ji,ji=i;var c=mr;i=yr;var d=32-cn(c)-1;c&=~(1<<d),a+=1;var g=32-cn(s)+d;if(30<g){var w=d-d%5;g=(c&(1<<w)-1).toString(32),c>>=w,d-=w,mr=1<<32-cn(s)+d|a<<d|c,yr=g+i}else mr=1<<g|a<<d|c,yr=i}function lh(i){i.return!==null&&(Gi(i,1),sb(i,1,0))}function ch(i){for(;i===Yc;)Yc=no[--ro],no[ro]=null,Zc=no[--ro],no[ro]=null;for(;i===ji;)ji=Tn[--kn],Tn[kn]=null,yr=Tn[--kn],Tn[kn]=null,mr=Tn[--kn],Tn[kn]=null}var Yt=null,ct=null,Ve=!1,Yi=null,Wn=!1,uh=Error(r(519));function Zi(i){var s=Error(r(418,""));throw ja(An(s,i)),uh}function ob(i){var s=i.stateNode,a=i.type,c=i.memoizedProps;switch(s[Vt]=i,s[Jt]=c,a){case"dialog":Me("cancel",s),Me("close",s);break;case"iframe":case"object":case"embed":Me("load",s);break;case"video":case"audio":for(a=0;a<ml.length;a++)Me(ml[a],s);break;case"source":Me("error",s);break;case"img":case"image":case"link":Me("error",s),Me("load",s);break;case"details":Me("toggle",s);break;case"input":Me("invalid",s),E0(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Oc(s);break;case"select":Me("invalid",s);break;case"textarea":Me("invalid",s),S0(s,c.value,c.defaultValue,c.children),Oc(s)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||s.textContent===""+a||c.suppressHydrationWarning===!0||Sv(s.textContent,a)?(c.popover!=null&&(Me("beforetoggle",s),Me("toggle",s)),c.onScroll!=null&&Me("scroll",s),c.onScrollEnd!=null&&Me("scrollend",s),c.onClick!=null&&(s.onclick=Nu),s=!0):s=!1,s||Zi(i)}function ab(i){for(Yt=i.return;Yt;)switch(Yt.tag){case 5:case 13:Wn=!1;return;case 27:case 3:Wn=!0;return;default:Yt=Yt.return}}function Fa(i){if(i!==Yt)return!1;if(!Ve)return ab(i),Ve=!0,!1;var s=i.tag,a;if((a=s!==3&&s!==27)&&((a=s===5)&&(a=i.type,a=!(a!=="form"&&a!=="button")||Tg(i.type,i.memoizedProps)),a=!a),a&&ct&&Zi(i),ab(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(a=i.data,a==="/$"){if(s===0){ct=Un(i.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++;i=i.nextSibling}ct=null}}else s===27?(s=ct,fi(i.type)?(i=Bg,Bg=null,ct=i):ct=s):ct=Yt?Un(i.stateNode.nextSibling):null;return!0}function Ka(){ct=Yt=null,Ve=!1}function lb(){var i=Yi;return i!==null&&(nn===null?nn=i:nn.push.apply(nn,i),Yi=null),i}function ja(i){Yi===null?Yi=[i]:Yi.push(i)}var fh=$(null),Xi=null,br=null;function Xr(i,s,a){ne(fh,s._currentValue),s._currentValue=a}function wr(i){i._currentValue=fh.current,W(fh)}function dh(i,s,a){for(;i!==null;){var c=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),i===a)break;i=i.return}}function hh(i,s,a,c){var d=i.child;for(d!==null&&(d.return=i);d!==null;){var g=d.dependencies;if(g!==null){var w=d.child;g=g.firstContext;e:for(;g!==null;){var v=g;g=d;for(var T=0;T<s.length;T++)if(v.context===s[T]){g.lanes|=a,v=g.alternate,v!==null&&(v.lanes|=a),dh(g.return,a,i),c||(w=null);break e}g=v.next}}else if(d.tag===18){if(w=d.return,w===null)throw Error(r(341));w.lanes|=a,g=w.alternate,g!==null&&(g.lanes|=a),dh(w,a,i),w=null}else w=d.child;if(w!==null)w.return=d;else for(w=d;w!==null;){if(w===i){w=null;break}if(d=w.sibling,d!==null){d.return=w.return,w=d;break}w=w.return}d=w}}function Ga(i,s,a,c){i=null;for(var d=s,g=!1;d!==null;){if(!g){if((d.flags&524288)!==0)g=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var w=d.alternate;if(w===null)throw Error(r(387));if(w=w.memoizedProps,w!==null){var v=d.type;un(d.pendingProps.value,w.value)||(i!==null?i.push(v):i=[v])}}else if(d===ve.current){if(w=d.alternate,w===null)throw Error(r(387));w.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(i!==null?i.push(xl):i=[xl])}d=d.return}i!==null&&hh(s,i,a,c),s.flags|=262144}function Xc(i){for(i=i.firstContext;i!==null;){if(!un(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Qi(i){Xi=i,br=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function $t(i){return cb(Xi,i)}function Qc(i,s){return Xi===null&&Qi(i),cb(i,s)}function cb(i,s){var a=s._currentValue;if(s={context:s,memoizedValue:a,next:null},br===null){if(i===null)throw Error(r(308));br=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else br=br.next=s;return a}var LC=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(a,c){i.push(c)}};this.abort=function(){s.aborted=!0,i.forEach(function(a){return a()})}},UC=n.unstable_scheduleCallback,PC=n.unstable_NormalPriority,vt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function gh(){return{controller:new LC,data:new Map,refCount:0}}function Ya(i){i.refCount--,i.refCount===0&&UC(PC,function(){i.controller.abort()})}var Za=null,ph=0,io=0,so=null;function zC(i,s){if(Za===null){var a=Za=[];ph=0,io=yg(),so={status:"pending",value:void 0,then:function(c){a.push(c)}}}return ph++,s.then(ub,ub),s}function ub(){if(--ph===0&&Za!==null){so!==null&&(so.status="fulfilled");var i=Za;Za=null,io=0,so=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function VC(i,s){var a=[],c={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return i.then(function(){c.status="fulfilled",c.value=s;for(var d=0;d<a.length;d++)(0,a[d])(s)},function(d){for(c.status="rejected",c.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),c}var fb=S.S;S.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&zC(i,s),fb!==null&&fb(i,s)};var Ji=$(null);function mh(){var i=Ji.current;return i!==null?i:Qe.pooledCache}function Jc(i,s){s===null?ne(Ji,Ji.current):ne(Ji,s.pool)}function db(){var i=mh();return i===null?null:{parent:vt._currentValue,pool:i}}var Xa=Error(r(460)),hb=Error(r(474)),Wc=Error(r(542)),yh={then:function(){}};function gb(i){return i=i.status,i==="fulfilled"||i==="rejected"}function eu(){}function pb(i,s,a){switch(a=i[a],a===void 0?i.push(s):a!==s&&(s.then(eu,eu),s=a),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,yb(i),i;default:if(typeof s.status=="string")s.then(eu,eu);else{if(i=Qe,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(c){if(s.status==="pending"){var d=s;d.status="fulfilled",d.value=c}},function(c){if(s.status==="pending"){var d=s;d.status="rejected",d.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,yb(i),i}throw Qa=s,Xa}}var Qa=null;function mb(){if(Qa===null)throw Error(r(459));var i=Qa;return Qa=null,i}function yb(i){if(i===Xa||i===Wc)throw Error(r(483))}var Qr=!1;function bh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wh(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Jr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Wr(i,s,a){var c=i.updateQueue;if(c===null)return null;if(c=c.shared,(He&2)!==0){var d=c.pending;return d===null?s.next=s:(s.next=d.next,d.next=s),c.pending=s,s=jc(i),rb(i,null,a),s}return Kc(i,c,s,a),jc(i)}function Ja(i,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194048)!==0)){var c=s.lanes;c&=i.pendingLanes,a|=c,s.lanes=a,u0(i,a)}}function vh(i,s){var a=i.updateQueue,c=i.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var d=null,g=null;if(a=a.firstBaseUpdate,a!==null){do{var w={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};g===null?d=g=w:g=g.next=w,a=a.next}while(a!==null);g===null?d=g=s:g=g.next=s}else d=g=s;a={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},i.updateQueue=a;return}i=a.lastBaseUpdate,i===null?a.firstBaseUpdate=s:i.next=s,a.lastBaseUpdate=s}var Eh=!1;function Wa(){if(Eh){var i=so;if(i!==null)throw i}}function el(i,s,a,c){Eh=!1;var d=i.updateQueue;Qr=!1;var g=d.firstBaseUpdate,w=d.lastBaseUpdate,v=d.shared.pending;if(v!==null){d.shared.pending=null;var T=v,V=T.next;T.next=null,w===null?g=V:w.next=V,w=T;var X=i.alternate;X!==null&&(X=X.updateQueue,v=X.lastBaseUpdate,v!==w&&(v===null?X.firstBaseUpdate=V:v.next=V,X.lastBaseUpdate=T))}if(g!==null){var ee=d.baseState;w=0,X=V=T=null,v=g;do{var q=v.lane&-536870913,F=q!==v.lane;if(F?(Oe&q)===q:(c&q)===q){q!==0&&q===io&&(Eh=!0),X!==null&&(X=X.next={lane:0,tag:v.tag,payload:v.payload,callback:null,next:null});e:{var Te=i,xe=v;q=s;var Ye=a;switch(xe.tag){case 1:if(Te=xe.payload,typeof Te=="function"){ee=Te.call(Ye,ee,q);break e}ee=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=xe.payload,q=typeof Te=="function"?Te.call(Ye,ee,q):Te,q==null)break e;ee=m({},ee,q);break e;case 2:Qr=!0}}q=v.callback,q!==null&&(i.flags|=64,F&&(i.flags|=8192),F=d.callbacks,F===null?d.callbacks=[q]:F.push(q))}else F={lane:q,tag:v.tag,payload:v.payload,callback:v.callback,next:null},X===null?(V=X=F,T=ee):X=X.next=F,w|=q;if(v=v.next,v===null){if(v=d.shared.pending,v===null)break;F=v,v=F.next,F.next=null,d.lastBaseUpdate=F,d.shared.pending=null}}while(!0);X===null&&(T=ee),d.baseState=T,d.firstBaseUpdate=V,d.lastBaseUpdate=X,g===null&&(d.shared.lanes=0),ai|=w,i.lanes=w,i.memoizedState=ee}}function bb(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function wb(i,s){var a=i.callbacks;if(a!==null)for(i.callbacks=null,i=0;i<a.length;i++)bb(a[i],s)}var oo=$(null),tu=$(0);function vb(i,s){i=Tr,ne(tu,i),ne(oo,s),Tr=i|s.baseLanes}function xh(){ne(tu,Tr),ne(oo,oo.current)}function Sh(){Tr=tu.current,W(oo),W(tu)}var ei=0,Ne=null,je=null,mt=null,nu=!1,ao=!1,Wi=!1,ru=0,tl=0,lo=null,$C=0;function gt(){throw Error(r(321))}function Ah(i,s){if(s===null)return!1;for(var a=0;a<s.length&&a<i.length;a++)if(!un(i[a],s[a]))return!1;return!0}function _h(i,s,a,c,d,g){return ei=g,Ne=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,S.H=i===null||i.memoizedState===null?rw:iw,Wi=!1,g=a(c,d),Wi=!1,ao&&(g=xb(s,a,c,d)),Eb(i),g}function Eb(i){S.H=cu;var s=je!==null&&je.next!==null;if(ei=0,mt=je=Ne=null,nu=!1,tl=0,lo=null,s)throw Error(r(300));i===null||_t||(i=i.dependencies,i!==null&&Xc(i)&&(_t=!0))}function xb(i,s,a,c){Ne=i;var d=0;do{if(ao&&(lo=null),tl=0,ao=!1,25<=d)throw Error(r(301));if(d+=1,mt=je=null,i.updateQueue!=null){var g=i.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}S.H=YC,g=s(a,c)}while(ao);return g}function HC(){var i=S.H,s=i.useState()[0];return s=typeof s.then=="function"?nl(s):s,i=i.useState()[0],(je!==null?je.memoizedState:null)!==i&&(Ne.flags|=1024),s}function Th(){var i=ru!==0;return ru=0,i}function kh(i,s,a){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~a}function Ch(i){if(nu){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}nu=!1}ei=0,mt=je=Ne=null,ao=!1,tl=ru=0,lo=null}function en(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Ne.memoizedState=mt=i:mt=mt.next=i,mt}function yt(){if(je===null){var i=Ne.alternate;i=i!==null?i.memoizedState:null}else i=je.next;var s=mt===null?Ne.memoizedState:mt.next;if(s!==null)mt=s,je=i;else{if(i===null)throw Ne.alternate===null?Error(r(467)):Error(r(310));je=i,i={memoizedState:je.memoizedState,baseState:je.baseState,baseQueue:je.baseQueue,queue:je.queue,next:null},mt===null?Ne.memoizedState=mt=i:mt=mt.next=i}return mt}function Nh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nl(i){var s=tl;return tl+=1,lo===null&&(lo=[]),i=pb(lo,i,s),s=Ne,(mt===null?s.memoizedState:mt.next)===null&&(s=s.alternate,S.H=s===null||s.memoizedState===null?rw:iw),i}function iu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return nl(i);if(i.$$typeof===C)return $t(i)}throw Error(r(438,String(i)))}function Bh(i){var s=null,a=Ne.updateQueue;if(a!==null&&(s=a.memoCache),s==null){var c=Ne.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(d){return d.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),a===null&&(a=Nh(),Ne.updateQueue=a),a.memoCache=s,a=s.data[s.index],a===void 0)for(a=s.data[s.index]=Array(i),c=0;c<i;c++)a[c]=G;return s.index++,a}function vr(i,s){return typeof s=="function"?s(i):s}function su(i){var s=yt();return Dh(s,je,i)}function Dh(i,s,a){var c=i.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=a;var d=i.baseQueue,g=c.pending;if(g!==null){if(d!==null){var w=d.next;d.next=g.next,g.next=w}s.baseQueue=d=g,c.pending=null}if(g=i.baseState,d===null)i.memoizedState=g;else{s=d.next;var v=w=null,T=null,V=s,X=!1;do{var ee=V.lane&-536870913;if(ee!==V.lane?(Oe&ee)===ee:(ei&ee)===ee){var q=V.revertLane;if(q===0)T!==null&&(T=T.next={lane:0,revertLane:0,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null}),ee===io&&(X=!0);else if((ei&q)===q){V=V.next,q===io&&(X=!0);continue}else ee={lane:0,revertLane:V.revertLane,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},T===null?(v=T=ee,w=g):T=T.next=ee,Ne.lanes|=q,ai|=q;ee=V.action,Wi&&a(g,ee),g=V.hasEagerState?V.eagerState:a(g,ee)}else q={lane:ee,revertLane:V.revertLane,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},T===null?(v=T=q,w=g):T=T.next=q,Ne.lanes|=ee,ai|=ee;V=V.next}while(V!==null&&V!==s);if(T===null?w=g:T.next=v,!un(g,i.memoizedState)&&(_t=!0,X&&(a=so,a!==null)))throw a;i.memoizedState=g,i.baseState=w,i.baseQueue=T,c.lastRenderedState=g}return d===null&&(c.lanes=0),[i.memoizedState,c.dispatch]}function Rh(i){var s=yt(),a=s.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=i;var c=a.dispatch,d=a.pending,g=s.memoizedState;if(d!==null){a.pending=null;var w=d=d.next;do g=i(g,w.action),w=w.next;while(w!==d);un(g,s.memoizedState)||(_t=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),a.lastRenderedState=g}return[g,c]}function Sb(i,s,a){var c=Ne,d=yt(),g=Ve;if(g){if(a===void 0)throw Error(r(407));a=a()}else a=s();var w=!un((je||d).memoizedState,a);w&&(d.memoizedState=a,_t=!0),d=d.queue;var v=Tb.bind(null,c,d,i);if(rl(2048,8,v,[i]),d.getSnapshot!==s||w||mt!==null&&mt.memoizedState.tag&1){if(c.flags|=2048,co(9,ou(),_b.bind(null,c,d,a,s),null),Qe===null)throw Error(r(349));g||(ei&124)!==0||Ab(c,s,a)}return a}function Ab(i,s,a){i.flags|=16384,i={getSnapshot:s,value:a},s=Ne.updateQueue,s===null?(s=Nh(),Ne.updateQueue=s,s.stores=[i]):(a=s.stores,a===null?s.stores=[i]:a.push(i))}function _b(i,s,a,c){s.value=a,s.getSnapshot=c,kb(s)&&Cb(i)}function Tb(i,s,a){return a(function(){kb(s)&&Cb(i)})}function kb(i){var s=i.getSnapshot;i=i.value;try{var a=s();return!un(i,a)}catch{return!0}}function Cb(i){var s=eo(i,2);s!==null&&mn(s,i,2)}function Mh(i){var s=en();if(typeof i=="function"){var a=i;if(i=a(),Wi){Gr(!0);try{a()}finally{Gr(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vr,lastRenderedState:i},s}function Nb(i,s,a,c){return i.baseState=a,Dh(i,je,typeof c=="function"?c:vr)}function qC(i,s,a,c,d){if(lu(i))throw Error(r(485));if(i=s.action,i!==null){var g={payload:d,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){g.listeners.push(w)}};S.T!==null?a(!0):g.isTransition=!1,c(g),a=s.pending,a===null?(g.next=s.pending=g,Bb(s,g)):(g.next=a.next,s.pending=a.next=g)}}function Bb(i,s){var a=s.action,c=s.payload,d=i.state;if(s.isTransition){var g=S.T,w={};S.T=w;try{var v=a(d,c),T=S.S;T!==null&&T(w,v),Db(i,s,v)}catch(V){Ih(i,s,V)}finally{S.T=g}}else try{g=a(d,c),Db(i,s,g)}catch(V){Ih(i,s,V)}}function Db(i,s,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){Rb(i,s,c)},function(c){return Ih(i,s,c)}):Rb(i,s,a)}function Rb(i,s,a){s.status="fulfilled",s.value=a,Mb(s),i.state=a,s=i.pending,s!==null&&(a=s.next,a===s?i.pending=null:(a=a.next,s.next=a,Bb(i,a)))}function Ih(i,s,a){var c=i.pending;if(i.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=a,Mb(s),s=s.next;while(s!==c)}i.action=null}function Mb(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function Ib(i,s){return s}function Ob(i,s){if(Ve){var a=Qe.formState;if(a!==null){e:{var c=Ne;if(Ve){if(ct){t:{for(var d=ct,g=Wn;d.nodeType!==8;){if(!g){d=null;break t}if(d=Un(d.nextSibling),d===null){d=null;break t}}g=d.data,d=g==="F!"||g==="F"?d:null}if(d){ct=Un(d.nextSibling),c=d.data==="F!";break e}}Zi(c)}c=!1}c&&(s=a[0])}}return a=en(),a.memoizedState=a.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ib,lastRenderedState:s},a.queue=c,a=ew.bind(null,Ne,c),c.dispatch=a,c=Mh(!1),g=zh.bind(null,Ne,!1,c.queue),c=en(),d={state:s,dispatch:null,action:i,pending:null},c.queue=d,a=qC.bind(null,Ne,d,g,a),d.dispatch=a,c.memoizedState=i,[s,a,!1]}function Lb(i){var s=yt();return Ub(s,je,i)}function Ub(i,s,a){if(s=Dh(i,s,Ib)[0],i=su(vr)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=nl(s)}catch(w){throw w===Xa?Wc:w}else c=s;s=yt();var d=s.queue,g=d.dispatch;return a!==s.memoizedState&&(Ne.flags|=2048,co(9,ou(),FC.bind(null,d,a),null)),[c,g,i]}function FC(i,s){i.action=s}function Pb(i){var s=yt(),a=je;if(a!==null)return Ub(s,a,i);yt(),s=s.memoizedState,a=yt();var c=a.queue.dispatch;return a.memoizedState=i,[s,c,!1]}function co(i,s,a,c){return i={tag:i,create:a,deps:c,inst:s,next:null},s=Ne.updateQueue,s===null&&(s=Nh(),Ne.updateQueue=s),a=s.lastEffect,a===null?s.lastEffect=i.next=i:(c=a.next,a.next=i,i.next=c,s.lastEffect=i),i}function ou(){return{destroy:void 0,resource:void 0}}function zb(){return yt().memoizedState}function au(i,s,a,c){var d=en();c=c===void 0?null:c,Ne.flags|=i,d.memoizedState=co(1|s,ou(),a,c)}function rl(i,s,a,c){var d=yt();c=c===void 0?null:c;var g=d.memoizedState.inst;je!==null&&c!==null&&Ah(c,je.memoizedState.deps)?d.memoizedState=co(s,g,a,c):(Ne.flags|=i,d.memoizedState=co(1|s,g,a,c))}function Vb(i,s){au(8390656,8,i,s)}function $b(i,s){rl(2048,8,i,s)}function Hb(i,s){return rl(4,2,i,s)}function qb(i,s){return rl(4,4,i,s)}function Fb(i,s){if(typeof s=="function"){i=i();var a=s(i);return function(){typeof a=="function"?a():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Kb(i,s,a){a=a!=null?a.concat([i]):null,rl(4,4,Fb.bind(null,s,i),a)}function Oh(){}function jb(i,s){var a=yt();s=s===void 0?null:s;var c=a.memoizedState;return s!==null&&Ah(s,c[1])?c[0]:(a.memoizedState=[i,s],i)}function Gb(i,s){var a=yt();s=s===void 0?null:s;var c=a.memoizedState;if(s!==null&&Ah(s,c[1]))return c[0];if(c=i(),Wi){Gr(!0);try{i()}finally{Gr(!1)}}return a.memoizedState=[c,s],c}function Lh(i,s,a){return a===void 0||(ei&1073741824)!==0?i.memoizedState=s:(i.memoizedState=a,i=Xw(),Ne.lanes|=i,ai|=i,a)}function Yb(i,s,a,c){return un(a,s)?a:oo.current!==null?(i=Lh(i,a,c),un(i,s)||(_t=!0),i):(ei&42)===0?(_t=!0,i.memoizedState=a):(i=Xw(),Ne.lanes|=i,ai|=i,s)}function Zb(i,s,a,c,d){var g=I.p;I.p=g!==0&&8>g?g:8;var w=S.T,v={};S.T=v,zh(i,!1,s,a);try{var T=d(),V=S.S;if(V!==null&&V(v,T),T!==null&&typeof T=="object"&&typeof T.then=="function"){var X=VC(T,c);il(i,s,X,pn(i))}else il(i,s,c,pn(i))}catch(ee){il(i,s,{then:function(){},status:"rejected",reason:ee},pn())}finally{I.p=g,S.T=w}}function KC(){}function Uh(i,s,a,c){if(i.tag!==5)throw Error(r(476));var d=Xb(i).queue;Zb(i,d,s,L,a===null?KC:function(){return Qb(i),a(c)})}function Xb(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vr,lastRenderedState:L},next:null};var a={};return s.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vr,lastRenderedState:a},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Qb(i){var s=Xb(i).next.queue;il(i,s,{},pn())}function Ph(){return $t(xl)}function Jb(){return yt().memoizedState}function Wb(){return yt().memoizedState}function jC(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var a=pn();i=Jr(a);var c=Wr(s,i,a);c!==null&&(mn(c,s,a),Ja(c,s,a)),s={cache:gh()},i.payload=s;return}s=s.return}}function GC(i,s,a){var c=pn();a={lane:c,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},lu(i)?tw(s,a):(a=ih(i,s,a,c),a!==null&&(mn(a,i,c),nw(a,s,c)))}function ew(i,s,a){var c=pn();il(i,s,a,c)}function il(i,s,a,c){var d={lane:c,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(lu(i))tw(s,d);else{var g=i.alternate;if(i.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var w=s.lastRenderedState,v=g(w,a);if(d.hasEagerState=!0,d.eagerState=v,un(v,w))return Kc(i,s,d,0),Qe===null&&Fc(),!1}catch{}finally{}if(a=ih(i,s,d,c),a!==null)return mn(a,i,c),nw(a,s,c),!0}return!1}function zh(i,s,a,c){if(c={lane:2,revertLane:yg(),action:c,hasEagerState:!1,eagerState:null,next:null},lu(i)){if(s)throw Error(r(479))}else s=ih(i,a,c,2),s!==null&&mn(s,i,2)}function lu(i){var s=i.alternate;return i===Ne||s!==null&&s===Ne}function tw(i,s){ao=nu=!0;var a=i.pending;a===null?s.next=s:(s.next=a.next,a.next=s),i.pending=s}function nw(i,s,a){if((a&4194048)!==0){var c=s.lanes;c&=i.pendingLanes,a|=c,s.lanes=a,u0(i,a)}}var cu={readContext:$t,use:iu,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useLayoutEffect:gt,useInsertionEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useSyncExternalStore:gt,useId:gt,useHostTransitionStatus:gt,useFormState:gt,useActionState:gt,useOptimistic:gt,useMemoCache:gt,useCacheRefresh:gt},rw={readContext:$t,use:iu,useCallback:function(i,s){return en().memoizedState=[i,s===void 0?null:s],i},useContext:$t,useEffect:Vb,useImperativeHandle:function(i,s,a){a=a!=null?a.concat([i]):null,au(4194308,4,Fb.bind(null,s,i),a)},useLayoutEffect:function(i,s){return au(4194308,4,i,s)},useInsertionEffect:function(i,s){au(4,2,i,s)},useMemo:function(i,s){var a=en();s=s===void 0?null:s;var c=i();if(Wi){Gr(!0);try{i()}finally{Gr(!1)}}return a.memoizedState=[c,s],c},useReducer:function(i,s,a){var c=en();if(a!==void 0){var d=a(s);if(Wi){Gr(!0);try{a(s)}finally{Gr(!1)}}}else d=s;return c.memoizedState=c.baseState=d,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:d},c.queue=i,i=i.dispatch=GC.bind(null,Ne,i),[c.memoizedState,i]},useRef:function(i){var s=en();return i={current:i},s.memoizedState=i},useState:function(i){i=Mh(i);var s=i.queue,a=ew.bind(null,Ne,s);return s.dispatch=a,[i.memoizedState,a]},useDebugValue:Oh,useDeferredValue:function(i,s){var a=en();return Lh(a,i,s)},useTransition:function(){var i=Mh(!1);return i=Zb.bind(null,Ne,i.queue,!0,!1),en().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,a){var c=Ne,d=en();if(Ve){if(a===void 0)throw Error(r(407));a=a()}else{if(a=s(),Qe===null)throw Error(r(349));(Oe&124)!==0||Ab(c,s,a)}d.memoizedState=a;var g={value:a,getSnapshot:s};return d.queue=g,Vb(Tb.bind(null,c,g,i),[i]),c.flags|=2048,co(9,ou(),_b.bind(null,c,g,a,s),null),a},useId:function(){var i=en(),s=Qe.identifierPrefix;if(Ve){var a=yr,c=mr;a=(c&~(1<<32-cn(c)-1)).toString(32)+a,s="«"+s+"R"+a,a=ru++,0<a&&(s+="H"+a.toString(32)),s+="»"}else a=$C++,s="«"+s+"r"+a.toString(32)+"»";return i.memoizedState=s},useHostTransitionStatus:Ph,useFormState:Ob,useActionState:Ob,useOptimistic:function(i){var s=en();s.memoizedState=s.baseState=i;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=a,s=zh.bind(null,Ne,!0,a),a.dispatch=s,[i,s]},useMemoCache:Bh,useCacheRefresh:function(){return en().memoizedState=jC.bind(null,Ne)}},iw={readContext:$t,use:iu,useCallback:jb,useContext:$t,useEffect:$b,useImperativeHandle:Kb,useInsertionEffect:Hb,useLayoutEffect:qb,useMemo:Gb,useReducer:su,useRef:zb,useState:function(){return su(vr)},useDebugValue:Oh,useDeferredValue:function(i,s){var a=yt();return Yb(a,je.memoizedState,i,s)},useTransition:function(){var i=su(vr)[0],s=yt().memoizedState;return[typeof i=="boolean"?i:nl(i),s]},useSyncExternalStore:Sb,useId:Jb,useHostTransitionStatus:Ph,useFormState:Lb,useActionState:Lb,useOptimistic:function(i,s){var a=yt();return Nb(a,je,i,s)},useMemoCache:Bh,useCacheRefresh:Wb},YC={readContext:$t,use:iu,useCallback:jb,useContext:$t,useEffect:$b,useImperativeHandle:Kb,useInsertionEffect:Hb,useLayoutEffect:qb,useMemo:Gb,useReducer:Rh,useRef:zb,useState:function(){return Rh(vr)},useDebugValue:Oh,useDeferredValue:function(i,s){var a=yt();return je===null?Lh(a,i,s):Yb(a,je.memoizedState,i,s)},useTransition:function(){var i=Rh(vr)[0],s=yt().memoizedState;return[typeof i=="boolean"?i:nl(i),s]},useSyncExternalStore:Sb,useId:Jb,useHostTransitionStatus:Ph,useFormState:Pb,useActionState:Pb,useOptimistic:function(i,s){var a=yt();return je!==null?Nb(a,je,i,s):(a.baseState=i,[i,a.queue.dispatch])},useMemoCache:Bh,useCacheRefresh:Wb},uo=null,sl=0;function uu(i){var s=sl;return sl+=1,uo===null&&(uo=[]),pb(uo,i,s)}function ol(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function fu(i,s){throw s.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function sw(i){var s=i._init;return s(i._payload)}function ow(i){function s(O,N){if(i){var z=O.deletions;z===null?(O.deletions=[N],O.flags|=16):z.push(N)}}function a(O,N){if(!i)return null;for(;N!==null;)s(O,N),N=N.sibling;return null}function c(O){for(var N=new Map;O!==null;)O.key!==null?N.set(O.key,O):N.set(O.index,O),O=O.sibling;return N}function d(O,N){return O=pr(O,N),O.index=0,O.sibling=null,O}function g(O,N,z){return O.index=z,i?(z=O.alternate,z!==null?(z=z.index,z<N?(O.flags|=67108866,N):z):(O.flags|=67108866,N)):(O.flags|=1048576,N)}function w(O){return i&&O.alternate===null&&(O.flags|=67108866),O}function v(O,N,z,J){return N===null||N.tag!==6?(N=oh(z,O.mode,J),N.return=O,N):(N=d(N,z),N.return=O,N)}function T(O,N,z,J){var pe=z.type;return pe===x?X(O,N,z.props.children,J,z.key):N!==null&&(N.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===H&&sw(pe)===N.type)?(N=d(N,z.props),ol(N,z),N.return=O,N):(N=Gc(z.type,z.key,z.props,null,O.mode,J),ol(N,z),N.return=O,N)}function V(O,N,z,J){return N===null||N.tag!==4||N.stateNode.containerInfo!==z.containerInfo||N.stateNode.implementation!==z.implementation?(N=ah(z,O.mode,J),N.return=O,N):(N=d(N,z.children||[]),N.return=O,N)}function X(O,N,z,J,pe){return N===null||N.tag!==7?(N=Ki(z,O.mode,J,pe),N.return=O,N):(N=d(N,z),N.return=O,N)}function ee(O,N,z){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=oh(""+N,O.mode,z),N.return=O,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case b:return z=Gc(N.type,N.key,N.props,null,O.mode,z),ol(z,N),z.return=O,z;case E:return N=ah(N,O.mode,z),N.return=O,N;case H:var J=N._init;return N=J(N._payload),ee(O,N,z)}if(D(N)||Y(N))return N=Ki(N,O.mode,z,null),N.return=O,N;if(typeof N.then=="function")return ee(O,uu(N),z);if(N.$$typeof===C)return ee(O,Qc(O,N),z);fu(O,N)}return null}function q(O,N,z,J){var pe=N!==null?N.key:null;if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return pe!==null?null:v(O,N,""+z,J);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case b:return z.key===pe?T(O,N,z,J):null;case E:return z.key===pe?V(O,N,z,J):null;case H:return pe=z._init,z=pe(z._payload),q(O,N,z,J)}if(D(z)||Y(z))return pe!==null?null:X(O,N,z,J,null);if(typeof z.then=="function")return q(O,N,uu(z),J);if(z.$$typeof===C)return q(O,N,Qc(O,z),J);fu(O,z)}return null}function F(O,N,z,J,pe){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return O=O.get(z)||null,v(N,O,""+J,pe);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case b:return O=O.get(J.key===null?z:J.key)||null,T(N,O,J,pe);case E:return O=O.get(J.key===null?z:J.key)||null,V(N,O,J,pe);case H:var De=J._init;return J=De(J._payload),F(O,N,z,J,pe)}if(D(J)||Y(J))return O=O.get(z)||null,X(N,O,J,pe,null);if(typeof J.then=="function")return F(O,N,z,uu(J),pe);if(J.$$typeof===C)return F(O,N,z,Qc(N,J),pe);fu(N,J)}return null}function Te(O,N,z,J){for(var pe=null,De=null,be=N,Ae=N=0,kt=null;be!==null&&Ae<z.length;Ae++){be.index>Ae?(kt=be,be=null):kt=be.sibling;var Ue=q(O,be,z[Ae],J);if(Ue===null){be===null&&(be=kt);break}i&&be&&Ue.alternate===null&&s(O,be),N=g(Ue,N,Ae),De===null?pe=Ue:De.sibling=Ue,De=Ue,be=kt}if(Ae===z.length)return a(O,be),Ve&&Gi(O,Ae),pe;if(be===null){for(;Ae<z.length;Ae++)be=ee(O,z[Ae],J),be!==null&&(N=g(be,N,Ae),De===null?pe=be:De.sibling=be,De=be);return Ve&&Gi(O,Ae),pe}for(be=c(be);Ae<z.length;Ae++)kt=F(be,O,Ae,z[Ae],J),kt!==null&&(i&&kt.alternate!==null&&be.delete(kt.key===null?Ae:kt.key),N=g(kt,N,Ae),De===null?pe=kt:De.sibling=kt,De=kt);return i&&be.forEach(function(mi){return s(O,mi)}),Ve&&Gi(O,Ae),pe}function xe(O,N,z,J){if(z==null)throw Error(r(151));for(var pe=null,De=null,be=N,Ae=N=0,kt=null,Ue=z.next();be!==null&&!Ue.done;Ae++,Ue=z.next()){be.index>Ae?(kt=be,be=null):kt=be.sibling;var mi=q(O,be,Ue.value,J);if(mi===null){be===null&&(be=kt);break}i&&be&&mi.alternate===null&&s(O,be),N=g(mi,N,Ae),De===null?pe=mi:De.sibling=mi,De=mi,be=kt}if(Ue.done)return a(O,be),Ve&&Gi(O,Ae),pe;if(be===null){for(;!Ue.done;Ae++,Ue=z.next())Ue=ee(O,Ue.value,J),Ue!==null&&(N=g(Ue,N,Ae),De===null?pe=Ue:De.sibling=Ue,De=Ue);return Ve&&Gi(O,Ae),pe}for(be=c(be);!Ue.done;Ae++,Ue=z.next())Ue=F(be,O,Ae,Ue.value,J),Ue!==null&&(i&&Ue.alternate!==null&&be.delete(Ue.key===null?Ae:Ue.key),N=g(Ue,N,Ae),De===null?pe=Ue:De.sibling=Ue,De=Ue);return i&&be.forEach(function(Z6){return s(O,Z6)}),Ve&&Gi(O,Ae),pe}function Ye(O,N,z,J){if(typeof z=="object"&&z!==null&&z.type===x&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case b:e:{for(var pe=z.key;N!==null;){if(N.key===pe){if(pe=z.type,pe===x){if(N.tag===7){a(O,N.sibling),J=d(N,z.props.children),J.return=O,O=J;break e}}else if(N.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===H&&sw(pe)===N.type){a(O,N.sibling),J=d(N,z.props),ol(J,z),J.return=O,O=J;break e}a(O,N);break}else s(O,N);N=N.sibling}z.type===x?(J=Ki(z.props.children,O.mode,J,z.key),J.return=O,O=J):(J=Gc(z.type,z.key,z.props,null,O.mode,J),ol(J,z),J.return=O,O=J)}return w(O);case E:e:{for(pe=z.key;N!==null;){if(N.key===pe)if(N.tag===4&&N.stateNode.containerInfo===z.containerInfo&&N.stateNode.implementation===z.implementation){a(O,N.sibling),J=d(N,z.children||[]),J.return=O,O=J;break e}else{a(O,N);break}else s(O,N);N=N.sibling}J=ah(z,O.mode,J),J.return=O,O=J}return w(O);case H:return pe=z._init,z=pe(z._payload),Ye(O,N,z,J)}if(D(z))return Te(O,N,z,J);if(Y(z)){if(pe=Y(z),typeof pe!="function")throw Error(r(150));return z=pe.call(z),xe(O,N,z,J)}if(typeof z.then=="function")return Ye(O,N,uu(z),J);if(z.$$typeof===C)return Ye(O,N,Qc(O,z),J);fu(O,z)}return typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint"?(z=""+z,N!==null&&N.tag===6?(a(O,N.sibling),J=d(N,z),J.return=O,O=J):(a(O,N),J=oh(z,O.mode,J),J.return=O,O=J),w(O)):a(O,N)}return function(O,N,z,J){try{sl=0;var pe=Ye(O,N,z,J);return uo=null,pe}catch(be){if(be===Xa||be===Wc)throw be;var De=fn(29,be,null,O.mode);return De.lanes=J,De.return=O,De}finally{}}}var fo=ow(!0),aw=ow(!1),Cn=$(null),er=null;function ti(i){var s=i.alternate;ne(Et,Et.current&1),ne(Cn,i),er===null&&(s===null||oo.current!==null||s.memoizedState!==null)&&(er=i)}function lw(i){if(i.tag===22){if(ne(Et,Et.current),ne(Cn,i),er===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(er=i)}}else ni()}function ni(){ne(Et,Et.current),ne(Cn,Cn.current)}function Er(i){W(Cn),er===i&&(er=null),W(Et)}var Et=$(0);function du(i){for(var s=i;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||Ng(a)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Vh(i,s,a,c){s=i.memoizedState,a=a(c,s),a=a==null?s:m({},s,a),i.memoizedState=a,i.lanes===0&&(i.updateQueue.baseState=a)}var $h={enqueueSetState:function(i,s,a){i=i._reactInternals;var c=pn(),d=Jr(c);d.payload=s,a!=null&&(d.callback=a),s=Wr(i,d,c),s!==null&&(mn(s,i,c),Ja(s,i,c))},enqueueReplaceState:function(i,s,a){i=i._reactInternals;var c=pn(),d=Jr(c);d.tag=1,d.payload=s,a!=null&&(d.callback=a),s=Wr(i,d,c),s!==null&&(mn(s,i,c),Ja(s,i,c))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var a=pn(),c=Jr(a);c.tag=2,s!=null&&(c.callback=s),s=Wr(i,c,a),s!==null&&(mn(s,i,a),Ja(s,i,a))}};function cw(i,s,a,c,d,g,w){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(c,g,w):s.prototype&&s.prototype.isPureReactComponent?!Ha(a,c)||!Ha(d,g):!0}function uw(i,s,a,c){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,c),s.state!==i&&$h.enqueueReplaceState(s,s.state,null)}function es(i,s){var a=s;if("ref"in s){a={};for(var c in s)c!=="ref"&&(a[c]=s[c])}if(i=i.defaultProps){a===s&&(a=m({},a));for(var d in i)a[d]===void 0&&(a[d]=i[d])}return a}var hu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function fw(i){hu(i)}function dw(i){console.error(i)}function hw(i){hu(i)}function gu(i,s){try{var a=i.onUncaughtError;a(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function gw(i,s,a){try{var c=i.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Hh(i,s,a){return a=Jr(a),a.tag=3,a.payload={element:null},a.callback=function(){gu(i,s)},a}function pw(i){return i=Jr(i),i.tag=3,i}function mw(i,s,a,c){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var g=c.value;i.payload=function(){return d(g)},i.callback=function(){gw(s,a,c)}}var w=a.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(i.callback=function(){gw(s,a,c),typeof d!="function"&&(li===null?li=new Set([this]):li.add(this));var v=c.stack;this.componentDidCatch(c.value,{componentStack:v!==null?v:""})})}function ZC(i,s,a,c,d){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=a.alternate,s!==null&&Ga(s,a,d,!0),a=Cn.current,a!==null){switch(a.tag){case 13:return er===null?dg():a.alternate===null&&ut===0&&(ut=3),a.flags&=-257,a.flags|=65536,a.lanes=d,c===yh?a.flags|=16384:(s=a.updateQueue,s===null?a.updateQueue=new Set([c]):s.add(c),gg(i,c,d)),!1;case 22:return a.flags|=65536,c===yh?a.flags|=16384:(s=a.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=s):(a=s.retryQueue,a===null?s.retryQueue=new Set([c]):a.add(c)),gg(i,c,d)),!1}throw Error(r(435,a.tag))}return gg(i,c,d),dg(),!1}if(Ve)return s=Cn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=d,c!==uh&&(i=Error(r(422),{cause:c}),ja(An(i,a)))):(c!==uh&&(s=Error(r(423),{cause:c}),ja(An(s,a))),i=i.current.alternate,i.flags|=65536,d&=-d,i.lanes|=d,c=An(c,a),d=Hh(i.stateNode,c,d),vh(i,d),ut!==4&&(ut=2)),!1;var g=Error(r(520),{cause:c});if(g=An(g,a),hl===null?hl=[g]:hl.push(g),ut!==4&&(ut=2),s===null)return!0;c=An(c,a),a=s;do{switch(a.tag){case 3:return a.flags|=65536,i=d&-d,a.lanes|=i,i=Hh(a.stateNode,c,i),vh(a,i),!1;case 1:if(s=a.type,g=a.stateNode,(a.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(li===null||!li.has(g))))return a.flags|=65536,d&=-d,a.lanes|=d,d=pw(d),mw(d,i,a,c),vh(a,d),!1}a=a.return}while(a!==null);return!1}var yw=Error(r(461)),_t=!1;function Bt(i,s,a,c){s.child=i===null?aw(s,null,a,c):fo(s,i.child,a,c)}function bw(i,s,a,c,d){a=a.render;var g=s.ref;if("ref"in c){var w={};for(var v in c)v!=="ref"&&(w[v]=c[v])}else w=c;return Qi(s),c=_h(i,s,a,w,g,d),v=Th(),i!==null&&!_t?(kh(i,s,d),xr(i,s,d)):(Ve&&v&&lh(s),s.flags|=1,Bt(i,s,c,d),s.child)}function ww(i,s,a,c,d){if(i===null){var g=a.type;return typeof g=="function"&&!sh(g)&&g.defaultProps===void 0&&a.compare===null?(s.tag=15,s.type=g,vw(i,s,g,c,d)):(i=Gc(a.type,null,c,s,s.mode,d),i.ref=s.ref,i.return=s,s.child=i)}if(g=i.child,!Xh(i,d)){var w=g.memoizedProps;if(a=a.compare,a=a!==null?a:Ha,a(w,c)&&i.ref===s.ref)return xr(i,s,d)}return s.flags|=1,i=pr(g,c),i.ref=s.ref,i.return=s,s.child=i}function vw(i,s,a,c,d){if(i!==null){var g=i.memoizedProps;if(Ha(g,c)&&i.ref===s.ref)if(_t=!1,s.pendingProps=c=g,Xh(i,d))(i.flags&131072)!==0&&(_t=!0);else return s.lanes=i.lanes,xr(i,s,d)}return qh(i,s,a,c,d)}function Ew(i,s,a){var c=s.pendingProps,d=c.children,g=i!==null?i.memoizedState:null;if(c.mode==="hidden"){if((s.flags&128)!==0){if(c=g!==null?g.baseLanes|a:a,i!==null){for(d=s.child=i.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;s.childLanes=g&~c}else s.childLanes=0,s.child=null;return xw(i,s,c,a)}if((a&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Jc(s,g!==null?g.cachePool:null),g!==null?vb(s,g):xh(),lw(s);else return s.lanes=s.childLanes=536870912,xw(i,s,g!==null?g.baseLanes|a:a,a)}else g!==null?(Jc(s,g.cachePool),vb(s,g),ni(),s.memoizedState=null):(i!==null&&Jc(s,null),xh(),ni());return Bt(i,s,d,a),s.child}function xw(i,s,a,c){var d=mh();return d=d===null?null:{parent:vt._currentValue,pool:d},s.memoizedState={baseLanes:a,cachePool:d},i!==null&&Jc(s,null),xh(),lw(s),i!==null&&Ga(i,s,c,!0),null}function pu(i,s){var a=s.ref;if(a===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(r(284));(i===null||i.ref!==a)&&(s.flags|=4194816)}}function qh(i,s,a,c,d){return Qi(s),a=_h(i,s,a,c,void 0,d),c=Th(),i!==null&&!_t?(kh(i,s,d),xr(i,s,d)):(Ve&&c&&lh(s),s.flags|=1,Bt(i,s,a,d),s.child)}function Sw(i,s,a,c,d,g){return Qi(s),s.updateQueue=null,a=xb(s,c,a,d),Eb(i),c=Th(),i!==null&&!_t?(kh(i,s,g),xr(i,s,g)):(Ve&&c&&lh(s),s.flags|=1,Bt(i,s,a,g),s.child)}function Aw(i,s,a,c,d){if(Qi(s),s.stateNode===null){var g=to,w=a.contextType;typeof w=="object"&&w!==null&&(g=$t(w)),g=new a(c,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=$h,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=c,g.state=s.memoizedState,g.refs={},bh(s),w=a.contextType,g.context=typeof w=="object"&&w!==null?$t(w):to,g.state=s.memoizedState,w=a.getDerivedStateFromProps,typeof w=="function"&&(Vh(s,a,w,c),g.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(w=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),w!==g.state&&$h.enqueueReplaceState(g,g.state,null),el(s,c,g,d),Wa(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(i===null){g=s.stateNode;var v=s.memoizedProps,T=es(a,v);g.props=T;var V=g.context,X=a.contextType;w=to,typeof X=="object"&&X!==null&&(w=$t(X));var ee=a.getDerivedStateFromProps;X=typeof ee=="function"||typeof g.getSnapshotBeforeUpdate=="function",v=s.pendingProps!==v,X||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(v||V!==w)&&uw(s,g,c,w),Qr=!1;var q=s.memoizedState;g.state=q,el(s,c,g,d),Wa(),V=s.memoizedState,v||q!==V||Qr?(typeof ee=="function"&&(Vh(s,a,ee,c),V=s.memoizedState),(T=Qr||cw(s,a,T,c,q,V,w))?(X||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=V),g.props=c,g.state=V,g.context=w,c=T):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{g=s.stateNode,wh(i,s),w=s.memoizedProps,X=es(a,w),g.props=X,ee=s.pendingProps,q=g.context,V=a.contextType,T=to,typeof V=="object"&&V!==null&&(T=$t(V)),v=a.getDerivedStateFromProps,(V=typeof v=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w!==ee||q!==T)&&uw(s,g,c,T),Qr=!1,q=s.memoizedState,g.state=q,el(s,c,g,d),Wa();var F=s.memoizedState;w!==ee||q!==F||Qr||i!==null&&i.dependencies!==null&&Xc(i.dependencies)?(typeof v=="function"&&(Vh(s,a,v,c),F=s.memoizedState),(X=Qr||cw(s,a,X,c,q,F,T)||i!==null&&i.dependencies!==null&&Xc(i.dependencies))?(V||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,F,T),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,F,T)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||w===i.memoizedProps&&q===i.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&q===i.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=F),g.props=c,g.state=F,g.context=T,c=X):(typeof g.componentDidUpdate!="function"||w===i.memoizedProps&&q===i.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&q===i.memoizedState||(s.flags|=1024),c=!1)}return g=c,pu(i,s),c=(s.flags&128)!==0,g||c?(g=s.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,i!==null&&c?(s.child=fo(s,i.child,null,d),s.child=fo(s,null,a,d)):Bt(i,s,a,d),s.memoizedState=g.state,i=s.child):i=xr(i,s,d),i}function _w(i,s,a,c){return Ka(),s.flags|=256,Bt(i,s,a,c),s.child}var Fh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Kh(i){return{baseLanes:i,cachePool:db()}}function jh(i,s,a){return i=i!==null?i.childLanes&~a:0,s&&(i|=Nn),i}function Tw(i,s,a){var c=s.pendingProps,d=!1,g=(s.flags&128)!==0,w;if((w=g)||(w=i!==null&&i.memoizedState===null?!1:(Et.current&2)!==0),w&&(d=!0,s.flags&=-129),w=(s.flags&32)!==0,s.flags&=-33,i===null){if(Ve){if(d?ti(s):ni(),Ve){var v=ct,T;if(T=v){e:{for(T=v,v=Wn;T.nodeType!==8;){if(!v){v=null;break e}if(T=Un(T.nextSibling),T===null){v=null;break e}}v=T}v!==null?(s.memoizedState={dehydrated:v,treeContext:ji!==null?{id:mr,overflow:yr}:null,retryLane:536870912,hydrationErrors:null},T=fn(18,null,null,0),T.stateNode=v,T.return=s,s.child=T,Yt=s,ct=null,T=!0):T=!1}T||Zi(s)}if(v=s.memoizedState,v!==null&&(v=v.dehydrated,v!==null))return Ng(v)?s.lanes=32:s.lanes=536870912,null;Er(s)}return v=c.children,c=c.fallback,d?(ni(),d=s.mode,v=mu({mode:"hidden",children:v},d),c=Ki(c,d,a,null),v.return=s,c.return=s,v.sibling=c,s.child=v,d=s.child,d.memoizedState=Kh(a),d.childLanes=jh(i,w,a),s.memoizedState=Fh,c):(ti(s),Gh(s,v))}if(T=i.memoizedState,T!==null&&(v=T.dehydrated,v!==null)){if(g)s.flags&256?(ti(s),s.flags&=-257,s=Yh(i,s,a)):s.memoizedState!==null?(ni(),s.child=i.child,s.flags|=128,s=null):(ni(),d=c.fallback,v=s.mode,c=mu({mode:"visible",children:c.children},v),d=Ki(d,v,a,null),d.flags|=2,c.return=s,d.return=s,c.sibling=d,s.child=c,fo(s,i.child,null,a),c=s.child,c.memoizedState=Kh(a),c.childLanes=jh(i,w,a),s.memoizedState=Fh,s=d);else if(ti(s),Ng(v)){if(w=v.nextSibling&&v.nextSibling.dataset,w)var V=w.dgst;w=V,c=Error(r(419)),c.stack="",c.digest=w,ja({value:c,source:null,stack:null}),s=Yh(i,s,a)}else if(_t||Ga(i,s,a,!1),w=(a&i.childLanes)!==0,_t||w){if(w=Qe,w!==null&&(c=a&-a,c=(c&42)!==0?1:Bd(c),c=(c&(w.suspendedLanes|a))!==0?0:c,c!==0&&c!==T.retryLane))throw T.retryLane=c,eo(i,c),mn(w,i,c),yw;v.data==="$?"||dg(),s=Yh(i,s,a)}else v.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=T.treeContext,ct=Un(v.nextSibling),Yt=s,Ve=!0,Yi=null,Wn=!1,i!==null&&(Tn[kn++]=mr,Tn[kn++]=yr,Tn[kn++]=ji,mr=i.id,yr=i.overflow,ji=s),s=Gh(s,c.children),s.flags|=4096);return s}return d?(ni(),d=c.fallback,v=s.mode,T=i.child,V=T.sibling,c=pr(T,{mode:"hidden",children:c.children}),c.subtreeFlags=T.subtreeFlags&65011712,V!==null?d=pr(V,d):(d=Ki(d,v,a,null),d.flags|=2),d.return=s,c.return=s,c.sibling=d,s.child=c,c=d,d=s.child,v=i.child.memoizedState,v===null?v=Kh(a):(T=v.cachePool,T!==null?(V=vt._currentValue,T=T.parent!==V?{parent:V,pool:V}:T):T=db(),v={baseLanes:v.baseLanes|a,cachePool:T}),d.memoizedState=v,d.childLanes=jh(i,w,a),s.memoizedState=Fh,c):(ti(s),a=i.child,i=a.sibling,a=pr(a,{mode:"visible",children:c.children}),a.return=s,a.sibling=null,i!==null&&(w=s.deletions,w===null?(s.deletions=[i],s.flags|=16):w.push(i)),s.child=a,s.memoizedState=null,a)}function Gh(i,s){return s=mu({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function mu(i,s){return i=fn(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Yh(i,s,a){return fo(s,i.child,null,a),i=Gh(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function kw(i,s,a){i.lanes|=s;var c=i.alternate;c!==null&&(c.lanes|=s),dh(i.return,s,a)}function Zh(i,s,a,c,d){var g=i.memoizedState;g===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:d}:(g.isBackwards=s,g.rendering=null,g.renderingStartTime=0,g.last=c,g.tail=a,g.tailMode=d)}function Cw(i,s,a){var c=s.pendingProps,d=c.revealOrder,g=c.tail;if(Bt(i,s,c.children,a),c=Et.current,(c&2)!==0)c=c&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&kw(i,a,s);else if(i.tag===19)kw(i,a,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}c&=1}switch(ne(Et,c),d){case"forwards":for(a=s.child,d=null;a!==null;)i=a.alternate,i!==null&&du(i)===null&&(d=a),a=a.sibling;a=d,a===null?(d=s.child,s.child=null):(d=a.sibling,a.sibling=null),Zh(s,!1,d,a,g);break;case"backwards":for(a=null,d=s.child,s.child=null;d!==null;){if(i=d.alternate,i!==null&&du(i)===null){s.child=d;break}i=d.sibling,d.sibling=a,a=d,d=i}Zh(s,!0,a,null,g);break;case"together":Zh(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function xr(i,s,a){if(i!==null&&(s.dependencies=i.dependencies),ai|=s.lanes,(a&s.childLanes)===0)if(i!==null){if(Ga(i,s,a,!1),(a&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,a=pr(i,i.pendingProps),s.child=a,a.return=s;i.sibling!==null;)i=i.sibling,a=a.sibling=pr(i,i.pendingProps),a.return=s;a.sibling=null}return s.child}function Xh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Xc(i)))}function XC(i,s,a){switch(s.tag){case 3:ke(s,s.stateNode.containerInfo),Xr(s,vt,i.memoizedState.cache),Ka();break;case 27:case 5:Je(s);break;case 4:ke(s,s.stateNode.containerInfo);break;case 10:Xr(s,s.type,s.memoizedProps.value);break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(ti(s),s.flags|=128,null):(a&s.child.childLanes)!==0?Tw(i,s,a):(ti(s),i=xr(i,s,a),i!==null?i.sibling:null);ti(s);break;case 19:var d=(i.flags&128)!==0;if(c=(a&s.childLanes)!==0,c||(Ga(i,s,a,!1),c=(a&s.childLanes)!==0),d){if(c)return Cw(i,s,a);s.flags|=128}if(d=s.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),ne(Et,Et.current),c)break;return null;case 22:case 23:return s.lanes=0,Ew(i,s,a);case 24:Xr(s,vt,i.memoizedState.cache)}return xr(i,s,a)}function Nw(i,s,a){if(i!==null)if(i.memoizedProps!==s.pendingProps)_t=!0;else{if(!Xh(i,a)&&(s.flags&128)===0)return _t=!1,XC(i,s,a);_t=(i.flags&131072)!==0}else _t=!1,Ve&&(s.flags&1048576)!==0&&sb(s,Zc,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var c=s.elementType,d=c._init;if(c=d(c._payload),s.type=c,typeof c=="function")sh(c)?(i=es(c,i),s.tag=1,s=Aw(null,s,c,i,a)):(s.tag=0,s=qh(null,s,c,i,a));else{if(c!=null){if(d=c.$$typeof,d===Z){s.tag=11,s=bw(null,s,c,i,a);break e}else if(d===oe){s.tag=14,s=ww(null,s,c,i,a);break e}}throw s=M(c)||c,Error(r(306,s,""))}}return s;case 0:return qh(i,s,s.type,s.pendingProps,a);case 1:return c=s.type,d=es(c,s.pendingProps),Aw(i,s,c,d,a);case 3:e:{if(ke(s,s.stateNode.containerInfo),i===null)throw Error(r(387));c=s.pendingProps;var g=s.memoizedState;d=g.element,wh(i,s),el(s,c,null,a);var w=s.memoizedState;if(c=w.cache,Xr(s,vt,c),c!==g.cache&&hh(s,[vt],a,!0),Wa(),c=w.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:w.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=_w(i,s,c,a);break e}else if(c!==d){d=An(Error(r(424)),s),ja(d),s=_w(i,s,c,a);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(ct=Un(i.firstChild),Yt=s,Ve=!0,Yi=null,Wn=!0,a=aw(s,null,c,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Ka(),c===d){s=xr(i,s,a);break e}Bt(i,s,c,a)}s=s.child}return s;case 26:return pu(i,s),i===null?(a=Mv(s.type,null,s.pendingProps,null))?s.memoizedState=a:Ve||(a=s.type,i=s.pendingProps,c=Bu(fe.current).createElement(a),c[Vt]=s,c[Jt]=i,Rt(c,a,i),At(c),s.stateNode=c):s.memoizedState=Mv(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Je(s),i===null&&Ve&&(c=s.stateNode=Bv(s.type,s.pendingProps,fe.current),Yt=s,Wn=!0,d=ct,fi(s.type)?(Bg=d,ct=Un(c.firstChild)):ct=d),Bt(i,s,s.pendingProps.children,a),pu(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Ve&&((d=c=ct)&&(c=A6(c,s.type,s.pendingProps,Wn),c!==null?(s.stateNode=c,Yt=s,ct=Un(c.firstChild),Wn=!1,d=!0):d=!1),d||Zi(s)),Je(s),d=s.type,g=s.pendingProps,w=i!==null?i.memoizedProps:null,c=g.children,Tg(d,g)?c=null:w!==null&&Tg(d,w)&&(s.flags|=32),s.memoizedState!==null&&(d=_h(i,s,HC,null,null,a),xl._currentValue=d),pu(i,s),Bt(i,s,c,a),s.child;case 6:return i===null&&Ve&&((i=a=ct)&&(a=_6(a,s.pendingProps,Wn),a!==null?(s.stateNode=a,Yt=s,ct=null,i=!0):i=!1),i||Zi(s)),null;case 13:return Tw(i,s,a);case 4:return ke(s,s.stateNode.containerInfo),c=s.pendingProps,i===null?s.child=fo(s,null,c,a):Bt(i,s,c,a),s.child;case 11:return bw(i,s,s.type,s.pendingProps,a);case 7:return Bt(i,s,s.pendingProps,a),s.child;case 8:return Bt(i,s,s.pendingProps.children,a),s.child;case 12:return Bt(i,s,s.pendingProps.children,a),s.child;case 10:return c=s.pendingProps,Xr(s,s.type,c.value),Bt(i,s,c.children,a),s.child;case 9:return d=s.type._context,c=s.pendingProps.children,Qi(s),d=$t(d),c=c(d),s.flags|=1,Bt(i,s,c,a),s.child;case 14:return ww(i,s,s.type,s.pendingProps,a);case 15:return vw(i,s,s.type,s.pendingProps,a);case 19:return Cw(i,s,a);case 31:return c=s.pendingProps,a=s.mode,c={mode:c.mode,children:c.children},i===null?(a=mu(c,a),a.ref=s.ref,s.child=a,a.return=s,s=a):(a=pr(i.child,c),a.ref=s.ref,s.child=a,a.return=s,s=a),s;case 22:return Ew(i,s,a);case 24:return Qi(s),c=$t(vt),i===null?(d=mh(),d===null&&(d=Qe,g=gh(),d.pooledCache=g,g.refCount++,g!==null&&(d.pooledCacheLanes|=a),d=g),s.memoizedState={parent:c,cache:d},bh(s),Xr(s,vt,d)):((i.lanes&a)!==0&&(wh(i,s),el(s,null,null,a),Wa()),d=i.memoizedState,g=s.memoizedState,d.parent!==c?(d={parent:c,cache:c},s.memoizedState=d,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=d),Xr(s,vt,c)):(c=g.cache,Xr(s,vt,c),c!==d.cache&&hh(s,[vt],a,!0))),Bt(i,s,s.pendingProps.children,a),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Sr(i){i.flags|=4}function Bw(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Pv(s)){if(s=Cn.current,s!==null&&((Oe&4194048)===Oe?er!==null:(Oe&62914560)!==Oe&&(Oe&536870912)===0||s!==er))throw Qa=yh,hb;i.flags|=8192}}function yu(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?l0():536870912,i.lanes|=s,mo|=s)}function al(i,s){if(!Ve)switch(i.tailMode){case"hidden":s=i.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?i.tail=null:a.sibling=null;break;case"collapsed":a=i.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:c.sibling=null}}function st(i){var s=i.alternate!==null&&i.alternate.child===i.child,a=0,c=0;if(s)for(var d=i.child;d!==null;)a|=d.lanes|d.childLanes,c|=d.subtreeFlags&65011712,c|=d.flags&65011712,d.return=i,d=d.sibling;else for(d=i.child;d!==null;)a|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=i,d=d.sibling;return i.subtreeFlags|=c,i.childLanes=a,s}function QC(i,s,a){var c=s.pendingProps;switch(ch(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return st(s),null;case 1:return st(s),null;case 3:return a=s.stateNode,c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),wr(vt),Ie(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(i===null||i.child===null)&&(Fa(s)?Sr(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,lb())),st(s),null;case 26:return a=s.memoizedState,i===null?(Sr(s),a!==null?(st(s),Bw(s,a)):(st(s),s.flags&=-16777217)):a?a!==i.memoizedState?(Sr(s),st(s),Bw(s,a)):(st(s),s.flags&=-16777217):(i.memoizedProps!==c&&Sr(s),st(s),s.flags&=-16777217),null;case 27:an(s),a=fe.current;var d=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==c&&Sr(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return st(s),null}i=se.current,Fa(s)?ob(s):(i=Bv(d,c,a),s.stateNode=i,Sr(s))}return st(s),null;case 5:if(an(s),a=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==c&&Sr(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return st(s),null}if(i=se.current,Fa(s))ob(s);else{switch(d=Bu(fe.current),i){case 1:i=d.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:i=d.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":i=d.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":i=d.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":i=d.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof c.is=="string"?d.createElement("select",{is:c.is}):d.createElement("select"),c.multiple?i.multiple=!0:c.size&&(i.size=c.size);break;default:i=typeof c.is=="string"?d.createElement(a,{is:c.is}):d.createElement(a)}}i[Vt]=s,i[Jt]=c;e:for(d=s.child;d!==null;){if(d.tag===5||d.tag===6)i.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===s)break e;for(;d.sibling===null;){if(d.return===null||d.return===s)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}s.stateNode=i;e:switch(Rt(i,a,c),a){case"button":case"input":case"select":case"textarea":i=!!c.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Sr(s)}}return st(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==c&&Sr(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(r(166));if(i=fe.current,Fa(s)){if(i=s.stateNode,a=s.memoizedProps,c=null,d=Yt,d!==null)switch(d.tag){case 27:case 5:c=d.memoizedProps}i[Vt]=s,i=!!(i.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||Sv(i.nodeValue,a)),i||Zi(s)}else i=Bu(i).createTextNode(c),i[Vt]=s,s.stateNode=i}return st(s),null;case 13:if(c=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(d=Fa(s),c!==null&&c.dehydrated!==null){if(i===null){if(!d)throw Error(r(318));if(d=s.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));d[Vt]=s}else Ka(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;st(s),d=!1}else d=lb(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=d),d=!0;if(!d)return s.flags&256?(Er(s),s):(Er(s),null)}if(Er(s),(s.flags&128)!==0)return s.lanes=a,s;if(a=c!==null,i=i!==null&&i.memoizedState!==null,a){c=s.child,d=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(d=c.alternate.memoizedState.cachePool.pool);var g=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==d&&(c.flags|=2048)}return a!==i&&a&&(s.child.flags|=8192),yu(s,s.updateQueue),st(s),null;case 4:return Ie(),i===null&&Eg(s.stateNode.containerInfo),st(s),null;case 10:return wr(s.type),st(s),null;case 19:if(W(Et),d=s.memoizedState,d===null)return st(s),null;if(c=(s.flags&128)!==0,g=d.rendering,g===null)if(c)al(d,!1);else{if(ut!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(g=du(i),g!==null){for(s.flags|=128,al(d,!1),i=g.updateQueue,s.updateQueue=i,yu(s,i),s.subtreeFlags=0,i=a,a=s.child;a!==null;)ib(a,i),a=a.sibling;return ne(Et,Et.current&1|2),s.child}i=i.sibling}d.tail!==null&&Jn()>vu&&(s.flags|=128,c=!0,al(d,!1),s.lanes=4194304)}else{if(!c)if(i=du(g),i!==null){if(s.flags|=128,c=!0,i=i.updateQueue,s.updateQueue=i,yu(s,i),al(d,!0),d.tail===null&&d.tailMode==="hidden"&&!g.alternate&&!Ve)return st(s),null}else 2*Jn()-d.renderingStartTime>vu&&a!==536870912&&(s.flags|=128,c=!0,al(d,!1),s.lanes=4194304);d.isBackwards?(g.sibling=s.child,s.child=g):(i=d.last,i!==null?i.sibling=g:s.child=g,d.last=g)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=Jn(),s.sibling=null,i=Et.current,ne(Et,c?i&1|2:i&1),s):(st(s),null);case 22:case 23:return Er(s),Sh(),c=s.memoizedState!==null,i!==null?i.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(a&536870912)!==0&&(s.flags&128)===0&&(st(s),s.subtreeFlags&6&&(s.flags|=8192)):st(s),a=s.updateQueue,a!==null&&yu(s,a.retryQueue),a=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==a&&(s.flags|=2048),i!==null&&W(Ji),null;case 24:return a=null,i!==null&&(a=i.memoizedState.cache),s.memoizedState.cache!==a&&(s.flags|=2048),wr(vt),st(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function JC(i,s){switch(ch(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return wr(vt),Ie(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return an(s),null;case 13:if(Er(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Ka()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return W(Et),null;case 4:return Ie(),null;case 10:return wr(s.type),null;case 22:case 23:return Er(s),Sh(),i!==null&&W(Ji),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return wr(vt),null;case 25:return null;default:return null}}function Dw(i,s){switch(ch(s),s.tag){case 3:wr(vt),Ie();break;case 26:case 27:case 5:an(s);break;case 4:Ie();break;case 13:Er(s);break;case 19:W(Et);break;case 10:wr(s.type);break;case 22:case 23:Er(s),Sh(),i!==null&&W(Ji);break;case 24:wr(vt)}}function ll(i,s){try{var a=s.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var d=c.next;a=d;do{if((a.tag&i)===i){c=void 0;var g=a.create,w=a.inst;c=g(),w.destroy=c}a=a.next}while(a!==d)}}catch(v){Ze(s,s.return,v)}}function ri(i,s,a){try{var c=s.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var g=d.next;c=g;do{if((c.tag&i)===i){var w=c.inst,v=w.destroy;if(v!==void 0){w.destroy=void 0,d=s;var T=a,V=v;try{V()}catch(X){Ze(d,T,X)}}}c=c.next}while(c!==g)}}catch(X){Ze(s,s.return,X)}}function Rw(i){var s=i.updateQueue;if(s!==null){var a=i.stateNode;try{wb(s,a)}catch(c){Ze(i,i.return,c)}}}function Mw(i,s,a){a.props=es(i.type,i.memoizedProps),a.state=i.memoizedState;try{a.componentWillUnmount()}catch(c){Ze(i,s,c)}}function cl(i,s){try{var a=i.ref;if(a!==null){switch(i.tag){case 26:case 27:case 5:var c=i.stateNode;break;case 30:c=i.stateNode;break;default:c=i.stateNode}typeof a=="function"?i.refCleanup=a(c):a.current=c}}catch(d){Ze(i,s,d)}}function tr(i,s){var a=i.ref,c=i.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(d){Ze(i,s,d)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){Ze(i,s,d)}else a.current=null}function Iw(i){var s=i.type,a=i.memoizedProps,c=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break e;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(d){Ze(i,i.return,d)}}function Qh(i,s,a){try{var c=i.stateNode;w6(c,i.type,a,s),c[Jt]=s}catch(d){Ze(i,i.return,d)}}function Ow(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&fi(i.type)||i.tag===4}function Jh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Ow(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&fi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Wh(i,s,a){var c=i.tag;if(c===5||c===6)i=i.stateNode,s?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(i,s):(s=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,s.appendChild(i),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=Nu));else if(c!==4&&(c===27&&fi(i.type)&&(a=i.stateNode,s=null),i=i.child,i!==null))for(Wh(i,s,a),i=i.sibling;i!==null;)Wh(i,s,a),i=i.sibling}function bu(i,s,a){var c=i.tag;if(c===5||c===6)i=i.stateNode,s?a.insertBefore(i,s):a.appendChild(i);else if(c!==4&&(c===27&&fi(i.type)&&(a=i.stateNode),i=i.child,i!==null))for(bu(i,s,a),i=i.sibling;i!==null;)bu(i,s,a),i=i.sibling}function Lw(i){var s=i.stateNode,a=i.memoizedProps;try{for(var c=i.type,d=s.attributes;d.length;)s.removeAttributeNode(d[0]);Rt(s,c,a),s[Vt]=i,s[Jt]=a}catch(g){Ze(i,i.return,g)}}var Ar=!1,pt=!1,eg=!1,Uw=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function WC(i,s){if(i=i.containerInfo,Ag=Lu,i=Y0(i),Jd(i)){if("selectionStart"in i)var a={start:i.selectionStart,end:i.selectionEnd};else e:{a=(a=i.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var d=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{a.nodeType,g.nodeType}catch{a=null;break e}var w=0,v=-1,T=-1,V=0,X=0,ee=i,q=null;t:for(;;){for(var F;ee!==a||d!==0&&ee.nodeType!==3||(v=w+d),ee!==g||c!==0&&ee.nodeType!==3||(T=w+c),ee.nodeType===3&&(w+=ee.nodeValue.length),(F=ee.firstChild)!==null;)q=ee,ee=F;for(;;){if(ee===i)break t;if(q===a&&++V===d&&(v=w),q===g&&++X===c&&(T=w),(F=ee.nextSibling)!==null)break;ee=q,q=ee.parentNode}ee=F}a=v===-1||T===-1?null:{start:v,end:T}}else a=null}a=a||{start:0,end:0}}else a=null;for(_g={focusedElem:i,selectionRange:a},Lu=!1,Tt=s;Tt!==null;)if(s=Tt,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,Tt=i;else for(;Tt!==null;){switch(s=Tt,g=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&g!==null){i=void 0,a=s,d=g.memoizedProps,g=g.memoizedState,c=a.stateNode;try{var Te=es(a.type,d,a.elementType===a.type);i=c.getSnapshotBeforeUpdate(Te,g),c.__reactInternalSnapshotBeforeUpdate=i}catch(xe){Ze(a,a.return,xe)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,a=i.nodeType,a===9)Cg(i);else if(a===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Cg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,Tt=i;break}Tt=s.return}}function Pw(i,s,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:ii(i,a),c&4&&ll(5,a);break;case 1:if(ii(i,a),c&4)if(i=a.stateNode,s===null)try{i.componentDidMount()}catch(w){Ze(a,a.return,w)}else{var d=es(a.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(d,s,i.__reactInternalSnapshotBeforeUpdate)}catch(w){Ze(a,a.return,w)}}c&64&&Rw(a),c&512&&cl(a,a.return);break;case 3:if(ii(i,a),c&64&&(i=a.updateQueue,i!==null)){if(s=null,a.child!==null)switch(a.child.tag){case 27:case 5:s=a.child.stateNode;break;case 1:s=a.child.stateNode}try{wb(i,s)}catch(w){Ze(a,a.return,w)}}break;case 27:s===null&&c&4&&Lw(a);case 26:case 5:ii(i,a),s===null&&c&4&&Iw(a),c&512&&cl(a,a.return);break;case 12:ii(i,a);break;case 13:ii(i,a),c&4&&$w(i,a),c&64&&(i=a.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(a=l6.bind(null,a),T6(i,a))));break;case 22:if(c=a.memoizedState!==null||Ar,!c){s=s!==null&&s.memoizedState!==null||pt,d=Ar;var g=pt;Ar=c,(pt=s)&&!g?si(i,a,(a.subtreeFlags&8772)!==0):ii(i,a),Ar=d,pt=g}break;case 30:break;default:ii(i,a)}}function zw(i){var s=i.alternate;s!==null&&(i.alternate=null,zw(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Md(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var tt=null,tn=!1;function _r(i,s,a){for(a=a.child;a!==null;)Vw(i,s,a),a=a.sibling}function Vw(i,s,a){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(Ba,a)}catch{}switch(a.tag){case 26:pt||tr(a,s),_r(i,s,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:pt||tr(a,s);var c=tt,d=tn;fi(a.type)&&(tt=a.stateNode,tn=!1),_r(i,s,a),bl(a.stateNode),tt=c,tn=d;break;case 5:pt||tr(a,s);case 6:if(c=tt,d=tn,tt=null,_r(i,s,a),tt=c,tn=d,tt!==null)if(tn)try{(tt.nodeType===9?tt.body:tt.nodeName==="HTML"?tt.ownerDocument.body:tt).removeChild(a.stateNode)}catch(g){Ze(a,s,g)}else try{tt.removeChild(a.stateNode)}catch(g){Ze(a,s,g)}break;case 18:tt!==null&&(tn?(i=tt,Cv(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,a.stateNode),Tl(i)):Cv(tt,a.stateNode));break;case 4:c=tt,d=tn,tt=a.stateNode.containerInfo,tn=!0,_r(i,s,a),tt=c,tn=d;break;case 0:case 11:case 14:case 15:pt||ri(2,a,s),pt||ri(4,a,s),_r(i,s,a);break;case 1:pt||(tr(a,s),c=a.stateNode,typeof c.componentWillUnmount=="function"&&Mw(a,s,c)),_r(i,s,a);break;case 21:_r(i,s,a);break;case 22:pt=(c=pt)||a.memoizedState!==null,_r(i,s,a),pt=c;break;default:_r(i,s,a)}}function $w(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Tl(i)}catch(a){Ze(s,s.return,a)}}function e6(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Uw),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Uw),s;default:throw Error(r(435,i.tag))}}function tg(i,s){var a=e6(i);s.forEach(function(c){var d=c6.bind(null,i,c);a.has(c)||(a.add(c),c.then(d,d))})}function dn(i,s){var a=s.deletions;if(a!==null)for(var c=0;c<a.length;c++){var d=a[c],g=i,w=s,v=w;e:for(;v!==null;){switch(v.tag){case 27:if(fi(v.type)){tt=v.stateNode,tn=!1;break e}break;case 5:tt=v.stateNode,tn=!1;break e;case 3:case 4:tt=v.stateNode.containerInfo,tn=!0;break e}v=v.return}if(tt===null)throw Error(r(160));Vw(g,w,d),tt=null,tn=!1,g=d.alternate,g!==null&&(g.return=null),d.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Hw(s,i),s=s.sibling}var Ln=null;function Hw(i,s){var a=i.alternate,c=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:dn(s,i),hn(i),c&4&&(ri(3,i,i.return),ll(3,i),ri(5,i,i.return));break;case 1:dn(s,i),hn(i),c&512&&(pt||a===null||tr(a,a.return)),c&64&&Ar&&(i=i.updateQueue,i!==null&&(c=i.callbacks,c!==null&&(a=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var d=Ln;if(dn(s,i),hn(i),c&512&&(pt||a===null||tr(a,a.return)),c&4){var g=a!==null?a.memoizedState:null;if(c=i.memoizedState,a===null)if(c===null)if(i.stateNode===null){e:{c=i.type,a=i.memoizedProps,d=d.ownerDocument||d;t:switch(c){case"title":g=d.getElementsByTagName("title")[0],(!g||g[Ma]||g[Vt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=d.createElement(c),d.head.insertBefore(g,d.querySelector("head > title"))),Rt(g,c,a),g[Vt]=i,At(g),c=g;break e;case"link":var w=Lv("link","href",d).get(c+(a.href||""));if(w){for(var v=0;v<w.length;v++)if(g=w[v],g.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&g.getAttribute("rel")===(a.rel==null?null:a.rel)&&g.getAttribute("title")===(a.title==null?null:a.title)&&g.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){w.splice(v,1);break t}}g=d.createElement(c),Rt(g,c,a),d.head.appendChild(g);break;case"meta":if(w=Lv("meta","content",d).get(c+(a.content||""))){for(v=0;v<w.length;v++)if(g=w[v],g.getAttribute("content")===(a.content==null?null:""+a.content)&&g.getAttribute("name")===(a.name==null?null:a.name)&&g.getAttribute("property")===(a.property==null?null:a.property)&&g.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&g.getAttribute("charset")===(a.charSet==null?null:a.charSet)){w.splice(v,1);break t}}g=d.createElement(c),Rt(g,c,a),d.head.appendChild(g);break;default:throw Error(r(468,c))}g[Vt]=i,At(g),c=g}i.stateNode=c}else Uv(d,i.type,i.stateNode);else i.stateNode=Ov(d,c,i.memoizedProps);else g!==c?(g===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):g.count--,c===null?Uv(d,i.type,i.stateNode):Ov(d,c,i.memoizedProps)):c===null&&i.stateNode!==null&&Qh(i,i.memoizedProps,a.memoizedProps)}break;case 27:dn(s,i),hn(i),c&512&&(pt||a===null||tr(a,a.return)),a!==null&&c&4&&Qh(i,i.memoizedProps,a.memoizedProps);break;case 5:if(dn(s,i),hn(i),c&512&&(pt||a===null||tr(a,a.return)),i.flags&32){d=i.stateNode;try{Gs(d,"")}catch(F){Ze(i,i.return,F)}}c&4&&i.stateNode!=null&&(d=i.memoizedProps,Qh(i,d,a!==null?a.memoizedProps:d)),c&1024&&(eg=!0);break;case 6:if(dn(s,i),hn(i),c&4){if(i.stateNode===null)throw Error(r(162));c=i.memoizedProps,a=i.stateNode;try{a.nodeValue=c}catch(F){Ze(i,i.return,F)}}break;case 3:if(Mu=null,d=Ln,Ln=Du(s.containerInfo),dn(s,i),Ln=d,hn(i),c&4&&a!==null&&a.memoizedState.isDehydrated)try{Tl(s.containerInfo)}catch(F){Ze(i,i.return,F)}eg&&(eg=!1,qw(i));break;case 4:c=Ln,Ln=Du(i.stateNode.containerInfo),dn(s,i),hn(i),Ln=c;break;case 12:dn(s,i),hn(i);break;case 13:dn(s,i),hn(i),i.child.flags&8192&&i.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(ag=Jn()),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,tg(i,c)));break;case 22:d=i.memoizedState!==null;var T=a!==null&&a.memoizedState!==null,V=Ar,X=pt;if(Ar=V||d,pt=X||T,dn(s,i),pt=X,Ar=V,hn(i),c&8192)e:for(s=i.stateNode,s._visibility=d?s._visibility&-2:s._visibility|1,d&&(a===null||T||Ar||pt||ts(i)),a=null,s=i;;){if(s.tag===5||s.tag===26){if(a===null){T=a=s;try{if(g=T.stateNode,d)w=g.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{v=T.stateNode;var ee=T.memoizedProps.style,q=ee!=null&&ee.hasOwnProperty("display")?ee.display:null;v.style.display=q==null||typeof q=="boolean"?"":(""+q).trim()}}catch(F){Ze(T,T.return,F)}}}else if(s.tag===6){if(a===null){T=s;try{T.stateNode.nodeValue=d?"":T.memoizedProps}catch(F){Ze(T,T.return,F)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;a===s&&(a=null),s=s.return}a===s&&(a=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=i.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,tg(i,a))));break;case 19:dn(s,i),hn(i),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,tg(i,c)));break;case 30:break;case 21:break;default:dn(s,i),hn(i)}}function hn(i){var s=i.flags;if(s&2){try{for(var a,c=i.return;c!==null;){if(Ow(c)){a=c;break}c=c.return}if(a==null)throw Error(r(160));switch(a.tag){case 27:var d=a.stateNode,g=Jh(i);bu(i,g,d);break;case 5:var w=a.stateNode;a.flags&32&&(Gs(w,""),a.flags&=-33);var v=Jh(i);bu(i,v,w);break;case 3:case 4:var T=a.stateNode.containerInfo,V=Jh(i);Wh(i,V,T);break;default:throw Error(r(161))}}catch(X){Ze(i,i.return,X)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function qw(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;qw(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function ii(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Pw(i,s.alternate,s),s=s.sibling}function ts(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:ri(4,s,s.return),ts(s);break;case 1:tr(s,s.return);var a=s.stateNode;typeof a.componentWillUnmount=="function"&&Mw(s,s.return,a),ts(s);break;case 27:bl(s.stateNode);case 26:case 5:tr(s,s.return),ts(s);break;case 22:s.memoizedState===null&&ts(s);break;case 30:ts(s);break;default:ts(s)}i=i.sibling}}function si(i,s,a){for(a=a&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,d=i,g=s,w=g.flags;switch(g.tag){case 0:case 11:case 15:si(d,g,a),ll(4,g);break;case 1:if(si(d,g,a),c=g,d=c.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(V){Ze(c,c.return,V)}if(c=g,d=c.updateQueue,d!==null){var v=c.stateNode;try{var T=d.shared.hiddenCallbacks;if(T!==null)for(d.shared.hiddenCallbacks=null,d=0;d<T.length;d++)bb(T[d],v)}catch(V){Ze(c,c.return,V)}}a&&w&64&&Rw(g),cl(g,g.return);break;case 27:Lw(g);case 26:case 5:si(d,g,a),a&&c===null&&w&4&&Iw(g),cl(g,g.return);break;case 12:si(d,g,a);break;case 13:si(d,g,a),a&&w&4&&$w(d,g);break;case 22:g.memoizedState===null&&si(d,g,a),cl(g,g.return);break;case 30:break;default:si(d,g,a)}s=s.sibling}}function ng(i,s){var a=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==a&&(i!=null&&i.refCount++,a!=null&&Ya(a))}function rg(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Ya(i))}function nr(i,s,a,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Fw(i,s,a,c),s=s.sibling}function Fw(i,s,a,c){var d=s.flags;switch(s.tag){case 0:case 11:case 15:nr(i,s,a,c),d&2048&&ll(9,s);break;case 1:nr(i,s,a,c);break;case 3:nr(i,s,a,c),d&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Ya(i)));break;case 12:if(d&2048){nr(i,s,a,c),i=s.stateNode;try{var g=s.memoizedProps,w=g.id,v=g.onPostCommit;typeof v=="function"&&v(w,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(T){Ze(s,s.return,T)}}else nr(i,s,a,c);break;case 13:nr(i,s,a,c);break;case 23:break;case 22:g=s.stateNode,w=s.alternate,s.memoizedState!==null?g._visibility&2?nr(i,s,a,c):ul(i,s):g._visibility&2?nr(i,s,a,c):(g._visibility|=2,ho(i,s,a,c,(s.subtreeFlags&10256)!==0)),d&2048&&ng(w,s);break;case 24:nr(i,s,a,c),d&2048&&rg(s.alternate,s);break;default:nr(i,s,a,c)}}function ho(i,s,a,c,d){for(d=d&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var g=i,w=s,v=a,T=c,V=w.flags;switch(w.tag){case 0:case 11:case 15:ho(g,w,v,T,d),ll(8,w);break;case 23:break;case 22:var X=w.stateNode;w.memoizedState!==null?X._visibility&2?ho(g,w,v,T,d):ul(g,w):(X._visibility|=2,ho(g,w,v,T,d)),d&&V&2048&&ng(w.alternate,w);break;case 24:ho(g,w,v,T,d),d&&V&2048&&rg(w.alternate,w);break;default:ho(g,w,v,T,d)}s=s.sibling}}function ul(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var a=i,c=s,d=c.flags;switch(c.tag){case 22:ul(a,c),d&2048&&ng(c.alternate,c);break;case 24:ul(a,c),d&2048&&rg(c.alternate,c);break;default:ul(a,c)}s=s.sibling}}var fl=8192;function go(i){if(i.subtreeFlags&fl)for(i=i.child;i!==null;)Kw(i),i=i.sibling}function Kw(i){switch(i.tag){case 26:go(i),i.flags&fl&&i.memoizedState!==null&&z6(Ln,i.memoizedState,i.memoizedProps);break;case 5:go(i);break;case 3:case 4:var s=Ln;Ln=Du(i.stateNode.containerInfo),go(i),Ln=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=fl,fl=16777216,go(i),fl=s):go(i));break;default:go(i)}}function jw(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function dl(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var a=0;a<s.length;a++){var c=s[a];Tt=c,Yw(c,i)}jw(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Gw(i),i=i.sibling}function Gw(i){switch(i.tag){case 0:case 11:case 15:dl(i),i.flags&2048&&ri(9,i,i.return);break;case 3:dl(i);break;case 12:dl(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,wu(i)):dl(i);break;default:dl(i)}}function wu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var a=0;a<s.length;a++){var c=s[a];Tt=c,Yw(c,i)}jw(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:ri(8,s,s.return),wu(s);break;case 22:a=s.stateNode,a._visibility&2&&(a._visibility&=-3,wu(s));break;default:wu(s)}i=i.sibling}}function Yw(i,s){for(;Tt!==null;){var a=Tt;switch(a.tag){case 0:case 11:case 15:ri(8,a,s);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ya(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,Tt=c;else e:for(a=i;Tt!==null;){c=Tt;var d=c.sibling,g=c.return;if(zw(c),c===a){Tt=null;break e}if(d!==null){d.return=g,Tt=d;break e}Tt=g}}}var t6={getCacheForType:function(i){var s=$t(vt),a=s.data.get(i);return a===void 0&&(a=i(),s.data.set(i,a)),a}},n6=typeof WeakMap=="function"?WeakMap:Map,He=0,Qe=null,Re=null,Oe=0,qe=0,gn=null,oi=!1,po=!1,ig=!1,Tr=0,ut=0,ai=0,ns=0,sg=0,Nn=0,mo=0,hl=null,nn=null,og=!1,ag=0,vu=1/0,Eu=null,li=null,Dt=0,ci=null,yo=null,bo=0,lg=0,cg=null,Zw=null,gl=0,ug=null;function pn(){if((He&2)!==0&&Oe!==0)return Oe&-Oe;if(S.T!==null){var i=io;return i!==0?i:yg()}return f0()}function Xw(){Nn===0&&(Nn=(Oe&536870912)===0||Ve?a0():536870912);var i=Cn.current;return i!==null&&(i.flags|=32),Nn}function mn(i,s,a){(i===Qe&&(qe===2||qe===9)||i.cancelPendingCommit!==null)&&(wo(i,0),ui(i,Oe,Nn,!1)),Ra(i,a),((He&2)===0||i!==Qe)&&(i===Qe&&((He&2)===0&&(ns|=a),ut===4&&ui(i,Oe,Nn,!1)),rr(i))}function Qw(i,s,a){if((He&6)!==0)throw Error(r(327));var c=!a&&(s&124)===0&&(s&i.expiredLanes)===0||Da(i,s),d=c?s6(i,s):hg(i,s,!0),g=c;do{if(d===0){po&&!c&&ui(i,s,0,!1);break}else{if(a=i.current.alternate,g&&!r6(a)){d=hg(i,s,!1),g=!1;continue}if(d===2){if(g=s,i.errorRecoveryDisabledLanes&g)var w=0;else w=i.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){s=w;e:{var v=i;d=hl;var T=v.current.memoizedState.isDehydrated;if(T&&(wo(v,w).flags|=256),w=hg(v,w,!1),w!==2){if(ig&&!T){v.errorRecoveryDisabledLanes|=g,ns|=g,d=4;break e}g=nn,nn=d,g!==null&&(nn===null?nn=g:nn.push.apply(nn,g))}d=w}if(g=!1,d!==2)continue}}if(d===1){wo(i,0),ui(i,s,0,!0);break}e:{switch(c=i,g=d,g){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:ui(c,s,Nn,!oi);break e;case 2:nn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(d=ag+300-Jn(),10<d)){if(ui(c,s,Nn,!oi),Rc(c,0,!0)!==0)break e;c.timeoutHandle=Tv(Jw.bind(null,c,a,nn,Eu,og,s,Nn,ns,mo,oi,g,2,-0,0),d);break e}Jw(c,a,nn,Eu,og,s,Nn,ns,mo,oi,g,0,-0,0)}}break}while(!0);rr(i)}function Jw(i,s,a,c,d,g,w,v,T,V,X,ee,q,F){if(i.timeoutHandle=-1,ee=s.subtreeFlags,(ee&8192||(ee&16785408)===16785408)&&(El={stylesheets:null,count:0,unsuspend:P6},Kw(s),ee=V6(),ee!==null)){i.cancelPendingCommit=ee(sv.bind(null,i,s,g,a,c,d,w,v,T,X,1,q,F)),ui(i,g,w,!V);return}sv(i,s,g,a,c,d,w,v,T)}function r6(i){for(var s=i;;){var a=s.tag;if((a===0||a===11||a===15)&&s.flags&16384&&(a=s.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var d=a[c],g=d.getSnapshot;d=d.value;try{if(!un(g(),d))return!1}catch{return!1}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ui(i,s,a,c){s&=~sg,s&=~ns,i.suspendedLanes|=s,i.pingedLanes&=~s,c&&(i.warmLanes|=s),c=i.expirationTimes;for(var d=s;0<d;){var g=31-cn(d),w=1<<g;c[g]=-1,d&=~w}a!==0&&c0(i,a,s)}function xu(){return(He&6)===0?(pl(0),!1):!0}function fg(){if(Re!==null){if(qe===0)var i=Re.return;else i=Re,br=Xi=null,Ch(i),uo=null,sl=0,i=Re;for(;i!==null;)Dw(i.alternate,i),i=i.return;Re=null}}function wo(i,s){var a=i.timeoutHandle;a!==-1&&(i.timeoutHandle=-1,E6(a)),a=i.cancelPendingCommit,a!==null&&(i.cancelPendingCommit=null,a()),fg(),Qe=i,Re=a=pr(i.current,null),Oe=s,qe=0,gn=null,oi=!1,po=Da(i,s),ig=!1,mo=Nn=sg=ns=ai=ut=0,nn=hl=null,og=!1,(s&8)!==0&&(s|=s&32);var c=i.entangledLanes;if(c!==0)for(i=i.entanglements,c&=s;0<c;){var d=31-cn(c),g=1<<d;s|=i[d],c&=~g}return Tr=s,Fc(),a}function Ww(i,s){Ne=null,S.H=cu,s===Xa||s===Wc?(s=mb(),qe=3):s===hb?(s=mb(),qe=4):qe=s===yw?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,gn=s,Re===null&&(ut=1,gu(i,An(s,i.current)))}function ev(){var i=S.H;return S.H=cu,i===null?cu:i}function tv(){var i=S.A;return S.A=t6,i}function dg(){ut=4,oi||(Oe&4194048)!==Oe&&Cn.current!==null||(po=!0),(ai&134217727)===0&&(ns&134217727)===0||Qe===null||ui(Qe,Oe,Nn,!1)}function hg(i,s,a){var c=He;He|=2;var d=ev(),g=tv();(Qe!==i||Oe!==s)&&(Eu=null,wo(i,s)),s=!1;var w=ut;e:do try{if(qe!==0&&Re!==null){var v=Re,T=gn;switch(qe){case 8:fg(),w=6;break e;case 3:case 2:case 9:case 6:Cn.current===null&&(s=!0);var V=qe;if(qe=0,gn=null,vo(i,v,T,V),a&&po){w=0;break e}break;default:V=qe,qe=0,gn=null,vo(i,v,T,V)}}i6(),w=ut;break}catch(X){Ww(i,X)}while(!0);return s&&i.shellSuspendCounter++,br=Xi=null,He=c,S.H=d,S.A=g,Re===null&&(Qe=null,Oe=0,Fc()),w}function i6(){for(;Re!==null;)nv(Re)}function s6(i,s){var a=He;He|=2;var c=ev(),d=tv();Qe!==i||Oe!==s?(Eu=null,vu=Jn()+500,wo(i,s)):po=Da(i,s);e:do try{if(qe!==0&&Re!==null){s=Re;var g=gn;t:switch(qe){case 1:qe=0,gn=null,vo(i,s,g,1);break;case 2:case 9:if(gb(g)){qe=0,gn=null,rv(s);break}s=function(){qe!==2&&qe!==9||Qe!==i||(qe=7),rr(i)},g.then(s,s);break e;case 3:qe=7;break e;case 4:qe=5;break e;case 7:gb(g)?(qe=0,gn=null,rv(s)):(qe=0,gn=null,vo(i,s,g,7));break;case 5:var w=null;switch(Re.tag){case 26:w=Re.memoizedState;case 5:case 27:var v=Re;if(!w||Pv(w)){qe=0,gn=null;var T=v.sibling;if(T!==null)Re=T;else{var V=v.return;V!==null?(Re=V,Su(V)):Re=null}break t}}qe=0,gn=null,vo(i,s,g,5);break;case 6:qe=0,gn=null,vo(i,s,g,6);break;case 8:fg(),ut=6;break e;default:throw Error(r(462))}}o6();break}catch(X){Ww(i,X)}while(!0);return br=Xi=null,S.H=c,S.A=d,He=a,Re!==null?0:(Qe=null,Oe=0,Fc(),ut)}function o6(){for(;Re!==null&&!Ck();)nv(Re)}function nv(i){var s=Nw(i.alternate,i,Tr);i.memoizedProps=i.pendingProps,s===null?Su(i):Re=s}function rv(i){var s=i,a=s.alternate;switch(s.tag){case 15:case 0:s=Sw(a,s,s.pendingProps,s.type,void 0,Oe);break;case 11:s=Sw(a,s,s.pendingProps,s.type.render,s.ref,Oe);break;case 5:Ch(s);default:Dw(a,s),s=Re=ib(s,Tr),s=Nw(a,s,Tr)}i.memoizedProps=i.pendingProps,s===null?Su(i):Re=s}function vo(i,s,a,c){br=Xi=null,Ch(s),uo=null,sl=0;var d=s.return;try{if(ZC(i,d,s,a,Oe)){ut=1,gu(i,An(a,i.current)),Re=null;return}}catch(g){if(d!==null)throw Re=d,g;ut=1,gu(i,An(a,i.current)),Re=null;return}s.flags&32768?(Ve||c===1?i=!0:po||(Oe&536870912)!==0?i=!1:(oi=i=!0,(c===2||c===9||c===3||c===6)&&(c=Cn.current,c!==null&&c.tag===13&&(c.flags|=16384))),iv(s,i)):Su(s)}function Su(i){var s=i;do{if((s.flags&32768)!==0){iv(s,oi);return}i=s.return;var a=QC(s.alternate,s,Tr);if(a!==null){Re=a;return}if(s=s.sibling,s!==null){Re=s;return}Re=s=i}while(s!==null);ut===0&&(ut=5)}function iv(i,s){do{var a=JC(i.alternate,i);if(a!==null){a.flags&=32767,Re=a;return}if(a=i.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!s&&(i=i.sibling,i!==null)){Re=i;return}Re=i=a}while(i!==null);ut=6,Re=null}function sv(i,s,a,c,d,g,w,v,T){i.cancelPendingCommit=null;do Au();while(Dt!==0);if((He&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(g=s.lanes|s.childLanes,g|=rh,Pk(i,a,g,w,v,T),i===Qe&&(Re=Qe=null,Oe=0),yo=s,ci=i,bo=a,lg=g,cg=d,Zw=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,u6(Nc,function(){return uv(),null})):(i.callbackNode=null,i.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=S.T,S.T=null,d=I.p,I.p=2,w=He,He|=4;try{WC(i,s,a)}finally{He=w,I.p=d,S.T=c}}Dt=1,ov(),av(),lv()}}function ov(){if(Dt===1){Dt=0;var i=ci,s=yo,a=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||a){a=S.T,S.T=null;var c=I.p;I.p=2;var d=He;He|=4;try{Hw(s,i);var g=_g,w=Y0(i.containerInfo),v=g.focusedElem,T=g.selectionRange;if(w!==v&&v&&v.ownerDocument&&G0(v.ownerDocument.documentElement,v)){if(T!==null&&Jd(v)){var V=T.start,X=T.end;if(X===void 0&&(X=V),"selectionStart"in v)v.selectionStart=V,v.selectionEnd=Math.min(X,v.value.length);else{var ee=v.ownerDocument||document,q=ee&&ee.defaultView||window;if(q.getSelection){var F=q.getSelection(),Te=v.textContent.length,xe=Math.min(T.start,Te),Ye=T.end===void 0?xe:Math.min(T.end,Te);!F.extend&&xe>Ye&&(w=Ye,Ye=xe,xe=w);var O=j0(v,xe),N=j0(v,Ye);if(O&&N&&(F.rangeCount!==1||F.anchorNode!==O.node||F.anchorOffset!==O.offset||F.focusNode!==N.node||F.focusOffset!==N.offset)){var z=ee.createRange();z.setStart(O.node,O.offset),F.removeAllRanges(),xe>Ye?(F.addRange(z),F.extend(N.node,N.offset)):(z.setEnd(N.node,N.offset),F.addRange(z))}}}}for(ee=[],F=v;F=F.parentNode;)F.nodeType===1&&ee.push({element:F,left:F.scrollLeft,top:F.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<ee.length;v++){var J=ee[v];J.element.scrollLeft=J.left,J.element.scrollTop=J.top}}Lu=!!Ag,_g=Ag=null}finally{He=d,I.p=c,S.T=a}}i.current=s,Dt=2}}function av(){if(Dt===2){Dt=0;var i=ci,s=yo,a=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||a){a=S.T,S.T=null;var c=I.p;I.p=2;var d=He;He|=4;try{Pw(i,s.alternate,s)}finally{He=d,I.p=c,S.T=a}}Dt=3}}function lv(){if(Dt===4||Dt===3){Dt=0,Nk();var i=ci,s=yo,a=bo,c=Zw;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Dt=5:(Dt=0,yo=ci=null,cv(i,i.pendingLanes));var d=i.pendingLanes;if(d===0&&(li=null),Dd(a),s=s.stateNode,ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(Ba,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=S.T,d=I.p,I.p=2,S.T=null;try{for(var g=i.onRecoverableError,w=0;w<c.length;w++){var v=c[w];g(v.value,{componentStack:v.stack})}}finally{S.T=s,I.p=d}}(bo&3)!==0&&Au(),rr(i),d=i.pendingLanes,(a&4194090)!==0&&(d&42)!==0?i===ug?gl++:(gl=0,ug=i):gl=0,pl(0)}}function cv(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Ya(s)))}function Au(i){return ov(),av(),lv(),uv()}function uv(){if(Dt!==5)return!1;var i=ci,s=lg;lg=0;var a=Dd(bo),c=S.T,d=I.p;try{I.p=32>a?32:a,S.T=null,a=cg,cg=null;var g=ci,w=bo;if(Dt=0,yo=ci=null,bo=0,(He&6)!==0)throw Error(r(331));var v=He;if(He|=4,Gw(g.current),Fw(g,g.current,w,a),He=v,pl(0,!1),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(Ba,g)}catch{}return!0}finally{I.p=d,S.T=c,cv(i,s)}}function fv(i,s,a){s=An(a,s),s=Hh(i.stateNode,s,2),i=Wr(i,s,2),i!==null&&(Ra(i,2),rr(i))}function Ze(i,s,a){if(i.tag===3)fv(i,i,a);else for(;s!==null;){if(s.tag===3){fv(s,i,a);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(li===null||!li.has(c))){i=An(a,i),a=pw(2),c=Wr(s,a,2),c!==null&&(mw(a,c,s,i),Ra(c,2),rr(c));break}}s=s.return}}function gg(i,s,a){var c=i.pingCache;if(c===null){c=i.pingCache=new n6;var d=new Set;c.set(s,d)}else d=c.get(s),d===void 0&&(d=new Set,c.set(s,d));d.has(a)||(ig=!0,d.add(a),i=a6.bind(null,i,s,a),s.then(i,i))}function a6(i,s,a){var c=i.pingCache;c!==null&&c.delete(s),i.pingedLanes|=i.suspendedLanes&a,i.warmLanes&=~a,Qe===i&&(Oe&a)===a&&(ut===4||ut===3&&(Oe&62914560)===Oe&&300>Jn()-ag?(He&2)===0&&wo(i,0):sg|=a,mo===Oe&&(mo=0)),rr(i)}function dv(i,s){s===0&&(s=l0()),i=eo(i,s),i!==null&&(Ra(i,s),rr(i))}function l6(i){var s=i.memoizedState,a=0;s!==null&&(a=s.retryLane),dv(i,a)}function c6(i,s){var a=0;switch(i.tag){case 13:var c=i.stateNode,d=i.memoizedState;d!==null&&(a=d.retryLane);break;case 19:c=i.stateNode;break;case 22:c=i.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(s),dv(i,a)}function u6(i,s){return zs(i,s)}var _u=null,Eo=null,pg=!1,Tu=!1,mg=!1,rs=0;function rr(i){i!==Eo&&i.next===null&&(Eo===null?_u=Eo=i:Eo=Eo.next=i),Tu=!0,pg||(pg=!0,d6())}function pl(i,s){if(!mg&&Tu){mg=!0;do for(var a=!1,c=_u;c!==null;){if(i!==0){var d=c.pendingLanes;if(d===0)var g=0;else{var w=c.suspendedLanes,v=c.pingedLanes;g=(1<<31-cn(42|i)+1)-1,g&=d&~(w&~v),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(a=!0,mv(c,g))}else g=Oe,g=Rc(c,c===Qe?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Da(c,g)||(a=!0,mv(c,g));c=c.next}while(a);mg=!1}}function f6(){hv()}function hv(){Tu=pg=!1;var i=0;rs!==0&&(v6()&&(i=rs),rs=0);for(var s=Jn(),a=null,c=_u;c!==null;){var d=c.next,g=gv(c,s);g===0?(c.next=null,a===null?_u=d:a.next=d,d===null&&(Eo=a)):(a=c,(i!==0||(g&3)!==0)&&(Tu=!0)),c=d}pl(i)}function gv(i,s){for(var a=i.suspendedLanes,c=i.pingedLanes,d=i.expirationTimes,g=i.pendingLanes&-62914561;0<g;){var w=31-cn(g),v=1<<w,T=d[w];T===-1?((v&a)===0||(v&c)!==0)&&(d[w]=Uk(v,s)):T<=s&&(i.expiredLanes|=v),g&=~v}if(s=Qe,a=Oe,a=Rc(i,i===s?a:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c=i.callbackNode,a===0||i===s&&(qe===2||qe===9)||i.cancelPendingCommit!==null)return c!==null&&c!==null&&Cd(c),i.callbackNode=null,i.callbackPriority=0;if((a&3)===0||Da(i,a)){if(s=a&-a,s===i.callbackPriority)return s;switch(c!==null&&Cd(c),Dd(a)){case 2:case 8:a=s0;break;case 32:a=Nc;break;case 268435456:a=o0;break;default:a=Nc}return c=pv.bind(null,i),a=zs(a,c),i.callbackPriority=s,i.callbackNode=a,s}return c!==null&&c!==null&&Cd(c),i.callbackPriority=2,i.callbackNode=null,2}function pv(i,s){if(Dt!==0&&Dt!==5)return i.callbackNode=null,i.callbackPriority=0,null;var a=i.callbackNode;if(Au()&&i.callbackNode!==a)return null;var c=Oe;return c=Rc(i,i===Qe?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c===0?null:(Qw(i,c,s),gv(i,Jn()),i.callbackNode!=null&&i.callbackNode===a?pv.bind(null,i):null)}function mv(i,s){if(Au())return null;Qw(i,s,!0)}function d6(){x6(function(){(He&6)!==0?zs(i0,f6):hv()})}function yg(){return rs===0&&(rs=a0()),rs}function yv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Uc(""+i)}function bv(i,s){var a=s.ownerDocument.createElement("input");return a.name=s.name,a.value=s.value,i.id&&a.setAttribute("form",i.id),s.parentNode.insertBefore(a,s),i=new FormData(i),a.parentNode.removeChild(a),i}function h6(i,s,a,c,d){if(s==="submit"&&a&&a.stateNode===d){var g=yv((d[Jt]||null).action),w=c.submitter;w&&(s=(s=w[Jt]||null)?yv(s.formAction):w.getAttribute("formAction"),s!==null&&(g=s,w=null));var v=new $c("action","action",null,c,d);i.push({event:v,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(rs!==0){var T=w?bv(d,w):new FormData(d);Uh(a,{pending:!0,data:T,method:d.method,action:g},null,T)}}else typeof g=="function"&&(v.preventDefault(),T=w?bv(d,w):new FormData(d),Uh(a,{pending:!0,data:T,method:d.method,action:g},g,T))},currentTarget:d}]})}}for(var bg=0;bg<nh.length;bg++){var wg=nh[bg],g6=wg.toLowerCase(),p6=wg[0].toUpperCase()+wg.slice(1);On(g6,"on"+p6)}On(Q0,"onAnimationEnd"),On(J0,"onAnimationIteration"),On(W0,"onAnimationStart"),On("dblclick","onDoubleClick"),On("focusin","onFocus"),On("focusout","onBlur"),On(RC,"onTransitionRun"),On(MC,"onTransitionStart"),On(IC,"onTransitionCancel"),On(eb,"onTransitionEnd"),Fs("onMouseEnter",["mouseout","mouseover"]),Fs("onMouseLeave",["mouseout","mouseover"]),Fs("onPointerEnter",["pointerout","pointerover"]),Fs("onPointerLeave",["pointerout","pointerover"]),$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$i("onBeforeInput",["compositionend","keypress","textInput","paste"]),$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ml));function wv(i,s){s=(s&4)!==0;for(var a=0;a<i.length;a++){var c=i[a],d=c.event;c=c.listeners;e:{var g=void 0;if(s)for(var w=c.length-1;0<=w;w--){var v=c[w],T=v.instance,V=v.currentTarget;if(v=v.listener,T!==g&&d.isPropagationStopped())break e;g=v,d.currentTarget=V;try{g(d)}catch(X){hu(X)}d.currentTarget=null,g=T}else for(w=0;w<c.length;w++){if(v=c[w],T=v.instance,V=v.currentTarget,v=v.listener,T!==g&&d.isPropagationStopped())break e;g=v,d.currentTarget=V;try{g(d)}catch(X){hu(X)}d.currentTarget=null,g=T}}}}function Me(i,s){var a=s[Rd];a===void 0&&(a=s[Rd]=new Set);var c=i+"__bubble";a.has(c)||(vv(s,i,2,!1),a.add(c))}function vg(i,s,a){var c=0;s&&(c|=4),vv(a,i,c,s)}var ku="_reactListening"+Math.random().toString(36).slice(2);function Eg(i){if(!i[ku]){i[ku]=!0,h0.forEach(function(a){a!=="selectionchange"&&(m6.has(a)||vg(a,!1,i),vg(a,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[ku]||(s[ku]=!0,vg("selectionchange",!1,s))}}function vv(i,s,a,c){switch(Fv(s)){case 2:var d=q6;break;case 8:d=F6;break;default:d=Og}a=d.bind(null,s,a,i),d=void 0,!qd||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(d=!0),c?d!==void 0?i.addEventListener(s,a,{capture:!0,passive:d}):i.addEventListener(s,a,!0):d!==void 0?i.addEventListener(s,a,{passive:d}):i.addEventListener(s,a,!1)}function xg(i,s,a,c,d){var g=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var v=c.stateNode.containerInfo;if(v===d)break;if(w===4)for(w=c.return;w!==null;){var T=w.tag;if((T===3||T===4)&&w.stateNode.containerInfo===d)return;w=w.return}for(;v!==null;){if(w=$s(v),w===null)return;if(T=w.tag,T===5||T===6||T===26||T===27){c=g=w;continue e}v=v.parentNode}}c=c.return}k0(function(){var V=g,X=$d(a),ee=[];e:{var q=tb.get(i);if(q!==void 0){var F=$c,Te=i;switch(i){case"keypress":if(zc(a)===0)break e;case"keydown":case"keyup":F=uC;break;case"focusin":Te="focus",F=Gd;break;case"focusout":Te="blur",F=Gd;break;case"beforeblur":case"afterblur":F=Gd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=B0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=Jk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=hC;break;case Q0:case J0:case W0:F=tC;break;case eb:F=pC;break;case"scroll":case"scrollend":F=Xk;break;case"wheel":F=yC;break;case"copy":case"cut":case"paste":F=rC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=R0;break;case"toggle":case"beforetoggle":F=wC}var xe=(s&4)!==0,Ye=!xe&&(i==="scroll"||i==="scrollend"),O=xe?q!==null?q+"Capture":null:q;xe=[];for(var N=V,z;N!==null;){var J=N;if(z=J.stateNode,J=J.tag,J!==5&&J!==26&&J!==27||z===null||O===null||(J=Oa(N,O),J!=null&&xe.push(yl(N,J,z))),Ye)break;N=N.return}0<xe.length&&(q=new F(q,Te,null,a,X),ee.push({event:q,listeners:xe}))}}if((s&7)===0){e:{if(q=i==="mouseover"||i==="pointerover",F=i==="mouseout"||i==="pointerout",q&&a!==Vd&&(Te=a.relatedTarget||a.fromElement)&&($s(Te)||Te[Vs]))break e;if((F||q)&&(q=X.window===X?X:(q=X.ownerDocument)?q.defaultView||q.parentWindow:window,F?(Te=a.relatedTarget||a.toElement,F=V,Te=Te?$s(Te):null,Te!==null&&(Ye=l(Te),xe=Te.tag,Te!==Ye||xe!==5&&xe!==27&&xe!==6)&&(Te=null)):(F=null,Te=V),F!==Te)){if(xe=B0,J="onMouseLeave",O="onMouseEnter",N="mouse",(i==="pointerout"||i==="pointerover")&&(xe=R0,J="onPointerLeave",O="onPointerEnter",N="pointer"),Ye=F==null?q:Ia(F),z=Te==null?q:Ia(Te),q=new xe(J,N+"leave",F,a,X),q.target=Ye,q.relatedTarget=z,J=null,$s(X)===V&&(xe=new xe(O,N+"enter",Te,a,X),xe.target=z,xe.relatedTarget=Ye,J=xe),Ye=J,F&&Te)t:{for(xe=F,O=Te,N=0,z=xe;z;z=xo(z))N++;for(z=0,J=O;J;J=xo(J))z++;for(;0<N-z;)xe=xo(xe),N--;for(;0<z-N;)O=xo(O),z--;for(;N--;){if(xe===O||O!==null&&xe===O.alternate)break t;xe=xo(xe),O=xo(O)}xe=null}else xe=null;F!==null&&Ev(ee,q,F,xe,!1),Te!==null&&Ye!==null&&Ev(ee,Ye,Te,xe,!0)}}e:{if(q=V?Ia(V):window,F=q.nodeName&&q.nodeName.toLowerCase(),F==="select"||F==="input"&&q.type==="file")var pe=V0;else if(P0(q))if($0)pe=NC;else{pe=kC;var De=TC}else F=q.nodeName,!F||F.toLowerCase()!=="input"||q.type!=="checkbox"&&q.type!=="radio"?V&&zd(V.elementType)&&(pe=V0):pe=CC;if(pe&&(pe=pe(i,V))){z0(ee,pe,a,X);break e}De&&De(i,q,V),i==="focusout"&&V&&q.type==="number"&&V.memoizedProps.value!=null&&Pd(q,"number",q.value)}switch(De=V?Ia(V):window,i){case"focusin":(P0(De)||De.contentEditable==="true")&&(Qs=De,Wd=V,qa=null);break;case"focusout":qa=Wd=Qs=null;break;case"mousedown":eh=!0;break;case"contextmenu":case"mouseup":case"dragend":eh=!1,Z0(ee,a,X);break;case"selectionchange":if(DC)break;case"keydown":case"keyup":Z0(ee,a,X)}var be;if(Zd)e:{switch(i){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Xs?L0(i,a)&&(Ae="onCompositionEnd"):i==="keydown"&&a.keyCode===229&&(Ae="onCompositionStart");Ae&&(M0&&a.locale!=="ko"&&(Xs||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Xs&&(be=C0()):(Zr=X,Fd="value"in Zr?Zr.value:Zr.textContent,Xs=!0)),De=Cu(V,Ae),0<De.length&&(Ae=new D0(Ae,i,null,a,X),ee.push({event:Ae,listeners:De}),be?Ae.data=be:(be=U0(a),be!==null&&(Ae.data=be)))),(be=EC?xC(i,a):SC(i,a))&&(Ae=Cu(V,"onBeforeInput"),0<Ae.length&&(De=new D0("onBeforeInput","beforeinput",null,a,X),ee.push({event:De,listeners:Ae}),De.data=be)),h6(ee,i,V,a,X)}wv(ee,s)})}function yl(i,s,a){return{instance:i,listener:s,currentTarget:a}}function Cu(i,s){for(var a=s+"Capture",c=[];i!==null;){var d=i,g=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||g===null||(d=Oa(i,a),d!=null&&c.unshift(yl(i,d,g)),d=Oa(i,s),d!=null&&c.push(yl(i,d,g))),i.tag===3)return c;i=i.return}return[]}function xo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Ev(i,s,a,c,d){for(var g=s._reactName,w=[];a!==null&&a!==c;){var v=a,T=v.alternate,V=v.stateNode;if(v=v.tag,T!==null&&T===c)break;v!==5&&v!==26&&v!==27||V===null||(T=V,d?(V=Oa(a,g),V!=null&&w.unshift(yl(a,V,T))):d||(V=Oa(a,g),V!=null&&w.push(yl(a,V,T)))),a=a.return}w.length!==0&&i.push({event:s,listeners:w})}var y6=/\r\n?/g,b6=/\u0000|\uFFFD/g;function xv(i){return(typeof i=="string"?i:""+i).replace(y6,`
`).replace(b6,"")}function Sv(i,s){return s=xv(s),xv(i)===s}function Nu(){}function Ge(i,s,a,c,d,g){switch(a){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||Gs(i,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&Gs(i,""+c);break;case"className":Ic(i,"class",c);break;case"tabIndex":Ic(i,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Ic(i,a,c);break;case"style":_0(i,c,g);break;case"data":if(s!=="object"){Ic(i,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||a!=="href")){i.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(a);break}c=Uc(""+c),i.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){i.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(a==="formAction"?(s!=="input"&&Ge(i,s,"name",d.name,d,null),Ge(i,s,"formEncType",d.formEncType,d,null),Ge(i,s,"formMethod",d.formMethod,d,null),Ge(i,s,"formTarget",d.formTarget,d,null)):(Ge(i,s,"encType",d.encType,d,null),Ge(i,s,"method",d.method,d,null),Ge(i,s,"target",d.target,d,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(a);break}c=Uc(""+c),i.setAttribute(a,c);break;case"onClick":c!=null&&(i.onclick=Nu);break;case"onScroll":c!=null&&Me("scroll",i);break;case"onScrollEnd":c!=null&&Me("scrollend",i);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(a=c.__html,a!=null){if(d.children!=null)throw Error(r(60));i.innerHTML=a}}break;case"multiple":i.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":i.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){i.removeAttribute("xlink:href");break}a=Uc(""+c),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(a,""+c):i.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(a,""):i.removeAttribute(a);break;case"capture":case"download":c===!0?i.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(a,c):i.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?i.setAttribute(a,c):i.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?i.removeAttribute(a):i.setAttribute(a,c);break;case"popover":Me("beforetoggle",i),Me("toggle",i),Mc(i,"popover",c);break;case"xlinkActuate":hr(i,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":hr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":hr(i,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":hr(i,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":hr(i,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":hr(i,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":hr(i,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":hr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":hr(i,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Mc(i,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Yk.get(a)||a,Mc(i,a,c))}}function Sg(i,s,a,c,d,g){switch(a){case"style":_0(i,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(a=c.__html,a!=null){if(d.children!=null)throw Error(r(60));i.innerHTML=a}}break;case"children":typeof c=="string"?Gs(i,c):(typeof c=="number"||typeof c=="bigint")&&Gs(i,""+c);break;case"onScroll":c!=null&&Me("scroll",i);break;case"onScrollEnd":c!=null&&Me("scrollend",i);break;case"onClick":c!=null&&(i.onclick=Nu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!g0.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),s=a.slice(2,d?a.length-7:void 0),g=i[Jt]||null,g=g!=null?g[a]:null,typeof g=="function"&&i.removeEventListener(s,g,d),typeof c=="function")){typeof g!="function"&&g!==null&&(a in i?i[a]=null:i.hasAttribute(a)&&i.removeAttribute(a)),i.addEventListener(s,c,d);break e}a in i?i[a]=c:c===!0?i.setAttribute(a,""):Mc(i,a,c)}}}function Rt(i,s,a){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Me("error",i),Me("load",i);var c=!1,d=!1,g;for(g in a)if(a.hasOwnProperty(g)){var w=a[g];if(w!=null)switch(g){case"src":c=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Ge(i,s,g,w,a,null)}}d&&Ge(i,s,"srcSet",a.srcSet,a,null),c&&Ge(i,s,"src",a.src,a,null);return;case"input":Me("invalid",i);var v=g=w=d=null,T=null,V=null;for(c in a)if(a.hasOwnProperty(c)){var X=a[c];if(X!=null)switch(c){case"name":d=X;break;case"type":w=X;break;case"checked":T=X;break;case"defaultChecked":V=X;break;case"value":g=X;break;case"defaultValue":v=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(137,s));break;default:Ge(i,s,c,X,a,null)}}E0(i,g,v,T,V,w,d,!1),Oc(i);return;case"select":Me("invalid",i),c=w=g=null;for(d in a)if(a.hasOwnProperty(d)&&(v=a[d],v!=null))switch(d){case"value":g=v;break;case"defaultValue":w=v;break;case"multiple":c=v;default:Ge(i,s,d,v,a,null)}s=g,a=w,i.multiple=!!c,s!=null?js(i,!!c,s,!1):a!=null&&js(i,!!c,a,!0);return;case"textarea":Me("invalid",i),g=d=c=null;for(w in a)if(a.hasOwnProperty(w)&&(v=a[w],v!=null))switch(w){case"value":c=v;break;case"defaultValue":d=v;break;case"children":g=v;break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(r(91));break;default:Ge(i,s,w,v,a,null)}S0(i,c,d,g),Oc(i);return;case"option":for(T in a)if(a.hasOwnProperty(T)&&(c=a[T],c!=null))switch(T){case"selected":i.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Ge(i,s,T,c,a,null)}return;case"dialog":Me("beforetoggle",i),Me("toggle",i),Me("cancel",i),Me("close",i);break;case"iframe":case"object":Me("load",i);break;case"video":case"audio":for(c=0;c<ml.length;c++)Me(ml[c],i);break;case"image":Me("error",i),Me("load",i);break;case"details":Me("toggle",i);break;case"embed":case"source":case"link":Me("error",i),Me("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(V in a)if(a.hasOwnProperty(V)&&(c=a[V],c!=null))switch(V){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Ge(i,s,V,c,a,null)}return;default:if(zd(s)){for(X in a)a.hasOwnProperty(X)&&(c=a[X],c!==void 0&&Sg(i,s,X,c,a,void 0));return}}for(v in a)a.hasOwnProperty(v)&&(c=a[v],c!=null&&Ge(i,s,v,c,a,null))}function w6(i,s,a,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,g=null,w=null,v=null,T=null,V=null,X=null;for(F in a){var ee=a[F];if(a.hasOwnProperty(F)&&ee!=null)switch(F){case"checked":break;case"value":break;case"defaultValue":T=ee;default:c.hasOwnProperty(F)||Ge(i,s,F,null,c,ee)}}for(var q in c){var F=c[q];if(ee=a[q],c.hasOwnProperty(q)&&(F!=null||ee!=null))switch(q){case"type":g=F;break;case"name":d=F;break;case"checked":V=F;break;case"defaultChecked":X=F;break;case"value":w=F;break;case"defaultValue":v=F;break;case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(137,s));break;default:F!==ee&&Ge(i,s,q,F,c,ee)}}Ud(i,w,v,T,V,X,g,d);return;case"select":F=w=v=q=null;for(g in a)if(T=a[g],a.hasOwnProperty(g)&&T!=null)switch(g){case"value":break;case"multiple":F=T;default:c.hasOwnProperty(g)||Ge(i,s,g,null,c,T)}for(d in c)if(g=c[d],T=a[d],c.hasOwnProperty(d)&&(g!=null||T!=null))switch(d){case"value":q=g;break;case"defaultValue":v=g;break;case"multiple":w=g;default:g!==T&&Ge(i,s,d,g,c,T)}s=v,a=w,c=F,q!=null?js(i,!!a,q,!1):!!c!=!!a&&(s!=null?js(i,!!a,s,!0):js(i,!!a,a?[]:"",!1));return;case"textarea":F=q=null;for(v in a)if(d=a[v],a.hasOwnProperty(v)&&d!=null&&!c.hasOwnProperty(v))switch(v){case"value":break;case"children":break;default:Ge(i,s,v,null,c,d)}for(w in c)if(d=c[w],g=a[w],c.hasOwnProperty(w)&&(d!=null||g!=null))switch(w){case"value":q=d;break;case"defaultValue":F=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(r(91));break;default:d!==g&&Ge(i,s,w,d,c,g)}x0(i,q,F);return;case"option":for(var Te in a)if(q=a[Te],a.hasOwnProperty(Te)&&q!=null&&!c.hasOwnProperty(Te))switch(Te){case"selected":i.selected=!1;break;default:Ge(i,s,Te,null,c,q)}for(T in c)if(q=c[T],F=a[T],c.hasOwnProperty(T)&&q!==F&&(q!=null||F!=null))switch(T){case"selected":i.selected=q&&typeof q!="function"&&typeof q!="symbol";break;default:Ge(i,s,T,q,c,F)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xe in a)q=a[xe],a.hasOwnProperty(xe)&&q!=null&&!c.hasOwnProperty(xe)&&Ge(i,s,xe,null,c,q);for(V in c)if(q=c[V],F=a[V],c.hasOwnProperty(V)&&q!==F&&(q!=null||F!=null))switch(V){case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(r(137,s));break;default:Ge(i,s,V,q,c,F)}return;default:if(zd(s)){for(var Ye in a)q=a[Ye],a.hasOwnProperty(Ye)&&q!==void 0&&!c.hasOwnProperty(Ye)&&Sg(i,s,Ye,void 0,c,q);for(X in c)q=c[X],F=a[X],!c.hasOwnProperty(X)||q===F||q===void 0&&F===void 0||Sg(i,s,X,q,c,F);return}}for(var O in a)q=a[O],a.hasOwnProperty(O)&&q!=null&&!c.hasOwnProperty(O)&&Ge(i,s,O,null,c,q);for(ee in c)q=c[ee],F=a[ee],!c.hasOwnProperty(ee)||q===F||q==null&&F==null||Ge(i,s,ee,q,c,F)}var Ag=null,_g=null;function Bu(i){return i.nodeType===9?i:i.ownerDocument}function Av(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _v(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Tg(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var kg=null;function v6(){var i=window.event;return i&&i.type==="popstate"?i===kg?!1:(kg=i,!0):(kg=null,!1)}var Tv=typeof setTimeout=="function"?setTimeout:void 0,E6=typeof clearTimeout=="function"?clearTimeout:void 0,kv=typeof Promise=="function"?Promise:void 0,x6=typeof queueMicrotask=="function"?queueMicrotask:typeof kv<"u"?function(i){return kv.resolve(null).then(i).catch(S6)}:Tv;function S6(i){setTimeout(function(){throw i})}function fi(i){return i==="head"}function Cv(i,s){var a=s,c=0,d=0;do{var g=a.nextSibling;if(i.removeChild(a),g&&g.nodeType===8)if(a=g.data,a==="/$"){if(0<c&&8>c){a=c;var w=i.ownerDocument;if(a&1&&bl(w.documentElement),a&2&&bl(w.body),a&4)for(a=w.head,bl(a),w=a.firstChild;w;){var v=w.nextSibling,T=w.nodeName;w[Ma]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&w.rel.toLowerCase()==="stylesheet"||a.removeChild(w),w=v}}if(d===0){i.removeChild(g),Tl(s);return}d--}else a==="$"||a==="$?"||a==="$!"?d++:c=a.charCodeAt(0)-48;else c=0;a=g}while(a);Tl(s)}function Cg(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var a=s;switch(s=s.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Cg(a),Md(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}i.removeChild(a)}}function A6(i,s,a,c){for(;i.nodeType===1;){var d=a;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(c){if(!i[Ma])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(g=i.getAttribute("rel"),g==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(g!==d.rel||i.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||i.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||i.getAttribute("title")!==(d.title==null?null:d.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(g=i.getAttribute("src"),(g!==(d.src==null?null:d.src)||i.getAttribute("type")!==(d.type==null?null:d.type)||i.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&g&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var g=d.name==null?null:""+d.name;if(d.type==="hidden"&&i.getAttribute("name")===g)return i}else return i;if(i=Un(i.nextSibling),i===null)break}return null}function _6(i,s,a){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=Un(i.nextSibling),i===null))return null;return i}function Ng(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function T6(i,s){var a=i.ownerDocument;if(i.data!=="$?"||a.readyState==="complete")s();else{var c=function(){s(),a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c),i._reactRetry=c}}function Un(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var Bg=null;function Nv(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var a=i.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return i;s--}else a==="/$"&&s++}i=i.previousSibling}return null}function Bv(i,s,a){switch(s=Bu(a),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function bl(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Md(i)}var Bn=new Map,Dv=new Set;function Du(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var kr=I.d;I.d={f:k6,r:C6,D:N6,C:B6,L:D6,m:R6,X:I6,S:M6,M:O6};function k6(){var i=kr.f(),s=xu();return i||s}function C6(i){var s=Hs(i);s!==null&&s.tag===5&&s.type==="form"?Qb(s):kr.r(i)}var So=typeof document>"u"?null:document;function Rv(i,s,a){var c=So;if(c&&typeof s=="string"&&s){var d=Sn(s);d='link[rel="'+i+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),Dv.has(d)||(Dv.add(d),i={rel:i,crossOrigin:a,href:s},c.querySelector(d)===null&&(s=c.createElement("link"),Rt(s,"link",i),At(s),c.head.appendChild(s)))}}function N6(i){kr.D(i),Rv("dns-prefetch",i,null)}function B6(i,s){kr.C(i,s),Rv("preconnect",i,s)}function D6(i,s,a){kr.L(i,s,a);var c=So;if(c&&i&&s){var d='link[rel="preload"][as="'+Sn(s)+'"]';s==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+Sn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+Sn(a.imageSizes)+'"]')):d+='[href="'+Sn(i)+'"]';var g=d;switch(s){case"style":g=Ao(i);break;case"script":g=_o(i)}Bn.has(g)||(i=m({rel:"preload",href:s==="image"&&a&&a.imageSrcSet?void 0:i,as:s},a),Bn.set(g,i),c.querySelector(d)!==null||s==="style"&&c.querySelector(wl(g))||s==="script"&&c.querySelector(vl(g))||(s=c.createElement("link"),Rt(s,"link",i),At(s),c.head.appendChild(s)))}}function R6(i,s){kr.m(i,s);var a=So;if(a&&i){var c=s&&typeof s.as=="string"?s.as:"script",d='link[rel="modulepreload"][as="'+Sn(c)+'"][href="'+Sn(i)+'"]',g=d;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=_o(i)}if(!Bn.has(g)&&(i=m({rel:"modulepreload",href:i},s),Bn.set(g,i),a.querySelector(d)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(vl(g)))return}c=a.createElement("link"),Rt(c,"link",i),At(c),a.head.appendChild(c)}}}function M6(i,s,a){kr.S(i,s,a);var c=So;if(c&&i){var d=qs(c).hoistableStyles,g=Ao(i);s=s||"default";var w=d.get(g);if(!w){var v={loading:0,preload:null};if(w=c.querySelector(wl(g)))v.loading=5;else{i=m({rel:"stylesheet",href:i,"data-precedence":s},a),(a=Bn.get(g))&&Dg(i,a);var T=w=c.createElement("link");At(T),Rt(T,"link",i),T._p=new Promise(function(V,X){T.onload=V,T.onerror=X}),T.addEventListener("load",function(){v.loading|=1}),T.addEventListener("error",function(){v.loading|=2}),v.loading|=4,Ru(w,s,c)}w={type:"stylesheet",instance:w,count:1,state:v},d.set(g,w)}}}function I6(i,s){kr.X(i,s);var a=So;if(a&&i){var c=qs(a).hoistableScripts,d=_o(i),g=c.get(d);g||(g=a.querySelector(vl(d)),g||(i=m({src:i,async:!0},s),(s=Bn.get(d))&&Rg(i,s),g=a.createElement("script"),At(g),Rt(g,"link",i),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(d,g))}}function O6(i,s){kr.M(i,s);var a=So;if(a&&i){var c=qs(a).hoistableScripts,d=_o(i),g=c.get(d);g||(g=a.querySelector(vl(d)),g||(i=m({src:i,async:!0,type:"module"},s),(s=Bn.get(d))&&Rg(i,s),g=a.createElement("script"),At(g),Rt(g,"link",i),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(d,g))}}function Mv(i,s,a,c){var d=(d=fe.current)?Du(d):null;if(!d)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(s=Ao(a.href),a=qs(d).hoistableStyles,c=a.get(s),c||(c={type:"style",instance:null,count:0,state:null},a.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){i=Ao(a.href);var g=qs(d).hoistableStyles,w=g.get(i);if(w||(d=d.ownerDocument||d,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(i,w),(g=d.querySelector(wl(i)))&&!g._p&&(w.instance=g,w.state.loading=5),Bn.has(i)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Bn.set(i,a),g||L6(d,i,a,w.state))),s&&c===null)throw Error(r(528,""));return w}if(s&&c!==null)throw Error(r(529,""));return null;case"script":return s=a.async,a=a.src,typeof a=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=_o(a),a=qs(d).hoistableScripts,c=a.get(s),c||(c={type:"script",instance:null,count:0,state:null},a.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Ao(i){return'href="'+Sn(i)+'"'}function wl(i){return'link[rel="stylesheet"]['+i+"]"}function Iv(i){return m({},i,{"data-precedence":i.precedence,precedence:null})}function L6(i,s,a,c){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=i.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),Rt(s,"link",a),At(s),i.head.appendChild(s))}function _o(i){return'[src="'+Sn(i)+'"]'}function vl(i){return"script[async]"+i}function Ov(i,s,a){if(s.count++,s.instance===null)switch(s.type){case"style":var c=i.querySelector('style[data-href~="'+Sn(a.href)+'"]');if(c)return s.instance=c,At(c),c;var d=m({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(i.ownerDocument||i).createElement("style"),At(c),Rt(c,"style",d),Ru(c,a.precedence,i),s.instance=c;case"stylesheet":d=Ao(a.href);var g=i.querySelector(wl(d));if(g)return s.state.loading|=4,s.instance=g,At(g),g;c=Iv(a),(d=Bn.get(d))&&Dg(c,d),g=(i.ownerDocument||i).createElement("link"),At(g);var w=g;return w._p=new Promise(function(v,T){w.onload=v,w.onerror=T}),Rt(g,"link",c),s.state.loading|=4,Ru(g,a.precedence,i),s.instance=g;case"script":return g=_o(a.src),(d=i.querySelector(vl(g)))?(s.instance=d,At(d),d):(c=a,(d=Bn.get(g))&&(c=m({},a),Rg(c,d)),i=i.ownerDocument||i,d=i.createElement("script"),At(d),Rt(d,"link",c),i.head.appendChild(d),s.instance=d);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,Ru(c,a.precedence,i));return s.instance}function Ru(i,s,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=c.length?c[c.length-1]:null,g=d,w=0;w<c.length;w++){var v=c[w];if(v.dataset.precedence===s)g=v;else if(g!==d)break}g?g.parentNode.insertBefore(i,g.nextSibling):(s=a.nodeType===9?a.head:a,s.insertBefore(i,s.firstChild))}function Dg(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Rg(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Mu=null;function Lv(i,s,a){if(Mu===null){var c=new Map,d=Mu=new Map;d.set(a,c)}else d=Mu,c=d.get(a),c||(c=new Map,d.set(a,c));if(c.has(i))return c;for(c.set(i,null),a=a.getElementsByTagName(i),d=0;d<a.length;d++){var g=a[d];if(!(g[Ma]||g[Vt]||i==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var w=g.getAttribute(s)||"";w=i+w;var v=c.get(w);v?v.push(g):c.set(w,[g])}}return c}function Uv(i,s,a){i=i.ownerDocument||i,i.head.insertBefore(a,s==="title"?i.querySelector("head > title"):null)}function U6(i,s,a){if(a===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Pv(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var El=null;function P6(){}function z6(i,s,a){if(El===null)throw Error(r(475));var c=El;if(s.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var d=Ao(a.href),g=i.querySelector(wl(d));if(g){i=g._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(c.count++,c=Iu.bind(c),i.then(c,c)),s.state.loading|=4,s.instance=g,At(g);return}g=i.ownerDocument||i,a=Iv(a),(d=Bn.get(d))&&Dg(a,d),g=g.createElement("link"),At(g);var w=g;w._p=new Promise(function(v,T){w.onload=v,w.onerror=T}),Rt(g,"link",a),s.instance=g}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(c.count++,s=Iu.bind(c),i.addEventListener("load",s),i.addEventListener("error",s))}}function V6(){if(El===null)throw Error(r(475));var i=El;return i.stylesheets&&i.count===0&&Mg(i,i.stylesheets),0<i.count?function(s){var a=setTimeout(function(){if(i.stylesheets&&Mg(i,i.stylesheets),i.unsuspend){var c=i.unsuspend;i.unsuspend=null,c()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(a)}}:null}function Iu(){if(this.count--,this.count===0){if(this.stylesheets)Mg(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Ou=null;function Mg(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Ou=new Map,s.forEach($6,i),Ou=null,Iu.call(i))}function $6(i,s){if(!(s.state.loading&4)){var a=Ou.get(i);if(a)var c=a.get(null);else{a=new Map,Ou.set(i,a);for(var d=i.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<d.length;g++){var w=d[g];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(a.set(w.dataset.precedence,w),c=w)}c&&a.set(null,c)}d=s.instance,w=d.getAttribute("data-precedence"),g=a.get(w)||c,g===c&&a.set(null,d),a.set(w,d),this.count++,c=Iu.bind(this),d.addEventListener("load",c),d.addEventListener("error",c),g?g.parentNode.insertBefore(d,g.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(d,i.firstChild)),s.state.loading|=4}}var xl={$$typeof:C,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function H6(i,s,a,c,d,g,w,v){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nd(0),this.hiddenUpdates=Nd(null),this.identifierPrefix=c,this.onUncaughtError=d,this.onCaughtError=g,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=v,this.incompleteTransitions=new Map}function zv(i,s,a,c,d,g,w,v,T,V,X,ee){return i=new H6(i,s,a,w,v,T,V,ee),s=1,g===!0&&(s|=24),g=fn(3,null,null,s),i.current=g,g.stateNode=i,s=gh(),s.refCount++,i.pooledCache=s,s.refCount++,g.memoizedState={element:c,isDehydrated:a,cache:s},bh(g),i}function Vv(i){return i?(i=to,i):to}function $v(i,s,a,c,d,g){d=Vv(d),c.context===null?c.context=d:c.pendingContext=d,c=Jr(s),c.payload={element:a},g=g===void 0?null:g,g!==null&&(c.callback=g),a=Wr(i,c,s),a!==null&&(mn(a,i,s),Ja(a,i,s))}function Hv(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var a=i.retryLane;i.retryLane=a!==0&&a<s?a:s}}function Ig(i,s){Hv(i,s),(i=i.alternate)&&Hv(i,s)}function qv(i){if(i.tag===13){var s=eo(i,67108864);s!==null&&mn(s,i,67108864),Ig(i,67108864)}}var Lu=!0;function q6(i,s,a,c){var d=S.T;S.T=null;var g=I.p;try{I.p=2,Og(i,s,a,c)}finally{I.p=g,S.T=d}}function F6(i,s,a,c){var d=S.T;S.T=null;var g=I.p;try{I.p=8,Og(i,s,a,c)}finally{I.p=g,S.T=d}}function Og(i,s,a,c){if(Lu){var d=Lg(c);if(d===null)xg(i,s,c,Uu,a),Kv(i,c);else if(j6(d,i,s,a,c))c.stopPropagation();else if(Kv(i,c),s&4&&-1<K6.indexOf(i)){for(;d!==null;){var g=Hs(d);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var w=Vi(g.pendingLanes);if(w!==0){var v=g;for(v.pendingLanes|=2,v.entangledLanes|=2;w;){var T=1<<31-cn(w);v.entanglements[1]|=T,w&=~T}rr(g),(He&6)===0&&(vu=Jn()+500,pl(0))}}break;case 13:v=eo(g,2),v!==null&&mn(v,g,2),xu(),Ig(g,2)}if(g=Lg(c),g===null&&xg(i,s,c,Uu,a),g===d)break;d=g}d!==null&&c.stopPropagation()}else xg(i,s,c,null,a)}}function Lg(i){return i=$d(i),Ug(i)}var Uu=null;function Ug(i){if(Uu=null,i=$s(i),i!==null){var s=l(i);if(s===null)i=null;else{var a=s.tag;if(a===13){if(i=u(s),i!==null)return i;i=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Uu=i,null}function Fv(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bk()){case i0:return 2;case s0:return 8;case Nc:case Dk:return 32;case o0:return 268435456;default:return 32}default:return 32}}var Pg=!1,di=null,hi=null,gi=null,Sl=new Map,Al=new Map,pi=[],K6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Kv(i,s){switch(i){case"focusin":case"focusout":di=null;break;case"dragenter":case"dragleave":hi=null;break;case"mouseover":case"mouseout":gi=null;break;case"pointerover":case"pointerout":Sl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Al.delete(s.pointerId)}}function _l(i,s,a,c,d,g){return i===null||i.nativeEvent!==g?(i={blockedOn:s,domEventName:a,eventSystemFlags:c,nativeEvent:g,targetContainers:[d]},s!==null&&(s=Hs(s),s!==null&&qv(s)),i):(i.eventSystemFlags|=c,s=i.targetContainers,d!==null&&s.indexOf(d)===-1&&s.push(d),i)}function j6(i,s,a,c,d){switch(s){case"focusin":return di=_l(di,i,s,a,c,d),!0;case"dragenter":return hi=_l(hi,i,s,a,c,d),!0;case"mouseover":return gi=_l(gi,i,s,a,c,d),!0;case"pointerover":var g=d.pointerId;return Sl.set(g,_l(Sl.get(g)||null,i,s,a,c,d)),!0;case"gotpointercapture":return g=d.pointerId,Al.set(g,_l(Al.get(g)||null,i,s,a,c,d)),!0}return!1}function jv(i){var s=$s(i.target);if(s!==null){var a=l(s);if(a!==null){if(s=a.tag,s===13){if(s=u(a),s!==null){i.blockedOn=s,zk(i.priority,function(){if(a.tag===13){var c=pn();c=Bd(c);var d=eo(a,c);d!==null&&mn(d,a,c),Ig(a,c)}});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){i.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pu(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var a=Lg(i.nativeEvent);if(a===null){a=i.nativeEvent;var c=new a.constructor(a.type,a);Vd=c,a.target.dispatchEvent(c),Vd=null}else return s=Hs(a),s!==null&&qv(s),i.blockedOn=a,!1;s.shift()}return!0}function Gv(i,s,a){Pu(i)&&a.delete(s)}function G6(){Pg=!1,di!==null&&Pu(di)&&(di=null),hi!==null&&Pu(hi)&&(hi=null),gi!==null&&Pu(gi)&&(gi=null),Sl.forEach(Gv),Al.forEach(Gv)}function zu(i,s){i.blockedOn===s&&(i.blockedOn=null,Pg||(Pg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,G6)))}var Vu=null;function Yv(i){Vu!==i&&(Vu=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Vu===i&&(Vu=null);for(var s=0;s<i.length;s+=3){var a=i[s],c=i[s+1],d=i[s+2];if(typeof c!="function"){if(Ug(c||a)===null)continue;break}var g=Hs(a);g!==null&&(i.splice(s,3),s-=3,Uh(g,{pending:!0,data:d,method:a.method,action:c},c,d))}}))}function Tl(i){function s(T){return zu(T,i)}di!==null&&zu(di,i),hi!==null&&zu(hi,i),gi!==null&&zu(gi,i),Sl.forEach(s),Al.forEach(s);for(var a=0;a<pi.length;a++){var c=pi[a];c.blockedOn===i&&(c.blockedOn=null)}for(;0<pi.length&&(a=pi[0],a.blockedOn===null);)jv(a),a.blockedOn===null&&pi.shift();if(a=(i.ownerDocument||i).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var d=a[c],g=a[c+1],w=d[Jt]||null;if(typeof g=="function")w||Yv(a);else if(w){var v=null;if(g&&g.hasAttribute("formAction")){if(d=g,w=g[Jt]||null)v=w.formAction;else if(Ug(d)!==null)continue}else v=w.action;typeof v=="function"?a[c+1]=v:(a.splice(c,3),c-=3),Yv(a)}}}function zg(i){this._internalRoot=i}$u.prototype.render=zg.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var a=s.current,c=pn();$v(a,c,i,s,null,null)},$u.prototype.unmount=zg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;$v(i.current,2,null,i,null,null),xu(),s[Vs]=null}};function $u(i){this._internalRoot=i}$u.prototype.unstable_scheduleHydration=function(i){if(i){var s=f0();i={blockedOn:null,target:i,priority:s};for(var a=0;a<pi.length&&s!==0&&s<pi[a].priority;a++);pi.splice(a,0,i),a===0&&jv(i)}};var Zv=e.version;if(Zv!=="19.1.1")throw Error(r(527,Zv,"19.1.1"));I.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=h(s),i=i!==null?p(i):null,i=i===null?null:i.stateNode,i};var Y6={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:S,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hu.isDisabled&&Hu.supportsFiber)try{Ba=Hu.inject(Y6),ln=Hu}catch{}}return Cl.createRoot=function(i,s){if(!o(i))throw Error(r(299));var a=!1,c="",d=fw,g=dw,w=hw,v=null;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(d=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(w=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(v=s.unstable_transitionCallbacks)),s=zv(i,1,!1,null,null,a,c,d,g,w,v,null),i[Vs]=s.current,Eg(i),new zg(s)},Cl.hydrateRoot=function(i,s,a){if(!o(i))throw Error(r(299));var c=!1,d="",g=fw,w=dw,v=hw,T=null,V=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(w=a.onCaughtError),a.onRecoverableError!==void 0&&(v=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(T=a.unstable_transitionCallbacks),a.formState!==void 0&&(V=a.formState)),s=zv(i,1,!0,s,a??null,c,d,g,w,v,T,V),s.context=Vv(null),a=s.current,c=pn(),c=Bd(c),d=Jr(c),d.callback=null,Wr(a,d,c),a=c,s.current.lanes=a,Ra(s,a),rr(s),i[Vs]=s.current,Eg(i),new $u(s)},Cl.version="19.1.1",Cl}var s1;function i4(){if(s1)return Hg.exports;s1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Hg.exports=r4(),Hg.exports}var s4=i4();const o4="modulepreload",a4=function(n){return"/variables-ui/"+n},o1={},a1=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let p=function(m){return Promise.all(m.map(y=>Promise.resolve(y).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var u=p;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),h=f?.nonce||f?.getAttribute("nonce");o=p(t.map(m=>{if(m=a4(m),m in o1)return;o1[m]=!0;const y=m.endsWith(".css"),b=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${b}`))return;const E=document.createElement("link");if(E.rel=y?"stylesheet":o4,y||(E.as="script"),E.crossOrigin="",E.href=m,h&&E.setAttribute("nonce",h),document.head.appendChild(E),y)return new Promise((x,k)=>{E.addEventListener("load",x),E.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return o.then(f=>{for(const h of f||[])h.status==="rejected"&&l(h.reason);return e().catch(l)})};function Cx(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var o=n.length;for(e=0;e<o;e++)n[e]&&(t=Cx(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Nx(){for(var n,e,t=0,r="",o=arguments.length;t<o;t++)(n=arguments[t])&&(e=Cx(n))&&(r&&(r+=" "),r+=e);return r}const Om="-",l4=n=>{const e=u4(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:u=>{const f=u.split(Om);return f[0]===""&&f.length!==1&&f.shift(),Bx(f,e)||c4(u)},getConflictingClassGroupIds:(u,f)=>{const h=t[u]||[];return f&&r[u]?[...h,...r[u]]:h}}},Bx=(n,e)=>{if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),o=r?Bx(n.slice(1),r):void 0;if(o)return o;if(e.validators.length===0)return;const l=n.join(Om);return e.validators.find(({validator:u})=>u(l))?.classGroupId},l1=/^\[(.+)\]$/,c4=n=>{if(l1.test(n)){const e=l1.exec(n)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},u4=n=>{const{theme:e,classGroups:t}=n,r={nextPart:new Map,validators:[]};for(const o in t)zp(t[o],r,o,e);return r},zp=(n,e,t,r)=>{n.forEach(o=>{if(typeof o=="string"){const l=o===""?e:c1(e,o);l.classGroupId=t;return}if(typeof o=="function"){if(f4(o)){zp(o(r),e,t,r);return}e.validators.push({validator:o,classGroupId:t});return}Object.entries(o).forEach(([l,u])=>{zp(u,c1(e,l),t,r)})})},c1=(n,e)=>{let t=n;return e.split(Om).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},f4=n=>n.isThemeGetter,d4=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const o=(l,u)=>{t.set(l,u),e++,e>n&&(e=0,r=t,t=new Map)};return{get(l){let u=t.get(l);if(u!==void 0)return u;if((u=r.get(l))!==void 0)return o(l,u),u},set(l,u){t.has(l)?t.set(l,u):o(l,u)}}},Vp="!",$p=":",h4=$p.length,g4=n=>{const{prefix:e,experimentalParseClassName:t}=n;let r=o=>{const l=[];let u=0,f=0,h=0,p;for(let x=0;x<o.length;x++){let k=o[x];if(u===0&&f===0){if(k===$p){l.push(o.slice(h,x)),h=x+h4;continue}if(k==="/"){p=x;continue}}k==="["?u++:k==="]"?u--:k==="("?f++:k===")"&&f--}const m=l.length===0?o:o.substring(h),y=p4(m),b=y!==m,E=p&&p>h?p-h:void 0;return{modifiers:l,hasImportantModifier:b,baseClassName:y,maybePostfixModifierPosition:E}};if(e){const o=e+$p,l=r;r=u=>u.startsWith(o)?l(u.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:u,maybePostfixModifierPosition:void 0}}if(t){const o=r;r=l=>t({className:l,parseClassName:o})}return r},p4=n=>n.endsWith(Vp)?n.substring(0,n.length-1):n.startsWith(Vp)?n.substring(1):n,m4=n=>{const e=Object.fromEntries(n.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let l=[];return r.forEach(u=>{u[0]==="["||e[u]?(o.push(...l.sort(),u),l=[]):l.push(u)}),o.push(...l.sort()),o}},y4=n=>({cache:d4(n.cacheSize),parseClassName:g4(n),sortModifiers:m4(n),...l4(n)}),b4=/\s+/,w4=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:l}=e,u=[],f=n.trim().split(b4);let h="";for(let p=f.length-1;p>=0;p-=1){const m=f[p],{isExternal:y,modifiers:b,hasImportantModifier:E,baseClassName:x,maybePostfixModifierPosition:k}=t(m);if(y){h=m+(h.length>0?" "+h:h);continue}let _=!!k,R=r(_?x.substring(0,k):x);if(!R){if(!_){h=m+(h.length>0?" "+h:h);continue}if(R=r(x),!R){h=m+(h.length>0?" "+h:h);continue}_=!1}const j=l(b).join(":"),C=E?j+Vp:j,Z=C+R;if(u.includes(Z))continue;u.push(Z);const Q=o(R,_);for(let re=0;re<Q.length;++re){const oe=Q[re];u.push(C+oe)}h=m+(h.length>0?" "+h:h)}return h};function v4(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=Dx(e))&&(r&&(r+=" "),r+=t);return r}const Dx=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=Dx(n[r]))&&(t&&(t+=" "),t+=e);return t};function E4(n,...e){let t,r,o,l=u;function u(h){const p=e.reduce((m,y)=>y(m),n());return t=y4(p),r=t.cache.get,o=t.cache.set,l=f,f(h)}function f(h){const p=r(h);if(p)return p;const m=w4(h,t);return o(h,m),m}return function(){return l(v4.apply(null,arguments))}}const xt=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},Rx=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Mx=/^\((?:(\w[\w-]*):)?(.+)\)$/i,x4=/^\d+\/\d+$/,S4=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,A4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,_4=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,T4=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,k4=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,To=n=>x4.test(n),Be=n=>!!n&&!Number.isNaN(Number(n)),yi=n=>!!n&&Number.isInteger(Number(n)),jg=n=>n.endsWith("%")&&Be(n.slice(0,-1)),Cr=n=>S4.test(n),C4=()=>!0,N4=n=>A4.test(n)&&!_4.test(n),Ix=()=>!1,B4=n=>T4.test(n),D4=n=>k4.test(n),R4=n=>!me(n)&&!ye(n),M4=n=>ga(n,Ux,Ix),me=n=>Rx.test(n),is=n=>ga(n,Px,N4),Gg=n=>ga(n,P4,Be),u1=n=>ga(n,Ox,Ix),I4=n=>ga(n,Lx,D4),qu=n=>ga(n,zx,B4),ye=n=>Mx.test(n),Nl=n=>pa(n,Px),O4=n=>pa(n,z4),f1=n=>pa(n,Ox),L4=n=>pa(n,Ux),U4=n=>pa(n,Lx),Fu=n=>pa(n,zx,!0),ga=(n,e,t)=>{const r=Rx.exec(n);return r?r[1]?e(r[1]):t(r[2]):!1},pa=(n,e,t=!1)=>{const r=Mx.exec(n);return r?r[1]?e(r[1]):t:!1},Ox=n=>n==="position"||n==="percentage",Lx=n=>n==="image"||n==="url",Ux=n=>n==="length"||n==="size"||n==="bg-size",Px=n=>n==="length",P4=n=>n==="number",z4=n=>n==="family-name",zx=n=>n==="shadow",V4=()=>{const n=xt("color"),e=xt("font"),t=xt("text"),r=xt("font-weight"),o=xt("tracking"),l=xt("leading"),u=xt("breakpoint"),f=xt("container"),h=xt("spacing"),p=xt("radius"),m=xt("shadow"),y=xt("inset-shadow"),b=xt("text-shadow"),E=xt("drop-shadow"),x=xt("blur"),k=xt("perspective"),_=xt("aspect"),R=xt("ease"),j=xt("animate"),C=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Z=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],Q=()=>[...Z(),ye,me],re=()=>["auto","hidden","clip","visible","scroll"],oe=()=>["auto","contain","none"],H=()=>[ye,me,h],B=()=>[To,"full","auto",...H()],G=()=>[yi,"none","subgrid",ye,me],te=()=>["auto",{span:["full",yi,ye,me]},yi,ye,me],Y=()=>[yi,"auto",ye,me],U=()=>["auto","min","max","fr",ye,me],M=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],D=()=>["start","end","center","stretch","center-safe","end-safe"],S=()=>["auto",...H()],I=()=>[To,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...H()],L=()=>[n,ye,me],ie=()=>[...Z(),f1,u1,{position:[ye,me]}],A=()=>["no-repeat",{repeat:["","x","y","space","round"]}],$=()=>["auto","cover","contain",L4,M4,{size:[ye,me]}],W=()=>[jg,Nl,is],ne=()=>["","none","full",p,ye,me],se=()=>["",Be,Nl,is],ue=()=>["solid","dashed","dotted","double"],fe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ve=()=>[Be,jg,f1,u1],ke=()=>["","none",x,ye,me],Ie=()=>["none",Be,ye,me],Je=()=>["none",Be,ye,me],an=()=>[Be,ye,me],In=()=>[To,"full",...H()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Cr],breakpoint:[Cr],color:[C4],container:[Cr],"drop-shadow":[Cr],ease:["in","out","in-out"],font:[R4],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Cr],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Cr],shadow:[Cr],spacing:["px",Be],text:[Cr],"text-shadow":[Cr],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",To,me,ye,_]}],container:["container"],columns:[{columns:[Be,me,ye,f]}],"break-after":[{"break-after":C()}],"break-before":[{"break-before":C()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:Q()}],overflow:[{overflow:re()}],"overflow-x":[{"overflow-x":re()}],"overflow-y":[{"overflow-y":re()}],overscroll:[{overscroll:oe()}],"overscroll-x":[{"overscroll-x":oe()}],"overscroll-y":[{"overscroll-y":oe()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:B()}],"inset-x":[{"inset-x":B()}],"inset-y":[{"inset-y":B()}],start:[{start:B()}],end:[{end:B()}],top:[{top:B()}],right:[{right:B()}],bottom:[{bottom:B()}],left:[{left:B()}],visibility:["visible","invisible","collapse"],z:[{z:[yi,"auto",ye,me]}],basis:[{basis:[To,"full","auto",f,...H()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Be,To,"auto","initial","none",me]}],grow:[{grow:["",Be,ye,me]}],shrink:[{shrink:["",Be,ye,me]}],order:[{order:[yi,"first","last","none",ye,me]}],"grid-cols":[{"grid-cols":G()}],"col-start-end":[{col:te()}],"col-start":[{"col-start":Y()}],"col-end":[{"col-end":Y()}],"grid-rows":[{"grid-rows":G()}],"row-start-end":[{row:te()}],"row-start":[{"row-start":Y()}],"row-end":[{"row-end":Y()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":U()}],"auto-rows":[{"auto-rows":U()}],gap:[{gap:H()}],"gap-x":[{"gap-x":H()}],"gap-y":[{"gap-y":H()}],"justify-content":[{justify:[...M(),"normal"]}],"justify-items":[{"justify-items":[...D(),"normal"]}],"justify-self":[{"justify-self":["auto",...D()]}],"align-content":[{content:["normal",...M()]}],"align-items":[{items:[...D(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...D(),{baseline:["","last"]}]}],"place-content":[{"place-content":M()}],"place-items":[{"place-items":[...D(),"baseline"]}],"place-self":[{"place-self":["auto",...D()]}],p:[{p:H()}],px:[{px:H()}],py:[{py:H()}],ps:[{ps:H()}],pe:[{pe:H()}],pt:[{pt:H()}],pr:[{pr:H()}],pb:[{pb:H()}],pl:[{pl:H()}],m:[{m:S()}],mx:[{mx:S()}],my:[{my:S()}],ms:[{ms:S()}],me:[{me:S()}],mt:[{mt:S()}],mr:[{mr:S()}],mb:[{mb:S()}],ml:[{ml:S()}],"space-x":[{"space-x":H()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":H()}],"space-y-reverse":["space-y-reverse"],size:[{size:I()}],w:[{w:[f,"screen",...I()]}],"min-w":[{"min-w":[f,"screen","none",...I()]}],"max-w":[{"max-w":[f,"screen","none","prose",{screen:[u]},...I()]}],h:[{h:["screen","lh",...I()]}],"min-h":[{"min-h":["screen","lh","none",...I()]}],"max-h":[{"max-h":["screen","lh",...I()]}],"font-size":[{text:["base",t,Nl,is]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,ye,Gg]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",jg,me]}],"font-family":[{font:[O4,me,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,ye,me]}],"line-clamp":[{"line-clamp":[Be,"none",ye,Gg]}],leading:[{leading:[l,...H()]}],"list-image":[{"list-image":["none",ye,me]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ye,me]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:L()}],"text-color":[{text:L()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ue(),"wavy"]}],"text-decoration-thickness":[{decoration:[Be,"from-font","auto",ye,is]}],"text-decoration-color":[{decoration:L()}],"underline-offset":[{"underline-offset":[Be,"auto",ye,me]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ye,me]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ye,me]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ie()}],"bg-repeat":[{bg:A()}],"bg-size":[{bg:$()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},yi,ye,me],radial:["",ye,me],conic:[yi,ye,me]},U4,I4]}],"bg-color":[{bg:L()}],"gradient-from-pos":[{from:W()}],"gradient-via-pos":[{via:W()}],"gradient-to-pos":[{to:W()}],"gradient-from":[{from:L()}],"gradient-via":[{via:L()}],"gradient-to":[{to:L()}],rounded:[{rounded:ne()}],"rounded-s":[{"rounded-s":ne()}],"rounded-e":[{"rounded-e":ne()}],"rounded-t":[{"rounded-t":ne()}],"rounded-r":[{"rounded-r":ne()}],"rounded-b":[{"rounded-b":ne()}],"rounded-l":[{"rounded-l":ne()}],"rounded-ss":[{"rounded-ss":ne()}],"rounded-se":[{"rounded-se":ne()}],"rounded-ee":[{"rounded-ee":ne()}],"rounded-es":[{"rounded-es":ne()}],"rounded-tl":[{"rounded-tl":ne()}],"rounded-tr":[{"rounded-tr":ne()}],"rounded-br":[{"rounded-br":ne()}],"rounded-bl":[{"rounded-bl":ne()}],"border-w":[{border:se()}],"border-w-x":[{"border-x":se()}],"border-w-y":[{"border-y":se()}],"border-w-s":[{"border-s":se()}],"border-w-e":[{"border-e":se()}],"border-w-t":[{"border-t":se()}],"border-w-r":[{"border-r":se()}],"border-w-b":[{"border-b":se()}],"border-w-l":[{"border-l":se()}],"divide-x":[{"divide-x":se()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":se()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ue(),"hidden","none"]}],"divide-style":[{divide:[...ue(),"hidden","none"]}],"border-color":[{border:L()}],"border-color-x":[{"border-x":L()}],"border-color-y":[{"border-y":L()}],"border-color-s":[{"border-s":L()}],"border-color-e":[{"border-e":L()}],"border-color-t":[{"border-t":L()}],"border-color-r":[{"border-r":L()}],"border-color-b":[{"border-b":L()}],"border-color-l":[{"border-l":L()}],"divide-color":[{divide:L()}],"outline-style":[{outline:[...ue(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Be,ye,me]}],"outline-w":[{outline:["",Be,Nl,is]}],"outline-color":[{outline:L()}],shadow:[{shadow:["","none",m,Fu,qu]}],"shadow-color":[{shadow:L()}],"inset-shadow":[{"inset-shadow":["none",y,Fu,qu]}],"inset-shadow-color":[{"inset-shadow":L()}],"ring-w":[{ring:se()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:L()}],"ring-offset-w":[{"ring-offset":[Be,is]}],"ring-offset-color":[{"ring-offset":L()}],"inset-ring-w":[{"inset-ring":se()}],"inset-ring-color":[{"inset-ring":L()}],"text-shadow":[{"text-shadow":["none",b,Fu,qu]}],"text-shadow-color":[{"text-shadow":L()}],opacity:[{opacity:[Be,ye,me]}],"mix-blend":[{"mix-blend":[...fe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":fe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Be]}],"mask-image-linear-from-pos":[{"mask-linear-from":ve()}],"mask-image-linear-to-pos":[{"mask-linear-to":ve()}],"mask-image-linear-from-color":[{"mask-linear-from":L()}],"mask-image-linear-to-color":[{"mask-linear-to":L()}],"mask-image-t-from-pos":[{"mask-t-from":ve()}],"mask-image-t-to-pos":[{"mask-t-to":ve()}],"mask-image-t-from-color":[{"mask-t-from":L()}],"mask-image-t-to-color":[{"mask-t-to":L()}],"mask-image-r-from-pos":[{"mask-r-from":ve()}],"mask-image-r-to-pos":[{"mask-r-to":ve()}],"mask-image-r-from-color":[{"mask-r-from":L()}],"mask-image-r-to-color":[{"mask-r-to":L()}],"mask-image-b-from-pos":[{"mask-b-from":ve()}],"mask-image-b-to-pos":[{"mask-b-to":ve()}],"mask-image-b-from-color":[{"mask-b-from":L()}],"mask-image-b-to-color":[{"mask-b-to":L()}],"mask-image-l-from-pos":[{"mask-l-from":ve()}],"mask-image-l-to-pos":[{"mask-l-to":ve()}],"mask-image-l-from-color":[{"mask-l-from":L()}],"mask-image-l-to-color":[{"mask-l-to":L()}],"mask-image-x-from-pos":[{"mask-x-from":ve()}],"mask-image-x-to-pos":[{"mask-x-to":ve()}],"mask-image-x-from-color":[{"mask-x-from":L()}],"mask-image-x-to-color":[{"mask-x-to":L()}],"mask-image-y-from-pos":[{"mask-y-from":ve()}],"mask-image-y-to-pos":[{"mask-y-to":ve()}],"mask-image-y-from-color":[{"mask-y-from":L()}],"mask-image-y-to-color":[{"mask-y-to":L()}],"mask-image-radial":[{"mask-radial":[ye,me]}],"mask-image-radial-from-pos":[{"mask-radial-from":ve()}],"mask-image-radial-to-pos":[{"mask-radial-to":ve()}],"mask-image-radial-from-color":[{"mask-radial-from":L()}],"mask-image-radial-to-color":[{"mask-radial-to":L()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":Z()}],"mask-image-conic-pos":[{"mask-conic":[Be]}],"mask-image-conic-from-pos":[{"mask-conic-from":ve()}],"mask-image-conic-to-pos":[{"mask-conic-to":ve()}],"mask-image-conic-from-color":[{"mask-conic-from":L()}],"mask-image-conic-to-color":[{"mask-conic-to":L()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ie()}],"mask-repeat":[{mask:A()}],"mask-size":[{mask:$()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ye,me]}],filter:[{filter:["","none",ye,me]}],blur:[{blur:ke()}],brightness:[{brightness:[Be,ye,me]}],contrast:[{contrast:[Be,ye,me]}],"drop-shadow":[{"drop-shadow":["","none",E,Fu,qu]}],"drop-shadow-color":[{"drop-shadow":L()}],grayscale:[{grayscale:["",Be,ye,me]}],"hue-rotate":[{"hue-rotate":[Be,ye,me]}],invert:[{invert:["",Be,ye,me]}],saturate:[{saturate:[Be,ye,me]}],sepia:[{sepia:["",Be,ye,me]}],"backdrop-filter":[{"backdrop-filter":["","none",ye,me]}],"backdrop-blur":[{"backdrop-blur":ke()}],"backdrop-brightness":[{"backdrop-brightness":[Be,ye,me]}],"backdrop-contrast":[{"backdrop-contrast":[Be,ye,me]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Be,ye,me]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Be,ye,me]}],"backdrop-invert":[{"backdrop-invert":["",Be,ye,me]}],"backdrop-opacity":[{"backdrop-opacity":[Be,ye,me]}],"backdrop-saturate":[{"backdrop-saturate":[Be,ye,me]}],"backdrop-sepia":[{"backdrop-sepia":["",Be,ye,me]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":H()}],"border-spacing-x":[{"border-spacing-x":H()}],"border-spacing-y":[{"border-spacing-y":H()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ye,me]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Be,"initial",ye,me]}],ease:[{ease:["linear","initial",R,ye,me]}],delay:[{delay:[Be,ye,me]}],animate:[{animate:["none",j,ye,me]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[k,ye,me]}],"perspective-origin":[{"perspective-origin":Q()}],rotate:[{rotate:Ie()}],"rotate-x":[{"rotate-x":Ie()}],"rotate-y":[{"rotate-y":Ie()}],"rotate-z":[{"rotate-z":Ie()}],scale:[{scale:Je()}],"scale-x":[{"scale-x":Je()}],"scale-y":[{"scale-y":Je()}],"scale-z":[{"scale-z":Je()}],"scale-3d":["scale-3d"],skew:[{skew:an()}],"skew-x":[{"skew-x":an()}],"skew-y":[{"skew-y":an()}],transform:[{transform:[ye,me,"","none","gpu","cpu"]}],"transform-origin":[{origin:Q()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:In()}],"translate-x":[{"translate-x":In()}],"translate-y":[{"translate-y":In()}],"translate-z":[{"translate-z":In()}],"translate-none":["translate-none"],accent:[{accent:L()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:L()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ye,me]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ye,me]}],fill:[{fill:["none",...L()]}],"stroke-w":[{stroke:[Be,Nl,is,Gg]}],stroke:[{stroke:["none",...L()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},$4=E4(V4);function Pt(...n){return $4(Nx(n))}function Lm({className:n,...e}){return K.jsx("div",{"data-slot":"card",className:Pt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",n),...e})}function Um({className:n,...e}){return K.jsx("div",{"data-slot":"card-header",className:Pt("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",n),...e})}function Pm({className:n,...e}){return K.jsx("div",{"data-slot":"card-title",className:Pt("leading-none font-semibold",n),...e})}function zm({className:n,...e}){return K.jsx("div",{"data-slot":"card-description",className:Pt("text-muted-foreground text-sm",n),...e})}function Vm({className:n,...e}){return K.jsx("div",{"data-slot":"card-content",className:Pt("px-6",n),...e})}function d1(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function Vx(...n){return e=>{let t=!1;const r=n.map(o=>{const l=d1(o,e);return!t&&typeof l=="function"&&(t=!0),l});if(t)return()=>{for(let o=0;o<r.length;o++){const l=r[o];typeof l=="function"?l():d1(n[o],null)}}}}function yf(...n){return ae.useCallback(Vx(...n),n)}function bf(n){const e=H4(n),t=ae.forwardRef((r,o)=>{const{children:l,...u}=r,f=ae.Children.toArray(l),h=f.find(F4);if(h){const p=h.props.children,m=f.map(y=>y===h?ae.Children.count(p)>1?ae.Children.only(null):ae.isValidElement(p)?p.props.children:null:y);return K.jsx(e,{...u,ref:o,children:ae.isValidElement(p)?ae.cloneElement(p,void 0,m):null})}return K.jsx(e,{...u,ref:o,children:l})});return t.displayName=`${n}.Slot`,t}var $x=bf("Slot");function H4(n){const e=ae.forwardRef((t,r)=>{const{children:o,...l}=t;if(ae.isValidElement(o)){const u=j4(o),f=K4(l,o.props);return o.type!==ae.Fragment&&(f.ref=r?Vx(r,u):u),ae.cloneElement(o,f)}return ae.Children.count(o)>1?ae.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var q4=Symbol("radix.slottable");function F4(n){return ae.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===q4}function K4(n,e){const t={...e};for(const r in e){const o=n[r],l=e[r];/^on[A-Z]/.test(r)?o&&l?t[r]=(...f)=>{const h=l(...f);return o(...f),h}:o&&(t[r]=o):r==="style"?t[r]={...o,...l}:r==="className"&&(t[r]=[o,l].filter(Boolean).join(" "))}return{...n,...t}}function j4(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}const h1=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,g1=Nx,$m=(n,e)=>t=>{var r;if(e?.variants==null)return g1(n,t?.class,t?.className);const{variants:o,defaultVariants:l}=e,u=Object.keys(o).map(p=>{const m=t?.[p],y=l?.[p];if(m===null)return null;const b=h1(m)||h1(y);return o[p][b]}),f=t&&Object.entries(t).reduce((p,m)=>{let[y,b]=m;return b===void 0||(p[y]=b),p},{}),h=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((p,m)=>{let{class:y,className:b,...E}=m;return Object.entries(E).every(x=>{let[k,_]=x;return Array.isArray(_)?_.includes({...l,...f}[k]):{...l,...f}[k]===_})?[...p,y,b]:p},[]);return g1(n,u,h,t?.class,t?.className)},G4=$m("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Mr({className:n,variant:e,size:t,asChild:r=!1,...o}){const l=r?$x:"button";return K.jsx(l,{"data-slot":"button",className:Pt(G4({variant:e,size:t,className:n})),...o})}function Pl({className:n,type:e,...t}){return K.jsx("input",{type:e,"data-slot":"input",className:Pt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),...t})}kx();var Y4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ui=Y4.reduce((n,e)=>{const t=bf(`Primitive.${e}`),r=ae.forwardRef((o,l)=>{const{asChild:u,...f}=o,h=u?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),K.jsx(h,{...f,ref:l})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{}),Z4="Label",Hx=ae.forwardRef((n,e)=>K.jsx(Ui.label,{...n,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(n.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Hx.displayName=Z4;var X4=Hx;function us({className:n,...e}){return K.jsx(X4,{"data-slot":"label",className:Pt("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",n),...e})}function qx({className:n,...e}){return K.jsx("textarea",{"data-slot":"textarea",className:Pt("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),...e})}const Q4=$m("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Hp({className:n,variant:e,...t}){return K.jsx("div",{"data-slot":"alert",role:"alert",className:Pt(Q4({variant:e}),n),...t})}function qp({className:n,...e}){return K.jsx("div",{"data-slot":"alert-description",className:Pt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",n),...e})}var J4="Separator",p1="horizontal",W4=["horizontal","vertical"],Fx=ae.forwardRef((n,e)=>{const{decorative:t,orientation:r=p1,...o}=n,l=e3(r)?r:p1,f=t?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return K.jsx(Ui.div,{"data-orientation":l,...f,...o,ref:e})});Fx.displayName=J4;function e3(n){return W4.includes(n)}var t3=Fx;function Fp({className:n,orientation:e="horizontal",decorative:t=!0,...r}){return K.jsx(t3,{"data-slot":"separator",decorative:t,orientation:e,className:Pt("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",n),...r})}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r3=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),m1=n=>{const e=r3(n);return e.charAt(0).toUpperCase()+e.slice(1)},Kx=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),i3=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var s3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=ae.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:o="",children:l,iconNode:u,...f},h)=>ae.createElement("svg",{ref:h,...s3,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:Kx("lucide",o),...!l&&!i3(f)&&{"aria-hidden":"true"},...f},[...u.map(([p,m])=>ae.createElement(p,m)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=(n,e)=>{const t=ae.forwardRef(({className:r,...o},l)=>ae.createElement(o3,{ref:l,iconNode:e,className:Kx(`lucide-${n3(m1(n))}`,`lucide-${n}`,r),...o}));return t.displayName=m1(n),t};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],y1=ma("clipboard",a3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],c3=ma("download",l3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],jx=ma("file-text",u3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],d3=ma("save",f3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],g3=ma("settings",h3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],wf=ma("upload",p3);async function m3(n){try{const e=await fetch(`https://ipfs.io/ipns/${n}`);if(!e.ok)return{success:!1,error:`Failed to fetch: ${e.status} ${e.statusText}`};let t;const r=e.headers.get("X-Ipfs-Roots");if(r&&(t=r.trim()),!t&&e.url){const l=e.url.match(/\/ipfs\/([a-zA-Z0-9]+)/);l&&(t=l[1])}return{success:!0,data:await e.json(),ipfsHash:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}function y3(n){if(typeof n!="object"||n===null)return{valid:!1,error:"Invalid JSON structure"};const e=n;for(const[t,r]of Object.entries(e))if(t!=="__env"&&(typeof r!="object"||r===null||!("ipnsPublicKey"in r)))return{valid:!1,error:`Environment "${t}" missing ipnsPublicKey`};return{valid:!0,config:e}}function b3({onConfigLoaded:n}){const[e,t]=ae.useState(""),[r,o]=ae.useState(null),l=h=>{const p=y3(h);if(!p.valid)throw new Error(p.error);n(h),t(""),o(null)},u=async h=>{const p=h.target.files?.[0];if(p)try{const m=await p.text(),y=JSON.parse(m);l(y)}catch(m){o(`Failed to parse file: ${m instanceof Error?m.message:"Unknown error"}`)}},f=()=>{if(!e.trim()){o("Please enter JSON configuration");return}try{const h=JSON.parse(e);l(h)}catch(h){o(`Failed to parse JSON: ${h instanceof Error?h.message:"Unknown error"}`)}};return K.jsxs(Lm,{className:"w-full max-w-4xl mx-auto",children:[K.jsxs(Um,{children:[K.jsxs(Pm,{className:"flex items-center gap-2",children:[K.jsx(wf,{className:"h-5 w-5"}),"Load Configuration Structure"]}),K.jsx(zm,{children:"Upload a JSON file or paste your environment configuration structure"})]}),K.jsx(Vm,{children:K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsxs(us,{className:"text-sm font-medium flex items-center gap-2",children:[K.jsx(wf,{className:"h-4 w-4"}),"Upload JSON File"]}),K.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6 text-center",children:[K.jsx(Pl,{type:"file",accept:".json",onChange:u,className:"w-full"}),K.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Select a JSON file with your environment configuration"})]})]}),K.jsxs("div",{className:"flex items-center gap-4",children:[K.jsx(Fp,{className:"flex-1"}),K.jsx("span",{className:"text-sm text-muted-foreground",children:"OR"}),K.jsx(Fp,{className:"flex-1"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsxs(us,{className:"text-sm font-medium flex items-center gap-2",children:[K.jsx(y1,{className:"h-4 w-4"}),"Paste Raw JSON"]}),K.jsx(qx,{placeholder:"Paste your JSON configuration here...",value:e,onChange:h=>t(h.target.value),className:"min-h-[200px] font-mono text-sm"}),K.jsxs(Mr,{onClick:f,disabled:!e.trim(),className:"w-full",children:[K.jsx(y1,{className:"h-4 w-4 mr-2"}),"Load from JSON"]})]}),K.jsxs(Hp,{children:[K.jsx(jx,{className:"h-4 w-4"}),K.jsxs(qp,{children:["Expected structure:",K.jsx("pre",{className:"mt-2 text-xs bg-muted p-2 rounded",children:`{
      "_env": {
        "pinataJWT": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      },
      "development": {
        "ipnsPublicKey": "k51qzi5uqu5dg7f...",
        "ipnsPrivateKey": "CAASqAkwggSk..." (optional)
      },
      "production": {
        "ipnsPublicKey": "k51qzi5uqu5dk61...",
        "ipnsPrivateKey": "CAASqAkwggSk..." (optional)
      }
    }`})]})]}),r&&K.jsx(Hp,{variant:"destructive",children:K.jsx(qp,{children:r})})]})})]})}function Lr(n,e,{checkForDefaultPrevented:t=!0}={}){return function(o){if(n?.(o),t===!1||!o.defaultPrevented)return e?.(o)}}function Hm(n,e=[]){let t=[];function r(l,u){const f=ae.createContext(u),h=t.length;t=[...t,u];const p=y=>{const{scope:b,children:E,...x}=y,k=b?.[n]?.[h]||f,_=ae.useMemo(()=>x,Object.values(x));return K.jsx(k.Provider,{value:_,children:E})};p.displayName=l+"Provider";function m(y,b){const E=b?.[n]?.[h]||f,x=ae.useContext(E);if(x)return x;if(u!==void 0)return u;throw new Error(`\`${y}\` must be used within \`${l}\``)}return[p,m]}const o=()=>{const l=t.map(u=>ae.createContext(u));return function(f){const h=f?.[n]||l;return ae.useMemo(()=>({[`__scope${n}`]:{...f,[n]:h}}),[f,h])}};return o.scopeName=n,[r,w3(o,...e)]}function w3(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(l){const u=r.reduce((f,{useScope:h,scopeName:p})=>{const y=h(l)[`__scope${p}`];return{...f,...y}},{});return ae.useMemo(()=>({[`__scope${e.scopeName}`]:u}),[u])}};return t.scopeName=e.scopeName,t}function v3(n){const e=n+"CollectionProvider",[t,r]=Hm(e),[o,l]=t(e,{collectionRef:{current:null},itemMap:new Map}),u=k=>{const{scope:_,children:R}=k,j=Ti.useRef(null),C=Ti.useRef(new Map).current;return K.jsx(o,{scope:_,itemMap:C,collectionRef:j,children:R})};u.displayName=e;const f=n+"CollectionSlot",h=bf(f),p=Ti.forwardRef((k,_)=>{const{scope:R,children:j}=k,C=l(f,R),Z=yf(_,C.collectionRef);return K.jsx(h,{ref:Z,children:j})});p.displayName=f;const m=n+"CollectionItemSlot",y="data-radix-collection-item",b=bf(m),E=Ti.forwardRef((k,_)=>{const{scope:R,children:j,...C}=k,Z=Ti.useRef(null),Q=yf(_,Z),re=l(m,R);return Ti.useEffect(()=>(re.itemMap.set(Z,{ref:Z,...C}),()=>void re.itemMap.delete(Z))),K.jsx(b,{[y]:"",ref:Q,children:j})});E.displayName=m;function x(k){const _=l(n+"CollectionConsumer",k);return Ti.useCallback(()=>{const j=_.collectionRef.current;if(!j)return[];const C=Array.from(j.querySelectorAll(`[${y}]`));return Array.from(_.itemMap.values()).sort((re,oe)=>C.indexOf(re.ref.current)-C.indexOf(oe.ref.current))},[_.collectionRef,_.itemMap])}return[{Provider:u,Slot:p,ItemSlot:E},x,r]}var vf=globalThis?.document?ae.useLayoutEffect:()=>{},E3=Tx[" useId ".trim().toString()]||(()=>{}),x3=0;function Gx(n){const[e,t]=ae.useState(E3());return vf(()=>{t(r=>r??String(x3++))},[n]),n||(e?`radix-${e}`:"")}function S3(n){const e=ae.useRef(n);return ae.useEffect(()=>{e.current=n}),ae.useMemo(()=>(...t)=>e.current?.(...t),[])}var A3=Tx[" useInsertionEffect ".trim().toString()]||vf;function Yx({prop:n,defaultProp:e,onChange:t=()=>{},caller:r}){const[o,l,u]=_3({defaultProp:e,onChange:t}),f=n!==void 0,h=f?n:o;{const m=ae.useRef(n!==void 0);ae.useEffect(()=>{const y=m.current;y!==f&&console.warn(`${r} is changing from ${y?"controlled":"uncontrolled"} to ${f?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=f},[f,r])}const p=ae.useCallback(m=>{if(f){const y=T3(m)?m(n):m;y!==n&&u.current?.(y)}else l(m)},[f,n,l,u]);return[h,p]}function _3({defaultProp:n,onChange:e}){const[t,r]=ae.useState(n),o=ae.useRef(t),l=ae.useRef(e);return A3(()=>{l.current=e},[e]),ae.useEffect(()=>{o.current!==t&&(l.current?.(t),o.current=t)},[t,o]),[t,r,l]}function T3(n){return typeof n=="function"}var k3=ae.createContext(void 0);function Zx(n){const e=ae.useContext(k3);return n||e||"ltr"}var Yg="rovingFocusGroup.onEntryFocus",C3={bubbles:!1,cancelable:!0},dc="RovingFocusGroup",[Kp,Xx,N3]=v3(dc),[B3,Qx]=Hm(dc,[N3]),[D3,R3]=B3(dc),Jx=ae.forwardRef((n,e)=>K.jsx(Kp.Provider,{scope:n.__scopeRovingFocusGroup,children:K.jsx(Kp.Slot,{scope:n.__scopeRovingFocusGroup,children:K.jsx(M3,{...n,ref:e})})}));Jx.displayName=dc;var M3=ae.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:o=!1,dir:l,currentTabStopId:u,defaultCurrentTabStopId:f,onCurrentTabStopIdChange:h,onEntryFocus:p,preventScrollOnEntryFocus:m=!1,...y}=n,b=ae.useRef(null),E=yf(e,b),x=Zx(l),[k,_]=Yx({prop:u,defaultProp:f??null,onChange:h,caller:dc}),[R,j]=ae.useState(!1),C=S3(p),Z=Xx(t),Q=ae.useRef(!1),[re,oe]=ae.useState(0);return ae.useEffect(()=>{const H=b.current;if(H)return H.addEventListener(Yg,C),()=>H.removeEventListener(Yg,C)},[C]),K.jsx(D3,{scope:t,orientation:r,dir:x,loop:o,currentTabStopId:k,onItemFocus:ae.useCallback(H=>_(H),[_]),onItemShiftTab:ae.useCallback(()=>j(!0),[]),onFocusableItemAdd:ae.useCallback(()=>oe(H=>H+1),[]),onFocusableItemRemove:ae.useCallback(()=>oe(H=>H-1),[]),children:K.jsx(Ui.div,{tabIndex:R||re===0?-1:0,"data-orientation":r,...y,ref:E,style:{outline:"none",...n.style},onMouseDown:Lr(n.onMouseDown,()=>{Q.current=!0}),onFocus:Lr(n.onFocus,H=>{const B=!Q.current;if(H.target===H.currentTarget&&B&&!R){const G=new CustomEvent(Yg,C3);if(H.currentTarget.dispatchEvent(G),!G.defaultPrevented){const te=Z().filter(S=>S.focusable),Y=te.find(S=>S.active),U=te.find(S=>S.id===k),D=[Y,U,...te].filter(Boolean).map(S=>S.ref.current);t2(D,m)}}Q.current=!1}),onBlur:Lr(n.onBlur,()=>j(!1))})})}),Wx="RovingFocusGroupItem",e2=ae.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:o=!1,tabStopId:l,children:u,...f}=n,h=Gx(),p=l||h,m=R3(Wx,t),y=m.currentTabStopId===p,b=Xx(t),{onFocusableItemAdd:E,onFocusableItemRemove:x,currentTabStopId:k}=m;return ae.useEffect(()=>{if(r)return E(),()=>x()},[r,E,x]),K.jsx(Kp.ItemSlot,{scope:t,id:p,focusable:r,active:o,children:K.jsx(Ui.span,{tabIndex:y?0:-1,"data-orientation":m.orientation,...f,ref:e,onMouseDown:Lr(n.onMouseDown,_=>{r?m.onItemFocus(p):_.preventDefault()}),onFocus:Lr(n.onFocus,()=>m.onItemFocus(p)),onKeyDown:Lr(n.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){m.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const R=L3(_,m.orientation,m.dir);if(R!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let C=b().filter(Z=>Z.focusable).map(Z=>Z.ref.current);if(R==="last")C.reverse();else if(R==="prev"||R==="next"){R==="prev"&&C.reverse();const Z=C.indexOf(_.currentTarget);C=m.loop?U3(C,Z+1):C.slice(Z+1)}setTimeout(()=>t2(C))}}),children:typeof u=="function"?u({isCurrentTabStop:y,hasTabStop:k!=null}):u})})});e2.displayName=Wx;var I3={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function O3(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function L3(n,e,t){const r=O3(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return I3[r]}function t2(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function U3(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var P3=Jx,z3=e2;function V3(n,e){return ae.useReducer((t,r)=>e[t][r]??t,n)}var n2=n=>{const{present:e,children:t}=n,r=$3(e),o=typeof t=="function"?t({present:r.isPresent}):ae.Children.only(t),l=yf(r.ref,H3(o));return typeof t=="function"||r.isPresent?ae.cloneElement(o,{ref:l}):null};n2.displayName="Presence";function $3(n){const[e,t]=ae.useState(),r=ae.useRef(null),o=ae.useRef(n),l=ae.useRef("none"),u=n?"mounted":"unmounted",[f,h]=V3(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return ae.useEffect(()=>{const p=Ku(r.current);l.current=f==="mounted"?p:"none"},[f]),vf(()=>{const p=r.current,m=o.current;if(m!==n){const b=l.current,E=Ku(p);n?h("MOUNT"):E==="none"||p?.display==="none"?h("UNMOUNT"):h(m&&b!==E?"ANIMATION_OUT":"UNMOUNT"),o.current=n}},[n,h]),vf(()=>{if(e){let p;const m=e.ownerDocument.defaultView??window,y=E=>{const k=Ku(r.current).includes(CSS.escape(E.animationName));if(E.target===e&&k&&(h("ANIMATION_END"),!o.current)){const _=e.style.animationFillMode;e.style.animationFillMode="forwards",p=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=_)})}},b=E=>{E.target===e&&(l.current=Ku(r.current))};return e.addEventListener("animationstart",b),e.addEventListener("animationcancel",y),e.addEventListener("animationend",y),()=>{m.clearTimeout(p),e.removeEventListener("animationstart",b),e.removeEventListener("animationcancel",y),e.removeEventListener("animationend",y)}}else h("ANIMATION_END")},[e,h]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:ae.useCallback(p=>{r.current=p?getComputedStyle(p):null,t(p)},[])}}function Ku(n){return n?.animationName||"none"}function H3(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var td="Tabs",[q3]=Hm(td,[Qx]),r2=Qx(),[F3,qm]=q3(td),i2=ae.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,onValueChange:o,defaultValue:l,orientation:u="horizontal",dir:f,activationMode:h="automatic",...p}=n,m=Zx(f),[y,b]=Yx({prop:r,onChange:o,defaultProp:l??"",caller:td});return K.jsx(F3,{scope:t,baseId:Gx(),value:y,onValueChange:b,orientation:u,dir:m,activationMode:h,children:K.jsx(Ui.div,{dir:m,"data-orientation":u,...p,ref:e})})});i2.displayName=td;var s2="TabsList",o2=ae.forwardRef((n,e)=>{const{__scopeTabs:t,loop:r=!0,...o}=n,l=qm(s2,t),u=r2(t);return K.jsx(P3,{asChild:!0,...u,orientation:l.orientation,dir:l.dir,loop:r,children:K.jsx(Ui.div,{role:"tablist","aria-orientation":l.orientation,...o,ref:e})})});o2.displayName=s2;var a2="TabsTrigger",l2=ae.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,disabled:o=!1,...l}=n,u=qm(a2,t),f=r2(t),h=f2(u.baseId,r),p=d2(u.baseId,r),m=r===u.value;return K.jsx(z3,{asChild:!0,...f,focusable:!o,active:m,children:K.jsx(Ui.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":p,"data-state":m?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:h,...l,ref:e,onMouseDown:Lr(n.onMouseDown,y=>{!o&&y.button===0&&y.ctrlKey===!1?u.onValueChange(r):y.preventDefault()}),onKeyDown:Lr(n.onKeyDown,y=>{[" ","Enter"].includes(y.key)&&u.onValueChange(r)}),onFocus:Lr(n.onFocus,()=>{const y=u.activationMode!=="manual";!m&&!o&&y&&u.onValueChange(r)})})})});l2.displayName=a2;var c2="TabsContent",u2=ae.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,forceMount:o,children:l,...u}=n,f=qm(c2,t),h=f2(f.baseId,r),p=d2(f.baseId,r),m=r===f.value,y=ae.useRef(m);return ae.useEffect(()=>{const b=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(b)},[]),K.jsx(n2,{present:o||m,children:({present:b})=>K.jsx(Ui.div,{"data-state":m?"active":"inactive","data-orientation":f.orientation,role:"tabpanel","aria-labelledby":h,hidden:!b,id:p,tabIndex:0,...u,ref:e,style:{...n.style,animationDuration:y.current?"0s":void 0},children:b&&l})})});u2.displayName=c2;function f2(n,e){return`${n}-trigger-${e}`}function d2(n,e){return`${n}-content-${e}`}var K3=i2,j3=o2,G3=l2,Y3=u2;function Z3({className:n,...e}){return K.jsx(K3,{"data-slot":"tabs",className:Pt("flex flex-col gap-2",n),...e})}function X3({className:n,...e}){return K.jsx(j3,{"data-slot":"tabs-list",className:Pt("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",n),...e})}function Q3({className:n,...e}){return K.jsx(G3,{"data-slot":"tabs-trigger",className:Pt("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...e})}function J3({className:n,...e}){return K.jsx(Y3,{"data-slot":"tabs-content",className:Pt("flex-1 outline-none",n),...e})}const W3=$m("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function e8({className:n,variant:e,asChild:t=!1,...r}){const o=t?$x:"span";return K.jsx(o,{"data-slot":"badge",className:Pt(W3({variant:e}),n),...r})}function t8(n){const e=n;if(!e)throw new Error("QuickNode API key is required - either from config.__env.quickNodeApiKey");return e}async function n8(n,e,t){try{const r=t8(t),o=JSON.stringify(n,null,2),l=`env-${e}.json`,u=new FormData,f=new Blob([o],{type:"application/json"});u.append("Body",f,l),u.append("Key",l),u.append("ContentType","application/json");const h=await fetch("https://api.quicknode.com/ipfs/rest/v1/s3/put-object",{method:"POST",headers:{"x-api-key":r},body:u});if(!h.ok){const y=await h.text();throw new Error(`QuickNode upload failed: ${h.status} - ${y}`)}const p=await h.json(),m=p.pin?.cid||p.cid||p.hash;if(!m)throw new Error("No IPFS hash returned from QuickNode");return{success:!0,ipfsHash:m}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown upload error"}}}function ko(n){return!!n}const r8=Symbol.for("@libp2p/connection"),Xl=Symbol.for("@libp2p/content-routing"),b1=Symbol.for("@libp2p/peer-discovery"),Fm=Symbol.for("@libp2p/peer-id");function Po(n){return!!n?.[Fm]}const Ql=Symbol.for("@libp2p/peer-routing"),h2="keep-alive";var Jl;(function(n){n[n.FATAL_ALL=0]="FATAL_ALL",n[n.NO_FATAL=1]="NO_FATAL"})(Jl||(Jl={}));let ea=class extends Error{static name="AbortError";constructor(e="The operation was aborted"){super(e),this.name="AbortError"}},ge=class extends Error{static name="InvalidParametersError";constructor(e="Invalid parameters"){super(e),this.name="InvalidParametersError"}};class g2 extends Error{static name="InvalidPublicKeyError";constructor(e="Invalid public key"){super(e),this.name="InvalidPublicKeyError"}}class p2 extends Error{static name="InvalidPrivateKeyError";constructor(e="Invalid private key"){super(e),this.name="InvalidPrivateKeyError"}}class i8 extends Error{static name="ConnectionClosingError";constructor(e="The connection is closing"){super(e),this.name="ConnectionClosingError"}}class m2 extends Error{static name="ConnectionClosedError";constructor(e="The connection is closed"){super(e),this.name="ConnectionClosedError"}}let Kn=class extends Error{static name="NotFoundError";constructor(e="Not found"){super(e),this.name="NotFoundError"}};class y2 extends Error{static name="InvalidPeerIdError";constructor(e="Invalid PeerID"){super(e),this.name="InvalidPeerIdError"}}let Km=class extends Error{static name="InvalidMultiaddrError";constructor(e="Invalid multiaddr"){super(e),this.name="InvalidMultiaddrError"}};class s8 extends Error{static name="InvalidCIDError";constructor(e="Invalid CID"){super(e),this.name="InvalidCIDError"}}class jm extends Error{static name="InvalidMultihashError";constructor(e="Invalid Multihash"){super(e),this.name="InvalidMultihashError"}}class b2 extends Error{static name="UnsupportedProtocolError";constructor(e="Unsupported protocol error"){super(e),this.name="UnsupportedProtocolError"}}class o8 extends Error{static name="InvalidMessageError";constructor(e="Invalid message"){super(e),this.name="InvalidMessageError"}}let a8=class extends Error{static name="TimeoutError";constructor(e="Timed out"){super(e),this.name="TimeoutError"}};class Ef extends Error{static name="NotStartedError";constructor(e="Not started"){super(e),this.name="NotStartedError"}}class Zg extends Error{static name="DialError";constructor(e="Dial error"){super(e),this.name="DialError"}}class w1 extends Error{static name="LimitedConnectionError";constructor(e="Limited connection"){super(e),this.name="LimitedConnectionError"}}class l8 extends Error{static name="TooManyInboundProtocolStreamsError";constructor(e="Too many inbound protocol streams"){super(e),this.name="TooManyInboundProtocolStreamsError"}}class c8 extends Error{static name="TooManyOutboundProtocolStreamsError";constructor(e="Too many outbound protocol streams"){super(e),this.name="TooManyOutboundProtocolStreamsError"}}class ya extends Error{static name="UnsupportedKeyTypeError";constructor(e="Unsupported key type"){super(e),this.name="UnsupportedKeyTypeError"}}class Ss extends EventTarget{#e=new Map;constructor(){super()}listenerCount(e){const t=this.#e.get(e);return t==null?0:t.length}addEventListener(e,t,r){super.addEventListener(e,t,r);let o=this.#e.get(e);o==null&&(o=[],this.#e.set(e,o)),o.push({callback:t,once:(r!==!0&&r!==!1&&r?.once)??!1})}removeEventListener(e,t,r){super.removeEventListener(e.toString(),t??null,r);let o=this.#e.get(e);o!=null&&(o=o.filter(({callback:l})=>l!==t),this.#e.set(e,o))}dispatchEvent(e){const t=super.dispatchEvent(e);let r=this.#e.get(e.type);return r==null||(r=r.filter(({once:o})=>!o),this.#e.set(e.type,r)),t}safeDispatchEvent(e,t={}){return this.dispatchEvent(new CustomEvent(e,t))}}function Gm(n){return n!=null&&typeof n.start=="function"&&typeof n.stop=="function"}async function hc(...n){const e=[];for(const t of n)Gm(t)&&e.push(t);await Promise.all(e.map(async t=>{t.beforeStart!=null&&await t.beforeStart()})),await Promise.all(e.map(async t=>{await t.start()})),await Promise.all(e.map(async t=>{t.afterStart!=null&&await t.afterStart()}))}async function gc(...n){const e=[];for(const t of n)Gm(t)&&e.push(t);await Promise.all(e.map(async t=>{t.beforeStop!=null&&await t.beforeStop()})),await Promise.all(e.map(async t=>{await t.stop()})),await Promise.all(e.map(async t=>{t.afterStop!=null&&await t.afterStop()}))}const xf=Symbol.for("@libp2p/service-capabilities"),v1=Symbol.for("@libp2p/service-dependencies");function Nt(n){const e=new globalThis.AbortController;function t(){e.abort();for(const l of n)l?.removeEventListener!=null&&l.removeEventListener("abort",t)}for(const l of n){if(l?.aborted===!0){t();break}l?.addEventListener!=null&&l.addEventListener("abort",t)}function r(){for(const l of n)l?.removeEventListener!=null&&l.removeEventListener("abort",t)}const o=e.signal;return o.clear=r,o}class Le extends Event{type;detail;constructor(e,t){super(e),this.type=e,this.detail=t}}function We(){const n={};return n.promise=new Promise((e,t)=>{n.resolve=e,n.reject=t}),n}class E1{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}class Xg{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new E1(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new E1(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}let u8=class extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}};function w2(n={}){return f8(t=>{const r=t.shift();if(r==null)return{done:!0};if(r.error!=null)throw r.error;return{done:r.done===!0,value:r.value}},n)}function f8(n,e){e=e??{};let t=e.onEnd,r=new Xg,o,l,u,f=We();const h=async()=>{try{return r.isEmpty()?u?{done:!0}:await new Promise((_,R)=>{l=j=>{l=null,r.push(j);try{_(n(r))}catch(C){R(C)}return o}}):n(r)}finally{r.isEmpty()&&queueMicrotask(()=>{f.resolve(),f=We()})}},p=_=>l!=null?l(_):(r.push(_),o),m=_=>(r=new Xg,l!=null?l({error:_}):(r.push({error:_}),o)),y=_=>{if(u)return o;if(e?.objectMode!==!0&&_?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return p({done:!1,value:_})},b=_=>u?o:(u=!0,_!=null?m(_):p({done:!0})),E=()=>(r=new Xg,b(),{done:!0}),x=_=>(b(_),{done:!0});if(o={[Symbol.asyncIterator](){return this},next:h,return:E,throw:x,push:y,end:b,get readableLength(){return r.size},onEmpty:async _=>{const R=_?.signal;if(R?.throwIfAborted(),r.isEmpty())return;let j,C;R!=null&&(j=new Promise((Z,Q)=>{C=()=>{Q(new u8)},R.addEventListener("abort",C)}));try{await Promise.race([f.promise,j])}finally{C!=null&&R!=null&&R?.removeEventListener("abort",C)}}},t==null)return o;const k=o;return o={[Symbol.asyncIterator](){return this},next(){return k.next()},throw(_){return k.throw(_),t!=null&&(t(_),t=void 0),{done:!0}},return(){return k.return(),t!=null&&(t(),t=void 0),{done:!0}},push:y,end(_){return k.end(_),t!=null&&(t(_),t=void 0),o},get readableLength(){return k.readableLength},onEmpty:_=>k.onEmpty(_)},o}let ta=class extends Error{static name="AbortError";name="AbortError";constructor(e="The operation was aborted",...t){super(e,...t)}};async function ws(n,e,t,r){const o=new ta(r?.errorMessage);r?.errorCode!=null&&(o.code=r.errorCode);const l=r?.errorEvent??"error";return t?.aborted===!0?Promise.reject(o):new Promise((u,f)=>{function h(){Jg(t,"abort",y),Jg(n,e,p),Jg(n,l,m)}const p=b=>{try{if(r?.filter?.(b)===!1)return}catch(E){h(),f(E);return}h(),u(b)},m=b=>{if(h(),b instanceof Error){f(b);return}f(b.detail??r?.error??new Error(`The "${r?.errorEvent}" event was emitted but the event had no '.detail' field. Pass an 'error' option to race-event to change this message.`))},y=()=>{h(),f(o)};Qg(t,"abort",y),Qg(n,e,p),Qg(n,l,m)})}function Qg(n,e,t){n!=null&&(v2(n)?n.addEventListener(e,t):n.addListener(e,t))}function Jg(n,e,t){n!=null&&(v2(n)?n.removeEventListener(e,t):n.removeListener(e,t))}function v2(n){return typeof n.addEventListener=="function"&&typeof n.removeEventListener=="function"}function jp(n,e){let t;const r=function(){const o=function(){t=void 0,n()};clearTimeout(t),t=setTimeout(o,e)};return r.start=()=>{},r.stop=()=>{clearTimeout(t)},r}class d8 extends Error{remainingPoints;msBeforeNext;consumedPoints;isFirstInDuration;constructor(e="Rate limit exceeded",t){super(e),this.name="RateLimitError",this.remainingPoints=t.remainingPoints,this.msBeforeNext=t.msBeforeNext,this.consumedPoints=t.consumedPoints,this.isFirstInDuration=t.isFirstInDuration}}let h8=class extends Error{static name="QueueFullError";constructor(e="The queue was full"){super(e),this.name="QueueFullError"}},x1=class extends Error{type;code;constructor(e,t,r){super(e??"The operation was aborted"),this.type="aborted",this.name=r??"AbortError",this.code=t??"ABORT_ERR"}};async function lr(n,e,t){if(e==null)return n;if(e.aborted)return n.catch(()=>{}),Promise.reject(new x1(t?.errorMessage,t?.errorCode,t?.errorName));let r;const o=new x1(t?.errorMessage,t?.errorCode,t?.errorName);try{return await Promise.race([n,new Promise((l,u)=>{r=()=>{u(o)},e.addEventListener("abort",r)})])}finally{r!=null&&e.removeEventListener("abort",r)}}let g8=class{deferred;signal;constructor(e){this.signal=e,this.deferred=We(),this.onAbort=this.onAbort.bind(this),this.signal?.addEventListener("abort",this.onAbort)}onAbort(){this.deferred.reject(this.signal?.reason??new ea)}cleanup(){this.signal?.removeEventListener("abort",this.onAbort)}};function p8(){return`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`}let m8=class{id;fn;options;recipients;status;timeline;controller;constructor(e,t){this.id=p8(),this.status="queued",this.fn=e,this.options=t,this.recipients=[],this.timeline={created:Date.now()},this.controller=new AbortController,this.controller.signal,this.onAbort=this.onAbort.bind(this)}abort(e){this.controller.abort(e)}onAbort(){this.recipients.reduce((t,r)=>t&&r.signal?.aborted===!0,!0)&&(this.controller.abort(new ea),this.cleanup())}async join(e={}){const t=new g8(e.signal);return this.recipients.push(t),e.signal?.addEventListener("abort",this.onAbort),t.deferred.promise}async run(){this.status="running",this.timeline.started=Date.now();try{this.controller.signal.throwIfAborted();const e=await lr(this.fn({...this.options??{},signal:this.controller.signal}),this.controller.signal);this.recipients.forEach(t=>{t.deferred.resolve(e)}),this.status="complete"}catch(e){this.recipients.forEach(t=>{t.deferred.reject(e)}),this.status="errored"}finally{this.timeline.finished=Date.now(),this.cleanup()}}cleanup(){this.recipients.forEach(e=>{e.cleanup(),e.signal?.removeEventListener("abort",this.onAbort)})}},Wl=class extends Ss{concurrency;maxSize;queue;pending;sort;constructor(e={}){super(),this.concurrency=e.concurrency??Number.POSITIVE_INFINITY,this.maxSize=e.maxSize??Number.POSITIVE_INFINITY,this.pending=0,e.metricName!=null&&e.metrics?.registerMetricGroup(e.metricName,{calculate:()=>({size:this.queue.length,running:this.pending,queued:this.queue.length-this.pending})}),this.sort=e.sort,this.queue=[],this.emitEmpty=jp(this.emitEmpty.bind(this),1),this.emitIdle=jp(this.emitIdle.bind(this),1)}emitEmpty(){this.size===0&&this.safeDispatchEvent("empty")}emitIdle(){this.running===0&&this.safeDispatchEvent("idle")}tryToStartAnother(){if(this.size===0)return this.emitEmpty(),this.running===0&&this.emitIdle(),!1;if(this.pending<this.concurrency){let e;for(const t of this.queue)if(t.status==="queued"){e=t;break}return e==null?!1:(this.safeDispatchEvent("active"),this.pending++,e.run().finally(()=>{for(let t=0;t<this.queue.length;t++)if(this.queue[t]===e){this.queue.splice(t,1);break}this.pending--,this.tryToStartAnother(),this.safeDispatchEvent("next")}),!0)}return!1}enqueue(e){this.queue.push(e),this.sort!=null&&this.queue.sort(this.sort)}async add(e,t){if(t?.signal?.throwIfAborted(),this.size===this.maxSize)throw new h8;const r=new m8(e,t);return this.enqueue(r),this.safeDispatchEvent("add"),this.tryToStartAnother(),r.join(t).then(o=>(this.safeDispatchEvent("completed",{detail:o}),this.safeDispatchEvent("success",{detail:{job:r,result:o}}),o)).catch(o=>{if(r.status==="queued"){for(let l=0;l<this.queue.length;l++)if(this.queue[l]===r){this.queue.splice(l,1);break}}throw this.safeDispatchEvent("failure",{detail:{job:r,error:o}}),o})}clear(){this.queue.splice(0,this.queue.length)}abort(){this.queue.forEach(e=>{e.abort(new ea)}),this.clear()}async onEmpty(e){this.size!==0&&await ws(this,"empty",e?.signal)}async onSizeLessThan(e,t){this.size<e||await ws(this,"next",t?.signal,{filter:()=>this.size<e})}async onIdle(e){this.pending===0&&this.size===0||await ws(this,"idle",e?.signal)}get size(){return this.queue.length}get queued(){return this.queue.length-this.pending}get running(){return this.pending}async*toGenerator(e){e?.signal?.throwIfAborted();const t=w2({objectMode:!0}),r=h=>{h!=null?this.abort():this.clear(),t.end(h)},o=h=>{h.detail!=null&&t.push(h.detail)},l=h=>{r(h.detail.error)},u=()=>{r()},f=()=>{r(new ea("Queue aborted"))};this.addEventListener("completed",o),this.addEventListener("failure",l),this.addEventListener("idle",u),e?.signal?.addEventListener("abort",f);try{yield*t}finally{this.removeEventListener("completed",o),this.removeEventListener("failure",l),this.removeEventListener("idle",u),e?.signal?.removeEventListener("abort",f),r()}}};class E2 extends Wl{has(e){return this.find(e)!=null}find(e){return this.queue.find(t=>e.equals(t.options.peerId))}}function y8(n){return n[Symbol.asyncIterator]!=null}function Gp(n){if(y8(n))return(async()=>{for await(const e of n);})();for(const e of n);}function Ot(n=0){return new Uint8Array(n)}function Vr(n=0){return new Uint8Array(n)}const b8=Math.pow(2,7),w8=Math.pow(2,14),v8=Math.pow(2,21),Ym=Math.pow(2,28),Zm=Math.pow(2,35),Xm=Math.pow(2,42),Qm=Math.pow(2,49),$e=128,Kt=127;function Xn(n){if(n<b8)return 1;if(n<w8)return 2;if(n<v8)return 3;if(n<Ym)return 4;if(n<Zm)return 5;if(n<Xm)return 6;if(n<Qm)return 7;if(Number.MAX_SAFE_INTEGER!=null&&n>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Sf(n,e,t=0){switch(Xn(n)){case 8:e[t++]=n&255|$e,n/=128;case 7:e[t++]=n&255|$e,n/=128;case 6:e[t++]=n&255|$e,n/=128;case 5:e[t++]=n&255|$e,n/=128;case 4:e[t++]=n&255|$e,n>>>=7;case 3:e[t++]=n&255|$e,n>>>=7;case 2:e[t++]=n&255|$e,n>>>=7;case 1:{e[t++]=n&255,n>>>=7;break}default:throw new Error("unreachable")}return e}function E8(n,e,t=0){switch(Xn(n)){case 8:e.set(t++,n&255|$e),n/=128;case 7:e.set(t++,n&255|$e),n/=128;case 6:e.set(t++,n&255|$e),n/=128;case 5:e.set(t++,n&255|$e),n/=128;case 4:e.set(t++,n&255|$e),n>>>=7;case 3:e.set(t++,n&255|$e),n>>>=7;case 2:e.set(t++,n&255|$e),n>>>=7;case 1:{e.set(t++,n&255),n>>>=7;break}default:throw new Error("unreachable")}return e}function x2(n,e){let t=n[e],r=0;if(r+=t&Kt,t<$e||(t=n[e+1],r+=(t&Kt)<<7,t<$e)||(t=n[e+2],r+=(t&Kt)<<14,t<$e)||(t=n[e+3],r+=(t&Kt)<<21,t<$e)||(t=n[e+4],r+=(t&Kt)*Ym,t<$e)||(t=n[e+5],r+=(t&Kt)*Zm,t<$e)||(t=n[e+6],r+=(t&Kt)*Xm,t<$e)||(t=n[e+7],r+=(t&Kt)*Qm,t<$e))return r;throw new RangeError("Could not decode varint")}function x8(n,e){let t=n.get(e),r=0;if(r+=t&Kt,t<$e||(t=n.get(e+1),r+=(t&Kt)<<7,t<$e)||(t=n.get(e+2),r+=(t&Kt)<<14,t<$e)||(t=n.get(e+3),r+=(t&Kt)<<21,t<$e)||(t=n.get(e+4),r+=(t&Kt)*Ym,t<$e)||(t=n.get(e+5),r+=(t&Kt)*Zm,t<$e)||(t=n.get(e+6),r+=(t&Kt)*Xm,t<$e)||(t=n.get(e+7),r+=(t&Kt)*Qm,t<$e))return r;throw new RangeError("Could not decode varint")}function zo(n,e,t=0){return e==null&&(e=Vr(Xn(n))),e instanceof Uint8Array?Sf(n,e,t):E8(n,e,t)}function Jm(n,e=0){return n instanceof Uint8Array?x2(n,e):x8(n,e)}function fr(n,e){e==null&&(e=n.reduce((o,l)=>o+l.length,0));const t=Vr(e);let r=0;for(const o of n)t.set(o,r),r+=o.length;return t}function et(n,e){if(n===e)return!0;if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.byteLength;t++)if(n[t]!==e[t])return!1;return!0}const S2=Symbol.for("@achingbrain/uint8arraylist");function S1(n,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let t=0;for(const r of n){const o=t+r.byteLength;if(e<o)return{buf:r,index:e-t};t=o}throw new RangeError("index is out of bounds")}function zl(n){return!!n?.[S2]}class rt{bufs;length;[S2]=!0;constructor(...e){this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const r of e)if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.push(r);else if(zl(r))t+=r.byteLength,this.bufs.push(...r.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const r of e.reverse())if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.unshift(r);else if(zl(r))t+=r.byteLength,this.bufs.unshift(...r.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}get(e){const t=S1(this.bufs,e);return t.buf[t.index]}set(e,t){const r=S1(this.bufs,e);r.buf[r.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let r=0;r<e.length;r++)this.set(t+r,e[r]);else if(zl(e))for(let r=0;r<e.length;r++)this.set(t+r,e.get(r));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,t){const{bufs:r,length:o}=this._subList(e,t);return fr(r,o)}subarray(e,t){const{bufs:r,length:o}=this._subList(e,t);return r.length===1?r[0]:fr(r,o)}sublist(e,t){const{bufs:r,length:o}=this._subList(e,t),l=new rt;return l.length=o,l.bufs=[...r],l}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(e===0&&t===this.length)return{bufs:this.bufs,length:this.length};const r=[];let o=0;for(let l=0;l<this.bufs.length;l++){const u=this.bufs[l],f=o,h=f+u.byteLength;if(o=h,e>=h)continue;const p=e>=f&&e<h,m=t>f&&t<=h;if(p&&m){if(e===f&&t===h){r.push(u);break}const y=e-f;r.push(u.subarray(y,y+(t-e)));break}if(p){if(e===0){r.push(u);continue}r.push(u.subarray(e-f));continue}if(m){if(t===h){r.push(u);break}r.push(u.subarray(0,t-f));break}r.push(u)}return{bufs:r,length:t-e}}indexOf(e,t=0){if(!zl(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const r=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),e.length===0)return t>this.length?this.length:t;const o=r.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");const l=256,u=new Int32Array(l);for(let y=0;y<l;y++)u[y]=-1;for(let y=0;y<o;y++)u[r[y]]=y;const f=u,h=this.byteLength-r.byteLength,p=r.byteLength-1;let m;for(let y=t;y<=h;y+=m){m=0;for(let b=p;b>=0;b--){const E=this.get(y+b);if(r[b]!==E){m=Math.max(1,b-f[E]);break}}if(m===0)return y}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const r=Vr(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt8(0,t),this.write(r,e)}getInt16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0,t)}setInt16(e,t,r){const o=Ot(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,t,r),this.write(o,e)}getInt32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0,t)}setInt32(e,t,r){const o=Ot(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,t,r),this.write(o,e)}getBigInt64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0,t)}setBigInt64(e,t,r){const o=Ot(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,t,r),this.write(o,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const r=Vr(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint8(0,t),this.write(r,e)}getUint16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,t)}setUint16(e,t,r){const o=Ot(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,t,r),this.write(o,e)}getUint32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0,t)}setUint32(e,t,r){const o=Ot(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,t,r),this.write(o,e)}getBigUint64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigUint64(0,t)}setBigUint64(e,t,r){const o=Ot(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,t,r),this.write(o,e)}getFloat32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat32(0,t)}setFloat32(e,t,r){const o=Ot(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,t,r),this.write(o,e)}getFloat64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat64(0,t)}setFloat64(e,t,r){const o=Ot(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,t,r),this.write(o,e)}equals(e){if(e==null||!(e instanceof rt)||e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!et(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const r=new rt;return r.bufs=e,t==null&&(t=e.reduce((o,l)=>o+l.byteLength,0)),r.length=t,r}}const A2=1024*1024*4;let S8=class extends Error{name="InvalidDataLengthError";code="ERR_MSG_DATA_TOO_LONG"};function A8(n){return n[Symbol.asyncIterator]!=null}function _2(n,e){if(n.byteLength>e)throw new S8("Message length too long")}const nd=n=>{const e=Xn(n),t=Vr(e);return zo(n,t),nd.bytes=e,t};nd.bytes=0;function T2(n,e){e=e??{};const t=e.lengthEncoder??nd,r=e?.maxDataLength??A2;function*o(l){_2(l,r);const u=t(l.byteLength);u instanceof Uint8Array?yield u:yield*u,l instanceof Uint8Array?yield l:yield*l}return A8(n)?(async function*(){for await(const l of n)yield*o(l)})():(function*(){for(const l of n)yield*o(l)})()}T2.single=(n,e)=>{e=e??{};const t=e.lengthEncoder??nd,r=e?.maxDataLength??A2;return _2(n,r),new rt(t(n.byteLength),n)};var A1;(function(n){n[n.LENGTH=0]="LENGTH",n[n.DATA=1]="DATA"})(A1||(A1={}));function Wm(n){const[e,t]=n[Symbol.asyncIterator]!=null?[n[Symbol.asyncIterator](),Symbol.asyncIterator]:[n[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>e.next(),push:o=>{r.push(o)},next:()=>r.length>0?{done:!1,value:r.shift()}:e.next(),[t](){return this}}}function _8(n){return n[Symbol.asyncIterator]!=null}function T8(n,e){let t=0;if(_8(n))return(async function*(){for await(const h of n)yield e(h,t++)})();const r=Wm(n),{value:o,done:l}=r.next();if(l===!0)return(function*(){})();const u=e(o,t++);if(typeof u.then=="function")return(async function*(){yield await u;for(const h of r)yield e(h,t++)})();const f=e;return(function*(){yield u;for(const h of r)yield f(h,t++)})()}class k8{readNext;haveNext;ended;nextResult;error;constructor(){this.ended=!1,this.readNext=We(),this.haveNext=We()}[Symbol.asyncIterator](){return this}async next(){if(this.nextResult==null&&await this.haveNext.promise,this.nextResult==null)throw new Error("HaveNext promise resolved but nextResult was undefined");const e=this.nextResult;return this.nextResult=void 0,this.readNext.resolve(),this.readNext=We(),e}async throw(e){return this.ended=!0,this.error=e,e!=null&&(this.haveNext.promise.catch(()=>{}),this.haveNext.reject(e)),{done:!0,value:void 0}}async return(){const e={done:!0,value:void 0};return this.ended=!0,this.nextResult=e,this.haveNext.resolve(),e}async push(e,t){await this._push(e,t)}async end(e,t){e!=null?await this.throw(e):await this._push(void 0,t)}async _push(e,t){if(e!=null&&this.ended)throw this.error??new Error("Cannot push value onto an ended pushable");for(;this.nextResult!=null;)await this.readNext.promise;e!=null?this.nextResult={done:!1,value:e}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=We(),await lr(this.readNext.promise,t?.signal,t)}}function k2(){return new k8}function C8(n){return n[Symbol.asyncIterator]!=null}async function N8(n,e,t){try{await Promise.all(n.map(async r=>{for await(const o of r)await e.push(o,{signal:t}),t.throwIfAborted()})),await e.end(void 0,{signal:t})}catch(r){await e.end(r,{signal:t}).catch(()=>{})}}async function*B8(n){const e=new AbortController,t=k2();N8(n,t,e.signal).catch(()=>{});try{yield*t}finally{e.abort()}}function*D8(n){for(const e of n)yield*e}function Vo(...n){const e=[];for(const t of n)C8(t)||e.push(t);return e.length===n.length?D8(e):B8(n)}function R8(n){return n[Symbol.asyncIterator]!=null}function _1(n,e){return R8(n)?(async function*(){let t=0;if(!(e<1)){for await(const r of n)if(yield r,t++,t===e)return}})():(function*(){let t=0;if(!(e<1)){for(const r of n)if(yield r,t++,t===e)return}})()}const ey=new Float32Array([-0]),Ci=new Uint8Array(ey.buffer);function M8(n,e,t){ey[0]=n,e[t]=Ci[0],e[t+1]=Ci[1],e[t+2]=Ci[2],e[t+3]=Ci[3]}function I8(n,e){return Ci[0]=n[e],Ci[1]=n[e+1],Ci[2]=n[e+2],Ci[3]=n[e+3],ey[0]}const ty=new Float64Array([-0]),jt=new Uint8Array(ty.buffer);function O8(n,e,t){ty[0]=n,e[t]=jt[0],e[t+1]=jt[1],e[t+2]=jt[2],e[t+3]=jt[3],e[t+4]=jt[4],e[t+5]=jt[5],e[t+6]=jt[6],e[t+7]=jt[7]}function L8(n,e){return jt[0]=n[e],jt[1]=n[e+1],jt[2]=n[e+2],jt[3]=n[e+3],jt[4]=n[e+4],jt[5]=n[e+5],jt[6]=n[e+6],jt[7]=n[e+7],ty[0]}const U8=BigInt(Number.MAX_SAFE_INTEGER),P8=BigInt(Number.MIN_SAFE_INTEGER);class Gt{lo;hi;constructor(e,t){this.lo=e|0,this.hi=t|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){const t=~this.lo+1>>>0;let r=~this.hi>>>0;return t===0&&(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){const t=~this.lo+1>>>0;let r=~this.hi>>>0;return t===0&&(r=r+1>>>0),-(BigInt(t)+(BigInt(r)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){const e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){const e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){const e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}static fromBigInt(e){if(e===0n)return vs;if(e<U8&&e>P8)return this.fromNumber(Number(e));const t=e<0n;t&&(e=-e);let r=e>>32n,o=e-(r<<32n);return t&&(r=~r|0n,o=~o|0n,++o>T1&&(o=0n,++r>T1&&(r=0n))),new Gt(Number(o),Number(r))}static fromNumber(e){if(e===0)return vs;const t=e<0;t&&(e=-e);let r=e>>>0,o=(e-r)/4294967296>>>0;return t&&(o=~o>>>0,r=~r>>>0,++r>4294967295&&(r=0,++o>4294967295&&(o=0))),new Gt(r,o)}static from(e){return typeof e=="number"?Gt.fromNumber(e):typeof e=="bigint"?Gt.fromBigInt(e):typeof e=="string"?Gt.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new Gt(e.low>>>0,e.high>>>0):vs}}const vs=new Gt(0,0);vs.toBigInt=function(){return 0n};vs.zzEncode=vs.zzDecode=function(){return this};vs.length=function(){return 1};const T1=4294967296n;function z8(n){let e=0,t=0;for(let r=0;r<n.length;++r)t=n.charCodeAt(r),t<128?e+=1:t<2048?e+=2:(t&64512)===55296&&(n.charCodeAt(r+1)&64512)===56320?(++r,e+=4):e+=3;return e}function V8(n,e,t){if(t-e<1)return"";let o;const l=[];let u=0,f;for(;e<t;)f=n[e++],f<128?l[u++]=f:f>191&&f<224?l[u++]=(f&31)<<6|n[e++]&63:f>239&&f<365?(f=((f&7)<<18|(n[e++]&63)<<12|(n[e++]&63)<<6|n[e++]&63)-65536,l[u++]=55296+(f>>10),l[u++]=56320+(f&1023)):l[u++]=(f&15)<<12|(n[e++]&63)<<6|n[e++]&63,u>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,l)),u=0);return o!=null?(u>0&&o.push(String.fromCharCode.apply(String,l.slice(0,u))),o.join("")):String.fromCharCode.apply(String,l.slice(0,u))}function C2(n,e,t){const r=t;let o,l;for(let u=0;u<n.length;++u)o=n.charCodeAt(u),o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&((l=n.charCodeAt(u+1))&64512)===56320?(o=65536+((o&1023)<<10)+(l&1023),++u,e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128);return t-r}function Pn(n,e){return RangeError(`index out of range: ${n.pos} + ${e??1} > ${n.len}`)}function ju(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}class $8{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Pn(this,10);return e}int32(){return this.uint32()|0}sint32(){const e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Pn(this,4);return ju(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Pn(this,4);return ju(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Pn(this,4);const e=I8(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw Pn(this,4);const e=L8(this.buf,this.pos);return this.pos+=8,e}bytes(){const e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw Pn(this,e);return this.pos+=e,t===r?new Uint8Array(0):this.buf.subarray(t,r)}string(){const e=this.bytes();return V8(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Pn(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Pn(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){const e=new Gt(0,0);let t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw Pn(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Pn(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Pn(this,8);const e=ju(this.buf,this.pos+=4),t=ju(this.buf,this.pos+=4);return new Gt(e,t)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const e=x2(this.buf,this.pos);return this.pos+=Xn(e),e}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function H8(n){return new $8(n instanceof Uint8Array?n:n.subarray())}function jn(n,e,t){const r=H8(n);return e.decode(r,void 0,t)}function q8(n,e){if(n===e)return!0;if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.byteLength;t++)if(n[t]!==e[t])return!1;return!0}function ba(n){if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")}function F8(n){return new TextEncoder().encode(n)}function K8(n){return new TextDecoder().decode(n)}function j8(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var o=0;o<n.length;o++){var l=n.charAt(o),u=l.charCodeAt(0);if(t[u]!==255)throw new TypeError(l+" is ambiguous");t[u]=o}var f=n.length,h=n.charAt(0),p=Math.log(f)/Math.log(256),m=Math.log(256)/Math.log(f);function y(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var k=0,_=0,R=0,j=x.length;R!==j&&x[R]===0;)R++,k++;for(var C=(j-R)*m+1>>>0,Z=new Uint8Array(C);R!==j;){for(var Q=x[R],re=0,oe=C-1;(Q!==0||re<_)&&oe!==-1;oe--,re++)Q+=256*Z[oe]>>>0,Z[oe]=Q%f>>>0,Q=Q/f>>>0;if(Q!==0)throw new Error("Non-zero carry");_=re,R++}for(var H=C-_;H!==C&&Z[H]===0;)H++;for(var B=h.repeat(k);H<C;++H)B+=n.charAt(Z[H]);return B}function b(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var k=0;if(x[k]!==" "){for(var _=0,R=0;x[k]===h;)_++,k++;for(var j=(x.length-k)*p+1>>>0,C=new Uint8Array(j);x[k];){var Z=t[x.charCodeAt(k)];if(Z===255)return;for(var Q=0,re=j-1;(Z!==0||Q<R)&&re!==-1;re--,Q++)Z+=f*C[re]>>>0,C[re]=Z%256>>>0,Z=Z/256>>>0;if(Z!==0)throw new Error("Non-zero carry");R=Q,k++}if(x[k]!==" "){for(var oe=j-R;oe!==j&&C[oe]===0;)oe++;for(var H=new Uint8Array(_+(j-oe)),B=_;oe!==j;)H[B++]=C[oe++];return H}}}function E(x){var k=b(x);if(k)return k;throw new Error(`Non-${e} character`)}return{encode:y,decodeUnsafe:b,decode:E}}var G8=j8,Y8=G8;class Z8{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class X8{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){this.name=e,this.prefix=t;const o=t.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return N2(this,e)}}class Q8{decoders;constructor(e){this.decoders=e}or(e){return N2(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r!=null)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function N2(n,e){return new Q8({...n.decoders??{[n.prefix]:n},...e.decoders??{[e.prefix]:e}})}class J8{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,o){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=o,this.encoder=new Z8(e,t,r),this.decoder=new X8(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function rd({name:n,prefix:e,encode:t,decode:r}){return new J8(n,e,t,r)}function pc({name:n,prefix:e,alphabet:t}){const{encode:r,decode:o}=Y8(t,n);return rd({prefix:e,name:n,encode:r,decode:l=>ba(o(l))})}function W8(n,e,t,r){let o=n.length;for(;n[o-1]==="=";)--o;const l=new Uint8Array(o*t/8|0);let u=0,f=0,h=0;for(let p=0;p<o;++p){const m=e[n[p]];if(m===void 0)throw new SyntaxError(`Non-${r} character`);f=f<<t|m,u+=t,u>=8&&(u-=8,l[h++]=255&f>>u)}if(u>=t||(255&f<<8-u)!==0)throw new SyntaxError("Unexpected end of data");return l}function eN(n,e,t){const r=e[e.length-1]==="=",o=(1<<t)-1;let l="",u=0,f=0;for(let h=0;h<n.length;++h)for(f=f<<8|n[h],u+=8;u>t;)u-=t,l+=e[o&f>>u];if(u!==0&&(l+=e[o&f<<t-u]),r)for(;(l.length*t&7)!==0;)l+="=";return l}function tN(n){const e={};for(let t=0;t<n.length;++t)e[n[t]]=t;return e}function zt({name:n,prefix:e,bitsPerChar:t,alphabet:r}){const o=tN(r);return rd({prefix:e,name:n,encode(l){return eN(l,r,t)},decode(l){return W8(l,o,t,n)}})}const nN=pc({prefix:"9",name:"base10",alphabet:"0123456789"}),rN=Object.freeze(Object.defineProperty({__proto__:null,base10:nN},Symbol.toStringTag,{value:"Module"})),iN=zt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sN=zt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),oN=Object.freeze(Object.defineProperty({__proto__:null,base16:iN,base16upper:sN},Symbol.toStringTag,{value:"Module"})),aN=zt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),lN=Object.freeze(Object.defineProperty({__proto__:null,base2:aN},Symbol.toStringTag,{value:"Module"})),B2=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),cN=B2.reduce((n,e,t)=>(n[t]=e,n),[]),uN=B2.reduce((n,e,t)=>{const r=e.codePointAt(0);if(r==null)throw new Error(`Invalid character: ${e}`);return n[r]=t,n},[]);function fN(n){return n.reduce((e,t)=>(e+=cN[t],e),"")}function dN(n){const e=[];for(const t of n){const r=t.codePointAt(0);if(r==null)throw new Error(`Invalid character: ${t}`);const o=uN[r];if(o==null)throw new Error(`Non-base256emoji character: ${t}`);e.push(o)}return new Uint8Array(e)}const hN=rd({prefix:"🚀",name:"base256emoji",encode:fN,decode:dN}),gN=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:hN},Symbol.toStringTag,{value:"Module"})),wn=zt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),pN=zt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mN=zt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yN=zt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),bN=zt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),wN=zt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vN=zt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),EN=zt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xN=zt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),SN=Object.freeze(Object.defineProperty({__proto__:null,base32:wn,base32hex:bN,base32hexpad:vN,base32hexpadupper:EN,base32hexupper:wN,base32pad:mN,base32padupper:yN,base32upper:pN,base32z:xN},Symbol.toStringTag,{value:"Module"})),cr=pc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),AN=pc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),_N=Object.freeze(Object.defineProperty({__proto__:null,base36:cr,base36upper:AN},Symbol.toStringTag,{value:"Module"})),St=pc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),TN=pc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),kN=Object.freeze(Object.defineProperty({__proto__:null,base58btc:St,base58flickr:TN},Symbol.toStringTag,{value:"Module"})),Fr=zt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),CN=zt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),D2=zt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),NN=zt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),BN=Object.freeze(Object.defineProperty({__proto__:null,base64:Fr,base64pad:CN,base64url:D2,base64urlpad:NN},Symbol.toStringTag,{value:"Module"})),DN=zt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),RN=Object.freeze(Object.defineProperty({__proto__:null,base8:DN},Symbol.toStringTag,{value:"Module"})),MN=rd({prefix:"\0",name:"identity",encode:n=>K8(n),decode:n=>F8(n)}),IN=Object.freeze(Object.defineProperty({__proto__:null,identity:MN},Symbol.toStringTag,{value:"Module"})),ON=new TextEncoder,LN=new TextDecoder,UN="json",R2=512;function PN(n){return ON.encode(JSON.stringify(n))}function zN(n){return JSON.parse(LN.decode(n))}const VN=Object.freeze(Object.defineProperty({__proto__:null,code:R2,decode:zN,encode:PN,name:UN},Symbol.toStringTag,{value:"Module"})),$N="raw",ny=85;function HN(n){return ba(n)}function qN(n){return ba(n)}const FN=Object.freeze(Object.defineProperty({__proto__:null,code:ny,decode:qN,encode:HN,name:$N},Symbol.toStringTag,{value:"Module"}));var KN=M2,k1=128,jN=-128,GN=Math.pow(2,31);function M2(n,e,t){e=e||[],t=t||0;for(var r=t;n>=GN;)e[t++]=n&255|k1,n/=128;for(;n&jN;)e[t++]=n&255|k1,n>>>=7;return e[t]=n|0,M2.bytes=t-r+1,e}var YN=Yp,ZN=128,C1=127;function Yp(n,r){var t=0,r=r||0,o=0,l=r,u,f=n.length;do{if(l>=f)throw Yp.bytes=0,new RangeError("Could not decode varint");u=n[l++],t+=o<28?(u&C1)<<o:(u&C1)*Math.pow(2,o),o+=7}while(u>=ZN);return Yp.bytes=l-r,t}var XN=Math.pow(2,7),QN=Math.pow(2,14),JN=Math.pow(2,21),WN=Math.pow(2,28),eB=Math.pow(2,35),tB=Math.pow(2,42),nB=Math.pow(2,49),rB=Math.pow(2,56),iB=Math.pow(2,63),sB=function(n){return n<XN?1:n<QN?2:n<JN?3:n<WN?4:n<eB?5:n<tB?6:n<nB?7:n<rB?8:n<iB?9:10},oB={encode:KN,decode:YN,encodingLength:sB},Af=oB;function Zp(n,e=0){return[Af.decode(n,e),Af.decode.bytes]}function _f(n,e,t=0){return Af.encode(n,e,t),e}function Tf(n){return Af.encodingLength(n)}function wa(n,e){const t=e.byteLength,r=Tf(n),o=r+Tf(t),l=new Uint8Array(o+t);return _f(n,l,0),_f(t,l,r),l.set(e,o),new ry(n,t,e,l)}function va(n){const e=ba(n),[t,r]=Zp(e),[o,l]=Zp(e.subarray(r)),u=e.subarray(r+l);if(u.byteLength!==o)throw new Error("Incorrect length");return new ry(t,o,u,e)}function aB(n,e){if(n===e)return!0;{const t=e;return n.code===t.code&&n.size===t.size&&t.bytes instanceof Uint8Array&&q8(n.bytes,t.bytes)}}class ry{code;size;digest;bytes;constructor(e,t,r,o){this.code=e,this.size=t,this.digest=r,this.bytes=o}}const I2=0,lB="identity",O2=ba;function cB(n,e){if(e?.truncate!=null&&e.truncate!==n.byteLength){if(e.truncate<0||e.truncate>n.byteLength)throw new Error(`Invalid truncate option, must be less than or equal to ${n.byteLength}`);n=n.subarray(0,e.truncate)}return wa(I2,O2(n))}const Mi={code:I2,name:lB,encode:O2,digest:cB},uB=20;function L2({name:n,code:e,encode:t,minDigestLength:r,maxDigestLength:o}){return new fB(n,e,t,r,o)}class fB{name;code;encode;minDigestLength;maxDigestLength;constructor(e,t,r,o,l){this.name=e,this.code=t,this.encode=r,this.minDigestLength=o??uB,this.maxDigestLength=l}digest(e,t){if(t?.truncate!=null){if(t.truncate<this.minDigestLength)throw new Error(`Invalid truncate option, must be greater than or equal to ${this.minDigestLength}`);if(this.maxDigestLength!=null&&t.truncate>this.maxDigestLength)throw new Error(`Invalid truncate option, must be less than or equal to ${this.maxDigestLength}`)}if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?N1(r,this.code,t?.truncate):r.then(o=>N1(o,this.code,t?.truncate))}else throw Error("Unknown type, must be binary type")}}function N1(n,e,t){if(t!=null&&t!==n.byteLength){if(t>n.byteLength)throw new Error(`Invalid truncate option, must be less than or equal to ${n.byteLength}`);n=n.subarray(0,t)}return wa(e,n)}function U2(n){return async e=>new Uint8Array(await crypto.subtle.digest(n,e))}const na=L2({name:"sha2-256",code:18,encode:U2("SHA-256")}),B1=L2({name:"sha2-512",code:19,encode:U2("SHA-512")});function D1(n,e){const{bytes:t,version:r}=n;switch(r){case 0:return hB(t,Xp(n),e??St.encoder);default:return gB(t,Xp(n),e??wn.encoder)}}const R1=new WeakMap;function Xp(n){const e=R1.get(n);if(e==null){const t=new Map;return R1.set(n,t),t}return e}class Se{code;version;multihash;bytes;"/";constructor(e,t,r,o){this.code=t,this.version=e,this.multihash=r,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Bl)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==pB)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Se.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=wa(e,t);return Se.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Se.equals(this,e)}static equals(e,t){const r=t;return r!=null&&e.code===r.code&&e.version===r.version&&aB(e.multihash,r.multihash)}toString(e){return D1(this,e)}toJSON(){return{"/":D1(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof Se)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:r,code:o,multihash:l,bytes:u}=t;return new Se(r,o,l,u??M1(r,o,l.bytes))}else if(t[mB]===!0){const{version:r,multihash:o,code:l}=t,u=va(o);return Se.create(r,l,u)}else return null}static create(e,t,r){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==Bl)throw new Error(`Version 0 CID must use dag-pb (code: ${Bl}) block encoding`);return new Se(e,t,r,r.bytes)}case 1:{const o=M1(e,t,r.bytes);return new Se(e,t,r,o)}default:throw new Error("Invalid version")}}static createV0(e){return Se.create(0,Bl,e)}static createV1(e,t){return Se.create(1,e,t)}static decode(e){const[t,r]=Se.decodeFirst(e);if(r.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Se.inspectBytes(e),r=t.size-t.multihashSize,o=ba(e.subarray(r,r+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const l=o.subarray(t.multihashSize-t.digestSize),u=new ry(t.multihashCode,t.digestSize,l,o);return[t.version===0?Se.createV0(u):Se.createV1(t.codec,u),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[y,b]=Zp(e.subarray(t));return t+=b,y};let o=r(),l=Bl;if(o===18?(o=0,t=0):l=r(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const u=t,f=r(),h=r(),p=t+h,m=p-u;return{version:o,codec:l,multihashCode:f,digestSize:h,multihashSize:m,size:p}}static parse(e,t){const[r,o]=dB(e,t),l=Se.decode(o);if(l.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Xp(l).set(r,e),l}}function dB(n,e){switch(n[0]){case"Q":{const t=e??St;return[St.prefix,t.decode(`${St.prefix}${n}`)]}case St.prefix:{const t=e??St;return[St.prefix,t.decode(n)]}case wn.prefix:{const t=e??wn;return[wn.prefix,t.decode(n)]}case cr.prefix:{const t=e??cr;return[cr.prefix,t.decode(n)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[n[0],e.decode(n)]}}}function hB(n,e,t){const{prefix:r}=t;if(r!==St.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=e.get(r);if(o==null){const l=t.encode(n).slice(1);return e.set(r,l),l}else return o}function gB(n,e,t){const{prefix:r}=t,o=e.get(r);if(o==null){const l=t.encode(n);return e.set(r,l),l}else return o}const Bl=112,pB=18;function M1(n,e,t){const r=Tf(n),o=r+Tf(e),l=new Uint8Array(o+t.byteLength);return _f(n,l,0),_f(e,l,r),l.set(t,o),l}const mB=Symbol.for("@ipld/js-cid/CID"),Qp={...IN,...lN,...RN,...rN,...oN,...SN,..._N,...kN,...BN,...gN};function P2(n,e,t,r){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:r}}}const I1=P2("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Wg=P2("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=Vr(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),z2={utf8:I1,"utf-8":I1,hex:Qp.base16,latin1:Wg,ascii:Wg,binary:Wg,...Qp};function de(n,e="utf8"){const t=z2[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${n}`)}function yB(n){let r,o=8192;return function(u){if(u<1||u>4096)return Vr(u);o+u>8192&&(r=Vr(8192),o=0);const f=r.subarray(o,o+=u);return(o&7)!==0&&(o=(o|7)+1),f}}class Vl{fn;len;next;val;constructor(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}}function ep(){}class bB{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}}const wB=yB();function vB(n){return globalThis.Buffer!=null?Vr(n):wB(n)}class Jp{len;head;tail;states;constructor(){this.len=0,this.head=new Vl(ep,0,0),this.tail=this.head,this.states=null}_push(e,t,r){return this.tail=this.tail.next=new Vl(e,t,r),this.len+=t,this}uint32(e){return this.len+=(this.tail=this.tail.next=new xB((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(Gu,10,Gt.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){const t=Gt.fromBigInt(e);return this._push(Gu,t.length(),t)}uint64Number(e){return this._push(Sf,Xn(e),e)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){const t=Gt.fromBigInt(e).zzEncode();return this._push(Gu,t.length(),t)}sint64Number(e){const t=Gt.fromNumber(e).zzEncode();return this._push(Gu,t.length(),t)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(tp,1,e?1:0)}fixed32(e){return this._push(Dl,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){const t=Gt.fromBigInt(e);return this._push(Dl,4,t.lo)._push(Dl,4,t.hi)}fixed64Number(e){const t=Gt.fromNumber(e);return this._push(Dl,4,t.lo)._push(Dl,4,t.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(M8,4,e)}double(e){return this._push(O8,8,e)}bytes(e){const t=e.length>>>0;return t===0?this._push(tp,1,0):this.uint32(t)._push(SB,t,e)}string(e){const t=z8(e);return t!==0?this.uint32(t)._push(C2,t,e):this._push(tp,1,0)}fork(){return this.states=new bB(this),this.head=this.tail=new Vl(ep,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Vl(ep,0,0),this.len=0),this}ldelim(){const e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r!==0&&(this.tail.next=e.next,this.tail=t,this.len+=r),this}finish(){let e=this.head.next;const t=vB(this.len);let r=0;for(;e!=null;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t}}function tp(n,e,t){e[t]=n&255}function EB(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}class xB extends Vl{next;constructor(e,t){super(EB,e,t),this.next=void 0}}function Gu(n,e,t){for(;n.hi!==0;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}function Dl(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function SB(n,e,t){e.set(n,t)}globalThis.Buffer!=null&&(Jp.prototype.bytes=function(n){const e=n.length>>>0;return this.uint32(e),e>0&&this._push(AB,e,n),this},Jp.prototype.string=function(n){const e=globalThis.Buffer.byteLength(n);return this.uint32(e),e>0&&this._push(_B,e,n),this});function AB(n,e,t){e.set(n,t)}function _B(n,e,t){n.length<40?C2(n,e,t):e.utf8Write!=null?e.utf8Write(n,t):e.set(de(n),t)}function TB(){return new Jp}function Gn(n,e){const t=TB();return e.encode(n,t,{lengthDelimited:!1}),t.finish()}var kf;(function(n){n[n.VARINT=0]="VARINT",n[n.BIT64=1]="BIT64",n[n.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",n[n.START_GROUP=3]="START_GROUP",n[n.END_GROUP=4]="END_GROUP",n[n.BIT32=5]="BIT32"})(kf||(kf={}));function V2(n,e,t,r){return{name:n,type:e,encode:t,decode:r}}function $2(n){function e(o){if(n[o.toString()]==null)throw new Error("Invalid enum value");return n[o]}const t=function(l,u){const f=e(l);u.int32(f)},r=function(l){const u=l.int32();return e(u)};return V2("enum",kf.VARINT,t,r)}function Yn(n,e){return V2("message",kf.LENGTH_DELIMITED,n,e)}class Wp extends Error{code="ERR_MAX_LENGTH";name="MaxLengthError"}class O1 extends Error{code="ERR_MAX_SIZE";name="MaxSizeError"}function Ee(n,e="utf8"){const t=z2[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(n).substring(1)}const kB=parseInt("11111",2),em=parseInt("10000000",2),CB=parseInt("01111111",2),L1={0:Rl,1:Rl,2:NB,3:RB,4:MB,5:DB,6:BB,16:Rl,22:Rl,48:Rl};function Bs(n,e={offset:0}){const t=n[e.offset]&kB;if(e.offset++,L1[t]!=null)return L1[t](n,e);throw new Error("No decoder for tag "+t)}function mc(n,e){let t=0;if((n[e.offset]&em)===em){const r=n[e.offset]&CB;let o="0x";e.offset++;for(let l=0;l<r;l++,e.offset++)o+=n[e.offset].toString(16).padStart(2,"0");t=parseInt(o,16)}else t=n[e.offset],e.offset++;return t}function Rl(n,e){mc(n,e);const t=[];for(;!(e.offset>=n.byteLength);){const r=Bs(n,e);if(r===null)break;t.push(r)}return t}function NB(n,e){const t=mc(n,e),r=e.offset,o=e.offset+t,l=[];for(let u=r;u<o;u++)u===r&&n[u]===0||l.push(n[u]);return e.offset+=t,Uint8Array.from(l)}function BB(n,e){const t=mc(n,e),r=e.offset+t,o=n[e.offset];e.offset++;let l=0,u=0;o<40?(l=0,u=o):o<80?(l=1,u=o-40):(l=2,u=o-80);let f=`${l}.${u}`,h=[];for(;e.offset<r;){const p=n[e.offset];if(e.offset++,h.push(p&127),p<128){h.reverse();let m=0;for(let y=0;y<h.length;y++)m+=h[y]<<y*7;f+=`.${m}`,h=[]}}return f}function DB(n,e){return e.offset++,null}function RB(n,e){const t=mc(n,e),r=n[e.offset];e.offset++;const o=n.subarray(e.offset,e.offset+t-1);if(e.offset+=t,r!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function MB(n,e){const t=mc(n,e),r=n.subarray(e.offset,e.offset+t);return e.offset+=t,r}function IB(n){let e=n.toString(16);e.length%2===1&&(e="0"+e);const t=new rt;for(let r=0;r<e.length;r+=2)t.append(Uint8Array.from([parseInt(`${e[r]}${e[r+1]}`,16)]));return t}function id(n){if(n.byteLength<128)return Uint8Array.from([n.byteLength]);const e=IB(n.byteLength);return new rt(Uint8Array.from([e.byteLength|em]),e)}function yn(n){const e=new rt,t=128;return(n.subarray()[0]&t)===t&&e.append(Uint8Array.from([0])),e.append(n),new rt(Uint8Array.from([2]),id(e),e)}function iy(n){const e=Uint8Array.from([0]),t=new rt(e,n);return new rt(Uint8Array.from([3]),id(t),t)}function OB(n){return new rt(Uint8Array.from([4]),id(n),n)}function Ur(n,e=48){const t=new rt;for(const r of n)t.append(r);return new rt(Uint8Array.from([e]),id(t),t)}const LB="1.2.840.10045.3.1.7",UB="1.3.132.0.34",PB="1.3.132.0.35";async function zB(n="P-256"){const e=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:n},!0,["sign","verify"]);return{publicKey:await crypto.subtle.exportKey("jwk",e.publicKey),privateKey:await crypto.subtle.exportKey("jwk",e.privateKey)}}async function VB(n,e,t){const r=await crypto.subtle.importKey("jwk",n,{name:"ECDSA",namedCurve:n.crv??"P-256"},!1,["sign"]);t?.signal?.throwIfAborted();const o=await crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},r,e.subarray());return t?.signal?.throwIfAborted(),new Uint8Array(o,0,o.byteLength)}async function $B(n,e,t,r){const o=await crypto.subtle.importKey("jwk",n,{name:"ECDSA",namedCurve:n.crv??"P-256"},!1,["verify"]);r?.signal?.throwIfAborted();const l=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},o,e,t.subarray());return r?.signal?.throwIfAborted(),l}const HB=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),qB=Uint8Array.from([6,5,43,129,4,0,34]),FB=Uint8Array.from([6,5,43,129,4,0,35]),H2={ext:!0,kty:"EC",crv:"P-256"},q2={ext:!0,kty:"EC",crv:"P-384"},F2={ext:!0,kty:"EC",crv:"P-521"},$o=32,Ho=48,qo=66;function KB(n){const e=Bs(n);return K2(e)}function K2(n){const e=n[1],t=Ee(e,"base64url"),r=n[2][1][0],o=1;let l,u;if(e.byteLength===$o)return l=Ee(r.subarray(o,o+$o),"base64url"),u=Ee(r.subarray(o+$o),"base64url"),new gf({...H2,key_ops:["sign"],d:t,x:l,y:u});if(e.byteLength===Ho)return l=Ee(r.subarray(o,o+Ho),"base64url"),u=Ee(r.subarray(o+Ho),"base64url"),new gf({...q2,key_ops:["sign"],d:t,x:l,y:u});if(e.byteLength===qo)return l=Ee(r.subarray(o,o+qo),"base64url"),u=Ee(r.subarray(o+qo),"base64url"),new gf({...F2,key_ops:["sign"],d:t,x:l,y:u});throw new ge(`Private key length was wrong length, got ${e.byteLength}, expected 32, 48 or 66`)}function j2(n){const e=Bs(n);return jB(e)}function jB(n){const e=n[1][1][0],t=1;let r,o;if(e.byteLength===$o*2+1)return r=Ee(e.subarray(t,t+$o),"base64url"),o=Ee(e.subarray(t+$o),"base64url"),new hf({...H2,key_ops:["verify"],x:r,y:o});if(e.byteLength===Ho*2+1)return r=Ee(e.subarray(t,t+Ho),"base64url"),o=Ee(e.subarray(t+Ho),"base64url"),new hf({...q2,key_ops:["verify"],x:r,y:o});if(e.byteLength===qo*2+1)return r=Ee(e.subarray(t,t+qo),"base64url"),o=Ee(e.subarray(t+qo),"base64url"),new hf({...F2,key_ops:["verify"],x:r,y:o});throw new ge(`coordinates were wrong length, got ${e.byteLength}, expected 65, 97 or 133`)}function GB(n){return Ur([yn(Uint8Array.from([1])),OB(de(n.d??"","base64url")),Ur([G2(n.crv)],160),Ur([iy(new rt(Uint8Array.from([4]),de(n.x??"","base64url"),de(n.y??"","base64url")))],161)]).subarray()}function YB(n){return Ur([yn(Uint8Array.from([1])),Ur([G2(n.crv)],160),Ur([iy(new rt(Uint8Array.from([4]),de(n.x??"","base64url"),de(n.y??"","base64url")))],161)]).subarray()}function G2(n){if(n==="P-256")return HB;if(n==="P-384")return qB;if(n==="P-521")return FB;throw new ge(`Invalid curve ${n}`)}async function ZB(n="P-256"){const e=await zB(n);return new gf(e.privateKey)}class hf{type="ECDSA";jwk;_raw;constructor(e){this.jwk=e}get raw(){return this._raw==null&&(this._raw=YB(this.jwk)),this._raw}toMultihash(){return Mi.digest(Di(this))}toCID(){return Se.createV1(114,this.toMultihash())}toString(){return St.encode(this.toMultihash().bytes).substring(1)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}async verify(e,t,r){return $B(this.jwk,t,e,r)}}class gf{type="ECDSA";jwk;publicKey;_raw;constructor(e){this.jwk=e,this.publicKey=new hf({crv:e.crv,ext:e.ext,key_ops:["verify"],kty:"EC",x:e.x,y:e.y})}get raw(){return this._raw==null&&(this._raw=GB(this.jwk)),this._raw}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}async sign(e,t){return VB(this.jwk,e,t)}}const Co=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function yc(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function Fo(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function Pi(n,...e){if(!yc(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function sy(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Fo(n.outputLen),Fo(n.blockLen)}function Cf(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function XB(n,e){Pi(n);const t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function $r(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function Fl(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function ir(n,e){return n<<32-e|n>>>e}function np(n,e){return n<<e|n>>>32-e>>>0}const Y2=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",QB=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Es(n){if(Pi(n),Y2)return n.toHex();let e="";for(let t=0;t<n.length;t++)e+=QB[n[t]];return e}const Nr={_0:48,_9:57,A:65,F:70,a:97,f:102};function U1(n){if(n>=Nr._0&&n<=Nr._9)return n-Nr._0;if(n>=Nr.A&&n<=Nr.F)return n-(Nr.A-10);if(n>=Nr.a&&n<=Nr.f)return n-(Nr.a-10)}function Nf(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);if(Y2)return Uint8Array.fromHex(n);const e=n.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(t);for(let o=0,l=0;o<t;o++,l+=2){const u=U1(n.charCodeAt(l)),f=U1(n.charCodeAt(l+1));if(u===void 0||f===void 0){const h=n[l]+n[l+1];throw new Error('hex string expected, got non-hex character "'+h+'" at index '+l)}r[o]=u*16+f}return r}const JB=async()=>{};async function WB(n,e,t){let r=Date.now();for(let o=0;o<n;o++){t(o);const l=Date.now()-r;l>=0&&l<e||(await JB(),r+=l)}}function Z2(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function oy(n){return typeof n=="string"&&(n=Z2(n)),Pi(n),n}function P1(n){return typeof n=="string"&&(n=Z2(n)),Pi(n),n}function ar(...n){let e=0;for(let r=0;r<n.length;r++){const o=n[r];Pi(o),e+=o.length}const t=new Uint8Array(e);for(let r=0,o=0;r<n.length;r++){const l=n[r];t.set(l,o),o+=l.length}return t}function eD(n,e){if(e!==void 0&&{}.toString.call(e)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(n,e)}class X2{}function ay(n){const e=r=>n().update(oy(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function sd(n=32){if(Co&&typeof Co.getRandomValues=="function")return Co.getRandomValues(new Uint8Array(n));if(Co&&typeof Co.randomBytes=="function")return Uint8Array.from(Co.randomBytes(n));throw new Error("crypto.getRandomValues must be defined")}function tD(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const o=BigInt(32),l=BigInt(4294967295),u=Number(t>>o&l),f=Number(t&l),h=r?4:0,p=r?0:4;n.setUint32(e+h,u,r),n.setUint32(e+p,f,r)}function Q2(n,e,t){return n&e^~n&t}function J2(n,e,t){return n&e^n&t^e&t}class ly extends X2{constructor(e,t,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(e),this.view=Fl(this.buffer)}update(e){Cf(this),e=oy(e),Pi(e);const{view:t,buffer:r,blockLen:o}=this,l=e.length;for(let u=0;u<l;){const f=Math.min(o-this.pos,l-u);if(f===o){const h=Fl(e);for(;o<=l-u;u+=o)this.process(h,u);continue}r.set(e.subarray(u,u+f),this.pos),this.pos+=f,u+=f,this.pos===o&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Cf(this),XB(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:o,isLE:l}=this;let{pos:u}=this;t[u++]=128,$r(this.buffer.subarray(u)),this.padOffset>o-u&&(this.process(r,0),u=0);for(let y=u;y<o;y++)t[y]=0;tD(r,o-8,BigInt(this.length*8),l),this.process(r,0);const f=Fl(e),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const p=h/4,m=this.get();if(p>m.length)throw new Error("_sha2: outputLen bigger than state");for(let y=0;y<p;y++)f.setUint32(4*y,m[y],l)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:o,finished:l,destroyed:u,pos:f}=this;return e.destroyed=u,e.finished=l,e.length=o,e.pos=f,o%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const bi=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),qt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Yu=BigInt(2**32-1),z1=BigInt(32);function nD(n,e=!1){return e?{h:Number(n&Yu),l:Number(n>>z1&Yu)}:{h:Number(n>>z1&Yu)|0,l:Number(n&Yu)|0}}function rD(n,e=!1){const t=n.length;let r=new Uint32Array(t),o=new Uint32Array(t);for(let l=0;l<t;l++){const{h:u,l:f}=nD(n[l],e);[r[l],o[l]]=[u,f]}return[r,o]}const V1=(n,e,t)=>n>>>t,$1=(n,e,t)=>n<<32-t|e>>>t,No=(n,e,t)=>n>>>t|e<<32-t,Bo=(n,e,t)=>n<<32-t|e>>>t,Zu=(n,e,t)=>n<<64-t|e>>>t-32,Xu=(n,e,t)=>n>>>t-32|e<<64-t;function Br(n,e,t,r){const o=(e>>>0)+(r>>>0);return{h:n+t+(o/2**32|0)|0,l:o|0}}const iD=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),sD=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,oD=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),aD=(n,e,t,r,o)=>e+t+r+o+(n/2**32|0)|0,lD=(n,e,t,r,o)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(o>>>0),cD=(n,e,t,r,o,l)=>e+t+r+o+l+(n/2**32|0)|0,uD=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),wi=new Uint32Array(64);class fD extends ly{constructor(e=32){super(64,e,8,!1),this.A=bi[0]|0,this.B=bi[1]|0,this.C=bi[2]|0,this.D=bi[3]|0,this.E=bi[4]|0,this.F=bi[5]|0,this.G=bi[6]|0,this.H=bi[7]|0}get(){const{A:e,B:t,C:r,D:o,E:l,F:u,G:f,H:h}=this;return[e,t,r,o,l,u,f,h]}set(e,t,r,o,l,u,f,h){this.A=e|0,this.B=t|0,this.C=r|0,this.D=o|0,this.E=l|0,this.F=u|0,this.G=f|0,this.H=h|0}process(e,t){for(let y=0;y<16;y++,t+=4)wi[y]=e.getUint32(t,!1);for(let y=16;y<64;y++){const b=wi[y-15],E=wi[y-2],x=ir(b,7)^ir(b,18)^b>>>3,k=ir(E,17)^ir(E,19)^E>>>10;wi[y]=k+wi[y-7]+x+wi[y-16]|0}let{A:r,B:o,C:l,D:u,E:f,F:h,G:p,H:m}=this;for(let y=0;y<64;y++){const b=ir(f,6)^ir(f,11)^ir(f,25),E=m+b+Q2(f,h,p)+uD[y]+wi[y]|0,k=(ir(r,2)^ir(r,13)^ir(r,22))+J2(r,o,l)|0;m=p,p=h,h=f,f=u+E|0,u=l,l=o,o=r,r=E+k|0}r=r+this.A|0,o=o+this.B|0,l=l+this.C|0,u=u+this.D|0,f=f+this.E|0,h=h+this.F|0,p=p+this.G|0,m=m+this.H|0,this.set(r,o,l,u,f,h,p,m)}roundClean(){$r(wi)}destroy(){this.set(0,0,0,0,0,0,0,0),$r(this.buffer)}}const W2=rD(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),dD=W2[0],hD=W2[1],vi=new Uint32Array(80),Ei=new Uint32Array(80);class gD extends ly{constructor(e=64){super(128,e,16,!1),this.Ah=qt[0]|0,this.Al=qt[1]|0,this.Bh=qt[2]|0,this.Bl=qt[3]|0,this.Ch=qt[4]|0,this.Cl=qt[5]|0,this.Dh=qt[6]|0,this.Dl=qt[7]|0,this.Eh=qt[8]|0,this.El=qt[9]|0,this.Fh=qt[10]|0,this.Fl=qt[11]|0,this.Gh=qt[12]|0,this.Gl=qt[13]|0,this.Hh=qt[14]|0,this.Hl=qt[15]|0}get(){const{Ah:e,Al:t,Bh:r,Bl:o,Ch:l,Cl:u,Dh:f,Dl:h,Eh:p,El:m,Fh:y,Fl:b,Gh:E,Gl:x,Hh:k,Hl:_}=this;return[e,t,r,o,l,u,f,h,p,m,y,b,E,x,k,_]}set(e,t,r,o,l,u,f,h,p,m,y,b,E,x,k,_){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=o|0,this.Ch=l|0,this.Cl=u|0,this.Dh=f|0,this.Dl=h|0,this.Eh=p|0,this.El=m|0,this.Fh=y|0,this.Fl=b|0,this.Gh=E|0,this.Gl=x|0,this.Hh=k|0,this.Hl=_|0}process(e,t){for(let C=0;C<16;C++,t+=4)vi[C]=e.getUint32(t),Ei[C]=e.getUint32(t+=4);for(let C=16;C<80;C++){const Z=vi[C-15]|0,Q=Ei[C-15]|0,re=No(Z,Q,1)^No(Z,Q,8)^V1(Z,Q,7),oe=Bo(Z,Q,1)^Bo(Z,Q,8)^$1(Z,Q,7),H=vi[C-2]|0,B=Ei[C-2]|0,G=No(H,B,19)^Zu(H,B,61)^V1(H,B,6),te=Bo(H,B,19)^Xu(H,B,61)^$1(H,B,6),Y=oD(oe,te,Ei[C-7],Ei[C-16]),U=aD(Y,re,G,vi[C-7],vi[C-16]);vi[C]=U|0,Ei[C]=Y|0}let{Ah:r,Al:o,Bh:l,Bl:u,Ch:f,Cl:h,Dh:p,Dl:m,Eh:y,El:b,Fh:E,Fl:x,Gh:k,Gl:_,Hh:R,Hl:j}=this;for(let C=0;C<80;C++){const Z=No(y,b,14)^No(y,b,18)^Zu(y,b,41),Q=Bo(y,b,14)^Bo(y,b,18)^Xu(y,b,41),re=y&E^~y&k,oe=b&x^~b&_,H=lD(j,Q,oe,hD[C],Ei[C]),B=cD(H,R,Z,re,dD[C],vi[C]),G=H|0,te=No(r,o,28)^Zu(r,o,34)^Zu(r,o,39),Y=Bo(r,o,28)^Xu(r,o,34)^Xu(r,o,39),U=r&l^r&f^l&f,M=o&u^o&h^u&h;R=k|0,j=_|0,k=E|0,_=x|0,E=y|0,x=b|0,{h:y,l:b}=Br(p|0,m|0,B|0,G|0),p=f|0,m=h|0,f=l|0,h=u|0,l=r|0,u=o|0;const D=iD(G,Y,M);r=sD(D,B,te,U),o=D|0}({h:r,l:o}=Br(this.Ah|0,this.Al|0,r|0,o|0)),{h:l,l:u}=Br(this.Bh|0,this.Bl|0,l|0,u|0),{h:f,l:h}=Br(this.Ch|0,this.Cl|0,f|0,h|0),{h:p,l:m}=Br(this.Dh|0,this.Dl|0,p|0,m|0),{h:y,l:b}=Br(this.Eh|0,this.El|0,y|0,b|0),{h:E,l:x}=Br(this.Fh|0,this.Fl|0,E|0,x|0),{h:k,l:_}=Br(this.Gh|0,this.Gl|0,k|0,_|0),{h:R,l:j}=Br(this.Hh|0,this.Hl|0,R|0,j|0),this.set(r,o,l,u,f,h,p,m,y,b,E,x,k,_,R,j)}roundClean(){$r(vi,Ei)}destroy(){$r(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const eS=ay(()=>new fD),tS=ay(()=>new gD);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cy=BigInt(0),tm=BigInt(1);function As(n,e=""){if(typeof n!="boolean"){const t=e&&`"${e}"`;throw new Error(t+"expected boolean, got type="+typeof n)}return n}function Fn(n,e,t=""){const r=yc(n),o=n?.length,l=e!==void 0;if(!r||l&&o!==e){const u=t&&`"${t}" `,f=l?` of length ${e}`:"",h=r?`length=${o}`:`type=${typeof n}`;throw new Error(u+"expected Uint8Array"+f+", got "+h)}return n}function Qu(n){const e=n.toString(16);return e.length&1?"0"+e:e}function nS(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return n===""?cy:BigInt("0x"+n)}function od(n){return nS(Es(n))}function ec(n){return Pi(n),nS(Es(Uint8Array.from(n).reverse()))}function uy(n,e){return Nf(n.toString(16).padStart(e*2,"0"))}function rS(n,e){return uy(n,e).reverse()}function dt(n,e,t){let r;if(typeof e=="string")try{r=Nf(e)}catch(l){throw new Error(n+" must be hex string or Uint8Array, cause: "+l)}else if(yc(e))r=Uint8Array.from(e);else throw new Error(n+" must be hex string or Uint8Array");const o=r.length;if(typeof t=="number"&&o!==t)throw new Error(n+" of length "+t+" expected, got "+o);return r}function H1(n){return Uint8Array.from(n)}const rp=n=>typeof n=="bigint"&&cy<=n;function pD(n,e,t){return rp(n)&&rp(e)&&rp(t)&&e<=n&&n<t}function nm(n,e,t,r){if(!pD(e,t,r))throw new Error("expected valid "+n+": "+t+" <= n < "+r+", got "+e)}function iS(n){let e;for(e=0;n>cy;n>>=tm,e+=1);return e}const bc=n=>(tm<<BigInt(n))-tm;function mD(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");const r=E=>new Uint8Array(E),o=E=>Uint8Array.of(E);let l=r(n),u=r(n),f=0;const h=()=>{l.fill(1),u.fill(0),f=0},p=(...E)=>t(u,l,...E),m=(E=r(0))=>{u=p(o(0),E),l=p(),E.length!==0&&(u=p(o(1),E),l=p())},y=()=>{if(f++>=1e3)throw new Error("drbg: tried 1000 values");let E=0;const x=[];for(;E<e;){l=p();const k=l.slice();x.push(k),E+=l.length}return ar(...x)};return(E,x)=>{h(),m(E);let k;for(;!(k=x(y()));)m();return h(),k}}function wc(n,e,t={}){if(!n||typeof n!="object")throw new Error("expected valid options object");function r(o,l,u){const f=n[o];if(u&&f===void 0)return;const h=typeof f;if(h!==l||f===null)throw new Error(`param "${o}" is invalid: expected ${l}, got ${h}`)}Object.entries(e).forEach(([o,l])=>r(o,l,!1)),Object.entries(t).forEach(([o,l])=>r(o,l,!0))}function Bf(n){const e=new WeakMap;return(t,...r)=>{const o=e.get(t);if(o!==void 0)return o;const l=n(t,...r);return e.set(t,l),l}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const sn=BigInt(0),Ut=BigInt(1),hs=BigInt(2),sS=BigInt(3),oS=BigInt(4),aS=BigInt(5),yD=BigInt(7),lS=BigInt(8),bD=BigInt(9),cS=BigInt(16);function wt(n,e){const t=n%e;return t>=sn?t:e+t}function ft(n,e,t){let r=n;for(;e-- >sn;)r*=r,r%=t;return r}function q1(n,e){if(n===sn)throw new Error("invert: expected non-zero number");if(e<=sn)throw new Error("invert: expected positive modulus, got "+e);let t=wt(n,e),r=e,o=sn,l=Ut;for(;t!==sn;){const f=r/t,h=r%t,p=o-l*f;r=t,t=h,o=l,l=p}if(r!==Ut)throw new Error("invert: does not exist");return wt(o,e)}function fy(n,e,t){if(!n.eql(n.sqr(e),t))throw new Error("Cannot find square root")}function uS(n,e){const t=(n.ORDER+Ut)/oS,r=n.pow(e,t);return fy(n,r,e),r}function wD(n,e){const t=(n.ORDER-aS)/lS,r=n.mul(e,hs),o=n.pow(r,t),l=n.mul(e,o),u=n.mul(n.mul(l,hs),o),f=n.mul(l,n.sub(u,n.ONE));return fy(n,f,e),f}function vD(n){const e=Ds(n),t=fS(n),r=t(e,e.neg(e.ONE)),o=t(e,r),l=t(e,e.neg(r)),u=(n+yD)/cS;return(f,h)=>{let p=f.pow(h,u),m=f.mul(p,r);const y=f.mul(p,o),b=f.mul(p,l),E=f.eql(f.sqr(m),h),x=f.eql(f.sqr(y),h);p=f.cmov(p,m,E),m=f.cmov(b,y,x);const k=f.eql(f.sqr(m),h),_=f.cmov(p,m,k);return fy(f,_,h),_}}function fS(n){if(n<sS)throw new Error("sqrt is not defined for small field");let e=n-Ut,t=0;for(;e%hs===sn;)e/=hs,t++;let r=hs;const o=Ds(n);for(;F1(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return uS;let l=o.pow(r,e);const u=(e+Ut)/hs;return function(h,p){if(h.is0(p))return p;if(F1(h,p)!==1)throw new Error("Cannot find square root");let m=t,y=h.mul(h.ONE,l),b=h.pow(p,e),E=h.pow(p,u);for(;!h.eql(b,h.ONE);){if(h.is0(b))return h.ZERO;let x=1,k=h.sqr(b);for(;!h.eql(k,h.ONE);)if(x++,k=h.sqr(k),x===m)throw new Error("Cannot find square root");const _=Ut<<BigInt(m-x-1),R=h.pow(y,_);m=x,y=h.sqr(R),b=h.mul(b,y),E=h.mul(E,R)}return E}}function ED(n){return n%oS===sS?uS:n%lS===aS?wD:n%cS===bD?vD(n):fS(n)}const xD=(n,e)=>(wt(n,e)&Ut)===Ut,SD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function AD(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=SD.reduce((r,o)=>(r[o]="function",r),e);return wc(n,t),n}function _D(n,e,t){if(t<sn)throw new Error("invalid exponent, negatives unsupported");if(t===sn)return n.ONE;if(t===Ut)return e;let r=n.ONE,o=e;for(;t>sn;)t&Ut&&(r=n.mul(r,o)),o=n.sqr(o),t>>=Ut;return r}function dS(n,e,t=!1){const r=new Array(e.length).fill(t?n.ZERO:void 0),o=e.reduce((u,f,h)=>n.is0(f)?u:(r[h]=u,n.mul(u,f)),n.ONE),l=n.inv(o);return e.reduceRight((u,f,h)=>n.is0(f)?u:(r[h]=n.mul(u,r[h]),n.mul(u,f)),l),r}function F1(n,e){const t=(n.ORDER-Ut)/hs,r=n.pow(e,t),o=n.eql(r,n.ONE),l=n.eql(r,n.ZERO),u=n.eql(r,n.neg(n.ONE));if(!o&&!l&&!u)throw new Error("invalid Legendre symbol result");return o?1:l?0:-1}function hS(n,e){e!==void 0&&Fo(e);const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Ds(n,e,t=!1,r={}){if(n<=sn)throw new Error("invalid field: expected ORDER > 0, got "+n);let o,l,u=!1,f;if(typeof e=="object"&&e!=null){if(r.sqrt||t)throw new Error("cannot specify opts in two arguments");const b=e;b.BITS&&(o=b.BITS),b.sqrt&&(l=b.sqrt),typeof b.isLE=="boolean"&&(t=b.isLE),typeof b.modFromBytes=="boolean"&&(u=b.modFromBytes),f=b.allowedLengths}else typeof e=="number"&&(o=e),r.sqrt&&(l=r.sqrt);const{nBitLength:h,nByteLength:p}=hS(n,o);if(p>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let m;const y=Object.freeze({ORDER:n,isLE:t,BITS:h,BYTES:p,MASK:bc(h),ZERO:sn,ONE:Ut,allowedLengths:f,create:b=>wt(b,n),isValid:b=>{if(typeof b!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof b);return sn<=b&&b<n},is0:b=>b===sn,isValidNot0:b=>!y.is0(b)&&y.isValid(b),isOdd:b=>(b&Ut)===Ut,neg:b=>wt(-b,n),eql:(b,E)=>b===E,sqr:b=>wt(b*b,n),add:(b,E)=>wt(b+E,n),sub:(b,E)=>wt(b-E,n),mul:(b,E)=>wt(b*E,n),pow:(b,E)=>_D(y,b,E),div:(b,E)=>wt(b*q1(E,n),n),sqrN:b=>b*b,addN:(b,E)=>b+E,subN:(b,E)=>b-E,mulN:(b,E)=>b*E,inv:b=>q1(b,n),sqrt:l||(b=>(m||(m=ED(n)),m(y,b))),toBytes:b=>t?rS(b,p):uy(b,p),fromBytes:(b,E=!0)=>{if(f){if(!f.includes(b.length)||b.length>p)throw new Error("Field.fromBytes: expected "+f+" bytes, got "+b.length);const k=new Uint8Array(p);k.set(b,t?0:k.length-b.length),b=k}if(b.length!==p)throw new Error("Field.fromBytes: expected "+p+" bytes, got "+b.length);let x=t?ec(b):od(b);if(u&&(x=wt(x,n)),!E&&!y.isValid(x))throw new Error("invalid field element: outside of range 0..ORDER");return x},invertBatch:b=>dS(y,b),cmov:(b,E,x)=>x?E:b});return Object.freeze(y)}function gS(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function pS(n){const e=gS(n);return e+Math.ceil(e/2)}function TD(n,e,t=!1){const r=n.length,o=gS(e),l=pS(e);if(r<16||r<l||r>1024)throw new Error("expected "+l+"-1024 bytes of input, got "+r);const u=t?ec(n):od(n),f=wt(u,e-Ut)+Ut;return t?rS(f,o):uy(f,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ra=BigInt(0),gs=BigInt(1);function Df(n,e){const t=e.negate();return n?t:e}function ps(n,e){const t=dS(n.Fp,e.map(r=>r.Z));return e.map((r,o)=>n.fromAffine(r.toAffine(t[o])))}function mS(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+n)}function ip(n,e){mS(n,e);const t=Math.ceil(e/n)+1,r=2**(n-1),o=2**n,l=bc(n),u=BigInt(n);return{windows:t,windowSize:r,mask:l,maxNumber:o,shiftBy:u}}function K1(n,e,t){const{windowSize:r,mask:o,maxNumber:l,shiftBy:u}=t;let f=Number(n&o),h=n>>u;f>r&&(f-=l,h+=gs);const p=e*r,m=p+Math.abs(f)-1,y=f===0,b=f<0,E=e%2!==0;return{nextN:h,offset:m,isZero:y,isNeg:b,isNegF:E,offsetF:p}}function kD(n,e){if(!Array.isArray(n))throw new Error("array expected");n.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function CD(n,e){if(!Array.isArray(n))throw new Error("array of scalars expected");n.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}const sp=new WeakMap,yS=new WeakMap;function op(n){return yS.get(n)||1}function j1(n){if(n!==ra)throw new Error("invalid wNAF")}class bS{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let o=e;for(;t>ra;)t&gs&&(r=r.add(o)),o=o.double(),t>>=gs;return r}precomputeWindow(e,t){const{windows:r,windowSize:o}=ip(t,this.bits),l=[];let u=e,f=u;for(let h=0;h<r;h++){f=u,l.push(f);for(let p=1;p<o;p++)f=f.add(u),l.push(f);u=f.double()}return l}wNAF(e,t,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,l=this.BASE;const u=ip(e,this.bits);for(let f=0;f<u.windows;f++){const{nextN:h,offset:p,isZero:m,isNeg:y,isNegF:b,offsetF:E}=K1(r,f,u);r=h,m?l=l.add(Df(b,t[E])):o=o.add(Df(y,t[p]))}return j1(r),{p:o,f:l}}wNAFUnsafe(e,t,r,o=this.ZERO){const l=ip(e,this.bits);for(let u=0;u<l.windows&&r!==ra;u++){const{nextN:f,offset:h,isZero:p,isNeg:m}=K1(r,u,l);if(r=f,!p){const y=t[h];o=o.add(m?y.negate():y)}}return j1(r),o}getPrecomputes(e,t,r){let o=sp.get(t);return o||(o=this.precomputeWindow(t,e),e!==1&&(typeof r=="function"&&(o=r(o)),sp.set(t,o))),o}cached(e,t,r){const o=op(e);return this.wNAF(o,this.getPrecomputes(o,e,r),t)}unsafe(e,t,r,o){const l=op(e);return l===1?this._unsafeLadder(e,t,o):this.wNAFUnsafe(l,this.getPrecomputes(l,e,r),t,o)}createCache(e,t){mS(t,this.bits),yS.set(e,t),sp.delete(e)}hasCache(e){return op(e)!==1}}function ND(n,e,t,r){let o=e,l=n.ZERO,u=n.ZERO;for(;t>ra||r>ra;)t&gs&&(l=l.add(o)),r&gs&&(u=u.add(o)),o=o.double(),t>>=gs,r>>=gs;return{p1:l,p2:u}}function wS(n,e,t,r){kD(t,n),CD(r,e);const o=t.length,l=r.length;if(o!==l)throw new Error("arrays of points and scalars must have equal length");const u=n.ZERO,f=iS(BigInt(o));let h=1;f>12?h=f-3:f>4?h=f-2:f>0&&(h=2);const p=bc(h),m=new Array(Number(p)+1).fill(u),y=Math.floor((e.BITS-1)/h)*h;let b=u;for(let E=y;E>=0;E-=h){m.fill(u);for(let k=0;k<l;k++){const _=r[k],R=Number(_>>BigInt(E)&p);m[R]=m[R].add(t[k])}let x=u;for(let k=m.length-1,_=u;k>0;k--)_=_.add(m[k]),x=x.add(_);if(b=b.add(x),E!==0)for(let k=0;k<h;k++)b=b.double()}return b}function G1(n,e,t){if(e){if(e.ORDER!==n)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return AD(e),e}else return Ds(n,{isLE:t})}function vS(n,e,t={},r){if(r===void 0&&(r=n==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${n} CURVE object`);for(const h of["p","n","h"]){const p=e[h];if(!(typeof p=="bigint"&&p>ra))throw new Error(`CURVE.${h} must be positive bigint`)}const o=G1(e.p,t.Fp,r),l=G1(e.n,t.Fn,r),f=["Gx","Gy","a",n==="weierstrass"?"b":"d"];for(const h of f)if(!o.isValid(e[h]))throw new Error(`CURVE.${h} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:o,Fn:l}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xi=BigInt(0),Ct=BigInt(1),ap=BigInt(2),BD=BigInt(8);function DD(n,e,t,r){const o=n.sqr(t),l=n.sqr(r),u=n.add(n.mul(e.a,o),l),f=n.add(n.ONE,n.mul(e.d,n.mul(o,l)));return n.eql(u,f)}function RD(n,e={}){const t=vS("edwards",n,e,e.FpFnLE),{Fp:r,Fn:o}=t;let l=t.CURVE;const{h:u}=l;wc(e,{},{uvRatio:"function"});const f=ap<<BigInt(o.BYTES*8)-Ct,h=_=>r.create(_),p=e.uvRatio||((_,R)=>{try{return{isValid:!0,value:r.sqrt(r.div(_,R))}}catch{return{isValid:!1,value:xi}}});if(!DD(r,l,l.Gx,l.Gy))throw new Error("bad curve params: generator point");function m(_,R,j=!1){const C=j?Ct:xi;return nm("coordinate "+_,R,C,f),R}function y(_){if(!(_ instanceof x))throw new Error("ExtendedPoint expected")}const b=Bf((_,R)=>{const{X:j,Y:C,Z}=_,Q=_.is0();R==null&&(R=Q?BD:r.inv(Z));const re=h(j*R),oe=h(C*R),H=r.mul(Z,R);if(Q)return{x:xi,y:Ct};if(H!==Ct)throw new Error("invZ was invalid");return{x:re,y:oe}}),E=Bf(_=>{const{a:R,d:j}=l;if(_.is0())throw new Error("bad point: ZERO");const{X:C,Y:Z,Z:Q,T:re}=_,oe=h(C*C),H=h(Z*Z),B=h(Q*Q),G=h(B*B),te=h(oe*R),Y=h(B*h(te+H)),U=h(G+h(j*h(oe*H)));if(Y!==U)throw new Error("bad point: equation left != right (1)");const M=h(C*Z),D=h(Q*re);if(M!==D)throw new Error("bad point: equation left != right (2)");return!0});class x{constructor(R,j,C,Z){this.X=m("x",R),this.Y=m("y",j),this.Z=m("z",C,!0),this.T=m("t",Z),Object.freeze(this)}static CURVE(){return l}static fromAffine(R){if(R instanceof x)throw new Error("extended point not allowed");const{x:j,y:C}=R||{};return m("x",j),m("y",C),new x(j,C,Ct,h(j*C))}static fromBytes(R,j=!1){const C=r.BYTES,{a:Z,d:Q}=l;R=H1(Fn(R,C,"point")),As(j,"zip215");const re=H1(R),oe=R[C-1];re[C-1]=oe&-129;const H=ec(re),B=j?f:r.ORDER;nm("point.y",H,xi,B);const G=h(H*H),te=h(G-Ct),Y=h(Q*G-Z);let{isValid:U,value:M}=p(te,Y);if(!U)throw new Error("bad point: invalid y coordinate");const D=(M&Ct)===Ct,S=(oe&128)!==0;if(!j&&M===xi&&S)throw new Error("bad point: x=0 and x_0=1");return S!==D&&(M=h(-M)),x.fromAffine({x:M,y:H})}static fromHex(R,j=!1){return x.fromBytes(dt("point",R),j)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(R=8,j=!0){return k.createCache(this,R),j||this.multiply(ap),this}assertValidity(){E(this)}equals(R){y(R);const{X:j,Y:C,Z}=this,{X:Q,Y:re,Z:oe}=R,H=h(j*oe),B=h(Q*Z),G=h(C*oe),te=h(re*Z);return H===B&&G===te}is0(){return this.equals(x.ZERO)}negate(){return new x(h(-this.X),this.Y,this.Z,h(-this.T))}double(){const{a:R}=l,{X:j,Y:C,Z}=this,Q=h(j*j),re=h(C*C),oe=h(ap*h(Z*Z)),H=h(R*Q),B=j+C,G=h(h(B*B)-Q-re),te=H+re,Y=te-oe,U=H-re,M=h(G*Y),D=h(te*U),S=h(G*U),I=h(Y*te);return new x(M,D,I,S)}add(R){y(R);const{a:j,d:C}=l,{X:Z,Y:Q,Z:re,T:oe}=this,{X:H,Y:B,Z:G,T:te}=R,Y=h(Z*H),U=h(Q*B),M=h(oe*C*te),D=h(re*G),S=h((Z+Q)*(H+B)-Y-U),I=D-M,L=D+M,ie=h(U-j*Y),A=h(S*I),$=h(L*ie),W=h(S*ie),ne=h(I*L);return new x(A,$,ne,W)}subtract(R){return this.add(R.negate())}multiply(R){if(!o.isValidNot0(R))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:j,f:C}=k.cached(this,R,Z=>ps(x,Z));return ps(x,[j,C])[0]}multiplyUnsafe(R,j=x.ZERO){if(!o.isValid(R))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return R===xi?x.ZERO:this.is0()||R===Ct?this:k.unsafe(this,R,C=>ps(x,C),j)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return k.unsafe(this,l.n).is0()}toAffine(R){return b(this,R)}clearCofactor(){return u===Ct?this:this.multiplyUnsafe(u)}toBytes(){const{x:R,y:j}=this.toAffine(),C=r.toBytes(j);return C[C.length-1]|=R&Ct?128:0,C}toHex(){return Es(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(R){return ps(x,R)}static msm(R,j){return wS(x,o,R,j)}_setWindowSize(R){this.precompute(R)}toRawBytes(){return this.toBytes()}}x.BASE=new x(l.Gx,l.Gy,Ct,h(l.Gx*l.Gy)),x.ZERO=new x(xi,Ct,Ct,xi),x.Fp=r,x.Fn=o;const k=new bS(x,o.BITS);return x.BASE.precompute(8),x}function MD(n,e,t={}){if(typeof e!="function")throw new Error('"hash" function param is required');wc(t,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r}=t,{BASE:o,Fp:l,Fn:u}=n,f=t.randomBytes||sd,h=t.adjustScalarBytes||(B=>B),p=t.domain||((B,G,te)=>{if(As(te,"phflag"),G.length||te)throw new Error("Contexts/pre-hash are not supported");return B});function m(B){return u.create(ec(B))}function y(B){const G=C.secretKey;B=dt("private key",B,G);const te=dt("hashed private key",e(B),2*G),Y=h(te.slice(0,G)),U=te.slice(G,2*G),M=m(Y);return{head:Y,prefix:U,scalar:M}}function b(B){const{head:G,prefix:te,scalar:Y}=y(B),U=o.multiply(Y),M=U.toBytes();return{head:G,prefix:te,scalar:Y,point:U,pointBytes:M}}function E(B){return b(B).pointBytes}function x(B=Uint8Array.of(),...G){const te=ar(...G);return m(e(p(te,dt("context",B),!!r)))}function k(B,G,te={}){B=dt("message",B),r&&(B=r(B));const{prefix:Y,scalar:U,pointBytes:M}=b(G),D=x(te.context,Y,B),S=o.multiply(D).toBytes(),I=x(te.context,S,M,B),L=u.create(D+I*U);if(!u.isValid(L))throw new Error("sign failed: invalid s");const ie=ar(S,u.toBytes(L));return Fn(ie,C.signature,"result")}const _={zip215:!0};function R(B,G,te,Y=_){const{context:U,zip215:M}=Y,D=C.signature;B=dt("signature",B,D),G=dt("message",G),te=dt("publicKey",te,C.publicKey),M!==void 0&&As(M,"zip215"),r&&(G=r(G));const S=D/2,I=B.subarray(0,S),L=ec(B.subarray(S,D));let ie,A,$;try{ie=n.fromBytes(te,M),A=n.fromBytes(I,M),$=o.multiplyUnsafe(L)}catch{return!1}if(!M&&ie.isSmallOrder())return!1;const W=x(U,A.toBytes(),ie.toBytes(),G);return A.add(ie.multiplyUnsafe(W)).subtract($).clearCofactor().is0()}const j=l.BYTES,C={secretKey:j,publicKey:j,signature:2*j,seed:j};function Z(B=f(C.seed)){return Fn(B,C.seed,"seed")}function Q(B){const G=H.randomSecretKey(B);return{secretKey:G,publicKey:E(G)}}function re(B){return yc(B)&&B.length===u.BYTES}function oe(B,G){try{return!!n.fromBytes(B,G)}catch{return!1}}const H={getExtendedPublicKey:b,randomSecretKey:Z,isValidSecretKey:re,isValidPublicKey:oe,toMontgomery(B){const{y:G}=n.fromBytes(B),te=C.publicKey,Y=te===32;if(!Y&&te!==57)throw new Error("only defined for 25519 and 448");const U=Y?l.div(Ct+G,Ct-G):l.div(G-Ct,G+Ct);return l.toBytes(U)},toMontgomerySecret(B){const G=C.secretKey;Fn(B,G);const te=e(B.subarray(0,G));return h(te).subarray(0,G)},randomPrivateKey:Z,precompute(B=8,G=n.BASE){return G.precompute(B,!1)}};return Object.freeze({keygen:Q,getPublicKey:E,sign:k,verify:R,utils:H,Point:n,lengths:C})}function ID(n){const e={a:n.a,d:n.d,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},t=n.Fp,r=Ds(e.n,n.nBitLength,!0),o={Fp:t,Fn:r,uvRatio:n.uvRatio},l={randomBytes:n.randomBytes,adjustScalarBytes:n.adjustScalarBytes,domain:n.domain,prehash:n.prehash,mapToCurve:n.mapToCurve};return{CURVE:e,curveOpts:o,hash:n.hash,eddsaOpts:l}}function OD(n,e){const t=e.Point;return Object.assign({},e,{ExtendedPoint:t,CURVE:n,nBitLength:t.Fn.BITS,nByteLength:t.Fn.BYTES})}function LD(n){const{CURVE:e,curveOpts:t,hash:r,eddsaOpts:o}=ID(n),l=RD(e,t),u=MD(l,r,o);return OD(n,u)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const UD=BigInt(1),Y1=BigInt(2);BigInt(3);const PD=BigInt(5),zD=BigInt(8),dy=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),ES={p:dy,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:zD,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function VD(n){const e=BigInt(10),t=BigInt(20),r=BigInt(40),o=BigInt(80),l=dy,f=n*n%l*n%l,h=ft(f,Y1,l)*f%l,p=ft(h,UD,l)*n%l,m=ft(p,PD,l)*p%l,y=ft(m,e,l)*m%l,b=ft(y,t,l)*y%l,E=ft(b,r,l)*b%l,x=ft(E,o,l)*E%l,k=ft(x,o,l)*E%l,_=ft(k,e,l)*m%l;return{pow_p_5_8:ft(_,Y1,l)*n%l,b2:f}}function $D(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}const Z1=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function HD(n,e){const t=dy,r=wt(e*e*e,t),o=wt(r*r*e,t),l=VD(n*o).pow_p_5_8;let u=wt(n*r*l,t);const f=wt(e*u*u,t),h=u,p=wt(u*Z1,t),m=f===n,y=f===wt(-n,t),b=f===wt(-n*Z1,t);return m&&(u=h),(y||b)&&(u=p),xD(u,t)&&(u=wt(-u,t)),{isValid:m||y,value:u}}const qD=Ds(ES.p,{isLE:!0}),FD={...ES,Fp:qD,hash:tS,adjustScalarBytes:$D,uvRatio:HD},Rf=LD(FD);class X1 extends Error{constructor(e="An error occurred while signing a message"){super(e),this.name="SigningError"}}class Q1 extends Error{constructor(e="An error occurred while verifying a message"){super(e),this.name="VerificationError"}}class KD extends Error{constructor(e="Missing Web Crypto API"){super(e),this.name="WebCryptoMissingError"}}const Zt={get(n=globalThis){const e=n.crypto;if(e?.subtle==null)throw new KD("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return e}},Mf=32,or=64,rm=32;let Ko;const xS=(async()=>{try{return await Zt.get().subtle.generateKey({name:"Ed25519"},!0,["sign","verify"]),!0}catch{return!1}})();function jD(){const n=Rf.utils.randomPrivateKey(),e=Rf.getPublicKey(n);return{privateKey:WD(n,e),publicKey:e}}async function GD(n,e){let t;n.length===or?t=n.subarray(0,32):t=n;const r={crv:"Ed25519",kty:"OKP",x:Ee(n.subarray(32),"base64url"),d:Ee(t,"base64url"),ext:!0,key_ops:["sign"]},o=await Zt.get().subtle.importKey("jwk",r,{name:"Ed25519"},!0,["sign"]),l=await Zt.get().subtle.sign({name:"Ed25519"},o,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(l,0,l.byteLength)}function YD(n,e){const t=n.subarray(0,rm);return Rf.sign(e instanceof Uint8Array?e:e.subarray(),t)}async function ZD(n,e){return Ko==null&&(Ko=await xS),Ko?GD(n,e):YD(n,e)}async function XD(n,e,t){if(n.buffer instanceof ArrayBuffer){const r=await Zt.get().subtle.importKey("raw",n.buffer,{name:"Ed25519"},!1,["verify"]);return await Zt.get().subtle.verify({name:"Ed25519"},r,e,t instanceof Uint8Array?t:t.subarray())}throw new TypeError("WebCrypto does not support SharedArrayBuffer for Ed25519 keys")}function QD(n,e,t){return Rf.verify(e,t instanceof Uint8Array?t:t.subarray(),n)}async function JD(n,e,t){return Ko==null&&(Ko=await xS),Ko?XD(n,e,t):QD(n,e,t)}function WD(n,e){const t=new Uint8Array(or);for(let r=0;r<rm;r++)t[r]=n[r],t[rm+r]=e[r];return t}function ad(n){return n==null?!1:typeof n.then=="function"&&typeof n.catch=="function"&&typeof n.finally=="function"}class SS{type="Ed25519";raw;constructor(e){this.raw=tc(e,Mf)}toMultihash(){return Mi.digest(Di(this))}toCID(){return Se.createV1(114,this.toMultihash())}toString(){return St.encode(this.toMultihash().bytes).substring(1)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}verify(e,t,r){r?.signal?.throwIfAborted();const o=JD(this.raw,t,e);return ad(o)?o.then(l=>(r?.signal?.throwIfAborted(),l)):o}}class im{type="Ed25519";raw;publicKey;constructor(e,t){this.raw=tc(e,or),this.publicKey=new SS(t)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}sign(e,t){t?.signal?.throwIfAborted();const r=ZD(this.raw,e);return ad(r)?r.then(o=>(t?.signal?.throwIfAborted(),o)):(t?.signal?.throwIfAborted(),r)}}function AS(n){if(n.length>or){n=tc(n,or+Mf);const r=n.subarray(0,or),o=n.subarray(or,n.length);return new im(r,o)}n=tc(n,or);const e=n.subarray(0,or),t=n.subarray(Mf);return new im(e,t)}function _S(n){return n=tc(n,Mf),new SS(n)}async function eR(){const{privateKey:n,publicKey:e}=jD();return new im(n,e)}function tc(n,e){if(n=Uint8Array.from(n??[]),n.length!==e)throw new ge(`Key must be a Uint8Array of length ${e}, got ${n.length}`);return n}var nt;(function(n){n.RSA="RSA",n.Ed25519="Ed25519",n.secp256k1="secp256k1",n.ECDSA="ECDSA"})(nt||(nt={}));var sm;(function(n){n[n.RSA=0]="RSA",n[n.Ed25519=1]="Ed25519",n[n.secp256k1=2]="secp256k1",n[n.ECDSA=3]="ECDSA"})(sm||(sm={}));(function(n){n.codec=()=>$2(sm)})(nt||(nt={}));var Ii;(function(n){let e;n.codec=()=>(e==null&&(e=Yn((t,r,o={})=>{o.lengthDelimited!==!1&&r.fork(),t.Type!=null&&(r.uint32(8),nt.codec().encode(t.Type,r)),t.Data!=null&&(r.uint32(18),r.bytes(t.Data)),o.lengthDelimited!==!1&&r.ldelim()},(t,r,o={})=>{const l={},u=r==null?t.len:t.pos+r;for(;t.pos<u;){const f=t.uint32();switch(f>>>3){case 1:{l.Type=nt.codec().decode(t);break}case 2:{l.Data=t.bytes();break}default:{t.skipType(f&7);break}}}return l})),e),n.encode=t=>Gn(t,n.codec()),n.decode=(t,r)=>jn(t,n.codec(),r)})(Ii||(Ii={}));var If;(function(n){let e;n.codec=()=>(e==null&&(e=Yn((t,r,o={})=>{o.lengthDelimited!==!1&&r.fork(),t.Type!=null&&(r.uint32(8),nt.codec().encode(t.Type,r)),t.Data!=null&&(r.uint32(18),r.bytes(t.Data)),o.lengthDelimited!==!1&&r.ldelim()},(t,r,o={})=>{const l={},u=r==null?t.len:t.pos+r;for(;t.pos<u;){const f=t.uint32();switch(f>>>3){case 1:{l.Type=nt.codec().decode(t);break}case 2:{l.Data=t.bytes();break}default:{t.skipType(f&7);break}}}return l})),e),n.encode=t=>Gn(t,n.codec()),n.decode=(t,r)=>jn(t,n.codec(),r)})(If||(If={}));function nc(n){if(isNaN(n)||n<=0)throw new ge("random bytes length must be a Number bigger than 0");return sd(n)}const ld=eS;class hy{type="RSA";jwk;_raw;_multihash;constructor(e,t){this.jwk=e,this._multihash=t}get raw(){return this._raw==null&&(this._raw=py(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return Se.createV1(114,this._multihash)}toString(){return St.encode(this.toMultihash().bytes).substring(1)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}verify(e,t,r){return gR(this.jwk,t,e,r)}}class TS{type="RSA";jwk;_raw;publicKey;constructor(e,t){this.jwk=e,this.publicKey=t}get raw(){return this._raw==null&&(this._raw=iR(this.jwk)),this._raw}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}sign(e,t){return hR(this.jwk,e,t)}}const kS=8192,gy=18,tR=1062,nR=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function rR(n){return{n:Ee(n[1],"base64url"),e:Ee(n[2],"base64url"),d:Ee(n[3],"base64url"),p:Ee(n[4],"base64url"),q:Ee(n[5],"base64url"),dp:Ee(n[6],"base64url"),dq:Ee(n[7],"base64url"),qi:Ee(n[8],"base64url"),kty:"RSA"}}function iR(n){if(n.n==null||n.e==null||n.d==null||n.p==null||n.q==null||n.dp==null||n.dq==null||n.qi==null)throw new ge("JWK was missing components");return Ur([yn(Uint8Array.from([0])),yn(de(n.n,"base64url")),yn(de(n.e,"base64url")),yn(de(n.d,"base64url")),yn(de(n.p,"base64url")),yn(de(n.q,"base64url")),yn(de(n.dp,"base64url")),yn(de(n.dq,"base64url")),yn(de(n.qi,"base64url"))]).subarray()}function sR(n){const e=Bs(n[1],{offset:0});return{kty:"RSA",n:Ee(e[0],"base64url"),e:Ee(e[1],"base64url")}}function py(n){if(n.n==null||n.e==null)throw new ge("JWK was missing components");return Ur([nR,iy(Ur([yn(de(n.n,"base64url")),yn(de(n.e,"base64url"))]))]).subarray()}function oR(n){const e=Bs(n);return CS(e)}function CS(n){const e=rR(n);return cR(e)}function aR(n,e){if(n.byteLength>=tR)throw new g2("Key size is too large");const t=Bs(n,{offset:0});return lR(t,n,e)}function lR(n,e,t){const r=sR(n);if(t==null){const o=ld(Ii.encode({Type:nt.RSA,Data:e}));t=wa(gy,o)}return new hy(r,t)}function cR(n){if(mR(n)>kS)throw new ge("Key size is too large");const e=fR(n),t=ld(Ii.encode({Type:nt.RSA,Data:py(e.publicKey)})),r=wa(gy,t);return new TS(e.privateKey,new hy(e.publicKey,r))}async function uR(n){if(n>kS)throw new ge("Key size is too large");const e=await dR(n),t=ld(Ii.encode({Type:nt.RSA,Data:py(e.publicKey)})),r=wa(gy,t);return new TS(e.privateKey,new hy(e.publicKey,r))}function fR(n){if(n==null)throw new ge("Missing key parameter");return{privateKey:n,publicKey:{kty:n.kty,n:n.n,e:n.e}}}async function dR(n,e){const t=await Zt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await pR(t);return{privateKey:r[0],publicKey:r[1]}}async function hR(n,e,t){const r=await Zt.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]);t?.signal?.throwIfAborted();const o=await Zt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return t?.signal?.throwIfAborted(),new Uint8Array(o,0,o.byteLength)}async function gR(n,e,t,r){const o=await Zt.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);r?.signal?.throwIfAborted();const l=await Zt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},o,e,t instanceof Uint8Array?t:t.subarray());return r?.signal?.throwIfAborted(),l}async function pR(n,e){if(n.privateKey==null||n.publicKey==null)throw new ge("Private and public key are required");return await Promise.all([Zt.get().subtle.exportKey("jwk",n.privateKey),Zt.get().subtle.exportKey("jwk",n.publicKey)])}function mR(n){if(n.kty!=="RSA")throw new ge("invalid key type");if(n.n==null)throw new ge("invalid key modulus");return de(n.n,"base64url").length*8}class NS extends X2{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,sy(e);const r=oy(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,l=new Uint8Array(o);l.set(r.length>o?e.create().update(r).digest():r);for(let u=0;u<l.length;u++)l[u]^=54;this.iHash.update(l),this.oHash=e.create();for(let u=0;u<l.length;u++)l[u]^=106;this.oHash.update(l),$r(l)}update(e){return Cf(this),this.iHash.update(e),this}digestInto(e){Cf(this),Pi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:o,destroyed:l,blockLen:u,outputLen:f}=this;return e=e,e.finished=o,e.destroyed=l,e.blockLen=u,e.outputLen=f,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const my=(n,e,t)=>new NS(n,e).update(t).digest();my.create=(n,e)=>new NS(n,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const J1=(n,e)=>(n+(n>=0?e:-e)/BS)/e;function yR(n,e,t){const[[r,o],[l,u]]=e,f=J1(u*n,t),h=J1(-o*n,t);let p=n-f*r-h*l,m=-f*o-h*u;const y=p<Or,b=m<Or;y&&(p=-p),b&&(m=-m);const E=bc(Math.ceil(iS(t)/2))+jo;if(p<Or||p>=E||m<Or||m>=E)throw new Error("splitScalar (endomorphism): failed, k="+n);return{k1neg:y,k1:p,k2neg:b,k2:m}}function om(n){if(!["compact","recovered","der"].includes(n))throw new Error('Signature format must be "compact", "recovered", or "der"');return n}function lp(n,e){const t={};for(let r of Object.keys(e))t[r]=n[r]===void 0?e[r]:n[r];return As(t.lowS,"lowS"),As(t.prehash,"prehash"),t.format!==void 0&&om(t.format),t}class bR extends Error{constructor(e=""){super(e)}}const Ir={Err:bR,_tlv:{encode:(n,e)=>{const{Err:t}=Ir;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const r=e.length/2,o=Qu(r);if(o.length/2&128)throw new t("tlv.encode: long form length too big");const l=r>127?Qu(o.length/2|128):"";return Qu(n)+l+o+e},decode(n,e){const{Err:t}=Ir;let r=0;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[r++]!==n)throw new t("tlv.decode: wrong tlv");const o=e[r++],l=!!(o&128);let u=0;if(!l)u=o;else{const h=o&127;if(!h)throw new t("tlv.decode(long): indefinite length not supported");if(h>4)throw new t("tlv.decode(long): byte length is too big");const p=e.subarray(r,r+h);if(p.length!==h)throw new t("tlv.decode: length bytes not complete");if(p[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const m of p)u=u<<8|m;if(r+=h,u<128)throw new t("tlv.decode(long): not minimal encoding")}const f=e.subarray(r,r+u);if(f.length!==u)throw new t("tlv.decode: wrong value length");return{v:f,l:e.subarray(r+u)}}},_int:{encode(n){const{Err:e}=Ir;if(n<Or)throw new e("integer: negative integers are not allowed");let t=Qu(n);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(n){const{Err:e}=Ir;if(n[0]&128)throw new e("invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return od(n)}},toSig(n){const{Err:e,_int:t,_tlv:r}=Ir,o=dt("signature",n),{v:l,l:u}=r.decode(48,o);if(u.length)throw new e("invalid signature: left bytes after parsing");const{v:f,l:h}=r.decode(2,l),{v:p,l:m}=r.decode(2,h);if(m.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(f),s:t.decode(p)}},hexFromSig(n){const{_tlv:e,_int:t}=Ir,r=e.encode(2,t.encode(n.r)),o=e.encode(2,t.encode(n.s)),l=r+o;return e.encode(48,l)}},Or=BigInt(0),jo=BigInt(1),BS=BigInt(2),Ju=BigInt(3),wR=BigInt(4);function Io(n,e){const{BYTES:t}=n;let r;if(typeof e=="bigint")r=e;else{let o=dt("private key",e);try{r=n.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${t}, got ${typeof e}`)}}if(!n.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function vR(n,e={}){const t=vS("weierstrass",n,e),{Fp:r,Fn:o}=t;let l=t.CURVE;const{h:u,n:f}=l;wc(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:h}=e;if(h&&(!r.is0(l.a)||typeof h.beta!="bigint"||!Array.isArray(h.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const p=RS(r,o);function m(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function y(Y,U,M){const{x:D,y:S}=U.toAffine(),I=r.toBytes(D);if(As(M,"isCompressed"),M){m();const L=!r.isOdd(S);return ar(DS(L),I)}else return ar(Uint8Array.of(4),I,r.toBytes(S))}function b(Y){Fn(Y,void 0,"Point");const{publicKey:U,publicKeyUncompressed:M}=p,D=Y.length,S=Y[0],I=Y.subarray(1);if(D===U&&(S===2||S===3)){const L=r.fromBytes(I);if(!r.isValid(L))throw new Error("bad point: is not on curve, wrong x");const ie=k(L);let A;try{A=r.sqrt(ie)}catch(ne){const se=ne instanceof Error?": "+ne.message:"";throw new Error("bad point: is not on curve, sqrt error"+se)}m();const $=r.isOdd(A);return(S&1)===1!==$&&(A=r.neg(A)),{x:L,y:A}}else if(D===M&&S===4){const L=r.BYTES,ie=r.fromBytes(I.subarray(0,L)),A=r.fromBytes(I.subarray(L,L*2));if(!_(ie,A))throw new Error("bad point: is not on curve");return{x:ie,y:A}}else throw new Error(`bad point: got length ${D}, expected compressed=${U} or uncompressed=${M}`)}const E=e.toBytes||y,x=e.fromBytes||b;function k(Y){const U=r.sqr(Y),M=r.mul(U,Y);return r.add(r.add(M,r.mul(Y,l.a)),l.b)}function _(Y,U){const M=r.sqr(U),D=k(Y);return r.eql(M,D)}if(!_(l.Gx,l.Gy))throw new Error("bad curve params: generator point");const R=r.mul(r.pow(l.a,Ju),wR),j=r.mul(r.sqr(l.b),BigInt(27));if(r.is0(r.add(R,j)))throw new Error("bad curve params: a or b");function C(Y,U,M=!1){if(!r.isValid(U)||M&&r.is0(U))throw new Error(`bad point coordinate ${Y}`);return U}function Z(Y){if(!(Y instanceof B))throw new Error("ProjectivePoint expected")}function Q(Y){if(!h||!h.basises)throw new Error("no endo");return yR(Y,h.basises,o.ORDER)}const re=Bf((Y,U)=>{const{X:M,Y:D,Z:S}=Y;if(r.eql(S,r.ONE))return{x:M,y:D};const I=Y.is0();U==null&&(U=I?r.ONE:r.inv(S));const L=r.mul(M,U),ie=r.mul(D,U),A=r.mul(S,U);if(I)return{x:r.ZERO,y:r.ZERO};if(!r.eql(A,r.ONE))throw new Error("invZ was invalid");return{x:L,y:ie}}),oe=Bf(Y=>{if(Y.is0()){if(e.allowInfinityPoint&&!r.is0(Y.Y))return;throw new Error("bad point: ZERO")}const{x:U,y:M}=Y.toAffine();if(!r.isValid(U)||!r.isValid(M))throw new Error("bad point: x or y not field elements");if(!_(U,M))throw new Error("bad point: equation left != right");if(!Y.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function H(Y,U,M,D,S){return M=new B(r.mul(M.X,Y),M.Y,M.Z),U=Df(D,U),M=Df(S,M),U.add(M)}class B{constructor(U,M,D){this.X=C("x",U),this.Y=C("y",M,!0),this.Z=C("z",D),Object.freeze(this)}static CURVE(){return l}static fromAffine(U){const{x:M,y:D}=U||{};if(!U||!r.isValid(M)||!r.isValid(D))throw new Error("invalid affine point");if(U instanceof B)throw new Error("projective point not allowed");return r.is0(M)&&r.is0(D)?B.ZERO:new B(M,D,r.ONE)}static fromBytes(U){const M=B.fromAffine(x(Fn(U,void 0,"point")));return M.assertValidity(),M}static fromHex(U){return B.fromBytes(dt("pointHex",U))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(U=8,M=!0){return te.createCache(this,U),M||this.multiply(Ju),this}assertValidity(){oe(this)}hasEvenY(){const{y:U}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(U)}equals(U){Z(U);const{X:M,Y:D,Z:S}=this,{X:I,Y:L,Z:ie}=U,A=r.eql(r.mul(M,ie),r.mul(I,S)),$=r.eql(r.mul(D,ie),r.mul(L,S));return A&&$}negate(){return new B(this.X,r.neg(this.Y),this.Z)}double(){const{a:U,b:M}=l,D=r.mul(M,Ju),{X:S,Y:I,Z:L}=this;let ie=r.ZERO,A=r.ZERO,$=r.ZERO,W=r.mul(S,S),ne=r.mul(I,I),se=r.mul(L,L),ue=r.mul(S,I);return ue=r.add(ue,ue),$=r.mul(S,L),$=r.add($,$),ie=r.mul(U,$),A=r.mul(D,se),A=r.add(ie,A),ie=r.sub(ne,A),A=r.add(ne,A),A=r.mul(ie,A),ie=r.mul(ue,ie),$=r.mul(D,$),se=r.mul(U,se),ue=r.sub(W,se),ue=r.mul(U,ue),ue=r.add(ue,$),$=r.add(W,W),W=r.add($,W),W=r.add(W,se),W=r.mul(W,ue),A=r.add(A,W),se=r.mul(I,L),se=r.add(se,se),W=r.mul(se,ue),ie=r.sub(ie,W),$=r.mul(se,ne),$=r.add($,$),$=r.add($,$),new B(ie,A,$)}add(U){Z(U);const{X:M,Y:D,Z:S}=this,{X:I,Y:L,Z:ie}=U;let A=r.ZERO,$=r.ZERO,W=r.ZERO;const ne=l.a,se=r.mul(l.b,Ju);let ue=r.mul(M,I),fe=r.mul(D,L),ve=r.mul(S,ie),ke=r.add(M,D),Ie=r.add(I,L);ke=r.mul(ke,Ie),Ie=r.add(ue,fe),ke=r.sub(ke,Ie),Ie=r.add(M,S);let Je=r.add(I,ie);return Ie=r.mul(Ie,Je),Je=r.add(ue,ve),Ie=r.sub(Ie,Je),Je=r.add(D,S),A=r.add(L,ie),Je=r.mul(Je,A),A=r.add(fe,ve),Je=r.sub(Je,A),W=r.mul(ne,Ie),A=r.mul(se,ve),W=r.add(A,W),A=r.sub(fe,W),W=r.add(fe,W),$=r.mul(A,W),fe=r.add(ue,ue),fe=r.add(fe,ue),ve=r.mul(ne,ve),Ie=r.mul(se,Ie),fe=r.add(fe,ve),ve=r.sub(ue,ve),ve=r.mul(ne,ve),Ie=r.add(Ie,ve),ue=r.mul(fe,Ie),$=r.add($,ue),ue=r.mul(Je,Ie),A=r.mul(ke,A),A=r.sub(A,ue),ue=r.mul(ke,fe),W=r.mul(Je,W),W=r.add(W,ue),new B(A,$,W)}subtract(U){return this.add(U.negate())}is0(){return this.equals(B.ZERO)}multiply(U){const{endo:M}=e;if(!o.isValidNot0(U))throw new Error("invalid scalar: out of range");let D,S;const I=L=>te.cached(this,L,ie=>ps(B,ie));if(M){const{k1neg:L,k1:ie,k2neg:A,k2:$}=Q(U),{p:W,f:ne}=I(ie),{p:se,f:ue}=I($);S=ne.add(ue),D=H(M.beta,W,se,L,A)}else{const{p:L,f:ie}=I(U);D=L,S=ie}return ps(B,[D,S])[0]}multiplyUnsafe(U){const{endo:M}=e,D=this;if(!o.isValid(U))throw new Error("invalid scalar: out of range");if(U===Or||D.is0())return B.ZERO;if(U===jo)return D;if(te.hasCache(this))return this.multiply(U);if(M){const{k1neg:S,k1:I,k2neg:L,k2:ie}=Q(U),{p1:A,p2:$}=ND(B,D,I,ie);return H(M.beta,A,$,S,L)}else return te.unsafe(D,U)}multiplyAndAddUnsafe(U,M,D){const S=this.multiplyUnsafe(M).add(U.multiplyUnsafe(D));return S.is0()?void 0:S}toAffine(U){return re(this,U)}isTorsionFree(){const{isTorsionFree:U}=e;return u===jo?!0:U?U(B,this):te.unsafe(this,f).is0()}clearCofactor(){const{clearCofactor:U}=e;return u===jo?this:U?U(B,this):this.multiplyUnsafe(u)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}toBytes(U=!0){return As(U,"isCompressed"),this.assertValidity(),E(B,this,U)}toHex(U=!0){return Es(this.toBytes(U))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(U=!0){return this.toBytes(U)}_setWindowSize(U){this.precompute(U)}static normalizeZ(U){return ps(B,U)}static msm(U,M){return wS(B,o,U,M)}static fromPrivateKey(U){return B.BASE.multiply(Io(o,U))}}B.BASE=new B(l.Gx,l.Gy,r.ONE),B.ZERO=new B(r.ZERO,r.ONE,r.ZERO),B.Fp=r,B.Fn=o;const G=o.BITS,te=new bS(B,e.endo?Math.ceil(G/2):G);return B.BASE.precompute(8),B}function DS(n){return Uint8Array.of(n?2:3)}function RS(n,e){return{secretKey:e.BYTES,publicKey:1+n.BYTES,publicKeyUncompressed:1+2*n.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function ER(n,e={}){const{Fn:t}=n,r=e.randomBytes||sd,o=Object.assign(RS(n.Fp,t),{seed:pS(t.ORDER)});function l(E){try{return!!Io(t,E)}catch{return!1}}function u(E,x){const{publicKey:k,publicKeyUncompressed:_}=o;try{const R=E.length;return x===!0&&R!==k||x===!1&&R!==_?!1:!!n.fromBytes(E)}catch{return!1}}function f(E=r(o.seed)){return TD(Fn(E,o.seed,"seed"),t.ORDER)}function h(E,x=!0){return n.BASE.multiply(Io(t,E)).toBytes(x)}function p(E){const x=f(E);return{secretKey:x,publicKey:h(x)}}function m(E){if(typeof E=="bigint")return!1;if(E instanceof n)return!0;const{secretKey:x,publicKey:k,publicKeyUncompressed:_}=o;if(t.allowedLengths||x===k)return;const R=dt("key",E).length;return R===k||R===_}function y(E,x,k=!0){if(m(E)===!0)throw new Error("first arg must be private key");if(m(x)===!1)throw new Error("second arg must be public key");const _=Io(t,E);return n.fromHex(x).multiply(_).toBytes(k)}return Object.freeze({getPublicKey:h,getSharedSecret:y,keygen:p,Point:n,utils:{isValidSecretKey:l,isValidPublicKey:u,randomSecretKey:f,isValidPrivateKey:l,randomPrivateKey:f,normPrivateKeyToScalar:E=>Io(t,E),precompute(E=8,x=n.BASE){return x.precompute(E,!1)}},lengths:o})}function xR(n,e,t={}){sy(e),wc(t,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=t.randomBytes||sd,o=t.hmac||((M,...D)=>my(e,M,ar(...D))),{Fp:l,Fn:u}=n,{ORDER:f,BITS:h}=u,{keygen:p,getPublicKey:m,getSharedSecret:y,utils:b,lengths:E}=ER(n,t),x={prehash:!1,lowS:typeof t.lowS=="boolean"?t.lowS:!1,format:void 0,extraEntropy:!1},k="compact";function _(M){const D=f>>jo;return M>D}function R(M,D){if(!u.isValidNot0(D))throw new Error(`invalid signature ${M}: out of range 1..Point.Fn.ORDER`);return D}function j(M,D){om(D);const S=E.signature,I=D==="compact"?S:D==="recovered"?S+1:void 0;return Fn(M,I,`${D} signature`)}class C{constructor(D,S,I){this.r=R("r",D),this.s=R("s",S),I!=null&&(this.recovery=I),Object.freeze(this)}static fromBytes(D,S=k){j(D,S);let I;if(S==="der"){const{r:$,s:W}=Ir.toSig(Fn(D));return new C($,W)}S==="recovered"&&(I=D[0],S="compact",D=D.subarray(1));const L=u.BYTES,ie=D.subarray(0,L),A=D.subarray(L,L*2);return new C(u.fromBytes(ie),u.fromBytes(A),I)}static fromHex(D,S){return this.fromBytes(Nf(D),S)}addRecoveryBit(D){return new C(this.r,this.s,D)}recoverPublicKey(D){const S=l.ORDER,{r:I,s:L,recovery:ie}=this;if(ie==null||![0,1,2,3].includes(ie))throw new Error("recovery id invalid");if(f*BS<S&&ie>1)throw new Error("recovery id is ambiguous for h>1 curve");const $=ie===2||ie===3?I+f:I;if(!l.isValid($))throw new Error("recovery id 2 or 3 invalid");const W=l.toBytes($),ne=n.fromBytes(ar(DS((ie&1)===0),W)),se=u.inv($),ue=Q(dt("msgHash",D)),fe=u.create(-ue*se),ve=u.create(L*se),ke=n.BASE.multiplyUnsafe(fe).add(ne.multiplyUnsafe(ve));if(ke.is0())throw new Error("point at infinify");return ke.assertValidity(),ke}hasHighS(){return _(this.s)}toBytes(D=k){if(om(D),D==="der")return Nf(Ir.hexFromSig(this));const S=u.toBytes(this.r),I=u.toBytes(this.s);if(D==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return ar(Uint8Array.of(this.recovery),S,I)}return ar(S,I)}toHex(D){return Es(this.toBytes(D))}assertValidity(){}static fromCompact(D){return C.fromBytes(dt("sig",D),"compact")}static fromDER(D){return C.fromBytes(dt("sig",D),"der")}normalizeS(){return this.hasHighS()?new C(this.r,u.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Es(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Es(this.toBytes("compact"))}}const Z=t.bits2int||function(D){if(D.length>8192)throw new Error("input is too large");const S=od(D),I=D.length*8-h;return I>0?S>>BigInt(I):S},Q=t.bits2int_modN||function(D){return u.create(Z(D))},re=bc(h);function oe(M){return nm("num < 2^"+h,M,Or,re),u.toBytes(M)}function H(M,D){return Fn(M,void 0,"message"),D?Fn(e(M),void 0,"prehashed message"):M}function B(M,D,S){if(["recovered","canonical"].some(fe=>fe in S))throw new Error("sign() legacy options not supported");const{lowS:I,prehash:L,extraEntropy:ie}=lp(S,x);M=H(M,L);const A=Q(M),$=Io(u,D),W=[oe($),oe(A)];if(ie!=null&&ie!==!1){const fe=ie===!0?r(E.secretKey):ie;W.push(dt("extraEntropy",fe))}const ne=ar(...W),se=A;function ue(fe){const ve=Z(fe);if(!u.isValidNot0(ve))return;const ke=u.inv(ve),Ie=n.BASE.multiply(ve).toAffine(),Je=u.create(Ie.x);if(Je===Or)return;const an=u.create(ke*u.create(se+Je*$));if(an===Or)return;let In=(Ie.x===Je?0:2)|Number(Ie.y&jo),zs=an;return I&&_(an)&&(zs=u.neg(an),In^=1),new C(Je,zs,In)}return{seed:ne,k2sig:ue}}function G(M,D,S={}){M=dt("message",M);const{seed:I,k2sig:L}=B(M,D,S);return mD(e.outputLen,u.BYTES,o)(I,L)}function te(M){let D;const S=typeof M=="string"||yc(M),I=!S&&M!==null&&typeof M=="object"&&typeof M.r=="bigint"&&typeof M.s=="bigint";if(!S&&!I)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(I)D=new C(M.r,M.s);else if(S){try{D=C.fromBytes(dt("sig",M),"der")}catch(L){if(!(L instanceof Ir.Err))throw L}if(!D)try{D=C.fromBytes(dt("sig",M),"compact")}catch{return!1}}return D||!1}function Y(M,D,S,I={}){const{lowS:L,prehash:ie,format:A}=lp(I,x);if(S=dt("publicKey",S),D=H(dt("message",D),ie),"strict"in I)throw new Error("options.strict was renamed to lowS");const $=A===void 0?te(M):C.fromBytes(dt("sig",M),A);if($===!1)return!1;try{const W=n.fromBytes(S);if(L&&$.hasHighS())return!1;const{r:ne,s:se}=$,ue=Q(D),fe=u.inv(se),ve=u.create(ue*fe),ke=u.create(ne*fe),Ie=n.BASE.multiplyUnsafe(ve).add(W.multiplyUnsafe(ke));return Ie.is0()?!1:u.create(Ie.x)===ne}catch{return!1}}function U(M,D,S={}){const{prehash:I}=lp(S,x);return D=H(D,I),C.fromBytes(M,"recovered").recoverPublicKey(D).toBytes()}return Object.freeze({keygen:p,getPublicKey:m,getSharedSecret:y,utils:b,lengths:E,Point:n,sign:G,verify:Y,recoverPublicKey:U,Signature:C,hash:e})}function SR(n){const e={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},t=n.Fp;let r=n.allowedPrivateKeyLengths?Array.from(new Set(n.allowedPrivateKeyLengths.map(u=>Math.ceil(u/2)))):void 0;const o=Ds(e.n,{BITS:n.nBitLength,allowedLengths:r,modFromBytes:n.wrapPrivateKey}),l={Fp:t,Fn:o,allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes};return{CURVE:e,curveOpts:l}}function AR(n){const{CURVE:e,curveOpts:t}=SR(n),r={hmac:n.hmac,randomBytes:n.randomBytes,lowS:n.lowS,bits2int:n.bits2int,bits2int_modN:n.bits2int_modN};return{CURVE:e,curveOpts:t,hash:n.hash,ecdsaOpts:r}}function _R(n,e){const t=e.Point;return Object.assign({},e,{ProjectivePoint:t,CURVE:Object.assign({},n,hS(t.Fn.ORDER,t.Fn.BITS))})}function TR(n){const{CURVE:e,curveOpts:t,hash:r,ecdsaOpts:o}=AR(n),l=vR(e,t),u=xR(l,r,o);return _R(n,u)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function kR(n,e){const t=r=>TR({...n,hash:r});return{...t(e),create:t}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yy={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},CR={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},W1=BigInt(2);function NR(n){const e=yy.p,t=BigInt(3),r=BigInt(6),o=BigInt(11),l=BigInt(22),u=BigInt(23),f=BigInt(44),h=BigInt(88),p=n*n*n%e,m=p*p*n%e,y=ft(m,t,e)*m%e,b=ft(y,t,e)*m%e,E=ft(b,W1,e)*p%e,x=ft(E,o,e)*E%e,k=ft(x,l,e)*x%e,_=ft(k,f,e)*k%e,R=ft(_,h,e)*_%e,j=ft(R,f,e)*k%e,C=ft(j,t,e)*m%e,Z=ft(C,u,e)*x%e,Q=ft(Z,r,e)*p%e,re=ft(Q,W1,e);if(!am.eql(am.sqr(re),n))throw new Error("Cannot find square root");return re}const am=Ds(yy.p,{sqrt:NR}),Hr=kR({...yy,Fp:am,lowS:!0,endo:CR},eS),BR=32;function DR(n,e,t){const r=na.digest(e instanceof Uint8Array?e:e.subarray());if(ad(r))return r.then(({digest:o})=>(t?.signal?.throwIfAborted(),Hr.sign(o,n).toDERRawBytes())).catch(o=>{throw o.name==="AbortError"?o:new X1(String(o))});try{return Hr.sign(r.digest,n).toDERRawBytes()}catch(o){throw new X1(String(o))}}function RR(n,e,t,r){const o=na.digest(t instanceof Uint8Array?t:t.subarray());if(ad(o))return o.then(({digest:l})=>(r?.signal?.throwIfAborted(),Hr.verify(e,l,n))).catch(l=>{throw l.name==="AbortError"?l:new Q1(String(l))});try{return r?.signal?.throwIfAborted(),Hr.verify(e,o.digest,n)}catch(l){throw new Q1(String(l))}}class MS{type="secp256k1";raw;_key;constructor(e){this._key=LR(e),this.raw=IR(this._key)}toMultihash(){return Mi.digest(Di(this))}toCID(){return Se.createV1(114,this.toMultihash())}toString(){return St.encode(this.toMultihash().bytes).substring(1)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}verify(e,t,r){return RR(this._key,t,e,r)}}class IS{type="secp256k1";raw;publicKey;constructor(e,t){this.raw=OR(e),this.publicKey=new MS(t??UR(e))}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:et(this.raw,e.raw)}sign(e,t){return DR(this.raw,e,t)}}function OS(n){return new IS(n)}function LS(n){return new MS(n)}async function MR(){const n=PR();return new IS(n)}function IR(n){return Hr.ProjectivePoint.fromHex(n).toRawBytes(!0)}function OR(n){try{return Hr.getPublicKey(n,!0),n}catch(e){throw new p2(String(e))}}function LR(n){try{return Hr.ProjectivePoint.fromHex(n),n}catch(e){throw new g2(String(e))}}function UR(n){try{return Hr.getPublicKey(n,!0)}catch(e){throw new p2(String(e))}}function PR(){return Hr.utils.randomPrivateKey()}async function US(n,e){if(n==="Ed25519")return eR();if(n==="secp256k1")return MR();if(n==="RSA")return uR(VR());if(n==="ECDSA")return ZB($R());throw new ya}function cd(n,e){const{Type:t,Data:r}=Ii.decode(n),o=r??new Uint8Array;switch(t){case nt.RSA:return aR(o,e);case nt.Ed25519:return _S(o);case nt.secp256k1:return LS(o);case nt.ECDSA:return j2(o);default:throw new ya}}function PS(n){const{Type:e,Data:t}=Ii.decode(n.digest),r=t??new Uint8Array;switch(e){case nt.Ed25519:return _S(r);case nt.secp256k1:return LS(r);case nt.ECDSA:return j2(r);default:throw new ya}}function Di(n){return Ii.encode({Type:nt[n.type],Data:n.raw})}function by(n){const e=If.decode(n),t=e.Data??new Uint8Array;switch(e.Type){case nt.RSA:return oR(t);case nt.Ed25519:return AS(t);case nt.secp256k1:return OS(t);case nt.ECDSA:return KB(t);default:throw new ya}}function zR(n){if(n.byteLength===or)return AS(n);if(n.byteLength===BR)return OS(n);const e=Bs(n),t=e[2]?.[0];if(t===LB||t===UB||t===PB)return K2(e);if(e.length>8)return CS(e);throw new ge("Could not extract private key from raw bytes")}function vc(n){return If.encode({Type:nt[n.type],Data:n.raw})}function VR(n){return 2048}function $R(n){return"P-256"}const zS=Symbol.for("nodejs.util.inspect.custom"),HR=114;class wy{type;multihash;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Fm]=!0;toString(){return this.string==null&&(this.string=St.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return Se.createV1(HR,this.multihash)}toJSON(){return this.toString()}equals(e){if(e==null)return!1;if(e instanceof Uint8Array)return et(this.multihash.bytes,e);if(typeof e=="string")return this.toString()===e;if(e?.toMultihash()?.bytes!=null)return et(this.multihash.bytes,e.toMultihash().bytes);throw new Error("not valid Id")}[zS](){return`PeerId(${this.toString()})`}}class VS extends wy{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class $S extends wy{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.publicKey}}class HS extends wy{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.publicKey}}const qR=2336;class qS{type="url";multihash;publicKey;url;constructor(e){this.url=e.toString(),this.multihash=Mi.digest(de(this.url))}[zS](){return`PeerId(${this.url})`}[Fm]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return Se.createV1(qR,this.toMultihash())}toJSON(){return this.toString()}equals(e){return e==null?!1:(e instanceof Uint8Array&&(e=Ee(e)),e.toString()===this.toString())}}const FR=114,eE=2336;function _s(n,e){let t;if(n.charAt(0)==="1"||n.charAt(0)==="Q")t=va(St.decode(`z${n}`));else{if(n.startsWith("k51qzi5uqu5")||n.startsWith("kzwfwjn5ji4")||n.startsWith("k2k4r8")||n.startsWith("bafz"))return fd(Se.parse(n));throw new ge('Please pass a multibase decoder for strings that do not start with "1" or "Q"')}return ud(t)}function FS(n){if(n.type==="Ed25519")return new $S({multihash:n.toCID().multihash,publicKey:n});if(n.type==="secp256k1")return new HS({multihash:n.toCID().multihash,publicKey:n});if(n.type==="RSA")return new VS({multihash:n.toCID().multihash,publicKey:n});throw new ya}function KS(n){return FS(n.publicKey)}function ud(n){if(jR(n))return new VS({multihash:n});if(KR(n))try{const e=PS(n);if(e.type==="Ed25519")return new $S({multihash:n,publicKey:e});if(e.type==="secp256k1")return new HS({multihash:n,publicKey:e})}catch{const t=Ee(n.digest);return new qS(new URL(t))}throw new jm("Supplied PeerID Multihash is invalid")}function fd(n){if(n?.multihash==null||n.version==null||n.version===1&&n.code!==FR&&n.code!==eE)throw new s8("Supplied PeerID CID is invalid");if(n.code===eE){const e=Ee(n.multihash.digest);return new qS(new URL(e))}return ud(n.multihash)}function KR(n){return n.code===Mi.code}function jR(n){return n.code===na.code}function Kl(n,e){const t={[Symbol.iterator]:()=>t,next:()=>{const r=n.next(),o=r.value;return r.done===!0||o==null?{done:!0,value:void 0}:{done:!1,value:e(o)}}};return t}function cp(n){const e=va(St.decode(`z${n}`));return ud(e)}class Ec{map;constructor(e){if(this.map=new Map,e!=null)for(const[t,r]of e.entries())this.map.set(t.toString(),{key:t,value:r})}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){return this.map.delete(e.toString())}entries(){return Kl(this.map.entries(),e=>[e[1].key,e[1].value])}forEach(e){this.map.forEach((t,r)=>{e(t.value,t.key,this)})}get(e){return this.map.get(e.toString())?.value}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),{key:e,value:t})}keys(){return Kl(this.map.values(),e=>e.key)}values(){return Kl(this.map.values(),e=>e.value)}get size(){return this.map.size}}class Go{set;constructor(e){if(this.set=new Set,e!=null)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return Kl(this.set.entries(),e=>{const t=cp(e[0]);return[t,t]})}forEach(e){this.set.forEach(t=>{const r=cp(t);e(r,r,this)})}has(e){return this.set.has(e.toString())}values(){return Kl(this.set.values(),e=>cp(e))}intersection(e){const t=new Go;for(const r of e)this.has(r)&&t.add(r);return t}difference(e){const t=new Go;for(const r of this)e.has(r)||t.add(r);return t}union(e){const t=new Go;for(const r of e)t.add(r);for(const r of this)t.add(r);return t}}function jS(n,e,t,r){sy(n);const o=eD({dkLen:32,asyncTick:10},r),{c:l,dkLen:u,asyncTick:f}=o;if(Fo(l),Fo(u),Fo(f),l<1)throw new Error("iterations (c) should be >= 1");const h=P1(e),p=P1(t),m=new Uint8Array(u),y=my.create(n,h),b=y._cloneInto().update(p);return{c:l,dkLen:u,asyncTick:f,DK:m,PRF:y,PRFSalt:b}}function GS(n,e,t,r,o){return n.destroy(),e.destroy(),r&&r.destroy(),$r(o),t}function GR(n,e,t,r){const{c:o,dkLen:l,DK:u,PRF:f,PRFSalt:h}=jS(n,e,t,r);let p;const m=new Uint8Array(4),y=Fl(m),b=new Uint8Array(f.outputLen);for(let E=1,x=0;x<l;E++,x+=f.outputLen){const k=u.subarray(x,x+f.outputLen);y.setInt32(0,E,!1),(p=h._cloneInto(p)).update(m).digestInto(b),k.set(b.subarray(0,k.length));for(let _=1;_<o;_++){f._cloneInto(p).update(b).digestInto(b);for(let R=0;R<k.length;R++)k[R]^=b[R]}}return GS(f,h,u,p,b)}async function YS(n,e,t,r){const{c:o,dkLen:l,asyncTick:u,DK:f,PRF:h,PRFSalt:p}=jS(n,e,t,r);let m;const y=new Uint8Array(4),b=Fl(y),E=new Uint8Array(h.outputLen);for(let x=1,k=0;k<l;x++,k+=h.outputLen){const _=f.subarray(k,k+h.outputLen);b.setInt32(0,x,!1),(m=p._cloneInto(m)).update(y).digestInto(E),_.set(E.subarray(0,_.length)),await WB(o-1,u,()=>{h._cloneInto(m).update(E).digestInto(E);for(let R=0;R<_.length;R++)_[R]^=E[R]})}return GS(h,p,f,m,E)}const Ml=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),Si=new Uint32Array(80);class YR extends ly{constructor(){super(64,20,8,!1),this.A=Ml[0]|0,this.B=Ml[1]|0,this.C=Ml[2]|0,this.D=Ml[3]|0,this.E=Ml[4]|0}get(){const{A:e,B:t,C:r,D:o,E:l}=this;return[e,t,r,o,l]}set(e,t,r,o,l){this.A=e|0,this.B=t|0,this.C=r|0,this.D=o|0,this.E=l|0}process(e,t){for(let h=0;h<16;h++,t+=4)Si[h]=e.getUint32(t,!1);for(let h=16;h<80;h++)Si[h]=np(Si[h-3]^Si[h-8]^Si[h-14]^Si[h-16],1);let{A:r,B:o,C:l,D:u,E:f}=this;for(let h=0;h<80;h++){let p,m;h<20?(p=Q2(o,l,u),m=1518500249):h<40?(p=o^l^u,m=1859775393):h<60?(p=J2(o,l,u),m=2400959708):(p=o^l^u,m=3395469782);const y=np(r,5)+p+f+m+Si[h]|0;f=u,u=l,l=np(o,30),o=r,r=y}r=r+this.A|0,o=o+this.B|0,l=l+this.C|0,u=u+this.D|0,f=f+this.E|0,this.set(r,o,l,u,f)}roundClean(){$r(Si)}destroy(){this.set(0,0,0,0,0),$r(this.buffer)}}const ZR=ay(()=>new YR),XR=ZR,vy=tS,tE={sha1:XR,"sha2-256":ld,"sha2-512":vy};function nE(n,e,t,r,o){if(o!=="sha1"&&o!=="sha2-256"&&o!=="sha2-512"){const f=Object.keys(tE).join(" / ");throw new ge(`Hash '${o}' is unknown or not supported. Must be ${f}`)}const l=tE[o],u=GR(l,n,e,{c:t,dkLen:r});return Fr.encode(u).substring(1)}const Ey={32:16777619n,64:1099511628211n,128:309485009821345068724781371n,256:374144419156711147060143317175368453031918731002211n,512:35835915874844867368919076489095108449946327955754392558399825615420669938882575126094039892345713852759n,1024:5016456510113118655434598811035278955030765345404790744303017523831112055108147451509157692220295382716162651878526895249385292291816524375083746691371804094271873160484737966720260389217684476157468082573n},ZS={32:2166136261n,64:14695981039346656037n,128:144066263297769815596495629667062367629n,256:100029257958052580907070968620625704837092796014241193945225284501741471925557n,512:9659303129496669498009435400716310466090418745672637896108374329434462657994582932197716438449813051892206539805784495328239340083876191928701583869517785n,1024:14197795064947621068722070641403218320880622795441933960878474914617582723252296732303717722150864096521202355549365628174669108571814760471015076148029755969804077320157692458563003215304957150157403644460363550505412711285966361610267868082893823963790439336411086884584107735010676915n},XS=new globalThis.TextEncoder;function QR(n,e){const t=Ey[e];let r=ZS[e];for(let o=0;o<n.length;o++)r^=BigInt(n[o]),r=BigInt.asUintN(e,r*t);return r}function JR(n,e,t){if(t.length===0)throw new Error("The `utf8Buffer` option must have a length greater than zero");const r=Ey[e];let o=ZS[e],l=n;for(;l.length>0;){const u=XS.encodeInto(l,t);l=l.slice(u.read);for(let f=0;f<u.written;f++)o^=BigInt(t[f]),o=BigInt.asUintN(e,o*r)}return o}function WR(n,{size:e=32,utf8Buffer:t}={}){if(!Ey[e])throw new Error("The `size` option must be one of 32, 64, 128, 256, 512, or 1024");if(typeof n=="string"){if(t)return JR(n,e,t);n=XS.encode(n)}return QR(n,e)}const xy={hash:n=>Number(WR(n,{size:32})),hashV:(n,e)=>eM(xy.hash(n,e))};function eM(n){let e=n.toString(16);return e.length%2===1&&(e=`0${e}`),de(e,"base16")}const QS=64;class ms{fp;h;seed;constructor(e,t,r,o=2){if(o>QS)throw new TypeError("Invalid Fingerprint Size");const l=t.hashV(e,r),u=Ot(o);for(let f=0;f<u.length;f++)u[f]=l[f];u.length===0&&(u[0]=7),this.fp=u,this.h=t,this.seed=r}hash(){return this.h.hash(this.fp,this.seed)}equals(e){return e?.fp instanceof Uint8Array?et(this.fp,e.fp):!1}}function Of(n,e){return Math.floor(Math.random()*(e-n))+n}class Wu{contents;constructor(e){this.contents=new Array(e).fill(null)}has(e){if(!(e instanceof ms))throw new TypeError("Invalid Fingerprint");return this.contents.some(t=>e.equals(t))}add(e){if(!(e instanceof ms))throw new TypeError("Invalid Fingerprint");for(let t=0;t<this.contents.length;t++)if(this.contents[t]==null)return this.contents[t]=e,!0;return!0}swap(e){if(!(e instanceof ms))throw new TypeError("Invalid Fingerprint");const t=Of(0,this.contents.length-1),r=this.contents[t];return this.contents[t]=e,r}remove(e){if(!(e instanceof ms))throw new TypeError("Invalid Fingerprint");const t=this.contents.findIndex(r=>e.equals(r));return t>-1?(this.contents[t]=null,!0):!1}}const tM=500;class rE{bucketSize;filterSize;fingerprintSize;buckets;count;hash;seed;constructor(e){this.filterSize=e.filterSize,this.bucketSize=e.bucketSize??4,this.fingerprintSize=e.fingerprintSize??2,this.count=0,this.buckets=[],this.hash=e.hash??xy,this.seed=e.seed??Of(0,Math.pow(2,10))}add(e){typeof e=="string"&&(e=de(e));const t=new ms(e,this.hash,this.seed,this.fingerprintSize),r=this.hash.hash(e,this.seed)%this.filterSize,o=(r^t.hash())%this.filterSize;if(this.buckets[r]==null&&(this.buckets[r]=new Wu(this.bucketSize)),this.buckets[o]==null&&(this.buckets[o]=new Wu(this.bucketSize)),this.buckets[r].add(t)||this.buckets[o].add(t))return this.count++,!0;const l=[r,o];let u=l[Of(0,l.length-1)];this.buckets[u]==null&&(this.buckets[u]=new Wu(this.bucketSize));for(let f=0;f<tM;f++){const h=this.buckets[u].swap(t);if(h!=null&&(u=(u^h.hash())%this.filterSize,this.buckets[u]==null&&(this.buckets[u]=new Wu(this.bucketSize)),this.buckets[u].add(h)))return this.count++,!0}return!1}has(e){typeof e=="string"&&(e=de(e));const t=new ms(e,this.hash,this.seed,this.fingerprintSize),r=this.hash.hash(e,this.seed)%this.filterSize,o=this.buckets[r]?.has(t)??!1;if(o)return o;const l=(r^t.hash())%this.filterSize;return this.buckets[l]?.has(t)??!1}remove(e){typeof e=="string"&&(e=de(e));const t=new ms(e,this.hash,this.seed,this.fingerprintSize),r=this.hash.hash(e,this.seed)%this.filterSize,o=this.buckets[r]?.remove(t)??!1;if(o)return this.count--,o;const l=(r^t.hash())%this.filterSize,u=this.buckets[l]?.remove(t)??!1;return u&&this.count--,u}get reliable(){return Math.floor(100*(this.count/this.filterSize))<=90}}const nM={1:.5,2:.84,4:.95,8:.98};function rM(n=.001){return n>.002?2:n>1e-5?4:8}function iM(n,e=.001){const t=rM(e),r=nM[t],o=Math.round(n/r),l=Math.min(Math.ceil(Math.log2(1/e)+Math.log2(2*t)),QS);return{filterSize:o,bucketSize:t,fingerprintSize:l}}class sM{filterSize;bucketSize;fingerprintSize;scale;filterSeries;hash;seed;constructor(e){this.bucketSize=e.bucketSize??4,this.filterSize=e.filterSize??(1<<18)/this.bucketSize,this.fingerprintSize=e.fingerprintSize??2,this.scale=e.scale??2,this.hash=e.hash??xy,this.seed=e.seed??Of(0,Math.pow(2,10)),this.filterSeries=[new rE({filterSize:this.filterSize,bucketSize:this.bucketSize,fingerprintSize:this.fingerprintSize,hash:this.hash,seed:this.seed})]}add(e){if(typeof e=="string"&&(e=de(e)),this.has(e))return!0;let t=this.filterSeries.find(r=>r.reliable);if(t==null){const r=this.filterSize*Math.pow(this.scale,this.filterSeries.length);t=new rE({filterSize:r,bucketSize:this.bucketSize,fingerprintSize:this.fingerprintSize,hash:this.hash,seed:this.seed}),this.filterSeries.push(t)}return t.add(e)}has(e){typeof e=="string"&&(e=de(e));for(let t=0;t<this.filterSeries.length;t++)if(this.filterSeries[t].has(e))return!0;return!1}remove(e){typeof e=="string"&&(e=de(e));for(let t=0;t<this.filterSeries.length;t++)if(this.filterSeries[t].remove(e))return!0;return!1}get count(){return this.filterSeries.reduce((e,t)=>e+t.count,0)}}function Sy(n,e=.001,t){return new sM({...iM(n,e)})}class oM extends Ec{metric;constructor(e){super();const{name:t,metrics:r}=e;this.metric=r.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function aM(n){const{name:e,metrics:t}=n;let r;return t!=null?r=new oM({name:e,metrics:t}):r=new Ec,r}const ia=1e3,sa=ia*60,oa=sa*60,Ts=oa*24,rc=Ts*7,aa=Ts*365.25,ic=aa/12;function lM(n,e){if(typeof n=="string")return cM(n);if(typeof n=="number")return dM(n,e);throw Error(`Value provided to ms() must be a string or number. value=${JSON.stringify(n)}`)}var JS=lM;function cM(n){if(typeof n!="string"||n.length===0||n.length>100)throw Error(`Value provided to ms.parse() must be a string with length between 1 and 99. value=${JSON.stringify(n)}`);let e=/^(?<value>-?\d*\.?\d+) *(?<unit>milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)?$/i.exec(n);if(!e?.groups)return NaN;let{value:t,unit:r="ms"}=e.groups,o=parseFloat(t),l=r.toLowerCase();switch(l){case"years":case"year":case"yrs":case"yr":case"y":return o*aa;case"months":case"month":case"mo":return o*ic;case"weeks":case"week":case"w":return o*rc;case"days":case"day":case"d":return o*Ts;case"hours":case"hour":case"hrs":case"hr":case"h":return o*oa;case"minutes":case"minute":case"mins":case"min":case"m":return o*sa;case"seconds":case"second":case"secs":case"sec":case"s":return o*ia;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:throw Error(`Unknown unit "${l}" provided to ms.parse(). value=${JSON.stringify(n)}`)}}function uM(n){let e=Math.abs(n);return e>=aa?`${Math.round(n/aa)}y`:e>=ic?`${Math.round(n/ic)}mo`:e>=rc?`${Math.round(n/rc)}w`:e>=Ts?`${Math.round(n/Ts)}d`:e>=oa?`${Math.round(n/oa)}h`:e>=sa?`${Math.round(n/sa)}m`:e>=ia?`${Math.round(n/ia)}s`:`${n}ms`}function fM(n){let e=Math.abs(n);return e>=aa?ss(n,e,aa,"year"):e>=ic?ss(n,e,ic,"month"):e>=rc?ss(n,e,rc,"week"):e>=Ts?ss(n,e,Ts,"day"):e>=oa?ss(n,e,oa,"hour"):e>=sa?ss(n,e,sa,"minute"):e>=ia?ss(n,e,ia,"second"):`${n} ms`}function dM(n,e){if(typeof n!="number"||!Number.isFinite(n))throw Error("Value provided to ms.format() must be of type number.");return e?.long?fM(n):uM(n)}function ss(n,e,t,r){let o=e>=t*1.5;return`${Math.round(n/t)} ${r}${o?"s":""}`}function hM(n){t.debug=t,t.default=t,t.coerce=h,t.disable=l,t.enable=o,t.enabled=u,t.humanize=JS,t.destroy=p,Object.keys(n).forEach(m=>{t[m]=n[m]}),t.names=[],t.skips=[],t.formatters={};function e(m){let y=0;for(let b=0;b<m.length;b++)y=(y<<5)-y+m.charCodeAt(b),y|=0;return t.colors[Math.abs(y)%t.colors.length]}t.selectColor=e;function t(m){let y,b=null,E,x;function k(..._){if(!k.enabled)return;const R=k,j=Number(new Date),C=j-(y||j);R.diff=C,R.prev=y,R.curr=j,y=j,_[0]=t.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let Z=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(re,oe)=>{if(re==="%%")return"%";Z++;const H=t.formatters[oe];if(typeof H=="function"){const B=_[Z];re=H.call(R,B),_.splice(Z,1),Z--}return re}),t.formatArgs.call(R,_),(R.log||t.log).apply(R,_)}return k.namespace=m,k.useColors=t.useColors(),k.color=t.selectColor(m),k.extend=r,k.destroy=t.destroy,Object.defineProperty(k,"enabled",{enumerable:!0,configurable:!1,get:()=>b!==null?b:(E!==t.namespaces&&(E=t.namespaces,x=t.enabled(m)),x),set:_=>{b=_}}),typeof t.init=="function"&&t.init(k),k}function r(m,y){const b=t(this.namespace+(typeof y>"u"?":":y)+m);return b.log=this.log,b}function o(m){t.save(m),t.namespaces=m,t.names=[],t.skips=[];let y;const b=(typeof m=="string"?m:"").split(/[\s,]+/),E=b.length;for(y=0;y<E;y++)b[y]&&(m=b[y].replace(/\*/g,".*?"),m[0]==="-"?t.skips.push(new RegExp("^"+m.substr(1)+"$")):t.names.push(new RegExp("^"+m+"$")))}function l(){const m=[...t.names.map(f),...t.skips.map(f).map(y=>"-"+y)].join(",");return t.enable(""),m}function u(m){if(m[m.length-1]==="*")return!0;let y,b;for(y=0,b=t.skips.length;y<b;y++)if(t.skips[y].test(m))return!1;for(y=0,b=t.names.length;y<b;y++)if(t.names[y].test(m))return!0;return!1}function f(m){return m.toString().substring(2,m.toString().length-2).replace(/\.\*\?$/,"*")}function h(m){return m instanceof Error?m.stack??m.message:m}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.setupFormatters(t.formatters),t.enable(t.load()),t}var gM={};const Lf=EM(),pM=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function mM(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/(edge|trident)\/(\d+)/)!=null?!1:typeof document<"u"&&document.documentElement?.style?.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/firefox\/(\d+)/)!=null&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/applewebkit\/(\d+)/)}function yM(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+JS(this.diff),!this.useColors)return;const e="color: "+this.color;n.splice(1,0,e,"color: inherit");let t=0,r=0;n[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(r=t))}),n.splice(r,0,e)}const bM=console.debug??console.log??(()=>{});function wM(n){try{n?Lf?.setItem("debug",n):Lf?.removeItem("debug")}catch{}}function vM(){let n;try{n=Lf?.getItem("debug")}catch{}return!n&&typeof globalThis.process<"u"&&"env"in globalThis.process&&(n=gM.DEBUG),n}function EM(){try{return localStorage}catch{}}function xM(n){n.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}const vn=hM({formatArgs:yM,save:wM,load:vM,useColors:mM,setupFormatters:xM,colors:pM,storage:Lf,log:bM});vn.formatters.b=n=>n==null?"undefined":St.baseEncode(n);vn.formatters.t=n=>n==null?"undefined":wn.baseEncode(n);vn.formatters.m=n=>n==null?"undefined":Fr.baseEncode(n);vn.formatters.p=n=>n==null?"undefined":n.toString();vn.formatters.c=n=>n==null?"undefined":n.toString();vn.formatters.k=n=>n==null?"undefined":n.toString();vn.formatters.a=n=>n==null?"undefined":n.toString();vn.formatters.e=n=>n==null?"undefined":iE(n.stack)??iE(n.message)??n.toString();function SM(n){const e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=n,e.destroy=()=>!0,e.extend=()=>e,e}function dd(){return{forComponent(n){return zi(n)}}}function zi(n){let e=SM(`${n}:trace`);return vn.enabled(`${n}:trace`)&&vn.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=vn(`${n}:trace`)),Object.assign(vn(n),{error:vn(`${n}:error`),trace:e,newScope:t=>zi(`${n}:${t}`)})}function iE(n){if(n!=null&&(n=n.trim(),n.length!==0))return n}var up={exports:{}},sE;function AM(){return sE||(sE=1,(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function o(h,p,m){this.fn=h,this.context=p,this.once=m||!1}function l(h,p,m,y,b){if(typeof m!="function")throw new TypeError("The listener must be a function");var E=new o(m,y||h,b),x=t?t+p:p;return h._events[x]?h._events[x].fn?h._events[x]=[h._events[x],E]:h._events[x].push(E):(h._events[x]=E,h._eventsCount++),h}function u(h,p){--h._eventsCount===0?h._events=new r:delete h._events[p]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var p=[],m,y;if(this._eventsCount===0)return p;for(y in m=this._events)e.call(m,y)&&p.push(t?y.slice(1):y);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(m)):p},f.prototype.listeners=function(p){var m=t?t+p:p,y=this._events[m];if(!y)return[];if(y.fn)return[y.fn];for(var b=0,E=y.length,x=new Array(E);b<E;b++)x[b]=y[b].fn;return x},f.prototype.listenerCount=function(p){var m=t?t+p:p,y=this._events[m];return y?y.fn?1:y.length:0},f.prototype.emit=function(p,m,y,b,E,x){var k=t?t+p:p;if(!this._events[k])return!1;var _=this._events[k],R=arguments.length,j,C;if(_.fn){switch(_.once&&this.removeListener(p,_.fn,void 0,!0),R){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,m),!0;case 3:return _.fn.call(_.context,m,y),!0;case 4:return _.fn.call(_.context,m,y,b),!0;case 5:return _.fn.call(_.context,m,y,b,E),!0;case 6:return _.fn.call(_.context,m,y,b,E,x),!0}for(C=1,j=new Array(R-1);C<R;C++)j[C-1]=arguments[C];_.fn.apply(_.context,j)}else{var Z=_.length,Q;for(C=0;C<Z;C++)switch(_[C].once&&this.removeListener(p,_[C].fn,void 0,!0),R){case 1:_[C].fn.call(_[C].context);break;case 2:_[C].fn.call(_[C].context,m);break;case 3:_[C].fn.call(_[C].context,m,y);break;case 4:_[C].fn.call(_[C].context,m,y,b);break;default:if(!j)for(Q=1,j=new Array(R-1);Q<R;Q++)j[Q-1]=arguments[Q];_[C].fn.apply(_[C].context,j)}}return!0},f.prototype.on=function(p,m,y){return l(this,p,m,y,!1)},f.prototype.once=function(p,m,y){return l(this,p,m,y,!0)},f.prototype.removeListener=function(p,m,y,b){var E=t?t+p:p;if(!this._events[E])return this;if(!m)return u(this,E),this;var x=this._events[E];if(x.fn)x.fn===m&&(!b||x.once)&&(!y||x.context===y)&&u(this,E);else{for(var k=0,_=[],R=x.length;k<R;k++)(x[k].fn!==m||b&&!x[k].once||y&&x[k].context!==y)&&_.push(x[k]);_.length?this._events[E]=_.length===1?_[0]:_:u(this,E)}return this},f.prototype.removeAllListeners=function(p){var m;return p?(m=t?t+p:p,this._events[m]&&u(this,m)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=t,f.EventEmitter=f,n.exports=f})(up)),up.exports}var _M=AM();const TM=ha(_M);class WS extends Error{constructor(e){super(e),this.name="TimeoutError"}}let kM=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}};const oE=n=>globalThis.DOMException===void 0?new kM(n):new DOMException(n),aE=n=>{const e=n.reason===void 0?oE("This operation was aborted."):n.reason;return e instanceof Error?e:oE(e)};function CM(n,e){const{milliseconds:t,fallback:r,message:o,customTimers:l={setTimeout,clearTimeout}}=e;let u,f;const p=new Promise((m,y)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(e.signal){const{signal:E}=e;E.aborted&&y(aE(E)),f=()=>{y(aE(E))},E.addEventListener("abort",f,{once:!0})}if(t===Number.POSITIVE_INFINITY){n.then(m,y);return}const b=new WS;u=l.setTimeout.call(void 0,()=>{if(r){try{m(r())}catch(E){y(E)}return}typeof n.cancel=="function"&&n.cancel(),o===!1?m():o instanceof Error?y(o):(b.message=o??`Promise timed out after ${t} milliseconds`,y(b))},t),(async()=>{try{m(await n)}catch(E){y(E)}})()}).finally(()=>{p.clear(),f&&e.signal&&e.signal.removeEventListener("abort",f)});return p.clear=()=>{l.clearTimeout.call(void 0,u),u=void 0},p}function NM(n,e,t){let r=0,o=n.length;for(;o>0;){const l=Math.trunc(o/2);let u=r+l;t(n[u],e)<=0?(r=++u,o-=l+1):o=l}return r}let BM=class{#e=[];enqueue(e,t){t={priority:0,...t};const r={priority:t.priority,id:t.id,run:e};if(this.size===0||this.#e[this.size-1].priority>=t.priority){this.#e.push(r);return}const o=NM(this.#e,r,(l,u)=>u.priority-l.priority);this.#e.splice(o,0,r)}setPriority(e,t){const r=this.#e.findIndex(l=>l.id===e);if(r===-1)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);const[o]=this.#e.splice(r,1);this.enqueue(o.run,{priority:t,id:e})}dequeue(){return this.#e.shift()?.run}filter(e){return this.#e.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this.#e.length}};class eA extends TM{#e;#t;#n=0;#a;#o;#c=0;#i;#u;#r;#p;#s=0;#f;#l;#m;#w=1n;timeout;constructor(e){if(super(),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:BM,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#e=e.carryoverConcurrencyCount,this.#t=e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,this.#a=e.intervalCap,this.#o=e.interval,this.#r=new e.queueClass,this.#p=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#m=e.throwOnTimeout===!0,this.#l=e.autoStart===!1}get#v(){return this.#t||this.#n<this.#a}get#E(){return this.#s<this.#f}#x(){this.#s--,this.#d(),this.emit("next")}#S(){this.#b(),this.#y(),this.#u=void 0}get#A(){const e=Date.now();if(this.#i===void 0){const t=this.#c-e;if(t<0)this.#n=this.#e?this.#s:0;else return this.#u===void 0&&(this.#u=setTimeout(()=>{this.#S()},t)),!0}return!1}#d(){if(this.#r.size===0)return this.#i&&clearInterval(this.#i),this.#i=void 0,this.emit("empty"),this.#s===0&&this.emit("idle"),!1;if(!this.#l){const e=!this.#A;if(this.#v&&this.#E){const t=this.#r.dequeue();return t?(this.emit("active"),t(),e&&this.#y(),!0):!1}}return!1}#y(){this.#t||this.#i!==void 0||(this.#i=setInterval(()=>{this.#b()},this.#o),this.#c=Date.now()+this.#o)}#b(){this.#n===0&&this.#s===0&&this.#i&&(clearInterval(this.#i),this.#i=void 0),this.#n=this.#e?this.#s:0,this.#h()}#h(){for(;this.#d(););}get concurrency(){return this.#f}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#f=e,this.#h()}async#_(e){return new Promise((t,r)=>{e.addEventListener("abort",()=>{r(e.reason)},{once:!0})})}setPriority(e,t){this.#r.setPriority(e,t)}async add(e,t={}){return t.id??=(this.#w++).toString(),t={timeout:this.timeout,throwOnTimeout:this.#m,...t},new Promise((r,o)=>{this.#r.enqueue(async()=>{this.#s++;try{t.signal?.throwIfAborted(),this.#n++;let l=e({signal:t.signal});t.timeout&&(l=CM(Promise.resolve(l),{milliseconds:t.timeout})),t.signal&&(l=Promise.race([l,this.#_(t.signal)]));const u=await l;r(u),this.emit("completed",u)}catch(l){if(l instanceof WS&&!t.throwOnTimeout){r();return}o(l),this.emit("error",l)}finally{this.#x()}},t),this.emit("add"),this.#d()})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return this.#l?(this.#l=!1,this.#h(),this):this}pause(){this.#l=!0}clear(){this.#r=new this.#p}async onEmpty(){this.#r.size!==0&&await this.#g("empty")}async onSizeLessThan(e){this.#r.size<e||await this.#g("next",()=>this.#r.size<e)}async onIdle(){this.#s===0&&this.#r.size===0||await this.#g("idle")}async#g(e,t){return new Promise(r=>{const o=()=>{t&&!t()||(this.off(e,o),r())};this.on(e,o)})}get size(){return this.#r.size}sizeBy(e){return this.#r.filter(e).length}get pending(){return this.#s}get isPaused(){return this.#l}}function tA(n){const e=[Oi.A];return n==null?e:Array.isArray(n)?n.length===0?e:n:[n]}const nA=60;function rA(n){return{Status:n.Status??0,TC:n.TC??n.flag_tc??!1,RD:n.RD??n.flag_rd??!1,RA:n.RA??n.flag_ra??!1,AD:n.AD??n.flag_ad??!1,CD:n.CD??n.flag_cd??!1,Question:(n.Question??n.questions??[]).map(e=>({name:e.name,type:Oi[e.type]})),Answer:(n.Answer??n.answers??[]).map(e=>({name:e.name,type:Oi[e.type],TTL:e.TTL??e.ttl??nA,data:e.data instanceof Uint8Array?Ee(e.data):e.data}))}}const DM=4;function lE(n,e={}){const t=new eA({concurrency:e.queryConcurrency??DM});return async(r,o={})=>{const l=new URLSearchParams;l.set("name",r),tA(o.types).forEach(f=>{l.append("type",Oi[f])}),o.onProgress?.(new Le("dns:query",r));const u=await t.add(async()=>{const f=await fetch(`${n}?${l}`,{headers:{accept:"application/dns-json"},signal:o?.signal});if(f.status!==200)throw new Error(`Unexpected HTTP status: ${f.status} - ${f.statusText}`);const h=rA(await f.json());return o.onProgress?.(new Le("dns:response",h)),h},{signal:o.signal});if(u==null)throw new Error("No DNS response received");return u}}function RM(){return[lE("https://cloudflare-dns.com/dns-query"),lE("https://dns.google/resolve")]}var fp,cE;function MM(){return cE||(cE=1,fp=function(n){if(!n)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,t=Object.create(null),r=Object.create(null);function o(l,u){t[l]=u,e++,e>=n&&(e=0,r=t,t=Object.create(null))}return{has:function(l){return t[l]!==void 0||r[l]!==void 0},remove:function(l){t[l]!==void 0&&(t[l]=void 0),r[l]!==void 0&&(r[l]=void 0)},get:function(l){var u=t[l];if(u!==void 0)return u;if((u=r[l])!==void 0)return o(l,u),u},set:function(l,u){t[l]!==void 0?t[l]=u:o(l,u)},clear:function(){t=Object.create(null),r=Object.create(null)}}}),fp}var IM=MM();const OM=ha(IM);class LM{lru;constructor(e){this.lru=OM(e)}get(e,t){let r=!0;const o=[];for(const l of t){const u=this.getAnswers(e,l);if(u.length===0){r=!1;break}o.push(...u)}if(r)return rA({answers:o})}getAnswers(e,t){const r=`${e.toLowerCase()}-${t}`,o=this.lru.get(r);if(o!=null){const l=o.filter(u=>u.expires>Date.now()).map(({expires:u,value:f})=>({...f,TTL:Math.round((u-Date.now())/1e3),type:Oi[f.type]}));return l.length===0&&this.lru.remove(r),l}return[]}add(e,t){const r=`${e.toLowerCase()}-${t.type}`,o=this.lru.get(r)??[];o.push({expires:Date.now()+(t.TTL??nA)*1e3,value:t}),this.lru.set(r,o)}remove(e,t){const r=`${e.toLowerCase()}-${t}`;this.lru.remove(r)}clear(){this.lru.clear()}}function UM(n){return new LM(n)}const PM=1e3;let zM=class{resolvers;cache;constructor(e){this.resolvers={},this.cache=UM(e.cacheSize??PM),Object.entries(e.resolvers??{}).forEach(([t,r])=>{Array.isArray(r)||(r=[r]),t.endsWith(".")||(t=`${t}.`),this.resolvers[t]=r}),this.resolvers["."]==null&&(this.resolvers["."]=RM())}async query(e,t={}){const r=tA(t.types),o=t.cached!==!1?this.cache.get(e,r):void 0;if(o!=null)return t.onProgress?.(new Le("dns:cache",o)),o;const l=`${e.split(".").pop()}.`,u=(this.resolvers[l]??this.resolvers["."]).sort(()=>Math.random()>.5?-1:1),f=[];for(const h of u){if(t.signal?.aborted===!0)break;try{const p=await h(e,{...t,types:r});for(const m of p.Answer)this.cache.add(e,m);return p}catch(p){f.push(p),t.onProgress?.(new Le("dns:error",p))}}throw f.length===1?f[0]:new AggregateError(f,`DNS lookup of ${e} ${r} failed`)}};var Oi;(function(n){n[n.A=1]="A",n[n.CNAME=5]="CNAME",n[n.TXT=16]="TXT",n[n.AAAA=28]="AAAA"})(Oi||(Oi={}));function iA(n={}){return new zM(n)}const VM=["string","number","bigint","symbol"],$M=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function HM(n){if(n===null)return"null";if(n===void 0)return"undefined";if(n===!0||n===!1)return"boolean";const e=typeof n;if(VM.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(n))return"Array";if(qM(n))return"Buffer";const t=FM(n);return t||"Object"}function qM(n){return n&&n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer.call(null,n)}function FM(n){const e=Object.prototype.toString.call(n).slice(8,-1);if($M.includes(e))return e}class P{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}P.uint=new P(0,"uint",!0);P.negint=new P(1,"negint",!0);P.bytes=new P(2,"bytes",!0);P.string=new P(3,"string",!0);P.array=new P(4,"array",!1);P.map=new P(5,"map",!1);P.tag=new P(6,"tag",!1);P.float=new P(7,"float",!0);P.false=new P(7,"false",!0);P.true=new P(7,"true",!0);P.null=new P(7,"null",!0);P.undefined=new P(7,"undefined",!0);P.break=new P(7,"break",!0);class le{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const Ea=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",KM=new TextDecoder,jM=new TextEncoder;function Uf(n){return Ea&&globalThis.Buffer.isBuffer(n)}function Ay(n){return n instanceof Uint8Array?Uf(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n:Uint8Array.from(n)}const GM=Ea?(n,e,t)=>t-e>64?globalThis.Buffer.from(n.subarray(e,t)).toString("utf8"):fE(n,e,t):(n,e,t)=>t-e>64?KM.decode(n.subarray(e,t)):fE(n,e,t),sA=Ea?n=>n.length>64?globalThis.Buffer.from(n):uE(n):n=>n.length>64?jM.encode(n):uE(n),Dr=n=>Uint8Array.from(n),_y=Ea?(n,e,t)=>Uf(n)?new Uint8Array(n.subarray(e,t)):n.slice(e,t):(n,e,t)=>n.slice(e,t),YM=Ea?(n,e)=>(n=n.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Ay(globalThis.Buffer.concat(n,e))):(n,e)=>{const t=new Uint8Array(e);let r=0;for(let o of n)r+o.length>t.length&&(o=o.subarray(0,t.length-r)),t.set(o,r),r+=o.length;return t},ZM=Ea?n=>globalThis.Buffer.allocUnsafe(n):n=>new Uint8Array(n);function XM(n,e){if(Uf(n)&&Uf(e))return n.compare(e);for(let t=0;t<n.length;t++)if(n[t]!==e[t])return n[t]<e[t]?-1:1;return 0}function uE(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let o=n.charCodeAt(r);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e}function fE(n,e,t){const r=[];for(;e<t;){const o=n[e];let l=null,u=o>239?4:o>223?3:o>191?2:1;if(e+u<=t){let f,h,p,m;switch(u){case 1:o<128&&(l=o);break;case 2:f=n[e+1],(f&192)===128&&(m=(o&31)<<6|f&63,m>127&&(l=m));break;case 3:f=n[e+1],h=n[e+2],(f&192)===128&&(h&192)===128&&(m=(o&15)<<12|(f&63)<<6|h&63,m>2047&&(m<55296||m>57343)&&(l=m));break;case 4:f=n[e+1],h=n[e+2],p=n[e+3],(f&192)===128&&(h&192)===128&&(p&192)===128&&(m=(o&15)<<18|(f&63)<<12|(h&63)<<6|p&63,m>65535&&m<1114112&&(l=m))}}l===null?(l=65533,u=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l),e+=u}return oA(r)}const dE=4096;function oA(n){const e=n.length;if(e<=dE)return String.fromCharCode.apply(String,n);let t="",r=0;for(;r<e;)t+=String.fromCharCode.apply(String,n.slice(r,r+=dE));return t}const QM=256;class aA{constructor(e=QM){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const o=t.length-(this.maxCursor-this.cursor)-1;t.set(e,o)}else{if(t){const o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=ZM(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=_y(r,0,this.cursor)}else t=YM(this.chunks,this.cursor);return e&&this.reset(),t}}const we="CBOR decode error:",xs="CBOR encode error:";function xa(n,e,t){if(n.length-e<t)throw new Error(`${we} not enough data for type`)}const Lt=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Rs(n,e,t){xa(n,e,1);const r=n[e];if(t.strict===!0&&r<Lt[0])throw new Error(`${we} integer encoded in more bytes than necessary (strict decode)`);return r}function Ms(n,e,t){xa(n,e,2);const r=n[e]<<8|n[e+1];if(t.strict===!0&&r<Lt[1])throw new Error(`${we} integer encoded in more bytes than necessary (strict decode)`);return r}function Is(n,e,t){xa(n,e,4);const r=n[e]*16777216+(n[e+1]<<16)+(n[e+2]<<8)+n[e+3];if(t.strict===!0&&r<Lt[2])throw new Error(`${we} integer encoded in more bytes than necessary (strict decode)`);return r}function Os(n,e,t){xa(n,e,8);const r=n[e]*16777216+(n[e+1]<<16)+(n[e+2]<<8)+n[e+3],o=n[e+4]*16777216+(n[e+5]<<16)+(n[e+6]<<8)+n[e+7],l=(BigInt(r)<<BigInt(32))+BigInt(o);if(t.strict===!0&&l<Lt[3])throw new Error(`${we} integer encoded in more bytes than necessary (strict decode)`);if(l<=Number.MAX_SAFE_INTEGER)return Number(l);if(t.allowBigInt===!0)return l;throw new Error(`${we} integers outside of the safe integer range are not supported`)}function JM(n,e,t,r){return new le(P.uint,Rs(n,e+1,r),2)}function WM(n,e,t,r){return new le(P.uint,Ms(n,e+1,r),3)}function e5(n,e,t,r){return new le(P.uint,Is(n,e+1,r),5)}function t5(n,e,t,r){return new le(P.uint,Os(n,e+1,r),9)}function Ls(n,e){return Mn(n,0,e.value)}function Mn(n,e,t){if(t<Lt[0]){const r=Number(t);n.push([e|r])}else if(t<Lt[1]){const r=Number(t);n.push([e|24,r])}else if(t<Lt[2]){const r=Number(t);n.push([e|25,r>>>8,r&255])}else if(t<Lt[3]){const r=Number(t);n.push([e|26,r>>>24&255,r>>>16&255,r>>>8&255,r&255])}else{const r=BigInt(t);if(r<Lt[4]){const o=[e|27,0,0,0,0,0,0,0];let l=Number(r&BigInt(4294967295)),u=Number(r>>BigInt(32)&BigInt(4294967295));o[8]=l&255,l=l>>8,o[7]=l&255,l=l>>8,o[6]=l&255,l=l>>8,o[5]=l&255,o[4]=u&255,u=u>>8,o[3]=u&255,u=u>>8,o[2]=u&255,u=u>>8,o[1]=u&255,n.push(o)}else throw new Error(`${we} encountered BigInt larger than allowable range`)}}Ls.encodedSize=function(e){return Mn.encodedSize(e.value)};Mn.encodedSize=function(e){return e<Lt[0]?1:e<Lt[1]?2:e<Lt[2]?3:e<Lt[3]?5:9};Ls.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function n5(n,e,t,r){return new le(P.negint,-1-Rs(n,e+1,r),2)}function r5(n,e,t,r){return new le(P.negint,-1-Ms(n,e+1,r),3)}function i5(n,e,t,r){return new le(P.negint,-1-Is(n,e+1,r),5)}const Ty=BigInt(-1),lA=BigInt(1);function s5(n,e,t,r){const o=Os(n,e+1,r);if(typeof o!="bigint"){const l=-1-o;if(l>=Number.MIN_SAFE_INTEGER)return new le(P.negint,l,9)}if(r.allowBigInt!==!0)throw new Error(`${we} integers outside of the safe integer range are not supported`);return new le(P.negint,Ty-BigInt(o),9)}function ky(n,e){const t=e.value,r=typeof t=="bigint"?t*Ty-lA:t*-1-1;Mn(n,e.type.majorEncoded,r)}ky.encodedSize=function(e){const t=e.value,r=typeof t=="bigint"?t*Ty-lA:t*-1-1;return r<Lt[0]?1:r<Lt[1]?2:r<Lt[2]?3:r<Lt[3]?5:9};ky.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function xc(n,e,t,r){xa(n,e,t+r);const o=_y(n,e+t,e+t+r);return new le(P.bytes,o,t+r)}function o5(n,e,t,r){return xc(n,e,1,t)}function a5(n,e,t,r){return xc(n,e,2,Rs(n,e+1,r))}function l5(n,e,t,r){return xc(n,e,3,Ms(n,e+1,r))}function c5(n,e,t,r){return xc(n,e,5,Is(n,e+1,r))}function u5(n,e,t,r){const o=Os(n,e+1,r);if(typeof o=="bigint")throw new Error(`${we} 64-bit integer bytes lengths not supported`);return xc(n,e,9,o)}function Pf(n){return n.encodedBytes===void 0&&(n.encodedBytes=n.type===P.string?sA(n.value):n.value),n.encodedBytes}function hd(n,e){const t=Pf(e);Mn(n,e.type.majorEncoded,t.length),n.push(t)}hd.encodedSize=function(e){const t=Pf(e);return Mn.encodedSize(t.length)+t.length};hd.compareTokens=function(e,t){return f5(Pf(e),Pf(t))};function f5(n,e){return n.length<e.length?-1:n.length>e.length?1:XM(n,e)}function Sc(n,e,t,r,o){const l=t+r;xa(n,e,l);const u=new le(P.string,GM(n,e+t,e+l),l);return o.retainStringBytes===!0&&(u.byteValue=_y(n,e+t,e+l)),u}function d5(n,e,t,r){return Sc(n,e,1,t,r)}function h5(n,e,t,r){return Sc(n,e,2,Rs(n,e+1,r),r)}function g5(n,e,t,r){return Sc(n,e,3,Ms(n,e+1,r),r)}function p5(n,e,t,r){return Sc(n,e,5,Is(n,e+1,r),r)}function m5(n,e,t,r){const o=Os(n,e+1,r);if(typeof o=="bigint")throw new Error(`${we} 64-bit integer string lengths not supported`);return Sc(n,e,9,o,r)}const y5=hd;function Sa(n,e,t,r){return new le(P.array,r,t)}function b5(n,e,t,r){return Sa(n,e,1,t)}function w5(n,e,t,r){return Sa(n,e,2,Rs(n,e+1,r))}function v5(n,e,t,r){return Sa(n,e,3,Ms(n,e+1,r))}function E5(n,e,t,r){return Sa(n,e,5,Is(n,e+1,r))}function x5(n,e,t,r){const o=Os(n,e+1,r);if(typeof o=="bigint")throw new Error(`${we} 64-bit integer array lengths not supported`);return Sa(n,e,9,o)}function S5(n,e,t,r){if(r.allowIndefinite===!1)throw new Error(`${we} indefinite length items not allowed`);return Sa(n,e,1,1/0)}function Cy(n,e){Mn(n,P.array.majorEncoded,e.value)}Cy.compareTokens=Ls.compareTokens;Cy.encodedSize=function(e){return Mn.encodedSize(e.value)};function Aa(n,e,t,r){return new le(P.map,r,t)}function A5(n,e,t,r){return Aa(n,e,1,t)}function _5(n,e,t,r){return Aa(n,e,2,Rs(n,e+1,r))}function T5(n,e,t,r){return Aa(n,e,3,Ms(n,e+1,r))}function k5(n,e,t,r){return Aa(n,e,5,Is(n,e+1,r))}function C5(n,e,t,r){const o=Os(n,e+1,r);if(typeof o=="bigint")throw new Error(`${we} 64-bit integer map lengths not supported`);return Aa(n,e,9,o)}function N5(n,e,t,r){if(r.allowIndefinite===!1)throw new Error(`${we} indefinite length items not allowed`);return Aa(n,e,1,1/0)}function Ny(n,e){Mn(n,P.map.majorEncoded,e.value)}Ny.compareTokens=Ls.compareTokens;Ny.encodedSize=function(e){return Mn.encodedSize(e.value)};function B5(n,e,t,r){return new le(P.tag,t,1)}function D5(n,e,t,r){return new le(P.tag,Rs(n,e+1,r),2)}function R5(n,e,t,r){return new le(P.tag,Ms(n,e+1,r),3)}function M5(n,e,t,r){return new le(P.tag,Is(n,e+1,r),5)}function I5(n,e,t,r){return new le(P.tag,Os(n,e+1,r),9)}function By(n,e){Mn(n,P.tag.majorEncoded,e.value)}By.compareTokens=Ls.compareTokens;By.encodedSize=function(e){return Mn.encodedSize(e.value)};const O5=20,L5=21,U5=22,P5=23;function z5(n,e,t,r){if(r.allowUndefined===!1)throw new Error(`${we} undefined values are not supported`);return r.coerceUndefinedToNull===!0?new le(P.null,null,1):new le(P.undefined,void 0,1)}function V5(n,e,t,r){if(r.allowIndefinite===!1)throw new Error(`${we} indefinite length items not allowed`);return new le(P.break,void 0,1)}function Dy(n,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(n))throw new Error(`${we} NaN values are not supported`);if(t.allowInfinity===!1&&(n===1/0||n===-1/0))throw new Error(`${we} Infinity values are not supported`)}return new le(P.float,n,e)}function $5(n,e,t,r){return Dy(My(n,e+1),3,r)}function H5(n,e,t,r){return Dy(Iy(n,e+1),5,r)}function q5(n,e,t,r){return Dy(dA(n,e+1),9,r)}function Ry(n,e,t){const r=e.value;if(r===!1)n.push([P.float.majorEncoded|O5]);else if(r===!0)n.push([P.float.majorEncoded|L5]);else if(r===null)n.push([P.float.majorEncoded|U5]);else if(r===void 0)n.push([P.float.majorEncoded|P5]);else{let o,l=!1;(!t||t.float64!==!0)&&(uA(r),o=My($n,1),r===o||Number.isNaN(r)?($n[0]=249,n.push($n.slice(0,3)),l=!0):(fA(r),o=Iy($n,1),r===o&&($n[0]=250,n.push($n.slice(0,5)),l=!0))),l||(F5(r),o=dA($n,1),$n[0]=251,n.push($n.slice(0,9)))}}Ry.encodedSize=function(e,t){const r=e.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!t||t.float64!==!0){uA(r);let o=My($n,1);if(r===o||Number.isNaN(r))return 3;if(fA(r),o=Iy($n,1),r===o)return 5}return 9};const cA=new ArrayBuffer(9),Dn=new DataView(cA,1),$n=new Uint8Array(cA,0);function uA(n){if(n===1/0)Dn.setUint16(0,31744,!1);else if(n===-1/0)Dn.setUint16(0,64512,!1);else if(Number.isNaN(n))Dn.setUint16(0,32256,!1);else{Dn.setFloat32(0,n);const e=Dn.getUint32(0),t=(e&2139095040)>>23,r=e&8388607;if(t===255)Dn.setUint16(0,31744,!1);else if(t===0)Dn.setUint16(0,(n&2147483648)>>16|r>>13,!1);else{const o=t-127;o<-24?Dn.setUint16(0,0):o<-14?Dn.setUint16(0,(e&2147483648)>>16|1<<24+o,!1):Dn.setUint16(0,(e&2147483648)>>16|o+15<<10|r>>13,!1)}}}function My(n,e){if(n.length-e<2)throw new Error(`${we} not enough data for float16`);const t=(n[e]<<8)+n[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;const r=t>>10&31,o=t&1023;let l;return r===0?l=o*2**-24:r!==31?l=(o+1024)*2**(r-25):l=o===0?1/0:NaN,t&32768?-l:l}function fA(n){Dn.setFloat32(0,n,!1)}function Iy(n,e){if(n.length-e<4)throw new Error(`${we} not enough data for float32`);const t=(n.byteOffset||0)+e;return new DataView(n.buffer,t,4).getFloat32(0,!1)}function F5(n){Dn.setFloat64(0,n,!1)}function dA(n,e){if(n.length-e<8)throw new Error(`${we} not enough data for float64`);const t=(n.byteOffset||0)+e;return new DataView(n.buffer,t,8).getFloat64(0,!1)}Ry.compareTokens=Ls.compareTokens;function ze(n,e,t){throw new Error(`${we} encountered invalid minor (${t}) for major ${n[e]>>>5}`)}function gd(n){return()=>{throw new Error(`${we} ${n}`)}}const ce=[];for(let n=0;n<=23;n++)ce[n]=ze;ce[24]=JM;ce[25]=WM;ce[26]=e5;ce[27]=t5;ce[28]=ze;ce[29]=ze;ce[30]=ze;ce[31]=ze;for(let n=32;n<=55;n++)ce[n]=ze;ce[56]=n5;ce[57]=r5;ce[58]=i5;ce[59]=s5;ce[60]=ze;ce[61]=ze;ce[62]=ze;ce[63]=ze;for(let n=64;n<=87;n++)ce[n]=o5;ce[88]=a5;ce[89]=l5;ce[90]=c5;ce[91]=u5;ce[92]=ze;ce[93]=ze;ce[94]=ze;ce[95]=gd("indefinite length bytes/strings are not supported");for(let n=96;n<=119;n++)ce[n]=d5;ce[120]=h5;ce[121]=g5;ce[122]=p5;ce[123]=m5;ce[124]=ze;ce[125]=ze;ce[126]=ze;ce[127]=gd("indefinite length bytes/strings are not supported");for(let n=128;n<=151;n++)ce[n]=b5;ce[152]=w5;ce[153]=v5;ce[154]=E5;ce[155]=x5;ce[156]=ze;ce[157]=ze;ce[158]=ze;ce[159]=S5;for(let n=160;n<=183;n++)ce[n]=A5;ce[184]=_5;ce[185]=T5;ce[186]=k5;ce[187]=C5;ce[188]=ze;ce[189]=ze;ce[190]=ze;ce[191]=N5;for(let n=192;n<=215;n++)ce[n]=B5;ce[216]=D5;ce[217]=R5;ce[218]=M5;ce[219]=I5;ce[220]=ze;ce[221]=ze;ce[222]=ze;ce[223]=ze;for(let n=224;n<=243;n++)ce[n]=gd("simple values are not supported");ce[244]=ze;ce[245]=ze;ce[246]=ze;ce[247]=z5;ce[248]=gd("simple values are not supported");ce[249]=$5;ce[250]=H5;ce[251]=q5;ce[252]=ze;ce[253]=ze;ce[254]=ze;ce[255]=V5;const dr=[];for(let n=0;n<24;n++)dr[n]=new le(P.uint,n,1);for(let n=-1;n>=-24;n--)dr[31-n]=new le(P.negint,n,1);dr[64]=new le(P.bytes,new Uint8Array(0),1);dr[96]=new le(P.string,"",1);dr[128]=new le(P.array,0,1);dr[160]=new le(P.map,0,1);dr[244]=new le(P.false,!1,1);dr[245]=new le(P.true,!0,1);dr[246]=new le(P.null,null,1);function K5(n){switch(n.type){case P.false:return Dr([244]);case P.true:return Dr([245]);case P.null:return Dr([246]);case P.bytes:return n.value.length?void 0:Dr([64]);case P.string:return n.value===""?Dr([96]):void 0;case P.array:return n.value===0?Dr([128]):void 0;case P.map:return n.value===0?Dr([160]):void 0;case P.uint:return n.value<24?Dr([Number(n.value)]):void 0;case P.negint:if(n.value>=-24)return Dr([31-Number(n.value)])}}const j5={float64:!1,mapSorter:Z5,quickEncodeToken:K5};function G5(){const n=[];return n[P.uint.major]=Ls,n[P.negint.major]=ky,n[P.bytes.major]=hd,n[P.string.major]=y5,n[P.array.major]=Cy,n[P.map.major]=Ny,n[P.tag.major]=By,n[P.float.major]=Ry,n}const hA=G5(),dp=new aA;class zf{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${xs} object contains circular references`);return new zf(t,e)}}const Ai={null:new le(P.null,null),undefined:new le(P.undefined,void 0),true:new le(P.true,!0),false:new le(P.false,!1),emptyArray:new le(P.array,0),emptyMap:new le(P.map,0)},Li={number(n,e,t,r){return!Number.isInteger(n)||!Number.isSafeInteger(n)?new le(P.float,n):n>=0?new le(P.uint,n):new le(P.negint,n)},bigint(n,e,t,r){return n>=BigInt(0)?new le(P.uint,n):new le(P.negint,n)},Uint8Array(n,e,t,r){return new le(P.bytes,n)},string(n,e,t,r){return new le(P.string,n)},boolean(n,e,t,r){return n?Ai.true:Ai.false},null(n,e,t,r){return Ai.null},undefined(n,e,t,r){return Ai.undefined},ArrayBuffer(n,e,t,r){return new le(P.bytes,new Uint8Array(n))},DataView(n,e,t,r){return new le(P.bytes,new Uint8Array(n.buffer,n.byteOffset,n.byteLength))},Array(n,e,t,r){if(!n.length)return t.addBreakTokens===!0?[Ai.emptyArray,new le(P.break)]:Ai.emptyArray;r=zf.createCheck(r,n);const o=[];let l=0;for(const u of n)o[l++]=pf(u,t,r);return t.addBreakTokens?[new le(P.array,n.length),o,new le(P.break)]:[new le(P.array,n.length),o]},Object(n,e,t,r){const o=e!=="Object",l=o?n.keys():Object.keys(n),u=o?n.size:l.length;if(!u)return t.addBreakTokens===!0?[Ai.emptyMap,new le(P.break)]:Ai.emptyMap;r=zf.createCheck(r,n);const f=[];let h=0;for(const p of l)f[h++]=[pf(p,t,r),pf(o?n.get(p):n[p],t,r)];return Y5(f,t),t.addBreakTokens?[new le(P.map,u),f,new le(P.break)]:[new le(P.map,u),f]}};Li.Map=Li.Object;Li.Buffer=Li.Uint8Array;for(const n of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Li[`${n}Array`]=Li.DataView;function pf(n,e={},t){const r=HM(n),o=e&&e.typeEncoders&&e.typeEncoders[r]||Li[r];if(typeof o=="function"){const u=o(n,r,e,t);if(u!=null)return u}const l=Li[r];if(!l)throw new Error(`${xs} unsupported type: ${r}`);return l(n,r,e,t)}function Y5(n,e){e.mapSorter&&n.sort(e.mapSorter)}function Z5(n,e){const t=Array.isArray(n[0])?n[0][0]:n[0],r=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==r.type)return t.type.compare(r.type);const o=t.type.major,l=hA[o].compareTokens(t,r);return l===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),l}function gA(n,e,t,r){if(Array.isArray(e))for(const o of e)gA(n,o,t,r);else t[e.type.major](n,e,r)}function pA(n,e,t){const r=pf(n,t);if(!Array.isArray(r)&&t.quickEncodeToken){const o=t.quickEncodeToken(r);if(o)return o;const l=e[r.type.major];if(l.encodedSize){const u=l.encodedSize(r,t),f=new aA(u);if(l(f,r,t),f.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return Ay(f.chunks[0])}}return dp.reset(),gA(dp,r,e,t),dp.toBytes(!0)}function jl(n,e){return e=Object.assign({},j5,e),pA(n,hA,e)}const X5={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Q5{constructor(e,t={}){this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=dr[e];if(t===void 0){const r=ce[e];if(!r)throw new Error(`${we} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const o=e&31;t=r(this.data,this._pos,o,this.options)}return this._pos+=t.encodedLength,t}}const sc=Symbol.for("DONE"),pd=Symbol.for("BREAK");function J5(n,e,t){const r=[];for(let o=0;o<n.value;o++){const l=oc(e,t);if(l===pd){if(n.value===1/0)break;throw new Error(`${we} got unexpected break to lengthed array`)}if(l===sc)throw new Error(`${we} found array but not enough entries (got ${o}, expected ${n.value})`);r[o]=l}return r}function W5(n,e,t){const r=t.useMaps===!0,o=r?void 0:{},l=r?new Map:void 0;for(let u=0;u<n.value;u++){const f=oc(e,t);if(f===pd){if(n.value===1/0)break;throw new Error(`${we} got unexpected break to lengthed map`)}if(f===sc)throw new Error(`${we} found map but not enough entries (got ${u} [no key], expected ${n.value})`);if(r!==!0&&typeof f!="string")throw new Error(`${we} non-string keys not supported (got ${typeof f})`);if(t.rejectDuplicateMapKeys===!0&&(r&&l.has(f)||!r&&f in o))throw new Error(`${we} found repeat map key "${f}"`);const h=oc(e,t);if(h===sc)throw new Error(`${we} found map but not enough entries (got ${u} [no value], expected ${n.value})`);r?l.set(f,h):o[f]=h}return r?l:o}function oc(n,e){if(n.done())return sc;const t=n.next();if(t.type===P.break)return pd;if(t.type.terminal)return t.value;if(t.type===P.array)return J5(t,n,e);if(t.type===P.map)return W5(t,n,e);if(t.type===P.tag){if(e.tags&&typeof e.tags[t.value]=="function"){const r=oc(n,e);return e.tags[t.value](r)}throw new Error(`${we} tag not supported (${t.value})`)}throw new Error("unsupported")}function eI(n,e){if(!(n instanceof Uint8Array))throw new Error(`${we} data to decode must be a Uint8Array`);e=Object.assign({},X5,e);const t=e.tokenizer||new Q5(n,e),r=oc(t,e);if(r===sc)throw new Error(`${we} did not find any content to decode`);if(r===pd)throw new Error(`${we} got unexpected break`);return[r,n.subarray(t.pos())]}function ki(n,e){const[t,r]=eI(n,e);if(r.length>0)throw new Error(`${we} too many terminals, data makes no sense`);return t}const Rr="/",mA=new TextEncoder().encode(Rr),ef=mA[0];class ot{_buf;constructor(e,t){if(typeof e=="string")this._buf=de(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==ef)throw new Error("Invalid key")}toString(e="utf8"){return Ee(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ot(e.join(Rr))}static random(){return new ot(Math.random().toString().substring(2))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new ot(e):typeof e.uint8Array=="function"?new ot(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=mA),this._buf[0]!==ef){const e=new Uint8Array(this._buf.byteLength+1);e.fill(ef,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ef;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let o=0;o<t.length;o++){if(r.length<o+1)return!1;const l=t[o],u=r[o];if(l<u)return!0;if(l>u)return!1}return t.length<r.length}reverse(){return ot.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Rr).slice(1)}type(){return tI(this.baseNamespace())}name(){return nI(this.baseNamespace())}instance(e){return new ot(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Rr)||(e+=Rr),e+=this.type(),new ot(e)}parent(){const e=this.list();return e.length===1?new ot(Rr):new ot(e.slice(0,-1).join(Rr))}child(e){return this.toString()===Rr?e:e.toString()===Rr?this:new ot(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return ot.withNamespaces([...this.namespaces(),...rI(e.map(t=>t.namespaces()))])}}function tI(n){const e=n.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function nI(n){const e=n.split(":");return e[e.length-1]}function rI(n){return[].concat(...n)}function tf({enumerable:n=!0,configurable:e=!1}={}){return{enumerable:n,configurable:e,writable:!1}}function*iI(n,e){if(e!=null&&typeof e=="object")if(Array.isArray(e))for(const[t,r]of e.entries()){const o=[...n,t],l=Se.asCID(r);l!=null?yield[o.join("/"),l]:typeof r=="object"&&(yield*lm(r,o))}else{const t=Se.asCID(e);t!=null?yield[n.join("/"),t]:yield*lm(e,n)}}function*lm(n,e){if(n==null||n instanceof Uint8Array)return;const t=Se.asCID(n);t!=null&&(yield[e.join("/"),t]);for(const[r,o]of Object.entries(n)){const l=[...e,r];yield*iI(l,o)}}function*sI(n,e){if(Array.isArray(e))for(const[t,r]of e.entries()){const o=[...n,t];yield o.join("/"),typeof r=="object"&&Se.asCID(r)==null&&(yield*cm(r,o))}else yield*cm(e,n)}function*cm(n,e){if(!(n==null||typeof n!="object"))for(const[t,r]of Object.entries(n)){const o=[...e,t];yield o.join("/"),r!=null&&!(r instanceof Uint8Array)&&typeof r=="object"&&Se.asCID(r)==null&&(yield*sI(o,r))}}function oI(n,e){let t=n;for(const[r,o]of e.entries()){if(t=t[o],t==null)throw new Error(`Object has no property at ${e.slice(0,r+1).map(u=>`[${JSON.stringify(u)}]`).join("")}`);const l=Se.asCID(t);if(l!=null)return{value:l,remaining:e.slice(r+1).join("/")}}return{value:t}}class aI{cid;bytes;value;asBlock;constructor({cid:e,bytes:t,value:r}){if(e==null||t==null||typeof r>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:tf(),bytes:tf(),value:tf(),asBlock:tf()})}links(){return lm(this.value,[])}tree(){return cm(this.value,[])}get(e="/"){return oI(this.value,e.split("/").filter(Boolean))}}function lI({bytes:n,cid:e,value:t,codec:r}){const o=t!==void 0?t:r?.decode(n);if(o===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new aI({cid:e,bytes:n,value:o})}const yA="/pin/",hE="/pinned-block/",um=cr,gE=1;function nf(n){return n.version===0&&(n=n.toV1()),new ot(`${yA}${n.toString(um)}`)}class cI{datastore;blockstore;getCodec;constructor(e,t,r){this.datastore=e,this.blockstore=t,this.getCodec=r}async*add(e,t={}){const r=nf(e);if(await this.datastore.has(r))throw new Error("Already pinned");const o=Math.round(t.depth??1/0);if(o<0)throw new Error("Depth must be greater than or equal to 0");const l=new Wl({concurrency:gE});for await(const f of this.#e(e,l,{...t,depth:o}))await this.#t(f,h=>h.pinnedBy.find(p=>et(p,e.bytes))!=null?!1:(h.pinCount++,h.pinnedBy.push(e.bytes),!0),t),yield f;const u={depth:o,metadata:t.metadata??{}};await this.datastore.put(r,jl(u),t)}async*#e(e,t,r){if(r.depth===-1)return;const o=await this.getCodec(e.code),l=await this.blockstore.get(e,r),u=lI({bytes:l,cid:e,codec:o});yield e;for(const[,f]of u.links())yield*await t.add(async()=>this.#e(f,t,{...r,depth:r.depth-1}))}async#t(e,t,r){const o=new ot(`${hE}${um.encode(e.multihash.bytes)}`);let l={pinCount:0,pinnedBy:[]};try{l=ki(await this.datastore.get(o,r))}catch(f){if(f.name!=="NotFoundError")throw f}if(t(l)){if(l.pinCount===0&&await this.datastore.has(o)){await this.datastore.delete(o);return}await this.datastore.put(o,jl(l),r),r.onProgress?.(new Le("helia:pin:add",e))}}async*rm(e,t={}){const r=nf(e),o=await this.datastore.get(r,t),l=ki(o);await this.datastore.delete(r,t);const u=new Wl({concurrency:gE});for await(const f of this.#e(e,u,{...t,depth:l.depth}))await this.#t(f,h=>(h.pinCount--,h.pinnedBy=h.pinnedBy.filter(p=>et(p,e.bytes)),!0),{...t,depth:l.depth}),yield f}async*ls(e={}){for await(const{key:t,value:r}of this.datastore.query({prefix:yA+(e.cid!=null?`${e.cid.toString(cr)}`:"")},e)){const o=Se.parse(t.toString().substring(5),cr),l=ki(r);yield{cid:o,...l}}}async isPinned(e,t={}){const r=new ot(`${hE}${um.encode(e.multihash.bytes)}`);return this.datastore.has(r,t)}async get(e,t){const r=nf(e),o=await this.datastore.get(r,t);return ki(o)}async setMetadata(e,t,r){const o=nf(e),l=await this.datastore.get(o,r),u=ki(l);u.metadata=t??{},await this.datastore.put(o,jl(u),r)}}const uI=1,fI=5;class dI extends Error{static name="InsufficientProvidersError";constructor(e="Insufficient providers found"){super(e),this.name="InsufficientProvidersError"}}class rf extends Error{static name="NoRoutersAvailableError";constructor(e="No routers available"){super(e),this.name="NoRoutersAvailableError"}}class hI extends Error{static name="UnknownHashAlgorithmError";constructor(e="Unknown hash algorithm"){super(e),this.name="UnknownHashAlgorithmError"}}class gI extends Error{static name="UnknownCodecError";constructor(e="Unknown codec"){super(e),this.name="UnknownCodecError"}}const pI=5;class mI{log;routers;providerLookupConcurrency;constructor(e,t){this.log=e.logger.forComponent("helia:routing"),this.routers=t.routers??[],this.providerLookupConcurrency=t.providerLookupConcurrency??pI,this.findProviders=e.metrics?.traceFunction("helia.routing.findProviders",this.findProviders.bind(this),{optionsIndex:1})??this.findProviders,this.provide=e.metrics?.traceFunction("helia.routing.provide",this.provide.bind(this),{optionsIndex:1})??this.provide,this.cancelReprovide=e.metrics?.traceFunction("helia.routing.cancelReprovide",this.cancelReprovide.bind(this),{optionsIndex:1})??this.cancelReprovide,this.put=e.metrics?.traceFunction("helia.routing.put",this.put.bind(this),{optionsIndex:2})??this.put,this.get=e.metrics?.traceFunction("helia.routing.get",this.get.bind(this),{optionsIndex:1})??this.get,this.findPeer=e.metrics?.traceFunction("helia.routing.findPeer",this.findPeer.bind(this),{optionsIndex:1})??this.findPeer,this.getClosestPeers=e.metrics?.traceFunction("helia.routing.getClosestPeers",this.getClosestPeers.bind(this),{optionsIndex:1})??this.getClosestPeers}async start(){await hc(...this.routers)}async stop(){await gc(...this.routers)}async*findProviders(e,t={}){if(this.routers.length===0)throw new rf("No content routers available");const r=new E2({concurrency:this.providerLookupConcurrency});r.addEventListener("error",()=>{});for await(const o of Vo(r.toGenerator(),...os(this.routers,"findProviders").map(l=>l.findProviders(e,t))))if(o!=null){if(o.multiaddrs.length===0){if(r.find(o.id)!=null)continue;r.add(async()=>{try{const l=await this.findPeer(o.id,t);return l.multiaddrs.length===0?null:l}catch(l){return this.log.error("could not load multiaddrs for peer %p",o.id,l),null}},{peerId:o.id,signal:t.signal}).catch(l=>{this.log.error("could not load multiaddrs for peer %p",o.id,l)})}yield o}}async provide(e,t={}){if(this.routers.length===0)throw new rf("No content routers available");await Promise.all(os(this.routers,"provide").map(async r=>{await r.provide(e,t)}))}async cancelReprovide(e,t={}){await Promise.all(os(this.routers,"cancelReprovide").map(async r=>{await r.cancelReprovide(e,t)}))}async put(e,t,r){await Promise.all(os(this.routers,"put").map(async o=>{await o.put(e,t,r)}))}async get(e,t){return Promise.any(os(this.routers,"get").map(async r=>r.get(e,t)))}async findPeer(e,t){if(this.routers.length===0)throw new rf("No peer routers available");const r=this,o=Vo(...os(this.routers,"findPeer").map(l=>(async function*(){try{yield await l.findPeer(e,t)}catch(u){r.log.error(u)}})()));for await(const l of o)if(l!=null)return l;throw new Kn("Could not find peer in routing")}async*getClosestPeers(e,t={}){if(this.routers.length===0)throw new rf("No peer routers available");for await(const r of Vo(...os(this.routers,"getClosestPeers").map(o=>o.getClosestPeers(e,t))))r!=null&&(yield r)}}function os(n,e){return n.filter(t=>t[e]!=null)}class yI extends Error{static name="QueueFullError";constructor(e="The queue was full"){super(e),this.name="QueueFullError"}}class bI{deferred;signal;constructor(e){this.signal=e,this.deferred=Promise.withResolvers(),this.onAbort=this.onAbort.bind(this),this.signal?.addEventListener("abort",this.onAbort)}onAbort(){this.deferred.reject(this.signal?.reason??new ta)}cleanup(){this.signal?.removeEventListener("abort",this.onAbort)}}function wI(){return`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`}class vI{id;fn;options;recipients;status;timeline;controller;constructor(e,t){this.id=wI(),this.status="queued",this.fn=e,this.options=t,this.recipients=[],this.timeline={created:Date.now()},this.controller=new AbortController,this.controller.signal,this.onAbort=this.onAbort.bind(this)}abort(e){this.controller.abort(e)}onAbort(){this.recipients.reduce((t,r)=>t&&r.signal?.aborted===!0,!0)&&(this.controller.abort(new ta),this.cleanup())}async join(e={}){const t=new bI(e.signal);return this.recipients.push(t),e.signal?.addEventListener("abort",this.onAbort),t.deferred.promise}async run(){this.status="running",this.timeline.started=Date.now();try{this.controller.signal.throwIfAborted();const e=await lr(this.fn({...this.options??{},signal:this.controller.signal}),this.controller.signal);this.recipients.forEach(t=>{t.deferred.resolve(e)}),this.status="complete"}catch(e){this.recipients.forEach(t=>{t.deferred.reject(e)}),this.status="errored"}finally{this.timeline.finished=Date.now(),this.cleanup()}}cleanup(){this.recipients.forEach(e=>{e.cleanup(),e.signal?.removeEventListener("abort",this.onAbort)})}}function pE(n,e){let t;const r=function(){const o=function(){t=void 0,n()};clearTimeout(t),t=setTimeout(o,e)};return r.start=()=>{},r.stop=()=>{clearTimeout(t)},r}class mE extends Ss{concurrency;maxSize;queue;pending;sort;autoStart;constructor(e={}){super(),this.concurrency=e.concurrency??Number.POSITIVE_INFINITY,this.maxSize=e.maxSize??Number.POSITIVE_INFINITY,this.pending=0,this.autoStart=e.autoStart??!0,this.sort=e.sort,this.queue=[],this.emitEmpty=pE(this.emitEmpty.bind(this),1),this.emitIdle=pE(this.emitIdle.bind(this),1)}[Symbol.asyncIterator](){return this.toGenerator()}emitEmpty(){this.size===0&&this.safeDispatchEvent("empty")}emitIdle(){this.running===0&&this.safeDispatchEvent("idle")}tryToStartAnother(){if(this.size===0)return this.emitEmpty(),this.running===0&&this.emitIdle(),!1;if(this.pending<this.concurrency){let e;for(const t of this.queue)if(t.status==="queued"){e=t;break}return e==null?!1:(this.safeDispatchEvent("active"),this.pending++,e.run().finally(()=>{for(let t=0;t<this.queue.length;t++)if(this.queue[t]===e){this.queue.splice(t,1);break}this.pending--,this.safeDispatchEvent("next"),this.autoStart&&this.tryToStartAnother()}),!0)}return!1}enqueue(e){this.queue.push(e),this.sort!=null&&this.queue.sort(this.sort)}start(){this.autoStart===!1&&(this.autoStart=!0,this.tryToStartAnother())}pause(){this.autoStart=!1}async add(e,t){if(t?.signal?.throwIfAborted(),this.size===this.maxSize)throw new yI;const r=new vI(e,t);return this.enqueue(r),this.safeDispatchEvent("add"),this.autoStart&&this.tryToStartAnother(),r.join(t).then(o=>(this.safeDispatchEvent("success",{detail:{job:r,result:o}}),o)).catch(o=>{if(r.status==="queued"){for(let l=0;l<this.queue.length;l++)if(this.queue[l]===r){this.queue.splice(l,1);break}}throw this.safeDispatchEvent("failure",{detail:{job:r,error:o}}),o})}clear(){this.queue.splice(0,this.queue.length)}abort(){this.queue.forEach(e=>{e.abort(new ta)}),this.clear()}async onEmpty(e){this.size!==0&&await ws(this,"empty",e?.signal)}async onSizeLessThan(e,t){this.size<e||await ws(this,"next",t?.signal,{filter:()=>this.size<e})}async onIdle(e){this.pending===0&&this.size===0||await ws(this,"idle",e?.signal)}get size(){return this.queue.length}get queued(){return this.queue.length-this.pending}get running(){return this.pending}async*toGenerator(e){e?.signal?.throwIfAborted();const t=w2({objectMode:!0}),r=h=>{h!=null?this.abort():this.clear(),t.end(h)},o=h=>{h.detail!=null&&t.push(h.detail.result)},l=h=>{r(h.detail.error)},u=()=>{r()},f=()=>{r(new ta("Queue aborted"))};this.addEventListener("success",o),this.addEventListener("failure",l),this.addEventListener("idle",u),e?.signal?.addEventListener("abort",f);try{yield*t}finally{this.removeEventListener("success",o),this.removeEventListener("failure",l),this.removeEventListener("idle",u),e?.signal?.removeEventListener("abort",f),r()}}}const bA="lock:worker:request-read",wA="lock:worker:abort-read-request",vA="lock:worker:release-read",EA="lock:master:grant-read",xA="lock:master:error-read",SA="lock:worker:request-write",AA="lock:worker:abort-write-request",_A="lock:worker:release-write",TA="lock:master:grant-write",kA="lock:master:error-write",CA="lock:worker:finalize",NA="mortice",EI={singleProcess:!1},yE=(n,e,t,r,o,l,u,f,h)=>p=>{if(p.data==null)return;const m={type:p.data.type,name:p.data.name,identifier:p.data.identifier};m.type===o&&n.safeDispatchEvent(t,{detail:{name:m.name,identifier:m.identifier,handler:async()=>{e.postMessage({type:h,name:m.name,identifier:m.identifier}),await new Promise(y=>{const b=E=>{if(E?.data==null)return;const x={type:E.data.type,name:E.data.name,identifier:E.data.identifier};x.type===f&&x.identifier===m.identifier&&(e.removeEventListener("message",b),y())};e.addEventListener("message",b)})},onError:y=>{e.postMessage({type:u,name:m.name,identifier:m.identifier,error:{message:y.message,name:y.name,stack:y.stack}})}}}),m.type===l&&n.safeDispatchEvent(r,{detail:{name:m.name,identifier:m.identifier}}),m.type===CA&&n.safeDispatchEvent("finalizeRequest",{detail:{name:m.name}})},xI=(n=10)=>Math.random().toString().substring(2,n+2);class SI{name;channel;constructor(e){this.name=e,this.channel=new BroadcastChannel(NA)}readLock(e){return this.sendRequest(bA,wA,EA,xA,vA,e)}writeLock(e){return this.sendRequest(SA,AA,TA,kA,_A,e)}finalize(){this.channel.postMessage({type:CA,name:this.name}),this.channel.close()}async sendRequest(e,t,r,o,l,u){u?.signal?.throwIfAborted();const f=xI();return this.channel.postMessage({type:e,identifier:f,name:this.name}),new Promise((h,p)=>{const m=()=>{this.channel.postMessage({type:t,identifier:f,name:this.name})};u?.signal?.addEventListener("abort",m,{once:!0});const y=b=>{if(b.data?.identifier===f&&(b.data?.type===r&&(this.channel.removeEventListener("message",y),u?.signal?.removeEventListener("abort",m),h(()=>{this.channel.postMessage({type:l,identifier:f,name:this.name})})),b.data.type===o)){this.channel.removeEventListener("message",y),u?.signal?.removeEventListener("abort",m);const E=new Error;b.data.error!=null&&(E.message=b.data.error.message,E.name=b.data.error.name,E.stack=b.data.error.stack),p(E)}};this.channel.addEventListener("message",y)})}}const AI=n=>{if(n=Object.assign({},EI,n),!!globalThis.document||n.singleProcess){const t=new BroadcastChannel(NA),r=new Ss;return t.addEventListener("message",yE(r,t,"requestReadLock","abortReadLockRequest",bA,wA,xA,vA,EA)),t.addEventListener("message",yE(r,t,"requestWriteLock","abortWriteLockRequest",SA,AA,kA,_A,TA)),r}return new SI(n.name)},ys=new Map;let Il;function BA(n){return typeof n?.readLock=="function"&&typeof n?.writeLock=="function"}function _I(n){if(Il==null&&(Il=AI(n),!BA(Il))){const e=Il;e.addEventListener("requestReadLock",t=>{const r=t.detail.name,o=t.detail.identifier,l=ys.get(r);if(l==null)return;const u=new AbortController,f=h=>{h.detail.name!==r||h.detail.identifier!==o||u.abort()};e.addEventListener("abortReadLockRequest",f),l.readLock({signal:u.signal}).then(async h=>{await t.detail.handler().finally(()=>{h()})}).catch(h=>{t.detail.onError(h)}).finally(()=>{e.removeEventListener("abortReadLockRequest",f)})}),e.addEventListener("requestWriteLock",t=>{const r=t.detail.name,o=t.detail.identifier,l=ys.get(r);if(l==null)return;const u=new AbortController,f=h=>{h.detail.name!==r||h.detail.identifier!==o||u.abort()};e.addEventListener("abortWriteLockRequest",f),l.writeLock({signal:u.signal}).then(async h=>{await t.detail.handler().finally(()=>{h()})}).catch(h=>{t.detail.onError(h)}).finally(()=>{e.removeEventListener("abortWriteLockRequest",f)})}),e.addEventListener("finalizeRequest",t=>{const r=t.detail.name,o=ys.get(r);o?.finalize()})}return Il}async function hp(n,e){let t,r;const o=new Promise((u,f)=>{t=u,r=f}),l=()=>{r(new ta)};return e?.signal?.addEventListener("abort",l,{once:!0}),n.add(async()=>{await new Promise(u=>{t(()=>{e?.signal?.removeEventListener("abort",l),u()})})},{signal:e?.signal}).catch(u=>{r(u)}),o}const TI=(n,e)=>{let t=ys.get(n);if(t!=null)return t;const r=_I(e);if(BA(r))return t=r,ys.set(n,t),t;const o=new mE({concurrency:1});let l;return t={async readLock(u){if(l!=null)return hp(l,u);l=new mE({concurrency:e.concurrency,autoStart:!1});const f=l,h=hp(l,u);return o.add(async()=>{f.start(),await f.onIdle().then(()=>{l===f&&(l=null)})}),h},async writeLock(u){return l=null,hp(o,u)},finalize:()=>{ys.delete(n)},queue:o},ys.set(n,t),e.autoFinalize===!0&&o.addEventListener("idle",()=>{t.finalize()},{once:!0}),t},kI={name:"lock",concurrency:1/0,singleProcess:!1,autoFinalize:!1};function DA(n){const e=Object.assign({},kI,n);return TI(e.name,e)}class CI{lock;child;pins;started;constructor(e,t,r={}){this.child=e,this.pins=t,this.lock=DA({singleProcess:r.holdGcLock}),this.started=!1}isStarted(){return this.started}async start(){await hc(this.child),this.started=!0}async stop(){await gc(this.child),this.started=!1}unwrap(){return this.child}async put(e,t,r={}){r?.signal?.throwIfAborted();const o=await this.lock.readLock();try{return await this.child.put(e,t,r)}finally{o()}}async*putMany(e,t={}){t?.signal?.throwIfAborted();const r=await this.lock.readLock();try{yield*this.child.putMany(e,t)}finally{r()}}async get(e,t={}){t?.signal?.throwIfAborted();const r=await this.lock.readLock();try{return await this.child.get(e,t)}finally{r()}}async*getMany(e,t={}){t?.signal?.throwIfAborted();const r=await this.lock.readLock();try{yield*this.child.getMany(e,t)}finally{r()}}async delete(e,t={}){t?.signal?.throwIfAborted();const r=await this.lock.writeLock();try{if(await this.pins.isPinned(e))throw new Error("CID was pinned");await this.child.delete(e,t)}finally{r()}}async*deleteMany(e,t={}){t?.signal?.throwIfAborted();const r=await this.lock.writeLock();try{const o=this;yield*this.child.deleteMany((async function*(){for await(const l of e){if(await o.pins.isPinned(l))throw new Error("CID was pinned");yield l}})(),t)}finally{r()}}async has(e,t={}){t?.signal?.throwIfAborted();const r=await this.lock.readLock();try{return await this.child.has(e,t)}finally{r()}}async*getAll(e={}){e?.signal?.throwIfAborted();const t=await this.lock.readLock();try{yield*this.child.getAll(e)}finally{t()}}createSession(e,t){return t?.signal?.throwIfAborted(),this.child.createSession(e,t)}}const gp=new ot("/version"),bE=1;async function NI(n){if(!await n.has(gp)){await n.put(gp,de(`${bE}`));return}const e=await n.get(gp),t=Ee(e);if(parseInt(t,10)!==bE)throw new Error("Unknown datastore version, a datastore migration may be required")}const RA=42;function MA(n){return n instanceof ArrayBuffer?new Uint8Array(n,0,n.byteLength):n}function BI(n){if(n.asCID!==n&&n["/"]!==n.bytes)return null;const e=Se.asCID(n);if(!e)return null;const t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new le(P.tag,RA),new le(P.bytes,t)]}function DI(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function RI(n){if(Number.isNaN(n))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(n===1/0||n===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function MI(n){for(const e of n.keys())if(typeof e!="string"||e.length===0)throw new Error("Non-string Map keys are not supported by the IPLD Data Model and cannot be encoded");return null}const fm={float64:!0,typeEncoders:{Map:MI,Object:BI,undefined:DI,number:RI}},II={...fm,typeEncoders:{...fm.typeEncoders}};function OI(n){if(n[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Se.decode(n.subarray(1))}const Vf={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Vf.tags[RA]=OI;const LI={...Vf,tags:Vf.tags.slice()},UI="dag-cbor",IA=113,PI=n=>jl(n,fm),zI=n=>ki(MA(n),Vf),VI=Object.freeze(Object.defineProperty({__proto__:null,code:IA,decode:zI,decodeOptions:LI,encode:PI,encodeOptions:II,name:UI,toByteView:MA},Symbol.toStringTag,{value:"Module"}));class $I extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===P.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===P.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?e.push([44]):e.push([58]))))}[P.uint.major](e,t){this.prefix(e);const r=String(t.value),o=[];for(let l=0;l<r.length;l++)o[l]=r.charCodeAt(l);e.push(o)}[P.negint.major](e,t){this[P.uint.major](e,t)}[P.bytes.major](e,t){throw new Error(`${xs} unsupported type: Uint8Array`)}[P.string.major](e,t){this.prefix(e);const r=sA(JSON.stringify(t.value));e.push(r.length>32?Ay(r):r)}[P.array.major](e,t){this.prefix(e),this.inRecursive.push({type:P.array,elements:0}),e.push([91])}[P.map.major](e,t){this.prefix(e),this.inRecursive.push({type:P.map,elements:0}),e.push([123])}[P.tag.major](e,t){}[P.float.major](e,t){if(t.type.name==="break"){const u=this.inRecursive.pop();if(u){if(u.type===P.array)e.push([93]);else if(u.type===P.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${xs} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}const r=String(t.value),o=[];let l=!1;for(let u=0;u<r.length;u++)o[u]=r.charCodeAt(u),!l&&(o[u]===46||o[u]===101||o[u]===69)&&(l=!0);l||(o.push(46),o.push(48)),e.push(o)}}function HI(n,e){if(Array.isArray(n[0])||Array.isArray(e[0]))throw new Error(`${xs} complex map keys are not supported`);const t=n[0],r=e[0];if(t.type!==P.string||r.type!==P.string)throw new Error(`${xs} non-string map keys are not supported`);if(t<r)return-1;if(t>r)return 1;throw new Error(`${xs} unexpected duplicate map keys, this is not supported`)}const qI={addBreakTokens:!0,mapSorter:HI};function FI(n,e){return e=Object.assign({},qI,e),pA(n,new $I,e)}class OA{constructor(e,t={}){this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${we} unexpected end of input at position ${this._pos}`);for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error(`${we} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this._pos;let t=!1,r=!1;const o=f=>{for(;!this.done();){const h=this.ch();if(f.includes(h))this._pos++;else break}};if(this.ch()===45&&(t=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,r=!0;else return new le(P.uint,0,this._pos-e);if(o([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error(`${we} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(r)throw new Error(`${we} unexpected token at position ${this._pos}`);r=!0,this._pos++,o([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(r=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,o([48,49,50,51,52,53,54,55,56,57]));const l=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),u=parseFloat(l);return r?new le(P.float,u,this._pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(u)?new le(u>=0?P.uint:P.negint,u,this._pos-e):new le(u>=0?P.uint:P.negint,BigInt(l),this._pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${we} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let l=this._pos,u=0;l<this.data.length&&u<65536;l++,u++){const f=this.data[l];if(f===92||f<32||f>=128)break;if(f===34){const h=String.fromCharCode.apply(null,this.data.subarray(this._pos,l));return this._pos=l+1,new le(P.string,h,u)}}const e=this._pos,t=[],r=()=>{if(this._pos+4>=this.data.length)throw new Error(`${we} unexpected end of unicode escape sequence at position ${this._pos}`);let l=0;for(let u=0;u<4;u++){let f=this.ch();if(f>=48&&f<=57)f-=48;else if(f>=97&&f<=102)f=f-97+10;else if(f>=65&&f<=70)f=f-65+10;else throw new Error(`${we} unexpected unicode escape character at position ${this._pos}`);l=l*16+f,this._pos++}return l},o=()=>{const l=this.ch();let u=null,f=l>239?4:l>223?3:l>191?2:1;if(this._pos+f>this.data.length)throw new Error(`${we} unexpected unicode sequence at position ${this._pos}`);let h,p,m,y;switch(f){case 1:l<128&&(u=l);break;case 2:h=this.data[this._pos+1],(h&192)===128&&(y=(l&31)<<6|h&63,y>127&&(u=y));break;case 3:h=this.data[this._pos+1],p=this.data[this._pos+2],(h&192)===128&&(p&192)===128&&(y=(l&15)<<12|(h&63)<<6|p&63,y>2047&&(y<55296||y>57343)&&(u=y));break;case 4:h=this.data[this._pos+1],p=this.data[this._pos+2],m=this.data[this._pos+3],(h&192)===128&&(p&192)===128&&(m&192)===128&&(y=(l&15)<<18|(h&63)<<12|(p&63)<<6|m&63,y>65535&&y<1114112&&(u=y))}u===null?(u=65533,f=1):u>65535&&(u-=65536,t.push(u>>>10&1023|55296),u=56320|u&1023),t.push(u),this._pos+=f};for(;!this.done();){const l=this.ch();let u;switch(l){case 92:if(this._pos++,this.done())throw new Error(`${we} unexpected string termination at position ${this._pos}`);switch(u=this.ch(),this._pos++,u){case 34:case 39:case 92:case 47:t.push(u);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${we} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new le(P.string,oA(t),this._pos-e);default:if(l<32)throw new Error(`${we} invalid control character at position ${this._pos}`);l<128?(t.push(l),this._pos++):o()}}throw new Error(`${we} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new le(P.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new le(P.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new le(P.null,null,4);case 102:return this.expect([102,97,108,115,101]),new le(P.false,!1,5);case 116:return this.expect([116,114,117,101]),new le(P.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${we} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new le(P.break,void 0,1);if(this.ch()!==44)throw new Error(`${we} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new le(P.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new le(P.break,void 0,1);if(this.ch()!==44)throw new Error(`${we} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new le(P.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${we} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${we} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function KI(n,e){return e=Object.assign({tokenizer:new OA(n,e)},e),ki(n,e)}function jI(n){return n instanceof ArrayBuffer?new Uint8Array(n,0,n.byteLength):n}function GI(n){if(n.asCID!==n&&n["/"]!==n.bytes)return null;const e=Se.asCID(n);if(!e)return null;const t=e.toString();return[new le(P.map,1/0,1),new le(P.string,"/",1),new le(P.string,t,t.length),new le(P.break,void 0,1)]}function $f(n){const e=Fr.encode(n).slice(1);return[new le(P.map,1/0,1),new le(P.string,"/",1),new le(P.map,1/0,1),new le(P.string,"bytes",5),new le(P.string,e,e.length),new le(P.break,void 0,1),new le(P.break,void 0,1)]}function zn(n){return $f(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}function YI(n){return $f(new Uint8Array(n))}function ZI(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function XI(n){if(Number.isNaN(n))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(n===1/0||n===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const QI={typeEncoders:{Object:GI,Buffer:$f,Uint8Array:$f,Int8Array:zn,Uint16Array:zn,Int16Array:zn,Uint32Array:zn,Int32Array:zn,Float32Array:zn,Float64Array:zn,Uint8ClampedArray:zn,BigInt64Array:zn,BigUint64Array:zn,DataView:zn,ArrayBuffer:YI,undefined:ZI,number:XI}};class JI extends OA{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===P.map){const t=this._next();if(t.type===P.string&&t.value==="/"){const r=this._next();if(r.type===P.string){if(this._next().type!==P.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(r),new le(P.tag,42,0)}if(r.type===P.map){const o=this._next();if(o.type===P.string&&o.value==="bytes"){const l=this._next();if(l.type===P.string){for(let f=0;f<2;f++)if(this._next().type!==P.break)throw new Error("Invalid encoded Bytes form");const u=Fr.decode(`m${l.value}`);return new le(P.bytes,u,l.value.length)}this.tokenBuffer.push(l)}this.tokenBuffer.push(o)}this.tokenBuffer.push(r)}this.tokenBuffer.push(t)}return e}}const dm={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};dm.tags[42]=Se.parse;const WI="dag-json",LA=297,UA=n=>FI(n,QI),PA=n=>{const e=jI(n),t=Object.assign(dm,{tokenizer:new JI(e,dm)});return KI(e,t)},wE=n=>eO.decode(UA(n)),eO=new TextDecoder,tO=n=>PA(nO.encode(n)),nO=new TextEncoder,rO=Object.freeze(Object.defineProperty({__proto__:null,code:LA,decode:PA,encode:UA,format:wE,name:WI,parse:tO,stringify:wE},Symbol.toStringTag,{value:"Module"})),iO=new TextDecoder;function Oy(n,e){let t=0;for(let r=0;;r+=7){if(r>=64)throw new Error("protobuf: varint overflow");if(e>=n.length)throw new Error("protobuf: unexpected end of data");const o=n[e++];if(t+=r<28?(o&127)<<r:(o&127)*2**r,o<128)break}return[t,e]}function Hf(n,e){let t;[t,e]=Oy(n,e);const r=e+t;if(t<0||r<0)throw new Error("protobuf: invalid length");if(r>n.length)throw new Error("protobuf: unexpected end of data");return[n.subarray(e,r),r]}function zA(n,e){let t;return[t,e]=Oy(n,e),[t&7,t>>3,e]}function sO(n){const e={},t=n.length;let r=0;for(;r<t;){let o,l;if([o,l,r]=zA(n,r),l===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,r]=Hf(n,r)}else if(l===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let u;[u,r]=Hf(n,r),e.Name=iO.decode(u)}else if(l===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[e.Tsize,r]=Oy(n,r)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${l}`)}if(r>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function oO(n){const e=n.length;let t=0,r,o=!1,l;for(;t<e;){let f,h;if([f,h,t]=zA(n,t),f!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${f}`);if(h===1){if(l)throw new Error("protobuf: (PBNode) duplicate Data section");[l,t]=Hf(n,t),r&&(o=!0)}else if(h===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");r||(r=[]);let p;[p,t]=Hf(n,t),r.push(sO(p))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${h}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");const u={};return l&&(u.Data=l),u.Links=r||[],u}const VA=new TextEncoder,vE=2**32,aO=2**31;function lO(n,e){let t=e.length;if(typeof n.Tsize=="number"){if(n.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(n.Tsize))throw new Error("Tsize too large for encoding");t=Gl(e,t,n.Tsize)-1,e[t]=24}if(typeof n.Name=="string"){const r=VA.encode(n.Name);t-=r.length,e.set(r,t),t=Gl(e,t,r.length)-1,e[t]=18}return n.Hash&&(t-=n.Hash.length,e.set(n.Hash,t),t=Gl(e,t,n.Hash.length)-1,e[t]=10),e.length-t}function cO(n){const e=fO(n),t=new Uint8Array(e);let r=e;if(n.Data&&(r-=n.Data.length,t.set(n.Data,r),r=Gl(t,r,n.Data.length)-1,t[r]=10),n.Links)for(let o=n.Links.length-1;o>=0;o--){const l=lO(n.Links[o],t.subarray(0,r));r-=l,r=Gl(t,r,l)-1,t[r]=18}return t}function uO(n){let e=0;if(n.Hash){const t=n.Hash.length;e+=1+t+Yo(t)}if(typeof n.Name=="string"){const t=VA.encode(n.Name).length;e+=1+t+Yo(t)}return typeof n.Tsize=="number"&&(e+=1+Yo(n.Tsize)),e}function fO(n){let e=0;if(n.Data){const t=n.Data.length;e+=1+t+Yo(t)}if(n.Links)for(const t of n.Links){const r=uO(t);e+=1+r+Yo(r)}return e}function Gl(n,e,t){e-=Yo(t);const r=e;for(;t>=aO;)n[e++]=t&127|128,t/=128;for(;t>=128;)n[e++]=t&127|128,t>>>=7;return n[e]=t,r}function Yo(n){return n%2===0&&n++,Math.floor((dO(n)+6)/7)}function dO(n){let e=0;return n>=vE&&(n=Math.floor(n/vE),e=32),n>=65536&&(n>>>=16,e+=16),n>=256&&(n>>>=8,e+=8),e+hO[n]}const hO=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],gO=["Data","Links"],pO=["Hash","Name","Tsize"],hm=new TextEncoder;function $A(n,e){if(n===e)return 0;const t=n.Name?hm.encode(n.Name):[],r=e.Name?hm.encode(e.Name):[];let o=t.length,l=r.length;for(let u=0,f=Math.min(o,l);u<f;++u)if(t[u]!==r[u]){o=t[u],l=r[u];break}return o<l?-1:l<o?1:0}function EE(n,e){return!Object.keys(n).some(t=>!e.includes(t))}function HA(n){if(typeof n.asCID=="object"){const t=Se.asCID(n);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof n!="object"||Array.isArray(n))throw new TypeError("Invalid DAG-PB form");const e={};if(n.Hash){let t=Se.asCID(n.Hash);try{t||(typeof n.Hash=="string"?t=Se.parse(n.Hash):n.Hash instanceof Uint8Array&&(t=Se.decode(n.Hash)))}catch(r){throw new TypeError(`Invalid DAG-PB form: ${r.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof n.Name=="string"&&(e.Name=n.Name),typeof n.Tsize=="number"&&(e.Tsize=n.Tsize),e}function qA(n){if((n instanceof Uint8Array||typeof n=="string")&&(n={Data:n}),typeof n!="object"||Array.isArray(n))throw new TypeError("Invalid DAG-PB form");const e={};if(n.Data!==void 0)if(typeof n.Data=="string")e.Data=hm.encode(n.Data);else if(n.Data instanceof Uint8Array)e.Data=n.Data;else throw new TypeError("Invalid DAG-PB form");if(n.Links!==void 0)if(Array.isArray(n.Links))e.Links=n.Links.map(HA),e.Links.sort($A);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function FA(n){if(!n||typeof n!="object"||Array.isArray(n)||n instanceof Uint8Array||n["/"]&&n["/"]===n.bytes)throw new TypeError("Invalid DAG-PB form");if(!EE(n,gO))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(n.Data!==void 0&&!(n.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(n.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let e=0;e<n.Links.length;e++){const t=n.Links[e];if(!t||typeof t!="object"||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!EE(t,pO))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(t.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash==null||!t.Hash["/"]||t.Hash["/"]!==t.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0){if(typeof t.Tsize!="number"||t.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(e>0&&$A(t,n.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function mO(n,e=[]){return qA({Data:n,Links:e})}function yO(n,e,t){return HA({Hash:t,Name:n,Tsize:e})}function bO(n){return n instanceof ArrayBuffer?new Uint8Array(n,0,n.byteLength):n}const wO="dag-pb",KA=112;function vO(n){FA(n);const e={};return n.Links&&(e.Links=n.Links.map(t=>{const r={};return t.Hash&&(r.Hash=t.Hash.bytes),t.Name!==void 0&&(r.Name=t.Name),t.Tsize!==void 0&&(r.Tsize=t.Tsize),r})),n.Data&&(e.Data=n.Data),cO(e)}function EO(n){const e=bO(n),t=oO(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map(o=>{const l={};try{l.Hash=Se.decode(o.Hash)}catch{}if(!l.Hash)throw new Error("Invalid Hash field found in link, expected CID");return o.Name!==void 0&&(l.Name=o.Name),o.Tsize!==void 0&&(l.Tsize=o.Tsize),l})),r}const xO=Object.freeze(Object.defineProperty({__proto__:null,code:KA,createLink:yO,createNode:mO,decode:EO,encode:vO,name:wO,prepare:qA,validate:FA},Symbol.toStringTag,{value:"Module"}));function Ly(n){return n?.then!=null}function SO(n=[],e){const t={[KA]:xO,[ny]:FN,[IA]:VI,[LA]:rO,[R2]:VN};return n.forEach(r=>{t[r.code]=r}),async r=>{let o=t[r];if(o==null&&e!=null){const l=e(r);Ly(l)?o=await l:o=l,t[o.code]=o}if(o!=null)return o;throw new gI(`Could not load codec for ${r}`)}}function AO(n=[],e){const t={[na.code]:na,[B1.code]:B1,[Mi.code]:Mi};return n.forEach(r=>{t[r.code]=r}),async r=>{let o=t[r];if(o==null&&e!=null){const l=e(r);Ly(l)?o=await l:o=l,t[o.code]=o}if(o!=null)return o;throw new hI(`No hasher configured for multihash code 0x${r.toString(16)}, please configure one. You can look up which hash this is at https://github.com/multiformats/multicodec/blob/master/table.csv`)}}class la extends Error{static name="NotFoundError";static code="ERR_NOT_FOUND";name=la.name;code=la.code;constructor(e="Not Found"){super(e)}}class jA{has(e,t){return Promise.reject(new Error(".has is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}async*putMany(e,t){for await(const{cid:r,block:o}of e)await this.put(r,o,t),yield r}get(e,t){return Promise.reject(new Error(".get is not implemented"))}async*getMany(e,t){for await(const r of e)yield{cid:r,block:await this.get(r,t)}}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(e,t){for await(const r of e)await this.delete(r,t),yield r}async*getAll(e){throw new Error(".getAll is not implemented")}}const sf=0;class _O extends jA{child;constructor(e){super(),this.child=e}put(e,t,r){return e.multihash.code===sf||this.child==null?(r?.signal?.throwIfAborted(),e):this.child.put(e,t,r)}get(e,t){if(e.multihash.code===sf)return t?.signal?.throwIfAborted(),e.multihash.digest;if(this.child==null)throw t?.signal?.throwIfAborted(),new la;return this.child.get(e,t)}has(e,t){return e.multihash.code===sf?(t?.signal?.throwIfAborted(),!0):this.child==null?(t?.signal?.throwIfAborted(),!1):this.child.has(e,t)}delete(e,t){if(e.code===sf){t?.signal?.throwIfAborted();return}if(this.child!=null)return this.child.delete(e,t)}getAll(e){return this.child!=null?this.child.getAll(e):(e?.signal?.throwIfAborted(),[])}}function TO(n){return n[Symbol.asyncIterator]!=null}function cs(n,e){let t=0;if(TO(n))return(async function*(){for await(const h of n)await e(h,t++)&&(yield h)})();const r=Wm(n),{value:o,done:l}=r.next();if(l===!0)return(function*(){})();const u=e(o,t++);if(typeof u.then=="function")return(async function*(){await u&&(yield o);for(const h of r)await e(h,t++)&&(yield h)})();const f=e;return(function*(){u===!0&&(yield o);for(const h of r)f(h,t++)&&(yield h)})()}function kO(n){return n[Symbol.asyncIterator]!=null}function xE(n){return n?.then!=null}function SE(n,e){let t=0;if(kO(n))return(async function*(){for await(const h of n){const p=e(h,t++);xE(p)&&await p,yield h}})();const r=Wm(n),{value:o,done:l}=r.next();if(l===!0)return(function*(){})();if(typeof e(o,t++)?.then=="function")return(async function*(){yield o;for(const h of r){const p=e(h,t++);xE(p)&&await p,yield h}})();const f=e;return(function*(){yield o;for(const h of r)f(h,t++),yield h})()}class GA{child;getHasher;log;logger;components;constructor(e){this.log=e.logger.forComponent("helia:networked-storage"),this.logger=e.logger,this.components=e,this.child=new _O(e.blockstore),this.getHasher=e.getHasher}async put(e,t,r={}){return await this.child.has(e,r)?(r.onProgress?.(new Le("blocks:put:duplicate",e)),e):(r.onProgress?.(new Le("blocks:put:providers:notify",e)),await Promise.all(this.components.blockBrokers.map(async o=>o.announce?.(e,t,r))),r.onProgress?.(new Le("blocks:put:blockstore:put",e)),this.child.put(e,t,r))}async*putMany(e,t={}){const r=cs(e,async({cid:l})=>{const u=await this.child.has(l,t);return u&&t.onProgress?.(new Le("blocks:put-many:duplicate",l)),!u}),o=SE(r,async({cid:l,block:u})=>{t.onProgress?.(new Le("blocks:put-many:providers:notify",l)),await Promise.all(this.components.blockBrokers.map(async f=>f.announce?.(l,u,t)))});t.onProgress?.(new Le("blocks:put-many:blockstore:put-many")),yield*this.child.putMany(o,t)}async get(e,t={}){if(t.offline!==!0&&!await this.child.has(e,t)){const r=await this.getHasher(e.multihash.code);t.onProgress?.(new Le("blocks:get:providers:get",e));const o=await AE(e,this.components.blockBrokers,r,{...t,log:this.log});return t.onProgress?.(new Le("blocks:get:blockstore:put",e)),await this.child.put(e,o,t),t.onProgress?.(new Le("blocks:get:providers:notify",e)),await Promise.all(this.components.blockBrokers.map(async l=>l.announce?.(e,o,t))),o}return t.onProgress?.(new Le("blocks:get:blockstore:get",e)),this.child.get(e,t)}async*getMany(e,t={}){t.onProgress?.(new Le("blocks:get-many:blockstore:get-many")),yield*this.child.getMany(SE(e,async r=>{if(t.offline!==!0&&!await this.child.has(r,t)){const o=await this.getHasher(r.multihash.code);t.onProgress?.(new Le("blocks:get-many:providers:get",r));const l=await AE(r,this.components.blockBrokers,o,{...t,log:this.log});t.onProgress?.(new Le("blocks:get-many:blockstore:put",r)),await this.child.put(r,l,t),t.onProgress?.(new Le("blocks:get-many:providers:notify",r)),await Promise.all(this.components.blockBrokers.map(async u=>u.announce?.(r,l,t)))}}))}async delete(e,t={}){t.onProgress?.(new Le("blocks:delete:blockstore:delete",e)),await this.child.delete(e,t)}async*deleteMany(e,t={}){t.onProgress?.(new Le("blocks:delete-many:blockstore:delete-many")),yield*this.child.deleteMany((async function*(){for await(const r of e)yield r})(),t)}async has(e,t={}){return this.child.has(e,t)}async*getAll(e={}){e.onProgress?.(new Le("blocks:get-all:blockstore:get-many")),yield*this.child.getAll(e)}}class CO extends GA{started;constructor(e){super(e),this.started=!1}isStarted(){return this.started}async start(){await hc(this.child,...this.components.blockBrokers),this.started=!0}async stop(){await gc(this.child,...this.components.blockBrokers),this.started=!1}unwrap(){return this.child}createSession(e,t){const r=this.components.blockBrokers.map(o=>o.createSession==null?o:o.createSession(t));return new NO({blockstore:this.child,blockBrokers:r,getHasher:this.getHasher,logger:this.logger},{root:e})}}class NO extends GA{closeController;constructor(e,t){super(e),this.closeController=new AbortController,this.closeController.signal,this.log=e.logger.forComponent(`helia:session-storage:${t.root}`)}close(){this.closeController.abort()}async put(e,t,r={}){const o=Nt([this.closeController.signal,r.signal]);try{return await super.put(e,t,{...r,signal:o})}finally{o.clear()}}async*putMany(e,t={}){const r=Nt([this.closeController.signal,t.signal]);try{yield*super.putMany(e,{...t,signal:r})}finally{r.clear()}}async get(e,t={}){const r=Nt([this.closeController.signal,t.signal]);try{return await super.get(e,{...t,signal:r})}finally{r.clear()}}async*getMany(e,t={}){const r=Nt([this.closeController.signal,t.signal]);try{yield*super.getMany(e,{...t,signal:r})}finally{r.clear()}}async delete(e,t={}){const r=Nt([this.closeController.signal,t.signal]);try{await super.delete(e,{...t,signal:r})}finally{r.clear()}}async*deleteMany(e,t={}){const r=Nt([this.closeController.signal,t.signal]);try{yield*super.deleteMany(e,{...t,signal:r})}finally{r.clear()}}async has(e,t={}){const r=Nt([this.closeController.signal,t.signal]);try{return await super.has(e,{...t,signal:r})}finally{r.clear()}}async*getAll(e={}){const t=Nt([this.closeController.signal,e.signal]);try{yield*super.getAll({...e,signal:t})}finally{t.clear()}}}function BO(n){return typeof n.retrieve=="function"}const DO=(n,e)=>{if(e==null)throw new ge(`No hasher configured for multihash code 0x${n.multihash.code.toString(16)}, please configure one. You can look up which hash this is at https://github.com/multiformats/multicodec/blob/master/table.csv`);return async t=>{let r;const o=e.digest(t);if(Ly(o)?r=await o:r=o,!et(r.digest,n.multihash.digest))throw new jm("Hash of downloaded block did not match multihash from passed CID")}};async function AE(n,e,t,r){const o=DO(n,t),l=new AbortController,u=Nt([l.signal,r.signal]);l.signal;const f=[];for(const h of e)BO(h)&&f.push(h);try{return await Promise.any(f.map(async h=>{try{let p=!1;const m=await h.retrieve(n,{...r,signal:u,validateFn:async y=>{await o(y),p=!0}});return p||await o(m),m}catch(p){throw r.log.error("could not retrieve verified block for %c",n,p),p}}))}finally{l.abort(),u.clear()}}class RO extends Ss{initialPeerSearchComplete;requests;name;log;logger;minProviders;maxProviders;providers;evictionFilter;initialProviders;constructor(e,t){super(),this.name=t.name,this.logger=e.logger,this.log=e.logger.forComponent(this.name),this.requests=new Map,this.minProviders=t.minProviders??uI,this.maxProviders=t.maxProviders??fI,this.providers=[],this.evictionFilter=Sy(this.maxProviders),this.initialProviders=t.providers??[]}async retrieve(e,t={}){const r=Fr.encode(e.multihash.bytes),o=this.requests.get(r);if(o!=null)return this.log("join existing request for %c",e),o;const l=We();if(this.requests.set(r,l.promise),this.providers.length===0){let m=!1;this.initialPeerSearchComplete==null&&(m=!0,this.log=this.logger.forComponent(`${this.name}:${e}`),this.initialPeerSearchComplete=this.findProviders(e,this.minProviders,t)),await this.initialPeerSearchComplete,m&&this.log("found initial session peers for %c",e)}let u=!1;const f=new Wl({concurrency:this.maxProviders});f.addEventListener("error",()=>{}),f.addEventListener("failure",m=>{this.log.error("error querying provider %o, evicting from session",m.detail.job.options.provider,m.detail.error),this.evict(m.detail.job.options.provider)}),f.addEventListener("success",m=>{u=!0,l.resolve(m.detail.result)}),f.addEventListener("idle",()=>{if(u||t.signal?.aborted===!0){this.log.trace("session idle, found block");return}Promise.resolve().then(async()=>{this.log("no session peers had block for for %c, finding new providers",e);for(let m=0;m<this.minProviders&&this.providers.length!==0;m++){const y=this.providers[Math.floor(Math.random()*this.providers.length)];this.evict(y)}await this.findProviders(e,this.minProviders,t),this.log("found new providers re-retrieving %c",e),this.requests.delete(r),l.resolve(await this.retrieve(e,t))}).catch(m=>{this.log.error("could not find new providers for %c",e,m),l.reject(m)})});const h=m=>{f.add(async()=>this.queryProvider(e,m.detail,t),{provider:m.detail}).catch(y=>{t.signal?.aborted!==!0&&this.log.error("error retrieving session block for %c",e,y)})};this.addEventListener("provider",h),Promise.all([...this.providers].map(async m=>f.add(async()=>this.queryProvider(e,m,t),{provider:m}))).catch(m=>{t.signal?.aborted!==!0&&this.log.error("error retrieving session block for %c",e,m)});const p=()=>{l.reject(new ea(t.signal?.reason??"Session aborted")),f.abort()};t.signal?.addEventListener("abort",p);try{return await l.promise}finally{this.removeEventListener("provider",h),t.signal?.removeEventListener("abort",p),f.clear(),this.requests.delete(r)}}evict(e){this.evictionFilter.add(this.toEvictionKey(e));const t=this.providers.findIndex(r=>this.equals(r,e));t!==-1&&this.providers.splice(t,1)}isEvicted(e){return this.evictionFilter.has(this.toEvictionKey(e))}hasProvider(e){return!!(this.providers.find(t=>this.equals(t,e))!=null||this.isEvicted(e))}async findProviders(e,t,r){const o=We();let l=0;return Promise.resolve().then(async()=>{if(this.log("finding %d-%d new provider(s) for %c",t,this.maxProviders,e),this.initialProviders.length>0)for(;l<t&&this.initialProviders.length>0;){const u=this.initialProviders.pop();if(u==null)break;const f=await this.convertToProvider(u,r);if(r.signal?.aborted===!0)break;if(f!=null&&!this.hasProvider(f)&&(this.log("found %d/%d new providers",l,this.maxProviders),this.providers.push(f),this.safeDispatchEvent("provider",{detail:f}),l++,l===t&&(this.log("session is ready"),o.resolve()),this.providers.length===this.maxProviders)){this.log("found max session peers",l);break}}if(l<this.maxProviders)for await(const u of this.findNewProviders(e,r)){if(l===this.maxProviders||r.signal?.aborted===!0)break;if(!this.hasProvider(u)&&(this.log("found %d/%d new providers",l,this.maxProviders),this.providers.push(u),this.safeDispatchEvent("provider",{detail:u}),l++,l===t&&(this.log("session is ready"),o.resolve()),this.providers.length===this.maxProviders)){this.log("found max session peers",l);break}}if(this.log("found %d/%d new session peers",l,this.maxProviders),l<t)throw new dI(`Found ${l} of ${t} ${this.name} providers for ${e}`)}).catch(u=>{this.log.error("error searching routing for potential session peers for %c",e,u.errors??u),o.reject(u)}),o.promise}}class MO{libp2p;blockstore;datastore;pins;logger;routing;getCodec;getHasher;dns;metrics;log;constructor(e){this.logger=e.logger??dd(),this.log=this.logger.forComponent("helia"),this.getHasher=AO(e.hashers,e.loadHasher),this.getCodec=SO(e.codecs,e.loadCodec),this.dns=e.dns??iA(),this.metrics=e.metrics,this.libp2p=e.libp2p;const t={blockstore:e.blockstore,datastore:e.datastore,logger:this.logger,libp2p:this.libp2p,blockBrokers:[],getHasher:this.getHasher,getCodec:this.getCodec,dns:this.dns,metrics:this.metrics,...e.components??{}};this.routing=t.routing=new mI(t,{routers:(e.routers??[]).flatMap(o=>{const l=[o];return o[Xl]!=null&&l.push(o[Xl]),o[Ql]!=null&&l.push(o[Ql]),l}),providerLookupConcurrency:e.providerLookupConcurrency});const r=new CO(t);this.pins=new cI(e.datastore,r,this.getCodec),this.blockstore=new CI(r,this.pins,{holdGcLock:e.holdGcLock??!0}),this.datastore=e.datastore,t.blockBrokers=e.blockBrokers.map(o=>o(t))}async start(){await NI(this.datastore),await hc(this.blockstore,this.datastore,this.routing,this.libp2p)}async stop(){await gc(this.blockstore,this.datastore,this.routing,this.libp2p)}async gc(e={}){const t=await this.blockstore.lock.writeLock();try{const r=this,o=this.blockstore.unwrap();this.log("gc start"),await Gp(o.deleteMany((async function*(){for await(const{cid:l}of o.getAll())try{if(await r.pins.isPinned(l,e))continue;yield l,e.onProgress?.(new Le("helia:gc:deleted",l))}catch(u){r.log.error("Error during gc",u),e.onProgress?.(new Le("helia:gc:error",u))}})()))}finally{t()}this.log("gc finished")}}class IO extends Map{metric;constructor(e){super();const{name:t,metrics:r}=e;this.metric=r.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function qr(n){const{name:e,metrics:t}=n;let r;return t!=null?r=new IO({name:e,metrics:t}):r=new Map,r}class Rn extends Error{static name="InvalidMultiaddrError";name="InvalidMultiaddrError"}class ac extends Error{static name="ValidationError";name="ValidationError"}class OO extends Error{static name="InvalidParametersError";name="InvalidParametersError"}class LO extends Error{static name="UnknownProtocolError";name="UnknownProtocolError"}class UO{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,r=e();return r===void 0&&(this.index=t),r}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{const t=this.readChar();if(t===e)return t})}readSeparator(e,t,r){return this.readAtomically(()=>{if(!(t>0&&this.readGivenChar(e)===void 0))return r()})}readNumber(e,t,r,o){return this.readAtomically(()=>{let l=0,u=0;const f=this.peekChar();if(f===void 0)return;const h=f==="0",p=2**(8*o)-1;for(;;){const m=this.readAtomically(()=>{const y=this.readChar();if(y===void 0)return;const b=Number.parseInt(y,e);if(!Number.isNaN(b))return b});if(m===void 0)break;if(l*=e,l+=m,l>p||(u+=1,t!==void 0&&u>t))return}if(u!==0)return!r&&h&&u>1?void 0:l})}readIPv4Addr(){return this.readAtomically(()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const r=this.readSeparator(".",t,()=>this.readNumber(10,3,!1,1));if(r===void 0)return;e[t]=r}return e})}readIPv6Addr(){const e=t=>{for(let r=0;r<t.length/2;r++){const o=r*2;if(r<t.length-3){const u=this.readSeparator(":",r,()=>this.readIPv4Addr());if(u!==void 0)return t[o]=u[0],t[o+1]=u[1],t[o+2]=u[2],t[o+3]=u[3],[o+4,!0]}const l=this.readSeparator(":",r,()=>this.readNumber(16,4,!0,2));if(l===void 0)return[o,!1];t[o]=l>>8,t[o+1]=l&255}return[t.length,!1]};return this.readAtomically(()=>{const t=new Uint8Array(16),[r,o]=e(t);if(r===16)return t;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const l=new Uint8Array(14),u=16-(r+2),[f]=e(l.subarray(0,u));return t.set(l.subarray(0,f),16-f),t})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const YA=45,PO=15,ca=new UO;function ZA(n){if(!(n.length>PO))return ca.new(n).parseWith(()=>ca.readIPv4Addr())}function XA(n){if(n.includes("%")&&(n=n.split("%")[0]),!(n.length>YA))return ca.new(n).parseWith(()=>ca.readIPv6Addr())}function gm(n,e=!1){if(n.includes("%")&&(n=n.split("%")[0]),n.length>YA)return;const t=ca.new(n).parseWith(()=>ca.readIPAddr());if(t)return e&&t.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,t[0],t[1],t[2],t[3]]):t}function ua(n){return!!ZA(n)}function QA(n){return!!XA(n)}const ks=4,Pr=6,qf=273,zO=33,zr=41,_a=42,Uy=43,Ac=53,_c=54,Ta=55,Tc=56,VO=132,$O=301,HO=302,JA=400,Ke=421,qO=444,FO=445,KO=446,jO=447,Zo=448,WA=449,GO=454,e_=460,t_=461,n_=465,lc=466,Xo=480,YO=481,pm=443,Py=477,r_=478,ZO=479,XO=277,QO=275,JO=276,i_=280,mf=281,md=290,s_=777;function _E(n){return e=>Ee(e,n)}function TE(n){return e=>de(e,n)}function $l(n){return new DataView(n.buffer).getUint16(n.byteOffset).toString()}function Oo(n){const e=new ArrayBuffer(2);return new DataView(e).setUint16(0,typeof n=="string"?parseInt(n):n),new Uint8Array(e)}function WO(n){const e=n.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);const t=de(e[0],"base32"),r=parseInt(e[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const o=Oo(r);return fr([t,o],t.length+o.length)}function eL(n){const e=n.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);const t=wn.decode(`b${e[0]}`),r=parseInt(e[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const o=Oo(r);return fr([t,o],t.length+o.length)}function kE(n){const e=n.subarray(0,n.length-2),t=n.subarray(n.length-2),r=Ee(e,"base32"),o=$l(t);return`${r}:${o}`}const o_=function(n){n=n.toString().trim();const e=new Uint8Array(4);return n.split(/\./g).forEach((t,r)=>{const o=parseInt(t,10);if(isNaN(o)||o<0||o>255)throw new Rn("Invalid byte value in IP address");e[r]=o}),e},tL=function(n){let e=0;n=n.toString().trim();const t=n.split(":",8);let r;for(r=0;r<t.length;r++){const l=ua(t[r]);let u;l&&(u=o_(t[r]),t[r]=Ee(u.subarray(0,2),"base16")),u!=null&&++r<8&&t.splice(r,0,Ee(u.subarray(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(r=0;r<t.length&&t[r]!=="";r++);const l=[r,1];for(r=9-t.length;r>0;r--)l.push("0");t.splice.apply(t,l)}const o=new Uint8Array(e+16);for(r=0;r<t.length;r++){t[r]===""&&(t[r]="0");const l=parseInt(t[r],16);if(isNaN(l)||l<0||l>65535)throw new Rn("Invalid byte value in IP address");o[e++]=l>>8&255,o[e++]=l&255}return o},nL=function(n){if(n.byteLength!==4)throw new Rn("IPv4 address was incorrect length");const e=[];for(let t=0;t<n.byteLength;t++)e.push(n[t]);return e.join(".")},rL=function(n){if(n.byteLength!==16)throw new Rn("IPv6 address was incorrect length");const e=[];for(let r=0;r<n.byteLength;r+=2){const o=n[r],l=n[r+1],u=`${o.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`;e.push(u)}const t=e.join(":");try{const r=new URL(`http://[${t}]`);return r.hostname.substring(1,r.hostname.length-1)}catch{throw new Rn(`Invalid IPv6 address "${t}"`)}};function iL(n){try{const e=new URL(`http://[${n}]`);return e.hostname.substring(1,e.hostname.length-1)}catch{throw new Rn(`Invalid IPv6 address "${n}"`)}}const pp=Object.values(Qp).map(n=>n.decoder),sL=(function(){let n=pp[0].or(pp[1]);return pp.slice(2).forEach(e=>n=n.or(e)),n})();function oL(n){return sL.decode(n)}function aL(n){return e=>n.encoder.encode(e)}function lL(n){if(parseInt(n).toString()!==n)throw new ac("Value must be an integer")}function cL(n){if(n<0)throw new ac("Value must be a positive integer, or zero")}function uL(n){return e=>{if(e>n)throw new ac(`Value must be smaller than or equal to ${n}`)}}function fL(...n){return e=>{for(const t of n)t(e)}}const of=fL(lL,cL,uL(65535)),Ft=-1;class dL{protocolsByCode=new Map;protocolsByName=new Map;getProtocol(e){let t;if(typeof e=="string"?t=this.protocolsByName.get(e):t=this.protocolsByCode.get(e),t==null)throw new LO(`Protocol ${e} was unknown`);return t}addProtocol(e){this.protocolsByCode.set(e.code,e),this.protocolsByName.set(e.name,e),e.aliases?.forEach(t=>{this.protocolsByName.set(t,e)})}removeProtocol(e){const t=this.protocolsByCode.get(e);t!=null&&(this.protocolsByCode.delete(t.code),this.protocolsByName.delete(t.name),t.aliases?.forEach(r=>{this.protocolsByName.delete(r)}))}}const ur=new dL,hL=[{code:ks,name:"ip4",size:32,valueToBytes:o_,bytesToValue:nL,validate:n=>{if(!ua(n))throw new ac(`Invalid IPv4 address "${n}"`)}},{code:Pr,name:"tcp",size:16,valueToBytes:Oo,bytesToValue:$l,validate:of},{code:qf,name:"udp",size:16,valueToBytes:Oo,bytesToValue:$l,validate:of},{code:zO,name:"dccp",size:16,valueToBytes:Oo,bytesToValue:$l,validate:of},{code:zr,name:"ip6",size:128,valueToBytes:tL,bytesToValue:rL,stringToValue:iL,validate:n=>{if(!QA(n))throw new ac(`Invalid IPv6 address "${n}"`)}},{code:_a,name:"ip6zone",size:Ft},{code:Uy,name:"ipcidr",size:8,bytesToValue:_E("base10"),valueToBytes:TE("base10")},{code:Ac,name:"dns",size:Ft,resolvable:!0},{code:_c,name:"dns4",size:Ft,resolvable:!0},{code:Ta,name:"dns6",size:Ft,resolvable:!0},{code:Tc,name:"dnsaddr",size:Ft,resolvable:!0},{code:VO,name:"sctp",size:16,valueToBytes:Oo,bytesToValue:$l,validate:of},{code:$O,name:"udt"},{code:HO,name:"utp"},{code:JA,name:"unix",size:Ft,path:!0,stringToValue:n=>decodeURIComponent(n),valueToString:n=>encodeURIComponent(n)},{code:Ke,name:"p2p",aliases:["ipfs"],size:Ft,bytesToValue:_E("base58btc"),valueToBytes:n=>n.startsWith("Q")||n.startsWith("1")?TE("base58btc")(n):Se.parse(n).multihash.bytes},{code:qO,name:"onion",size:96,bytesToValue:kE,valueToBytes:WO},{code:FO,name:"onion3",size:296,bytesToValue:kE,valueToBytes:eL},{code:KO,name:"garlic64",size:Ft},{code:jO,name:"garlic32",size:Ft},{code:Zo,name:"tls"},{code:WA,name:"sni",size:Ft},{code:GO,name:"noise"},{code:e_,name:"quic"},{code:t_,name:"quic-v1"},{code:n_,name:"webtransport"},{code:lc,name:"certhash",size:Ft,bytesToValue:aL(D2),valueToBytes:oL},{code:Xo,name:"http"},{code:YO,name:"http-path",size:Ft,stringToValue:n=>`/${decodeURIComponent(n)}`,valueToString:n=>encodeURIComponent(n.substring(1))},{code:pm,name:"https"},{code:Py,name:"ws"},{code:r_,name:"wss"},{code:ZO,name:"p2p-websocket-star"},{code:XO,name:"p2p-stardust"},{code:QO,name:"p2p-webrtc-star"},{code:JO,name:"p2p-webrtc-direct"},{code:i_,name:"webrtc-direct"},{code:mf,name:"webrtc"},{code:md,name:"p2p-circuit"},{code:s_,name:"memory",size:Ft}];hL.forEach(n=>{ur.addProtocol(n)});function gL(n){const e=[];let t=0;for(;t<n.length;){const r=Jm(n,t),o=ur.getProtocol(r),l=Xn(r),u=bL(o,n,t+l);let f=0;u>0&&o.size===Ft&&(f=Xn(u));const h=l+f+u,p={code:r,name:o.name,bytes:n.subarray(t,t+h)};if(u>0){const m=t+l+f,y=n.subarray(m,m+u);p.value=o.bytesToValue?.(y)??Ee(y)}e.push(p),t+=h}return e}function pL(n){let e=0;const t=[];for(const r of n){if(r.bytes==null){const o=ur.getProtocol(r.code),l=Xn(r.code);let u,f=0,h=0;r.value!=null&&(u=o.valueToBytes?.(r.value)??de(r.value),f=u.byteLength,o.size===Ft&&(h=Xn(f)));const p=new Uint8Array(l+h+f);let m=0;Sf(r.code,p,m),m+=l,u!=null&&(o.size===Ft&&(Sf(f,p,m),m+=h),p.set(u,m)),r.bytes=p}t.push(r.bytes),e+=r.bytes.byteLength}return fr(t,e)}function mL(n){if(n.charAt(0)!=="/")throw new Rn('String multiaddr must start with "/"');const e=[];let t="protocol",r="",o="";for(let l=1;l<n.length;l++){const u=n.charAt(l);u!=="/"&&(t==="protocol"?o+=n.charAt(l):r+=n.charAt(l));const f=l===n.length-1;if(u==="/"||f){const h=ur.getProtocol(o);if(t==="protocol"){if(h.size==null||h.size===0){e.push({code:h.code,name:h.name}),r="",o="",t="protocol";continue}else if(f)throw new Rn(`Component ${o} was missing value`);t="value"}else if(t==="value"){const p={code:h.code,name:h.name};if(h.size!=null&&h.size!==0){if(r==="")throw new Rn(`Component ${o} was missing value`);p.value=h.stringToValue?.(r)??r}e.push(p),r="",o="",t="protocol"}}}if(o!==""&&r!=="")throw new Rn("Incomplete multiaddr");return e}function yL(n){return`/${n.flatMap(e=>{if(e.value==null)return e.name;const t=ur.getProtocol(e.code);if(t==null)throw new Rn(`Unknown protocol code ${e.code}`);return[e.name,t.valueToString?.(e.value)??e.value]}).join("/")}`}function bL(n,e,t){return n.size==null||n.size===0?0:n.size>0?n.size/8:Jm(e,t)}const wL=Symbol.for("nodejs.util.inspect.custom"),a_=Symbol.for("@multiformats/multiaddr"),vL=[Ac,_c,Ta,Tc];class EL extends Error{constructor(e="No available resolver"){super(e),this.name="NoAvailableResolverError"}}function xL(n){if(n==null&&(n="/"),yd(n))return n.getComponents();if(n instanceof Uint8Array)return gL(n);if(typeof n=="string")return n=n.replace(/\/(\/)+/,"/").replace(/(\/)+$/,""),n===""&&(n="/"),mL(n);if(Array.isArray(n))return n;throw new Rn("Must be a string, Uint8Array, Component[], or another Multiaddr")}class Lo{[a_]=!0;#e;#t;#n;constructor(e="/",t={}){this.#e=xL(e),t.validate!==!1&&SL(this)}get bytes(){return this.#n==null&&(this.#n=pL(this.#e)),this.#n}toString(){return this.#t==null&&(this.#t=yL(this.#e)),this.#t}toJSON(){return this.toString()}toOptions(){let e,t,r,o,l="";for(const{code:f,name:h,value:p}of this.#e)f===_a&&(l=`%${p??""}`),vL.includes(f)&&(t="tcp",o=443,r=`${p??""}${l}`,e=f===Ta?6:4),(f===Pr||f===qf)&&(t=h==="tcp"?"tcp":"udp",o=parseInt(p??"")),(f===ks||f===zr)&&(t="tcp",r=`${p??""}${l}`,e=f===zr?6:4);if(e==null||t==null||r==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:r,transport:t,port:o}}getComponents(){return[...this.#e]}protos(){return this.#e.map(({code:e,value:t})=>{const r=ur.getProtocol(e);return{code:e,size:r.size??0,name:r.name,resolvable:!!r.resolvable,path:!!r.path}})}protoCodes(){return this.#e.map(({code:e})=>e)}protoNames(){return this.#e.map(({name:e})=>e)}tuples(){return this.#e.map(({code:e,value:t})=>{if(t==null)return[e];const r=ur.getProtocol(e),o=[e];return t!=null&&o.push(r.valueToBytes?.(t)??de(t)),o})}stringTuples(){return this.#e.map(({code:e,value:t})=>t==null?[e]:[e,t])}encapsulate(e){const t=new Lo(e);return new Lo([...this.#e,...t.getComponents()],{validate:!1})}decapsulate(e){const t=e.toString(),r=this.toString(),o=r.lastIndexOf(t);if(o<0)throw new OO(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Lo(r.slice(0,o),{validate:!1})}decapsulateCode(e){let t;for(let r=this.#e.length-1;r>-1;r--)if(this.#e[r].code===e){t=r;break}return new Lo(this.#e.slice(0,t),{validate:!1})}getPeerId(){try{let e=[];this.#e.forEach(({code:r,value:o})=>{r===Ke&&e.push([r,o]),r===md&&(e=[])});const t=e.pop();if(t?.[1]!=null){const r=t[1];return r[0]==="Q"||r[0]==="1"?Ee(St.decode(`z${r}`),"base58btc"):Ee(Se.parse(r).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){for(const e of this.#e)if(ur.getProtocol(e.code).path)return e.value??null;return null}equals(e){return et(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find(l=>l.resolvable);if(t==null)return[this];const r=IL.get(t.name);if(r==null)throw new EL(`no available resolver for ${t.name}`);return(await r(this,e)).map(l=>lt(l))}nodeAddress(){const e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(){return!(this.#e.length!==2||this.#e[0].code!==ks&&this.#e[0].code!==zr||this.#e[1].code!==Pr&&this.#e[1].code!==qf)}[wL](){return`Multiaddr(${this.toString()})`}}function SL(n){n.getComponents().forEach(e=>{const t=ur.getProtocol(e.code);e.value!=null&&t.validate?.(e.value)})}function AL(n,e,t){let r=0;for(const o of n)if(!(r<e)){if(r>t)break;if(o!==255)return!1;r++}return!0}function _L(n,e,t,r){let o=0;for(const l of n)if(!(o<t)){if(o>r)break;if(l!==e[o])return!1;o++}return!0}function TL(n){switch(n.length){case cc:return n.join(".");case uc:{const e=[];for(let t=0;t<n.length;t++)t%2===0&&e.push(n[t].toString(16).padStart(2,"0")+n[t+1].toString(16).padStart(2,"0"));return e.join(":")}default:throw new Error("Invalid ip length")}}function kL(n){let e=0;for(let[t,r]of n.entries()){if(r===255){e+=8;continue}for(;(r&128)!=0;)e++,r=r<<1;if((r&128)!=0)return-1;for(let o=t+1;o<n.length;o++)if(n[o]!=0)return-1;break}return e}function CL(n){let e="0x";for(const t of n)e+=(t>>4).toString(16)+(t&15).toString(16);return e}const cc=4,uc=16,NL=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function l_(n,e){e.length===uc&&n.length===cc&&AL(e,0,11)&&(e=e.slice(12)),e.length===cc&&n.length===uc&&_L(n,NL,0,11)&&(n=n.slice(12));const t=n.length;if(t!=e.length)throw new Error("Failed to mask ip");const r=new Uint8Array(t);for(let o=0;o<t;o++)r[o]=n[o]&e[o];return r}function BL(n,e){if(typeof e=="string"&&(e=gm(e)),e==null)throw new Error("Invalid ip");if(e.length!==n.network.length)return!1;for(let t=0;t<e.length;t++)if((n.network[t]&n.mask[t])!==(e[t]&n.mask[t]))return!1;return!0}function DL(n){const[e,t]=n.split("/");if(!e||!t)throw new Error("Failed to parse given CIDR: "+n);let r=cc,o=ZA(e);if(o==null&&(r=uc,o=XA(e),o==null))throw new Error("Failed to parse given CIDR: "+n);const l=parseInt(t,10);if(Number.isNaN(l)||String(l).length!==t.length||l<0||l>r*8)throw new Error("Failed to parse given CIDR: "+n);const u=c_(l,8*r);return{network:l_(o,u),mask:u}}function c_(n,e){if(e!==8*cc&&e!==8*uc)throw new Error("Invalid CIDR mask");if(n<0||n>e)throw new Error("Invalid CIDR mask");const t=e/8,r=new Uint8Array(t);for(let o=0;o<t;o++){if(n>=8){r[o]=255,n-=8;continue}r[o]=255-(255>>n),n=0}return r}class RL{constructor(e,t){if(t==null)({network:this.network,mask:this.mask}=DL(e));else{const r=gm(e);if(r==null)throw new Error("Failed to parse network");t=String(t);const o=parseInt(t,10);if(Number.isNaN(o)||String(o).length!==t.length||o<0||o>r.length*8){const l=gm(t);if(l==null)throw new Error("Failed to parse mask");this.mask=l}else this.mask=c_(o,8*r.length);this.network=l_(r,this.mask)}}contains(e){return BL({network:this.network,mask:this.mask},e)}toString(){const e=kL(this.mask),t=e!==-1?String(e):CL(this.mask);return TL(this.network)+"/"+t}}function ML(n){let e,t;if(n.getComponents().forEach(r=>{(r.name==="ip4"||r.name==="ip6")&&(t=r.value),r.name==="ipcidr"&&(e=r.value)}),e==null||t==null)throw new Error("Invalid multiaddr");return new RL(t,e)}const IL=new Map;function yd(n){return!!n?.[a_]}function lt(n){return new Lo(n)}function u_(n){const e=ur.getProtocol(n);return{code:e.code,size:e.size??0,name:e.name,resolvable:!!e.resolvable,path:!!e.path}}const OL=[Pr,Ac,Tc,_c,Ta];function CE(n){return f_("sni",n)?.value}function NE(n){const e=f_("tcp",n)?.value;return e==null?"":`:${e}`}function f_(n,e){return e.find(t=>t.name===n)}function BE(n){return n.some(({code:e})=>e===Zo)}function Vn(n,e){const t=d_[n.name];if(t==null)throw new Error(`Can't interpret protocol ${n.name}`);const r=t(n,e);return n.code===zr?`[${r}]`:r}const d_={ip4:(n,e)=>n.value,ip6:(n,e)=>e.length===0?n.value:`[${n.value}]`,tcp:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");return`tcp://${Vn(t,e)}:${n.value}`},udp:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");return`udp://${Vn(t,e)}:${n.value}`},dnsaddr:(n,e)=>n.value,dns4:(n,e)=>n.value,dns6:(n,e)=>n.value,dns:(n,e)=>n.value,ipfs:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");return`${Vn(t,e)}`},p2p:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");return`${Vn(t,e)}`},http:(n,e)=>{const t=BE(e),r=CE(e),o=NE(e);if(t&&r!=null)return`https://${r}${o}`;const l=t?"https://":"http://",u=e.pop();if(u==null)throw new Error("Unexpected end of multiaddr");let f=Vn(u,e);return f=f?.replace("tcp://",""),`${l}${f}`},"http-path":(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");const r=Vn(t,e),o=decodeURIComponent(n.value??"");return`${r}${o}`},tls:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");return Vn(t,e)},sni:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");return Vn(t,e)},https:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");let r=Vn(t,e);return r=r?.replace("tcp://",""),`https://${r}`},ws:(n,e)=>{const t=BE(e),r=CE(e),o=NE(e);if(t&&r!=null)return`wss://${r}${o}`;const l=t?"wss://":"ws://",u=e.pop();if(u==null)throw new Error("Unexpected end of multiaddr");let f=Vn(u,e);return f=f?.replace("tcp://",""),`${l}${f}`},wss:(n,e)=>{const t=e.pop();if(t==null)throw new Error("Unexpected end of multiaddr");let r=Vn(t,e);return r=r?.replace("tcp://",""),`wss://${r}`}};function h_(n,e){const r=lt(n).getComponents(),o=r.pop();if(o==null)throw new Error("Unexpected end of multiaddr");const l=d_[o.name];if(l==null)throw new Error(`No interpreter found for ${o.name}`);let u=l(o,r)??"";return OL.includes(o.code)&&(u=u.replace(/^.*:\/\//,""),o.value==="443"?u=`https://${u}`:u=`http://${u}`),(u.startsWith("http://")||u.startsWith("https://")||u.startsWith("ws://")||u.startsWith("wss://"))&&(u=new URL(u).toString(),u.endsWith("/")&&(u=u.substring(0,u.length-1))),u}var Do={},DE;function LL(){return DE||(DE=1,(function(){var n,e,t,r,o,l,u,f;f=function(h){var p,m,y,b;return p=(h&255<<24)>>>24,m=(h&255<<16)>>>16,y=(h&65280)>>>8,b=h&255,[p,m,y,b].join(".")},u=function(h){var p,m,y,b,E,x;for(p=[],y=b=0;b<=3&&h.length!==0;y=++b){if(y>0){if(h[0]!==".")throw new Error("Invalid IP");h=h.substring(1)}x=e(h),E=x[0],m=x[1],h=h.substring(m),p.push(E)}if(h.length!==0)throw new Error("Invalid IP");switch(p.length){case 1:if(p[0]>4294967295)throw new Error("Invalid IP");return p[0]>>>0;case 2:if(p[0]>255||p[1]>16777215)throw new Error("Invalid IP");return(p[0]<<24|p[1])>>>0;case 3:if(p[0]>255||p[1]>255||p[2]>65535)throw new Error("Invalid IP");return(p[0]<<24|p[1]<<16|p[2])>>>0;case 4:if(p[0]>255||p[1]>255||p[2]>255||p[3]>255)throw new Error("Invalid IP");return(p[0]<<24|p[1]<<16|p[2]<<8|p[3])>>>0;default:throw new Error("Invalid IP")}},t=function(h){return h.charCodeAt(0)},r=t("0"),l=t("a"),o=t("A"),e=function(h){var p,m,y,b,E;for(b=0,p=10,m="9",y=0,h.length>1&&h[y]==="0"&&(h[y+1]==="x"||h[y+1]==="X"?(y+=2,p=16):"0"<=h[y+1]&&h[y+1]<="9"&&(y++,p=8,m="7")),E=y;y<h.length;){if("0"<=h[y]&&h[y]<=m)b=b*p+(t(h[y])-r)>>>0;else if(p===16)if("a"<=h[y]&&h[y]<="f")b=b*p+(10+t(h[y])-l)>>>0;else if("A"<=h[y]&&h[y]<="F")b=b*p+(10+t(h[y])-o)>>>0;else break;else break;if(b>4294967295)throw new Error("too large");y++}if(y===E)throw new Error("empty octet");return[b,y]},n=(function(){function h(p,m){var y,b,E;if(typeof p!="string")throw new Error("Missing `net' parameter");if(m||(E=p.split("/",2),p=E[0],m=E[1]),m||(m=32),typeof m=="string"&&m.indexOf(".")>-1){try{this.maskLong=u(m)}catch{throw new Error("Invalid mask: "+m)}for(y=b=32;b>=0;y=--b)if(this.maskLong===4294967295<<32-y>>>0){this.bitmask=y;break}}else if(m||m===0)this.bitmask=parseInt(m,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(u(p)&this.maskLong)>>>0}catch{throw new Error("Invalid net address: "+p)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+m);this.size=Math.pow(2,32-this.bitmask),this.base=f(this.netLong),this.mask=f(this.maskLong),this.hostmask=f(~this.maskLong),this.first=this.bitmask<=30?f(this.netLong+1):this.base,this.last=this.bitmask<=30?f(this.netLong+this.size-2):f(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?f(this.netLong+this.size-1):void 0}return h.prototype.contains=function(p){return typeof p=="string"&&(p.indexOf("/")>0||p.split(".").length!==4)&&(p=new h(p)),p instanceof h?this.contains(p.base)&&this.contains(p.broadcast||p.last):(u(p)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},h.prototype.next=function(p){return p==null&&(p=1),new h(f(this.netLong+this.size*p),this.mask)},h.prototype.forEach=function(p){var m,y,b;for(b=u(this.first),y=u(this.last),m=0;b<=y;)p(f(b),b,m),m++,b++},h.prototype.toString=function(){return this.base+"/"+this.bitmask},h})(),Do.ip2long=u,Do.long2ip=f,Do.Netmask=n}).call(Do)),Do}var UL=LL();const PL=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],zL=PL.map(n=>new UL.Netmask(n));function zy(n){for(const e of zL)if(e.contains(n))return!0;return!1}function VL(n){return/^::ffff:([0-9a-fA-F]{1,4}):([0-9a-fA-F]{1,4})$/.test(n)}function $L(n){const e=n.split(":");if(e.length<2)return!1;const t=e[e.length-1].padStart(4,"0"),r=e[e.length-2].padStart(4,"0"),o=`${parseInt(r.substring(0,2),16)}.${parseInt(r.substring(2),16)}.${parseInt(t.substring(0,2),16)}.${parseInt(t.substring(2),16)}`;return zy(o)}function HL(n){return/^::ffff:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(n)}function qL(n){const e=n.split(":"),t=e[e.length-1];return zy(t)}function FL(n){return/^::$/.test(n)||/^::1$/.test(n)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(n)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(n)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(n)||/^ff([0-9a-fA-F]{2,2}):/i.test(n)}function kc(n){if(ua(n))return zy(n);if(VL(n))return $L(n);if(HL(n))return qL(n);if(QA(n))return FL(n)}const at=n=>({match:e=>{const t=e[0];return t==null||t.code!==n||t.value!=null?!1:e.slice(1)}}),_e=(n,e)=>({match:t=>{const r=t[0];return r?.code!==n||r.value==null||e!=null&&r.value!==e?!1:t.slice(1)}}),Pe=n=>({match:e=>{const t=n.match(e);return t===!1?e:t}}),Xt=(...n)=>({match:e=>{let t;for(const r of n){const o=r.match(e);o!==!1&&(t==null||o.length<t.length)&&(t=o)}return t??!1}}),Fe=(...n)=>({match:e=>{for(const t of n){const r=t.match(e);if(r===!1)return!1;e=r}return e}});function it(...n){function e(o){if(o==null)return!1;let l=o.getComponents();for(const u of n){const f=u.match(l);if(f===!1)return!1;l=f}return l}function t(o){return e(o)!==!1}function r(o){const l=e(o);return l===!1?!1:l.length===0}return{matchers:n,matches:t,exactMatch:r}}const KL=_e(Ke),jL=it(KL),bd=_e(_c),wd=_e(Ta),vd=_e(Tc),Vy=_e(Ac);it(bd,Pe(_e(Ke)));it(wd,Pe(_e(Ke)));it(vd,Pe(_e(Ke)));const GL=it(Xt(Vy,vd,bd,wd),Pe(_e(Ke))),g_=Fe(_e(ks),Pe(_e(Uy))),p_=Fe(Pe(_e(_a)),_e(zr),Pe(_e(Uy))),$y=Xt(g_,p_),Cs=Xt($y,Vy,bd,wd,vd);it(Xt($y,Fe(Xt(Vy,vd,bd,wd),Pe(_e(Ke)))));const RE=it(g_),ME=it(p_);it($y);const Hy=Fe(Cs,_e(Pr)),Cc=Fe(Cs,_e(qf)),mm=it(Fe(Hy,Pe(_e(Ke))));it(Cc);const qy=Fe(Cc,at(e_),Pe(_e(Ke))),Ed=Fe(Cc,at(t_),Pe(_e(Ke))),YL=Xt(qy,Ed);it(qy);const ZL=it(Ed),ym=Xt(Cs,Hy,Cc,qy,Ed),m_=Xt(Fe(ym,at(Py),Pe(_e(Ke)))),Ff=it(m_),y_=Xt(Fe(ym,at(r_),Pe(_e(Ke))),Fe(ym,at(Zo),Pe(_e(WA)),at(Py),Pe(_e(Ke)))),bm=it(y_),b_=Fe(Cc,at(i_),Pe(_e(lc)),Pe(_e(lc)),Pe(_e(Ke))),IE=it(b_),w_=Fe(Ed,at(n_),Pe(_e(lc)),Pe(_e(lc)),Pe(_e(Ke))),OE=it(w_),Kf=Xt(m_,y_,Fe(Hy,Pe(_e(Ke))),Fe(YL,Pe(_e(Ke))),Fe(Cs,Pe(_e(Ke))),b_,w_,_e(Ke));it(Kf);const XL=Fe(Kf,at(md),_e(Ke)),wm=it(XL),QL=Xt(Fe(Kf,at(md),at(mf),Pe(_e(Ke))),Fe(Kf,at(mf),Pe(_e(Ke))),Fe(at(mf),Pe(_e(Ke)))),LE=it(QL),JL=Xt(Fe(Cs,_e(Pr),at(Xo),Pe(_e(Ke))),Fe(Cs,at(Xo),Pe(_e(Ke)))),WL=it(JL),eU=Fe(Cs,Xt(Fe(_e(Pr,"443"),at(Xo)),Fe(_e(Pr),at(pm)),Fe(_e(Pr),at(Zo),at(Xo)),Fe(at(Zo),at(Xo)),at(Zo),at(pm)),Pe(_e(Ke))),tU=it(eU),nU=Xt(Fe(_e(s_),Pe(_e(Ke))));it(nU);const rU=Xt(Fe(_e(JA),Pe(_e(Ke))));it(rU);function v_(n,e,t){return n.filter(r=>{if(tU.matches(r)||e&&WL.matches(r))return t||GL.matches(r)?!0:kc(r.toOptions().host)===!1;if(!e&&t){const{host:o}=r.toOptions();if(o==="127.0.0.1"||o==="localhost"||o.endsWith(".localhost"))return!0}return!1})}async function*E_(n,e,t,r,o,l={}){for await(const u of e.findProviders(n,l)){const f=v_(u.multiaddrs,r,o);if(f.length===0)continue;const h=h_(f[0]);yield new x_(h,{logger:t,transformRequestInit:l.transformRequestInit})}}async function iU(n,e,t){const{signal:r,log:o}=t??{},l=n.headers.get("content-length");if(l!=null){const h=parseInt(l,10);if(h>e)throw o?.error("content-length header (%d) is greater than the limit (%d)",h,e),n.body!=null&&await n.body.cancel().catch(p=>{o?.error("error cancelling response body after content-length check - %e",p)}),new Error(`Content-Length header (${h}) is greater than the limit (${e}).`)}const u=n.body?.getReader();if(u==null)throw new Error("Response body is not readable");const f=new rt;try{for(;;){if(r?.aborted===!0)throw new Error("Response body read was aborted.");const{done:h,value:p}=await u.read();if(h)break;if(f.append(p),f.byteLength>e)throw new Error(`Response body is greater than the limit (${e}), received ${f.byteLength} bytes.`)}}finally{u.cancel().catch(h=>{o?.error("error cancelling reader - %e",h)}).finally(()=>{u.releaseLock()})}return f.subarray()}class x_{url;#e=0;#t=0;#n=0;#a=0;#o=new Map;log;transformRequestInit;constructor(e,{logger:t,transformRequestInit:r}){this.url=e instanceof URL?e:new URL(e),this.transformRequestInit=r,this.log=t.forComponent(`helia:trustless-gateway-block-broker:${this.url.hostname}`)}#c(e){const t=e.multihash.bytes;return Fr.encode(t)}async getRawBlock(e,{signal:t,maxSize:r=lU}={}){const o=new URL(this.url.toString());if(o.pathname=`/ipfs/${e.toString()}`,o.search="?format=raw",t?.aborted===!0)throw new Error(`Signal to fetch raw block for CID ${e} from gateway ${this.url} was aborted prior to fetch`);const l=this.#c(e),u=new AbortController,f=()=>{u.abort()};t?.addEventListener("abort",f);try{let h=this.#o.get(l);if(h==null){this.#e++;const p={signal:u.signal,headers:{Accept:"application/vnd.ipld.raw"},cache:"force-cache"},m=this.transformRequestInit!=null?await this.transformRequestInit(p):p;h=fetch(o.toString(),m).then(async y=>{if(this.log("GET %s %d",o,y.status),!y.ok)throw this.#t++,new Error(`unable to fetch raw block for CID ${e} from gateway ${this.url}`);const b=await iU(y,r,{signal:u.signal,log:this.log});return this.#a++,b}),this.#o.set(l,h)}return await h}catch{throw t?.aborted===!0?new Error(`fetching raw block for CID ${e} from gateway ${this.url} was aborted`):(this.#t++,new Error(`unable to fetch raw block for CID ${e}`))}finally{t?.removeEventListener("abort",f),this.#o.delete(l)}}reliability(){return this.#e===0?1:this.#n>0?-1/0:this.#a/(this.#e+this.#t*3)}incrementInvalidBlocks(){this.#n++}getStats(){return{attempts:this.#e,errors:this.#t,invalidBlocks:this.#n,successes:this.#a,pendingResponses:this.#o.size}}}class sU extends RO{routing;allowInsecure;allowLocal;transformRequestInit;constructor(e,t){super(e,{...t,name:"helia:trustless-gateway:session"}),this.routing=e.routing,this.allowInsecure=t.allowInsecure??S_,this.allowLocal=t.allowLocal??A_,this.transformRequestInit=t.transformRequestInit}async queryProvider(e,t,r){this.log("fetching BLOCK for %c from %s",e,t.url);const o=await t.getRawBlock(e,r);return this.log.trace("got block for %c from %s",e,t.url),await r.validateFn?.(o),o}async*findNewProviders(e,t={}){yield*E_(e,this.routing,this.logger,this.allowInsecure,this.allowLocal,{...t,transformRequestInit:this.transformRequestInit})}toEvictionKey(e){return e.url.toString()}equals(e,t){return e.url.toString()===t.url.toString()}async convertToProvider(e,t){if(Po(e))return;const r=v_(Array.isArray(e)?e:[e],this.allowInsecure,this.allowLocal);if(r.length===0)return;const o=h_(r[0]);return new x_(o,{logger:this.logger,transformRequestInit:this.transformRequestInit})}}function oU(n,e){return new sU(n,e)}class aU{allowInsecure;allowLocal;transformRequestInit;routing;log;logger;constructor(e,t={}){this.log=e.logger.forComponent("helia:trustless-gateway-block-broker"),this.logger=e.logger,this.routing=e.routing,this.allowInsecure=t.allowInsecure??S_,this.allowLocal=t.allowLocal??A_,this.transformRequestInit=t.transformRequestInit}async retrieve(e,t={}){const r=[];for await(const o of E_(e,this.routing,this.logger,this.allowInsecure,this.allowLocal,{...t,transformRequestInit:this.transformRequestInit})){this.log("getting block for %c from %s",e,o.url);try{const l=await o.getRawBlock(e,t);this.log.trace("got block for %c from %s",e,o.url);try{await t.validateFn?.(l)}catch(u){this.log.error("failed to validate block for %c from %s",e,o.url,u);continue}return l}catch(l){if(this.log.error("failed to get block for %c from %s",e,o.url,l),l instanceof Error?r.push(l):r.push(new Error(`Unable to fetch raw block for CID ${e} from gateway ${o.url}`)),t.signal?.aborted===!0){this.log.trace("request aborted while fetching raw block for CID %c from gateway %s",e,o.url);break}}}throw r.length>0?new AggregateError(r,`Unable to fetch raw block for CID ${e} from any gateway`):new Error(`Unable to fetch raw block for CID ${e} from any gateway`)}createSession(e={}){return oU({logger:this.logger,routing:this.routing},{...e,allowLocal:this.allowLocal,allowInsecure:this.allowInsecure,transformRequestInit:this.transformRequestInit})}}const S_=!1,A_=!1,lU=2097152;function cU(n={}){return e=>new aU(e,n)}async function*UE(n,e={}){const t=n.getReader();try{for(;;){const r=await t.read();if(r.done)return;yield r.value}}finally{e.preventCancel!==!0&&await t.cancel(),t.releaseLock()}}var mp={exports:{}},PE;function uU(){return PE||(PE=1,(function(n){(function(){n.exports=_;var e=86400,t=3200,r=146097*t/400,o=e*r,l=1e3*o,u=864e13,f=4294967296,h=1e6,p="000000000",m=Math.trunc||function(B){var G=B-B%1;return G==0&&(B<0||B===0&&1/B!=1/0)?-0:G},y=_.prototype,b=(_.fromDate=function(B){return new _(+B)},_.fromInt64BE=Q(0,1,2,3,0,4),_.fromInt64LE=Q(3,2,1,0,4,0),_.fromString=function(Y){var G,te=new _,Y=(Y+="").replace(/^\s*[+\-]?\d+/,function(M){var M=+M,D=1970+(M-1970)%400;return te.year=M-D,D}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(U,M,D){return M<0&&(D*=-1),G=6e4*(60*+M+ +D),""}).replace(/\.\d+$/,function(U){return te.nano=+(U+p).substr(1,9),""}).split(/\D+/);if(1<Y.length?Y[1]--:Y[1]=0,te.time=G=Date.UTC.apply(Date,Y)-(G||0),isNaN(G))throw new TypeError("Invalid Date");return R(te)},_.fromTimeT=function(B){return C(B,0)},y.year=0,y.time=0,y.nano=0,y.addNano=function(B){return this.nano+=+B||0,this},y.getNano=function(){var B=R(this);return(B.time%1e3*h+ +B.nano+1e9)%1e9},y.getTimeT=function(){var G=R(this),B=Math.floor(G.time/1e3),G=G.year;return G&&(B+=G*r*e/t),B},y.getYear=function(){return this.toDate().getUTCFullYear()+this.year},y.toDate=function(){return j(R(this).time)},y.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},y.toString=function(B){var G=this,te=G.toDate(),Y={H:function(){return oe(te.getUTCHours())},L:function(){return H(te.getUTCMilliseconds(),3)},M:function(){return oe(te.getUTCMinutes())},N:function(){return H(G.getNano(),9)},S:function(){return oe(te.getUTCSeconds())},Y:function(){var U=G.getYear();return 999999<U?"+"+U:9999<U?"+"+H(U,6):0<=U?H(U,4):-999999<=U?"-"+H(-U,6):U},a:function(){return x[te.getUTCDay()]},b:function(){return E[te.getUTCMonth()]},d:function(){return oe(te.getUTCDate())},e:function(){return(function(U){return(9<U?"":" ")+(0|U)})(te.getUTCDate())},m:function(){return oe(te.getUTCMonth()+1)}};return(function U(M){return M.replace(/%./g,function(D){var I=D[1],S=k[I],I=Y[I];return S?U(S):I?I():D})})(B||b)},y.writeInt64BE=Z(0,1,2,3,0,4),y.writeInt64LE=Z(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return _;function _(B,G,te){var Y=this;if(!(Y instanceof _))return new _(B,G,te);Y.time=+B||0,Y.nano=+G||0,Y.year=+te||0,R(Y)}function R(B){var G,te,Y,U=B.year,M=B.time,D=B.nano,S=((D<0||h<=D)&&(D-=(te=Math.floor(D/h))*h,M+=te,te=1),U%t);return(M<-u||u<M||S)&&((G=m(M/l))&&(U+=G*t,M-=G*l),(Y=j(M)).setUTCFullYear(S+Y.getUTCFullYear()),Y=(M=+Y)+(G=m((U-=S)/t))*l,G&&-u<=Y&&Y<=u&&(U-=G*t,M=Y),te=1),te&&(B.year=U,B.time=M,B.nano=D),B}function j(B){var G=new Date(0);return G.setTime(B),G}function C(U,Y){U=+U||0;var te=m((Y=(Y|0)*f)/o)+m(U/o),Y=Y%o+U%o,U=m(Y/o);return U&&(te+=U,Y-=U*o),new _(1e3*Y,0,te*t)}function Z(B,G,te,Y,U,M){return function(S,I){var ie=R(this);S=S||new Array(8),re(S,I|=0);var A=Math.floor(ie.time/1e3),ie=ie.year*(r*e/t),L=m(ie/f)+m(A/f),ie=ie%f+A%f,A=Math.floor(ie/f);return A&&(L+=A,ie-=A*f),D(S,I+U,L),D(S,I+M,ie),S};function D(S,I,L){S[I+B]=L>>24&255,S[I+G]=L>>16&255,S[I+te]=L>>8&255,S[I+Y]=255&L}}function Q(B,G,te,Y,U,M){return function(S,I){re(S,I|=0);var L=D(S,I+U);return C(D(S,I+M),L)};function D(S,I){return 16777216*S[I+B]+(S[I+G]<<16|S[I+te]<<8|S[I+Y])}}function re(B,G){if(B=B&&B.length,B==null)throw new TypeError("Invalid Buffer");if(B<G+8)throw new RangeError("Out of range")}function oe(B){return(9<B?"":"0")+(0|B)}function H(B,G){return(p+(0|B)).substr(-G)}})()})(mp)),mp.exports}var fU=uU();const __=ha(fU);class dU extends Error{static name="SignatureCreationError";constructor(e="Record signature creation failed"){super(e),this.name="SignatureCreationError"}}class fs extends Error{static name="SignatureVerificationError";constructor(e="Record signature verification failed"){super(e),this.name="SignatureVerificationError"}}class hU extends Error{static name="RecordExpiredError";constructor(e="Record has expired"){super(e),this.name="RecordExpiredError"}}class Fy extends Error{static name="UnsupportedValidityError";constructor(e="The validity type is unsupported"){super(e),this.name="UnsupportedValidityError"}}class gU extends Error{static name="RecordTooLargeError";constructor(e="The record is too large"){super(e),this.name="RecordTooLargeError"}}class T_ extends Error{static name="InvalidValueError";constructor(e="Value must be a valid content path starting with /"){super(e),this.name="InvalidValueError"}}class pU extends Error{static name="InvalidRecordDataError";constructor(e="Invalid record data"){super(e),this.name="InvalidRecordDataError"}}class zE extends Error{static name="InvalidEmbeddedPublicKeyError";constructor(e="Invalid embedded public key"){super(e),this.name="InvalidEmbeddedPublicKeyError"}}var Zn;(function(n){(function(r){r.EOL="EOL"})(n.ValidityType||(n.ValidityType={}));let e;(function(r){r[r.EOL=0]="EOL"})(e||(e={})),(function(r){r.codec=()=>$2(e)})(n.ValidityType||(n.ValidityType={}));let t;n.codec=()=>(t==null&&(t=Yn((r,o,l={})=>{l.lengthDelimited!==!1&&o.fork(),r.value!=null&&(o.uint32(10),o.bytes(r.value)),r.signatureV1!=null&&(o.uint32(18),o.bytes(r.signatureV1)),r.validityType!=null&&(o.uint32(24),n.ValidityType.codec().encode(r.validityType,o)),r.validity!=null&&(o.uint32(34),o.bytes(r.validity)),r.sequence!=null&&(o.uint32(40),o.uint64(r.sequence)),r.ttl!=null&&(o.uint32(48),o.uint64(r.ttl)),r.pubKey!=null&&(o.uint32(58),o.bytes(r.pubKey)),r.signatureV2!=null&&(o.uint32(66),o.bytes(r.signatureV2)),r.data!=null&&(o.uint32(74),o.bytes(r.data)),l.lengthDelimited!==!1&&o.ldelim()},(r,o,l={})=>{const u={},f=o==null?r.len:r.pos+o;for(;r.pos<f;){const h=r.uint32();switch(h>>>3){case 1:{u.value=r.bytes();break}case 2:{u.signatureV1=r.bytes();break}case 3:{u.validityType=n.ValidityType.codec().decode(r);break}case 4:{u.validity=r.bytes();break}case 5:{u.sequence=r.uint64();break}case 6:{u.ttl=r.uint64();break}case 7:{u.pubKey=r.bytes();break}case 8:{u.signatureV2=r.bytes();break}case 9:{u.data=r.bytes();break}default:{r.skipType(h&7);break}}}return u})),t),n.encode=r=>Gn(r,n.codec()),n.decode=(r,o)=>jn(r,n.codec(),o)})(Zn||(Zn={}));const mU=zi("ipns:utils"),k_=de("/ipns/"),yU=114,bU=0,wU=18;function vU(n){let e;if(n.pubKey!=null)try{e=cd(n.pubKey)}catch(t){throw mU.error(t),t}if(e!=null)return e}function EU(n,e,t){const r=de(e);return fr([n,t,r])}function C_(n){const e=de("ipns-signature:");return fr([e,n])}function Ky(n){return"signatureV1"in n?Zn.encode({value:de(n.value),signatureV1:n.signatureV1,validityType:n.validityType,validity:de(n.validity),sequence:n.sequence,ttl:n.ttl,pubKey:n.pubKey,signatureV2:n.signatureV2,data:n.data}):Zn.encode({pubKey:n.pubKey,signatureV2:n.signatureV2,data:n.data})}function xd(n){const e=Zn.decode(n);if(e.sequence!=null&&(e.sequence=BigInt(e.sequence)),e.ttl!=null&&(e.ttl=BigInt(e.ttl)),e.signatureV2==null||e.data==null)throw new fs("Missing data or signatureV2");const t=N_(e.data),r=SU(t.Value),o=Ee(t.Validity);if(e.value!=null&&e.signatureV1!=null)return _U(e),{value:r,validityType:Zn.ValidityType.EOL,validity:o,sequence:t.Sequence,ttl:t.TTL,pubKey:e.pubKey,signatureV1:e.signatureV1,signatureV2:e.signatureV2,data:e.data};if(e.signatureV2!=null)return{value:r,validityType:Zn.ValidityType.EOL,validity:o,sequence:t.Sequence,ttl:t.TTL,pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}function jy(n){return fr([k_,n.bytes])}function vm(n){const e=va(n.slice(k_.length));if(!Em(e,bU)&&!Em(e,wU))throw new jm("Multihash in IPNS key was not identity or sha2-256");return e}function xU(n,e,t,r,o){let l;if(e===Zn.ValidityType.EOL)l=0;else throw new Fy("The validity type is unsupported");return jl({Value:n,Validity:t,ValidityType:l,Sequence:r,TTL:o})}function N_(n){const e=ki(n);if(e.ValidityType===0)e.ValidityType=Zn.ValidityType.EOL;else throw new Fy("The validity type is unsupported");return Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),e}function SU(n){const e=Ee(n).trim();if(e.startsWith("/"))return e;try{return`/ipfs/${Se.decode(n).toV1().toString()}`}catch{}try{return`/ipfs/${Se.parse(e).toV1().toString()}`}catch{}throw new T_("Value must be a valid content path starting with /")}function AU(n){if(n!=null){const e=CU(n);if(e!=null)return e.code===yU?`/ipns/${e.toString(cr)}`:`/ipfs/${e.toV1().toString()}`;if(TU(n))return`/ipns/${cr.encode(n.bytes)}`;const t=n.toString().trim();if(t.startsWith("/")&&t.length>1)return t}throw new T_("Value must be a valid content path starting with /")}function _U(n){if(n.data==null)throw new pU("Record data is missing");const e=N_(n.data);if(!et(e.Value,n.value??new Uint8Array(0)))throw new fs('Field "value" did not match between protobuf and CBOR');if(!et(e.Validity,n.validity??new Uint8Array(0)))throw new fs('Field "validity" did not match between protobuf and CBOR');if(e.ValidityType!==n.validityType)throw new fs('Field "validityType" did not match between protobuf and CBOR');if(e.Sequence!==n.sequence)throw new fs('Field "sequence" did not match between protobuf and CBOR');if(e.TTL!==n.ttl)throw new fs('Field "ttl" did not match between protobuf and CBOR')}function TU(n){return n.bytes instanceof Uint8Array}function kU(n){return typeof n?.toCID=="function"}function CU(n){if(kU(n))return n.toCID();try{return Se.parse(n)}catch{}return Se.asCID(n)}function Em(n,e){return n.code===e}const NU=zi("ipns"),B_=300*1e9,D_={v1Compatible:!0,ttlNs:B_};async function BU(n,e,t,r,o=D_){const l=new __(Date.now()+Number(r)),u=Zn.ValidityType.EOL,f=BigInt(o.ttlNs??B_);return DU(n,e,t,u,l.toString(),f,o)}const DU=async(n,e,t,r,o,l,u=D_)=>{t=BigInt(t);const f=de(o),h=AU(e),p=de(h),m=xU(p,r,f,t,l),y=C_(m),b=await n.sign(y);let E;if(n.type==="RSA"&&(E=Di(n.publicKey)),u.v1Compatible===!0){const x=await RU(n,p,r,f),k={value:h,signatureV1:x,validity:o,validityType:r,sequence:t,ttl:l,signatureV2:b,data:m};return E!=null&&(k.pubKey=E),k}else{const x={value:h,validity:o,validityType:r,sequence:t,ttl:l,signatureV2:b,data:m};return E!=null&&(x.pubKey=E),x}},RU=async(n,e,t,r)=>{try{const o=EU(e,t,r);return await n.sign(o)}catch(o){throw NU.error("record signature creation failed",o),new dU("Record signature creation failed")}},af=zi("ipns:validator"),MU=1024*10;async function IU(n,e){const t=xd(e);let r;try{const o=C_(t.data);r=await n.verify(o,t.signatureV2)}catch{r=!1}if(!r)throw af.error("record signature verification failed"),new fs("Record signature verification failed");if(t.validityType===Zn.ValidityType.EOL){if(__.fromString(t.validity).toDate().getTime()<Date.now())throw af.error("record has expired"),new hU("record has expired")}else if(t.validityType!=null)throw af.error("the validity type is unsupported"),new Fy("The validity type is unsupported");af("ipns record for %s is valid",t.value)}async function OU(n,e){if(e.byteLength>MU)throw new gU("The record is too large");const t=vm(n);let r;Em(t,0)&&(r=PS(t));const o=xd(e),l=vU(o)??r;if(l==null)throw new zE("Could not extract public key from IPNS record or routing key");const u=jy(l.toMultihash());if(!et(u,n))throw new zE("Embedded public key did not match routing key");await IU(l,e)}let LU=class extends Error{name="InvalidMessageLengthError";code="ERR_INVALID_MESSAGE_LENGTH"};async function*VE(n,e={}){const t=/\r?\n/,r=new TextDecoder("utf8");let o="";for await(let l of n){if(typeof l=="string"&&(l=new TextEncoder().encode(l)),zl(l)&&(l=l.subarray()),o+=r.decode(l,{stream:!0}),o.length>(e?.maxMessageLength??o.length))throw new LU("Incoming message too long");const u=o.split(t);o=u.pop()??"";for(let f=0;f<u.length;f++)yield JSON.parse(u[f])}o+=r.decode(),o!==""&&(yield JSON.parse(o))}class yp extends Error{static name="InvalidRequestError";constructor(e="Invalid request"){super(e),this.name="InvalidRequestError"}}class _i extends Error{static name="BadResponseError";constructor(e="Bad response"){super(e),this.name="BadResponseError"}}function UU(n){return n[Symbol.asyncIterator]!=null}function PU(n){if(UU(n))return(async()=>{for await(const e of n)return e})();for(const e of n)return e}const $E=de("/ipns/");function HE(n){return et(n.subarray(0,$E.byteLength),$E)}class zU{client;constructor(e){this.client=e}async*findProviders(e,t={}){yield*T8(this.client.getProviders(e,t),r=>({id:r.ID,multiaddrs:r.Addrs??[]}))}async provide(){}async cancelReprovide(){}async put(e,t,r){if(!HE(e))return;const o=vm(e),l=Se.createV1(114,o),u=xd(t);await this.client.putIPNS(l,u,r)}async get(e,t){if(!HE(e))throw new Kn("Not found");const r=vm(e),o=Se.createV1(114,r);try{const l=await this.client.getIPNS(o,t);return Ky(l)}catch(l){throw l.name==="BadResponseError"?new Kn("Not found"):l}}}class VU{client;constructor(e){this.client=e}async findPeer(e,t={}){const r=await PU(this.client.getPeers(e,t));if(r!=null)return{id:r.ID,multiaddrs:r.Addrs??[]};throw new Kn("Not found")}async*getClosestPeers(e,t={}){}}const Mt=zi("delegated-routing-v1-http-api-client"),lf={concurrentRequests:4,timeout:3e4,cacheTTL:300*1e3,cacheName:"delegated-routing-v1-cache"};class $U{started;httpQueue;shutDownController;clientUrl;timeout;contentRouting;peerRouting;filterAddrs;filterProtocols;inFlightRequests;cacheName;cache;cacheTTL;constructor(e,t={}){this.started=!1,this.shutDownController=new AbortController,this.shutDownController.signal,this.httpQueue=new eA({concurrency:t.concurrentRequests??lf.concurrentRequests}),this.inFlightRequests=new Map,this.clientUrl=e instanceof URL?e:new URL(e),this.timeout=t.timeout??lf.timeout,this.filterAddrs=t.filterAddrs,this.filterProtocols=t.filterProtocols,this.contentRouting=new zU(this),this.peerRouting=new VU(this),this.cacheName=t.cacheName??lf.cacheName,this.cacheTTL=t.cacheTTL??lf.cacheTTL}get[Xl](){return this.contentRouting}get[Ql](){return this.peerRouting}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cacheTTL>0&&(this.cache=await globalThis.caches?.open(this.cacheName),this.cache!=null&&Mt("cache enabled with ttl %d",this.cacheTTL)))}async stop(){this.httpQueue.clear(),this.shutDownController.abort(),await globalThis.caches?.delete(this.cacheName),this.started=!1}async*getProviders(e,t={}){Mt("getProviders starts: %c",e);const r=AbortSignal.timeout(this.timeout),o=Nt([this.shutDownController.signal,r,t.signal]),l=We(),u=We();this.httpQueue.add(async()=>(l.resolve(),u.promise));try{await l.promise;const f=new URL(`${this.clientUrl}routing/v1/providers/${e.toString()}`);this.#t(f,t.filterAddrs,t.filterProtocols);const h={headers:{Accept:"application/x-ndjson"},signal:o},p=await this.#n(f.toString(),h);if(p==null)throw new _i("No response received");if(!p.ok)throw p.status===404?new Kn("No matching records found"):p.status===422?new yp("Request does not conform to schema or semantic constraints"):new _i(`Unexpected status code: ${p.status}`);if(p.body==null)throw new _i("Routing response had no body");const m=p.headers.get("Content-Type");if(m==null)throw new _i("No Content-Type header received");if(m?.startsWith("application/json")){const y=await p.json();for(const b of y.Providers){const E=this.#e(b);E!=null&&(yield E)}}else if(m.includes("application/x-ndjson"))for await(const y of VE(UE(p.body))){const b=this.#e(y);b!=null&&(yield b)}else throw new _i(`Unsupported Content-Type: ${m}`)}finally{o.clear(),u.resolve(),Mt("getProviders finished: %c",e)}}async*getPeers(e,t={}){Mt("getPeers starts: %c",e);const r=AbortSignal.timeout(this.timeout),o=Nt([this.shutDownController.signal,r,t.signal]),l=We(),u=We();this.httpQueue.add(async()=>(l.resolve(),u.promise));try{await l.promise;const f=new URL(`${this.clientUrl}routing/v1/peers/${e.toCID().toString()}`);this.#t(f,t.filterAddrs,t.filterProtocols);const h={headers:{Accept:"application/x-ndjson"},signal:o},p=await this.#n(f.toString(),h);if(p.status===404)throw new Kn("No matching records found");if(p.status===422)throw new yp("Request does not conform to schema or semantic constraints");if(p.body==null)throw new _i("Routing response had no body");if(p.headers.get("Content-Type")==="application/json"){const y=await p.json();for(const b of y.Peers){const E=this.#e(b);E!=null&&(yield E)}}else for await(const y of VE(UE(p.body))){const b=this.#e(y);b!=null&&(yield b)}}catch(f){Mt.error("getPeers errored:",f)}finally{o.clear(),u.resolve(),Mt("getPeers finished: %c",e)}}async getIPNS(e,t={}){Mt("getIPNS starts: %s",e);const r=AbortSignal.timeout(this.timeout),o=Nt([this.shutDownController.signal,r,t.signal]),l=We(),u=We();this.httpQueue.add(async()=>(l.resolve(),u.promise));const f=`${this.clientUrl}routing/v1/ipns/${e}`;try{await l.promise;const h={headers:{Accept:"application/vnd.ipfs.ipns-record"},signal:o},p=await this.#n(f,h);if(Mt("getIPNS GET %s %d",f,p.status),p.status===404)throw new Kn("No matching records found");if(p.status===422)throw new yp("Request does not conform to schema or semantic constraints");if(p.body==null)throw new _i("GET ipns response had no body");const m=await p.arrayBuffer(),y=new Uint8Array(m,0,m.byteLength);return t.validate!==!1&&await OU(jy(e.multihash),y),xd(y)}catch(h){throw Mt.error("getIPNS GET %s error:",f,h),h}finally{o.clear(),u.resolve(),Mt("getIPNS finished: %s",e)}}async putIPNS(e,t,r={}){Mt("putIPNS starts: %c",e);const o=AbortSignal.timeout(this.timeout),l=Nt([this.shutDownController.signal,o,r.signal]),u=We(),f=We();this.httpQueue.add(async()=>(u.resolve(),f.promise));const h=`${this.clientUrl}routing/v1/ipns/${e}`;try{await u.promise;const p=Ky(t),m={method:"PUT",headers:{"Content-Type":"application/vnd.ipfs.ipns-record"},body:p,signal:l},y=await this.#n(h,m);if(Mt("putIPNS PUT %s %d",h,y.status),y.status!==200)throw new _i("PUT ipns response had status other than 200")}catch(p){throw Mt.error("putIPNS PUT %s error:",h,p.stack),p}finally{l.clear(),f.resolve(),Mt("putIPNS finished: %c",e)}}#e(e){try{const t=[],r=e.Addrs?.map(lt)??[];return e.Protocols!=null&&t.push(...e.Protocols),e.Protocol!=null&&(t.push(e.Protocol),delete e.Protocol),{...e,Schema:"peer",ID:_s(e.ID),Addrs:r,Protocols:t}}catch(t){Mt.error("could not conform record to peer schema",t)}}#t(e,t,r){if(t!=null||this.filterAddrs!=null){const o=t?.join(",")??this.filterAddrs?.join(",")??"";o!==""&&e.searchParams.set("filter-addrs",o)}if(r!=null||this.filterProtocols!=null){const o=r?.join(",")??this.filterProtocols?.join(",")??"";o!==""&&e.searchParams.set("filter-protocols",o)}}async#n(e,t){const r=t.method??"GET",o=`${r}-${e}`;if(r==="GET"){const h=await this.cache?.match(e);if(h!=null){if(parseInt(h.headers.get("x-cache-expires")??"0",10)>Date.now())return Mt("returning cached response for %s",o),h;await this.cache?.delete(e)}}const l=this.inFlightRequests.get(o);if(l!=null){const h=await l;return Mt("deduplicating outgoing request for %s",o),h.clone()}const u=fetch(e,t).then(async h=>{if(this.cache!=null&&h.ok&&r==="GET"){const p=Date.now()+this.cacheTTL,m=new Headers(h.headers);m.set("x-cache-expires",p.toString());const y=new Response(h.clone().body,{status:h.status,statusText:h.statusText,headers:m});await this.cache.put(e,y)}return h}).finally(()=>{this.inFlightRequests.delete(o)});return this.inFlightRequests.set(o,u),await u}}function HU(n,e={}){return new $U(new URL(n),e)}const qE="[a-fA-F\\d:]",Ni=n=>n&&n.includeBoundaries?`(?:(?<=\\s|^)(?=${qE})|(?<=${qE})(?=\\s|$))`:"",qn="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",bt="[a-fA-F\\d]{1,4}",Sd=`
(?:
(?:${bt}:){7}(?:${bt}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${bt}:){6}(?:${qn}|:${bt}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${bt}:){5}(?::${qn}|(?::${bt}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${bt}:){4}(?:(?::${bt}){0,1}:${qn}|(?::${bt}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${bt}:){3}(?:(?::${bt}){0,2}:${qn}|(?::${bt}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${bt}:){2}(?:(?::${bt}){0,3}:${qn}|(?::${bt}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${bt}:){1}(?:(?::${bt}){0,4}:${qn}|(?::${bt}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${bt}){0,5}:${qn}|(?::${bt}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),qU=new RegExp(`(?:^${qn}$)|(?:^${Sd}$)`),FU=new RegExp(`^${qn}$`),KU=new RegExp(`^${Sd}$`),Ad=n=>n&&n.exact?qU:new RegExp(`(?:${Ni(n)}${qn}${Ni(n)})|(?:${Ni(n)}${Sd}${Ni(n)})`,"g");Ad.v4=n=>n&&n.exact?FU:new RegExp(`${Ni(n)}${qn}${Ni(n)}`,"g");Ad.v6=n=>n&&n.exact?KU:new RegExp(`${Ni(n)}${Sd}${Ni(n)}`,"g");function jU(n){const e=(...t)=>n(...t);return Object.defineProperty(e,"name",{value:`functionTimeout(${n.name||"<anonymous>"})`,configurable:!0}),e}const{toString:GU}=Object.prototype;function YU(n){return GU.call(n)==="[object RegExp]"}const FE={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function ZU(n,e={}){if(!YU(n))throw new TypeError("Expected a RegExp instance");const t=Object.keys(FE).map(o=>(typeof e[o]=="boolean"?e[o]:n[o])?FE[o]:"").join(""),r=new RegExp(e.source||n.source,t);return r.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:n.lastIndex,r}function R_(n,e,{timeout:t}={}){try{return jU(()=>ZU(n).test(e),{timeout:t})()}catch(r){throw r}}const XU=15,QU=45,M_={timeout:400};function KE(n){return n.length>QU?!1:R_(Ad.v6({exact:!0}),n,M_)}function JU(n){return n.length>XU?!1:R_(Ad.v4({exact:!0}),n,M_)}const jE={http:"80",https:"443",ws:"80",wss:"443"},WU=["http","https","ws","wss"];function e7(n,e){e=e??{};const t=e.defaultDnsType??"dns",{scheme:r,hostname:o,port:l,path:u}=t7(n),f=[n7(o,t),r7(l,r),i7(r)];u!=null&&f.push(s7(u));const h="/"+f.filter(p=>!!p).reduce((p,m)=>p.concat(m),[]).join("/");return lt(h)}function t7(n){const[e]=n.split(":");WU.includes(e)||(n="http"+n.substring(e.length));let{protocol:t,hostname:r,port:o,pathname:l,search:u}=new URL(n);if(o==null||o===""){const h=o7(e);h!=null&&(o=h),h==null&&t==="http:"&&(o="80")}let f;return l!=null&&l!==""&&l!=="/"&&(l.startsWith("/")&&(l=l.substring(1)),f=l),u!=null&&u!==""&&(f=f??"",f+=u),{scheme:e,hostname:r,port:o,path:f}}function n7(n,e){if(!(n==null||n==="")){if(JU(n))return["ip4",n];if(KE(n))return["ip6",n];if(n[0]==="["){const t=n.substring(1,n.length-1);if(KE(t))return["ip6",t]}return[e,n]}}function r7(n,e){if(!(n==null||n===""))return e==="udp"?["udp",n]:["tcp",n]}function i7(n){if(n.match(/^tcp$|^udp$/)==null)return n==="https"?["/tls/http"]:n==="wss"?["/tls/ws"]:[n]}function s7(n){if(!(n==null||n===""))return["http-path",encodeURIComponent(n)]}function o7(n){if(!(n==null||n===""||jE[n]==null))return jE[n]}const a7=["https://trustless-gateway.link","https://4everland.io"],l7=2336;function c7(n){return n=n.toString(),{id:fd(Se.createV1(l7,Mi.digest(de(n)))),multiaddrs:[e7(n)]}}class u7{gateways;shuffle;constructor(e={}){this.gateways=(e.gateways??a7).map(t=>c7(t)),this.shuffle=e.shuffle??!0}async*findProviders(e,t){yield*(this.shuffle?this.gateways.toSorted(()=>Math.random()>.5?1:-1):this.gateways).map(r=>({...r,protocols:["transport-ipfs-gateway-http"]}))}}function f7(n={}){return new u7(n)}class d7{libp2p;constructor(e){this.libp2p=e}async provide(e,t){await this.libp2p.contentRouting.provide(e,t)}async cancelReprovide(e,t){await this.libp2p.contentRouting.cancelReprovide(e,t)}async*findProviders(e,t){yield*this.libp2p.contentRouting.findProviders(e,t)}async put(e,t,r){await this.libp2p.contentRouting.put(e,t,r)}async get(e,t){return this.libp2p.contentRouting.get(e,t)}async findPeer(e,t){return this.libp2p.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t){yield*this.libp2p.peerRouting.getClosestPeers(e,t)}}function h7(n){return new d7(n)}class g7 extends jA{data;constructor(){super(),this.data=new Map}put(e,t,r){return r?.signal?.throwIfAborted(),this.data.set(wn.encode(e.multihash.bytes),t),e}get(e,t){t?.signal?.throwIfAborted();const r=this.data.get(wn.encode(e.multihash.bytes));if(r==null)throw new la;return r}has(e,t){return t?.signal?.throwIfAborted(),this.data.has(wn.encode(e.multihash.bytes))}async delete(e,t){t?.signal?.throwIfAborted(),this.data.delete(wn.encode(e.multihash.bytes))}async*getAll(e){e?.signal?.throwIfAborted();for(const[t,r]of this.data.entries())yield{cid:Se.createV1(ny,va(wn.decode(t))),block:r},e?.signal?.throwIfAborted()}}zi("blockstore:core:tiered");const p7="SHARDING";function m7(n){return n[Symbol.asyncIterator]!=null}function xm(n){if(m7(n))return(async()=>{const t=[];for await(const r of n)t.push(r);return t})();const e=[];for(const t of n)e.push(t);return e}function y7(n){return n[Symbol.asyncIterator]!=null}function GE(n,e){return y7(n)?(async function*(){yield*(await xm(n)).sort(e)})():(function*(){yield*xm(n).sort(e)})()}class b7{put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:o}of e)await this.put(r,o,t),yield r}async*getMany(e,t={}){for await(const r of e)yield{key:r,value:await this.get(r,t)}}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(r,o){e.push({key:r,value:o})},delete(r){t.push(r)},commit:async r=>{await Gp(this.putMany(e,r)),e=[],await Gp(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(e.prefix!=null){const o=e.prefix;r=cs(r,l=>l.key.toString().startsWith(o))}if(Array.isArray(e.filters)&&(r=e.filters.reduce((o,l)=>cs(o,l),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((o,l)=>GE(o,l),r)),e.offset!=null){let o=0;const l=e.offset;r=cs(r,()=>o++>=l)}return e.limit!=null&&(r=_1(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(e.prefix!=null){const o=e.prefix;r=cs(r,l=>l.toString().startsWith(o))}if(Array.isArray(e.filters)&&(r=e.filters.reduce((o,l)=>cs(o,l),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((o,l)=>GE(o,l),r)),e.offset!=null){const o=e.offset;let l=0;r=cs(r,()=>l++>=o)}return e.limit!=null&&(r=_1(r,e.limit)),r}}class I_ extends b7{data;constructor(){super(),this.data=new Map}put(e,t,r){return r?.signal?.throwIfAborted(),this.data.set(e.toString(),t),e}get(e,t){t?.signal?.throwIfAborted();const r=this.data.get(e.toString());if(r==null)throw new la;return r}has(e,t){return t?.signal?.throwIfAborted(),this.data.has(e.toString())}delete(e,t){t?.signal?.throwIfAborted(),this.data.delete(e.toString())}*_all(e,t){t?.signal?.throwIfAborted();for(const[r,o]of this.data.entries())yield{key:new ot(r),value:o},t?.signal?.throwIfAborted()}*_allKeys(e,t){t?.signal?.throwIfAborted();for(const r of this.data.keys())yield new ot(r),t?.signal?.throwIfAborted()}}new ot(p7);zi("datastore:core:tiered");function jf(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}const{hasOwnProperty:O_}=Object.prototype,{propertyIsEnumerable:w7}=Object,fa=(n,e,t)=>{Object.defineProperty(n,e,{value:t,writable:!0,enumerable:!0,configurable:!0})},v7=void 0,YE={concatArrays:!1,ignoreUndefined:!1},_d=n=>{const e=[];for(const t in n)O_.call(n,t)&&e.push(t);if(Object.getOwnPropertySymbols){const t=Object.getOwnPropertySymbols(n);for(const r of t)w7.call(n,r)&&e.push(r)}return e};function ka(n){return Array.isArray(n)?E7(n):jf(n)?x7(n):n}function E7(n){const e=n.slice(0,0);return _d(n).forEach(t=>{fa(e,t,ka(n[t]))}),e}function x7(n){const e=Object.getPrototypeOf(n)===null?Object.create(null):{};return _d(n).forEach(t=>{fa(e,t,ka(n[t]))}),e}const L_=(n,e,t,r)=>(t.forEach(o=>{typeof e[o]>"u"&&r.ignoreUndefined||(o in n&&n[o]!==Object.getPrototypeOf(n)?fa(n,o,Sm(n[o],e[o],r)):fa(n,o,ka(e[o])))}),n),S7=(n,e,t)=>{let r=n.slice(0,0),o=0;return[n,e].forEach(l=>{const u=[];for(let f=0;f<l.length;f++)O_.call(l,f)&&(u.push(String(f)),l===n?fa(r,o++,l[f]):fa(r,o++,ka(l[f])));r=L_(r,l,_d(l).filter(f=>!u.includes(f)),t)}),r};function Sm(n,e,t){return t.concatArrays&&Array.isArray(n)&&Array.isArray(e)?S7(n,e,t):!jf(e)||!jf(n)?ka(e):L_(n,e,_d(e),t)}function Gy(...n){const e=Sm(ka(YE),this!==v7&&this||{},YE);let t={_:{}};for(const r of n)if(r!==void 0){if(!jf(r))throw new TypeError("`"+r+"` is not an Option Object");t=Sm(t,{_:r},e)}return t._}class A7{dns;canResolve(e){return e.getComponents().some(({name:t})=>t==="dnsaddr")}async resolve(e,t){const r=e.getComponents().find(h=>h.name==="dnsaddr")?.value;if(r==null)return[e];const l=await this.getDNS(t).query(`_dnsaddr.${r}`,{signal:t?.signal,types:[Oi.TXT]}),u=e.getComponents().find(h=>h.name==="p2p")?.value,f=[];for(const h of l.Answer){const p=h.data.replace(/["']/g,"").trim().split("=")[1];p!=null&&(u!=null&&!p.includes(u)||f.push(lt(p)))}return f}getDNS(e){return e.dns!=null?e.dns:(this.dns==null&&(this.dns=iA()),this.dns)}}const Yy=new A7;var _7={};const T7={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:n=>n},connectionManager:{resolvers:{dnsaddr:Yy}},transportManager:{faultTolerance:Jl.FATAL_ALL}};async function k7(n){const e=Gy(T7,n);if(e.connectionProtector===null&&_7?.LIBP2P_FORCE_PNET!=null)throw new ge("Private network is enforced, but no protector was provided");return e}var Gf;(function(n){let e;n.codec=()=>(e==null&&(e=Yn((t,r,o={})=>{o.lengthDelimited!==!1&&r.fork(),t.publicKey!=null&&t.publicKey.byteLength>0&&(r.uint32(10),r.bytes(t.publicKey)),t.payloadType!=null&&t.payloadType.byteLength>0&&(r.uint32(18),r.bytes(t.payloadType)),t.payload!=null&&t.payload.byteLength>0&&(r.uint32(26),r.bytes(t.payload)),t.signature!=null&&t.signature.byteLength>0&&(r.uint32(42),r.bytes(t.signature)),o.lengthDelimited!==!1&&r.ldelim()},(t,r,o={})=>{const l={publicKey:Ot(0),payloadType:Ot(0),payload:Ot(0),signature:Ot(0)},u=r==null?t.len:t.pos+r;for(;t.pos<u;){const f=t.uint32();switch(f>>>3){case 1:{l.publicKey=t.bytes();break}case 2:{l.payloadType=t.bytes();break}case 3:{l.payload=t.bytes();break}case 5:{l.signature=t.bytes();break}default:{t.skipType(f&7);break}}}return l})),e),n.encode=t=>Gn(t,n.codec()),n.decode=(t,r)=>jn(t,n.codec(),r)})(Gf||(Gf={}));class C7 extends Error{constructor(e="Invalid signature"){super(e),this.name="InvalidSignatureError"}}class Qo{static createFromProtobuf=e=>{const t=Gf.decode(e),r=cd(t.publicKey);return new Qo({publicKey:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})};static seal=async(e,t,r)=>{if(t==null)throw new Error("Missing private key");const o=e.domain,l=e.codec,u=e.marshal(),f=ZE(o,l,u),h=await t.sign(f.subarray(),r);return new Qo({publicKey:t.publicKey,payloadType:l,payload:u,signature:h})};static openAndCertify=async(e,t,r)=>{const o=Qo.createFromProtobuf(e);if(!await o.validate(t,r))throw new C7("Envelope signature is not valid for the given domain");return o};publicKey;payloadType;payload;signature;marshaled;constructor(e){const{publicKey:t,payloadType:r,payload:o,signature:l}=e;this.publicKey=t,this.payloadType=r,this.payload=o,this.signature=l}marshal(){return this.marshaled==null&&(this.marshaled=Gf.encode({publicKey:Di(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return e==null?!1:et(this.marshal(),e.marshal())}async validate(e,t){const r=ZE(e,this.payloadType,this.payload);return this.publicKey.verify(r.subarray(),this.signature,t)}}const ZE=(n,e,t)=>{const r=de(n),o=zo(r.byteLength),l=zo(e.length),u=zo(t.length);return new rt(o,r,l,e,u,t)};function N7(n,e){const t=(r,o)=>r.toString().localeCompare(o.toString());return n.length!==e.length?!1:(e.sort(t),n.sort(t).every((r,o)=>e[o].equals(r)))}const B7="libp2p-peer-record",D7=Uint8Array.from([3,1]);var Yf;(function(n){(function(t){let r;t.codec=()=>(r==null&&(r=Yn((o,l,u={})=>{u.lengthDelimited!==!1&&l.fork(),o.multiaddr!=null&&o.multiaddr.byteLength>0&&(l.uint32(10),l.bytes(o.multiaddr)),u.lengthDelimited!==!1&&l.ldelim()},(o,l,u={})=>{const f={multiaddr:Ot(0)},h=l==null?o.len:o.pos+l;for(;o.pos<h;){const p=o.uint32();switch(p>>>3){case 1:{f.multiaddr=o.bytes();break}default:{o.skipType(p&7);break}}}return f})),r),t.encode=o=>Gn(o,t.codec()),t.decode=(o,l)=>jn(o,t.codec(),l)})(n.AddressInfo||(n.AddressInfo={}));let e;n.codec=()=>(e==null&&(e=Yn((t,r,o={})=>{if(o.lengthDelimited!==!1&&r.fork(),t.peerId!=null&&t.peerId.byteLength>0&&(r.uint32(10),r.bytes(t.peerId)),t.seq!=null&&t.seq!==0n&&(r.uint32(16),r.uint64(t.seq)),t.addresses!=null)for(const l of t.addresses)r.uint32(26),n.AddressInfo.codec().encode(l,r);o.lengthDelimited!==!1&&r.ldelim()},(t,r,o={})=>{const l={peerId:Ot(0),seq:0n,addresses:[]},u=r==null?t.len:t.pos+r;for(;t.pos<u;){const f=t.uint32();switch(f>>>3){case 1:{l.peerId=t.bytes();break}case 2:{l.seq=t.uint64();break}case 3:{if(o.limits?.addresses!=null&&l.addresses.length===o.limits.addresses)throw new Wp('Decode error - map field "addresses" had too many elements');l.addresses.push(n.AddressInfo.codec().decode(t,t.uint32(),{limits:o.limits?.addresses$}));break}default:{t.skipType(f&7);break}}}return l})),e),n.encode=t=>Gn(t,n.codec()),n.decode=(t,r)=>jn(t,n.codec(),r)})(Yf||(Yf={}));class Bi{static createFromProtobuf=e=>{const t=Yf.decode(e),r=ud(va(t.peerId)),o=(t.addresses??[]).map(u=>lt(u.multiaddr)),l=t.seq;return new Bi({peerId:r,multiaddrs:o,seqNumber:l})};static DOMAIN=B7;static CODEC=D7;peerId;multiaddrs;seqNumber;domain=Bi.DOMAIN;codec=Bi.CODEC;marshaled;constructor(e){const{peerId:t,multiaddrs:r,seqNumber:o}=e;this.peerId=t,this.multiaddrs=r??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Yf.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof Bi)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!N7(this.multiaddrs,e.multiaddrs))}}const R7=36e5,M7=216e5;var bs;(function(n){(function(t){let r;t.codec=()=>(r==null&&(r=Yn((o,l,u={})=>{u.lengthDelimited!==!1&&l.fork(),o.key!=null&&o.key!==""&&(l.uint32(10),l.string(o.key)),o.value!=null&&o.value.byteLength>0&&(l.uint32(18),l.bytes(o.value)),u.lengthDelimited!==!1&&l.ldelim()},(o,l,u={})=>{const f={key:"",value:Ot(0)},h=l==null?o.len:o.pos+l;for(;o.pos<h;){const p=o.uint32();switch(p>>>3){case 1:{f.key=o.string();break}case 2:{f.value=o.bytes();break}default:{o.skipType(p&7);break}}}return f})),r),t.encode=o=>Gn(o,t.codec()),t.decode=(o,l)=>jn(o,t.codec(),l)})(n.Peer$metadataEntry||(n.Peer$metadataEntry={})),(function(t){let r;t.codec=()=>(r==null&&(r=Yn((o,l,u={})=>{u.lengthDelimited!==!1&&l.fork(),o.key!=null&&o.key!==""&&(l.uint32(10),l.string(o.key)),o.value!=null&&(l.uint32(18),Xf.codec().encode(o.value,l)),u.lengthDelimited!==!1&&l.ldelim()},(o,l,u={})=>{const f={key:""},h=l==null?o.len:o.pos+l;for(;o.pos<h;){const p=o.uint32();switch(p>>>3){case 1:{f.key=o.string();break}case 2:{f.value=Xf.codec().decode(o,o.uint32(),{limits:u.limits?.value});break}default:{o.skipType(p&7);break}}}return f})),r),t.encode=o=>Gn(o,t.codec()),t.decode=(o,l)=>jn(o,t.codec(),l)})(n.Peer$tagsEntry||(n.Peer$tagsEntry={}));let e;n.codec=()=>(e==null&&(e=Yn((t,r,o={})=>{if(o.lengthDelimited!==!1&&r.fork(),t.addresses!=null)for(const l of t.addresses)r.uint32(10),Zf.codec().encode(l,r);if(t.protocols!=null)for(const l of t.protocols)r.uint32(18),r.string(l);if(t.publicKey!=null&&(r.uint32(34),r.bytes(t.publicKey)),t.peerRecordEnvelope!=null&&(r.uint32(42),r.bytes(t.peerRecordEnvelope)),t.metadata!=null&&t.metadata.size!==0)for(const[l,u]of t.metadata.entries())r.uint32(50),n.Peer$metadataEntry.codec().encode({key:l,value:u},r);if(t.tags!=null&&t.tags.size!==0)for(const[l,u]of t.tags.entries())r.uint32(58),n.Peer$tagsEntry.codec().encode({key:l,value:u},r);t.updated!=null&&(r.uint32(64),r.uint64Number(t.updated)),o.lengthDelimited!==!1&&r.ldelim()},(t,r,o={})=>{const l={addresses:[],protocols:[],metadata:new Map,tags:new Map},u=r==null?t.len:t.pos+r;for(;t.pos<u;){const f=t.uint32();switch(f>>>3){case 1:{if(o.limits?.addresses!=null&&l.addresses.length===o.limits.addresses)throw new Wp('Decode error - map field "addresses" had too many elements');l.addresses.push(Zf.codec().decode(t,t.uint32(),{limits:o.limits?.addresses$}));break}case 2:{if(o.limits?.protocols!=null&&l.protocols.length===o.limits.protocols)throw new Wp('Decode error - map field "protocols" had too many elements');l.protocols.push(t.string());break}case 4:{l.publicKey=t.bytes();break}case 5:{l.peerRecordEnvelope=t.bytes();break}case 6:{if(o.limits?.metadata!=null&&l.metadata.size===o.limits.metadata)throw new O1('Decode error - map field "metadata" had too many elements');const h=n.Peer$metadataEntry.codec().decode(t,t.uint32());l.metadata.set(h.key,h.value);break}case 7:{if(o.limits?.tags!=null&&l.tags.size===o.limits.tags)throw new O1('Decode error - map field "tags" had too many elements');const h=n.Peer$tagsEntry.codec().decode(t,t.uint32(),{limits:{value:o.limits?.tags$value}});l.tags.set(h.key,h.value);break}case 8:{l.updated=t.uint64Number();break}default:{t.skipType(f&7);break}}}return l})),e),n.encode=t=>Gn(t,n.codec()),n.decode=(t,r)=>jn(t,n.codec(),r)})(bs||(bs={}));var Zf;(function(n){let e;n.codec=()=>(e==null&&(e=Yn((t,r,o={})=>{o.lengthDelimited!==!1&&r.fork(),t.multiaddr!=null&&t.multiaddr.byteLength>0&&(r.uint32(10),r.bytes(t.multiaddr)),t.isCertified!=null&&(r.uint32(16),r.bool(t.isCertified)),t.observed!=null&&(r.uint32(24),r.uint64Number(t.observed)),o.lengthDelimited!==!1&&r.ldelim()},(t,r,o={})=>{const l={multiaddr:Ot(0)},u=r==null?t.len:t.pos+r;for(;t.pos<u;){const f=t.uint32();switch(f>>>3){case 1:{l.multiaddr=t.bytes();break}case 2:{l.isCertified=t.bool();break}case 3:{l.observed=t.uint64Number();break}default:{t.skipType(f&7);break}}}return l})),e),n.encode=t=>Gn(t,n.codec()),n.decode=(t,r)=>jn(t,n.codec(),r)})(Zf||(Zf={}));var Xf;(function(n){let e;n.codec=()=>(e==null&&(e=Yn((t,r,o={})=>{o.lengthDelimited!==!1&&r.fork(),t.value!=null&&t.value!==0&&(r.uint32(8),r.uint32(t.value)),t.expiry!=null&&(r.uint32(16),r.uint64(t.expiry)),o.lengthDelimited!==!1&&r.ldelim()},(t,r,o={})=>{const l={value:0},u=r==null?t.len:t.pos+r;for(;t.pos<u;){const f=t.uint32();switch(f>>>3){case 1:{l.value=t.uint32();break}case 2:{l.expiry=t.uint64();break}default:{t.skipType(f&7);break}}}return l})),e),n.encode=t=>Gn(t,n.codec()),n.decode=(t,r)=>jn(t,n.codec(),r)})(Xf||(Xf={}));function I7(n,e){if(n.publicKey!=null||e.publicKey==null)return n;let t;n.type==="RSA"&&(t=n.toMultihash());const r=cd(e.publicKey,t);return FS(r)}function O7(n,e,t){const r=bs.decode(e);return Hl(n,r,t)}function Hl(n,e,t){const r=new Map,o=BigInt(Date.now());for(const[l,u]of e.tags.entries())u.expiry!=null&&u.expiry<o||r.set(l,u);return{...e,id:I7(n,e),addresses:e.addresses.filter(({observed:l})=>l!=null&&l>Date.now()-t).map(({multiaddr:l,isCertified:u})=>({multiaddr:lt(l),isCertified:u??!1})),metadata:e.metadata,peerRecordEnvelope:e.peerRecordEnvelope??void 0,tags:r}}function L7(n,e){return U7(n.addresses,e.addresses)&&P7(n.protocols,e.protocols)&&z7(n.publicKey,e.publicKey)&&V7(n.peerRecordEnvelope,e.peerRecordEnvelope)&&$7(n.metadata,e.metadata)&&H7(n.tags,e.tags)}function U7(n,e){return P_(n,e,(t,r)=>!(t.isCertified!==r.isCertified||!et(t.multiaddr,r.multiaddr)))}function P7(n,e){return P_(n,e,(t,r)=>t===r)}function z7(n,e){return U_(n,e)}function V7(n,e){return U_(n,e)}function $7(n,e){return z_(n,e,(t,r)=>et(t,r))}function H7(n,e){return z_(n,e,(t,r)=>t.value===r.value&&t.expiry===r.expiry)}function U_(n,e){return n==null&&e==null?!0:n!=null&&e!=null?et(n,e):!1}function P_(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function z_(n,e,t){if(n.size!==e.size)return!1;for(const[r,o]of n.entries()){const l=e.get(r);if(l==null||!t(o,l))return!1}return!0}const V_="/peers/";function cf(n){if(!Po(n)||n.type==null)throw new ge("Invalid PeerId");const e=n.toCID().toString();return new ot(`${V_}${e}`)}async function q7(n,e,t,r,o){const l=new Map;for(const u of t){if(u==null)continue;if(u.multiaddr instanceof Uint8Array&&(u.multiaddr=lt(u.multiaddr)),!yd(u.multiaddr))throw new ge("Multiaddr was invalid");if(!await e(n,u.multiaddr,o))continue;const f=u.isCertified??!1,h=u.multiaddr.toString(),p=l.get(h);p!=null?u.isCertified=p.isCertified||f:l.set(h,{multiaddr:u.multiaddr,isCertified:f})}return[...l.values()].sort((u,f)=>u.multiaddr.toString().localeCompare(f.multiaddr.toString())).map(({isCertified:u,multiaddr:f})=>{const h=f.getPeerId();return n.equals(h)&&(f=f.decapsulate(lt(`/p2p/${n}`))),{isCertified:u,multiaddr:f.bytes}})}async function bp(n,e,t,r){if(e==null)throw new ge("Invalid PeerData");if(e.publicKey!=null&&n.publicKey!=null&&!e.publicKey.equals(n.publicKey))throw new ge("publicKey bytes do not match peer id publicKey bytes");const o=r.existingPeer?.peer;if(o!=null&&!n.equals(o.id))throw new ge("peer id did not match existing peer id");let l=o?.addresses??[],u=new Set(o?.protocols??[]),f=o?.metadata??new Map,h=o?.tags??new Map,p=o?.peerRecordEnvelope;if(t==="patch"){if((e.multiaddrs!=null||e.addresses!=null)&&(l=[],e.multiaddrs!=null&&l.push(...e.multiaddrs.map(b=>({isCertified:!1,multiaddr:b}))),e.addresses!=null&&l.push(...e.addresses)),e.protocols!=null&&(u=new Set(e.protocols)),e.metadata!=null){const b=e.metadata instanceof Map?[...e.metadata.entries()]:Object.entries(e.metadata);f=uf(b,{validate:XE})}if(e.tags!=null){const b=e.tags instanceof Map?[...e.tags.entries()]:Object.entries(e.tags);h=uf(b,{validate:QE,map:JE})}e.peerRecordEnvelope!=null&&(p=e.peerRecordEnvelope)}if(t==="merge"){if(e.multiaddrs!=null&&l.push(...e.multiaddrs.map(b=>({isCertified:!1,multiaddr:b}))),e.addresses!=null&&l.push(...e.addresses),e.protocols!=null&&(u=new Set([...u,...e.protocols])),e.metadata!=null){const b=e.metadata instanceof Map?[...e.metadata.entries()]:Object.entries(e.metadata);for(const[E,x]of b)x==null?f.delete(E):f.set(E,x);f=uf([...f.entries()],{validate:XE})}if(e.tags!=null){const b=e.tags instanceof Map?[...e.tags.entries()]:Object.entries(e.tags),E=new Map(h);for(const[x,k]of b)k==null?E.delete(x):E.set(x,k);h=uf([...E.entries()],{validate:QE,map:JE})}e.peerRecordEnvelope!=null&&(p=e.peerRecordEnvelope)}let m;o?.id.publicKey!=null?m=Di(o.id.publicKey):e.publicKey!=null?m=Di(e.publicKey):n.publicKey!=null&&(m=Di(n.publicKey));const y={addresses:await q7(n,r.addressFilter??(async()=>!0),l,r.existingPeer?.peerPB.addresses,r),protocols:[...u.values()].sort((b,E)=>b.localeCompare(E)),metadata:f,tags:h,publicKey:m,peerRecordEnvelope:p};return y.addresses.forEach(b=>{b.observed=r.existingPeer?.peerPB.addresses?.find(E=>et(E.multiaddr,E.multiaddr))?.observed??Date.now()}),n.type!=="RSA"&&delete y.publicKey,y}function uf(n,e){const t=new Map;for(const[r,o]of n)o!=null&&e.validate(r,o);for(const[r,o]of n.sort(([l],[u])=>l.localeCompare(u)))o!=null&&t.set(r,e.map?.(r,o)??o);return t}function XE(n,e){if(typeof n!="string")throw new ge("Metadata key must be a string");if(!(e instanceof Uint8Array))throw new ge("Metadata value must be a Uint8Array")}function QE(n,e){if(typeof n!="string")throw new ge("Tag name must be a string");if(e.value!=null){if(parseInt(`${e.value}`,10)!==e.value)throw new ge("Tag value must be an integer");if(e.value<0||e.value>100)throw new ge("Tag value must be between 0-100")}if(e.ttl!=null){if(parseInt(`${e.ttl}`,10)!==e.ttl)throw new ge("Tag ttl must be an integer");if(e.ttl<0)throw new ge("Tag ttl must be between greater than 0")}}function JE(n,e){let t;e.expiry!=null&&(t=e.expiry),e.ttl!=null&&(t=BigInt(Date.now()+Number(e.ttl)));const r={value:e.value??0};return t!=null&&(r.expiry=t),r}function $_(n){const e=n.toString().split("/")[2],t=Se.parse(e,wn);return fd(t)}function wp(n,e,t){const r=$_(n);return O7(r,e,t)}function F7(n,e){return{prefix:V_,filters:(n.filters??[]).map(t=>({key:r,value:o})=>t(wp(r,o,e))),orders:(n.orders??[]).map(t=>(r,o)=>t(wp(r.key,r.value,e),wp(o.key,o.value,e)))}}class K7{peerId;datastore;locks;addressFilter;log;maxAddressAge;maxPeerAge;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:peer-store"),this.peerId=e.peerId,this.datastore=e.datastore,this.addressFilter=t.addressFilter,this.locks=aM({name:"libp2p_peer_store_locks",metrics:e.metrics}),this.maxAddressAge=t.maxAddressAge??R7,this.maxPeerAge=t.maxPeerAge??M7}getLock(e){let t=this.locks.get(e);return t==null&&(t={refs:0,lock:DA({name:e.toString(),singleProcess:!0})},this.locks.set(e,t)),t.refs++,t}maybeRemoveLock(e,t){t.refs--,t.refs===0&&(t.lock.finalize(),this.locks.delete(e))}async getReadLock(e,t){const r=this.getLock(e);try{const o=await r.lock.readLock(t);return()=>{o(),this.maybeRemoveLock(e,r)}}catch(o){throw this.maybeRemoveLock(e,r),o}}async getWriteLock(e,t){const r=this.getLock(e);try{const o=await r.lock.writeLock(t);return()=>{o(),this.maybeRemoveLock(e,r)}}catch(o){throw this.maybeRemoveLock(e,r),o}}async has(e,t){try{return await this.load(e,t),!0}catch(r){if(r.name!=="NotFoundError")throw r}return!1}async delete(e,t){this.peerId.equals(e)||await this.datastore.delete(cf(e),t)}async load(e,t){const r=cf(e),o=await this.datastore.get(r,t),l=bs.decode(o);if(this.#n(e,l))throw await this.datastore.delete(r,t),new Kn;return Hl(e,l,this.peerId.equals(e)?1/0:this.maxAddressAge)}async save(e,t,r){const o=await this.#e(e,r),l=await bp(e,t,"patch",{...r,addressFilter:this.addressFilter});return this.#t(e,l,o)}async patch(e,t,r){const o=await this.#e(e,r),l=await bp(e,t,"patch",{...r,addressFilter:this.addressFilter,existingPeer:o});return this.#t(e,l,o)}async merge(e,t,r){const o=await this.#e(e,r),l=await bp(e,t,"merge",{addressFilter:this.addressFilter,existingPeer:o});return this.#t(e,l,o)}async*all(e){for await(const{key:t,value:r}of this.datastore.query(F7(e??{},this.maxAddressAge),e)){const o=$_(t);if(o.equals(this.peerId))continue;const l=bs.decode(r);if(this.#n(o,l)){await this.datastore.delete(t,e);continue}yield Hl(o,l,this.peerId.equals(o)?1/0:this.maxAddressAge)}}async#e(e,t){try{const r=cf(e),o=await this.datastore.get(r,t),l=bs.decode(o);if(this.#n(e,l))throw await this.datastore.delete(r,t),new Kn;return{peerPB:l,peer:Hl(e,l,this.maxAddressAge)}}catch(r){r.name!=="NotFoundError"&&this.log.error("invalid peer data found in peer store - %e",r)}}async#t(e,t,r,o){t.updated=Date.now();const l=bs.encode(t);return await this.datastore.put(cf(e),l,o),{peer:Hl(e,t,this.maxAddressAge),previous:r?.peer,updated:r==null||!L7(t,r.peerPB)}}#n(e,t){if(t.updated==null)return!0;if(this.peerId.equals(e))return!1;const r=t.updated<Date.now()-this.maxPeerAge,o=Date.now()-this.maxAddressAge,l=t.addresses.filter(u=>u.observed!=null&&u.observed>o);return r&&l.length===0}}class j7{store;events;peerId;log;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:peer-store"),this.events=e.events,this.peerId=e.peerId,this.store=new K7(e,t)}[Symbol.toStringTag]="@libp2p/peer-store";async forEach(e,t){for await(const r of this.store.all(t))e(r)}async all(e){return xm(this.store.all(e))}async delete(e,t){const r=await this.store.getReadLock(e,t);try{await this.store.delete(e,t)}finally{r()}}async has(e,t){const r=await this.store.getReadLock(e,t);try{return await this.store.has(e,t)}finally{this.log.trace("has release read lock"),r?.()}}async get(e,t){const r=await this.store.getReadLock(e,t);try{return await this.store.load(e,t)}finally{r?.()}}async getInfo(e,t){const r=await this.get(e,t);return{id:r.id,multiaddrs:r.addresses.map(({multiaddr:o})=>o)}}async save(e,t,r){const o=await this.store.getWriteLock(e,r);try{const l=await this.store.save(e,t,r);return this.#e(e,l),l.peer}finally{o?.()}}async patch(e,t,r){const o=await this.store.getWriteLock(e,r);try{const l=await this.store.patch(e,t,r);return this.#e(e,l),l.peer}finally{o?.()}}async merge(e,t,r){const o=await this.store.getWriteLock(e,r);try{const l=await this.store.merge(e,t,r);return this.#e(e,l),l.peer}finally{o?.()}}async consumePeerRecord(e,t,r){const o=Po(t)?t:Po(t?.expectedPeer)?t.expectedPeer:void 0,l=Po(t)||t===void 0?r:t,u=await Qo.openAndCertify(e,Bi.DOMAIN,l),f=fd(u.publicKey.toCID());if(o?.equals(f)===!1)return this.log("envelope peer id was not the expected peer id - expected: %p received: %p",o,f),!1;const h=Bi.createFromProtobuf(u.payload);let p;try{p=await this.get(f,l)}catch(m){if(m.name!=="NotFoundError")throw m}if(p?.peerRecordEnvelope!=null){const m=Qo.createFromProtobuf(p.peerRecordEnvelope),y=Bi.createFromProtobuf(m.payload);if(y.seqNumber>=h.seqNumber)return this.log("sequence number was lower or equal to existing sequence number - stored: %d received: %d",y.seqNumber,h.seqNumber),!1}return await this.patch(h.peerId,{peerRecordEnvelope:e,addresses:h.multiaddrs.map(m=>({isCertified:!0,multiaddr:m}))},l),!0}#e(e,t){t.updated&&(this.peerId.equals(e)?this.events.safeDispatchEvent("self:peer:update",{detail:t}):this.events.safeDispatchEvent("peer:update",{detail:t}))}}function G7(n,e={}){return new j7(n,e)}const WE=864e13,Y7=448,vp=449,Z7=53,X7=54,Q7=55,J7=56;class W7{log;mappings;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:address-manager:dns-mappings"),this.mappings=qr({name:"libp2p_address_manager_dns_mappings",metrics:e.metrics})}has(e){const t=this.findHost(e);for(const r of this.mappings.values())if(r.domain===t)return!0;return!1}add(e,t){t.forEach(r=>{this.log("add DNS mapping %s to %s",r,e);const o=kc(r)===!0;this.mappings.set(r,{domain:e,verified:o,expires:o?WE-Date.now():0,lastVerified:o?WE-Date.now():void 0})})}remove(e){const t=this.findHost(e);let r=!1;for(const[o,l]of this.mappings.entries())l.domain===t&&(this.log("removing %s to %s DNS mapping %e",o,l.domain),this.mappings.delete(o),r=r||l.verified);return r}getAll(e){const t=[];for(let r=0;r<e.length;r++){const l=e[r].multiaddr.stringTuples(),u=l[0][1];if(u!=null)for(const[f,h]of this.mappings.entries()){if(u!==f)continue;this.maybeAddSNITuple(l,h.domain)&&(e.splice(r,1),r--,t.push({multiaddr:lt(`/${l.map(m=>[u_(m[0]).name,m[1]].join("/")).join("/")}`),verified:h.verified,type:"dns-mapping",expires:h.expires,lastVerified:h.lastVerified}))}}return t}maybeAddSNITuple(e,t){for(let r=0;r<e.length;r++)if(e[r][0]===Y7&&e[r+1]?.[0]!==vp)return e.splice(r+1,0,[vp,t]),!0;return!1}confirm(e,t){const r=this.findHost(e);let o=!1;for(const[l,u]of this.mappings.entries())u.domain===r&&(this.log("marking %s to %s DNS mapping as verified",l,u.domain),o=u.verified,u.verified=!0,u.expires=Date.now()+t,u.lastVerified=Date.now());return o}unconfirm(e,t){const r=this.findHost(e);let o=!1;for(const[l,u]of this.mappings.entries())u.domain===r&&(this.log("removing verification of %s to %s DNS mapping",l,u.domain),o=o||u.verified,u.verified=!1,u.expires=Date.now()+t);return o}findHost(e){for(const t of e.stringTuples())if(t[0]===vp||t[0]===Z7||t[0]===X7||t[0]===Q7||t[0]===J7)return t[1]}}const Ep=4,xp=41,Sp=6,e9=273;class t9{log;mappings;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:address-manager:ip-mappings"),this.mappings=qr({name:"libp2p_address_manager_ip_mappings",metrics:e.metrics})}has(e){const t=e.stringTuples();for(const r of this.mappings.values())for(const o of r)if(o.externalIp===t[0][1])return!0;return!1}add(e,t,r,o=t,l="tcp"){const u=`${e}-${t}-${l}`,f=this.mappings.get(u)??[],h={internalIp:e,internalPort:t,externalIp:r,externalPort:o,externalFamily:ua(r)?4:6,protocol:l,verified:!1,expires:0};f.push(h),this.mappings.set(u,f)}remove(e){const t=e.stringTuples(),r=t[0][1]??"",o=t[1][0]===Sp?"tcp":"udp",l=parseInt(t[1][1]??"0");let u=!1;for(const[f,h]of this.mappings.entries()){for(let p=0;p<h.length;p++){const m=h[p];m.externalIp===r&&m.externalPort===l&&m.protocol===o&&(this.log("removing %s:%s to %s:%s %s IP mapping",m.externalIp,m.externalPort,r,l,o),u=u||m.verified,h.splice(p,1),p--)}h.length===0&&this.mappings.delete(f)}return u}getAll(e){const t=[];for(const{multiaddr:r}of e){const o=r.stringTuples();let l;if((o[0][0]===Ep||o[0][0]===xp)&&o[1][0]===Sp?l=`${o[0][1]}-${o[1][1]}-tcp`:(o[0][0]===Ep||o[0][0]===xp)&&o[1][0]===e9&&(l=`${o[0][1]}-${o[1][1]}-udp`),l==null)continue;const u=this.mappings.get(l);if(u!=null)for(const f of u)o[0][0]=f.externalFamily===4?Ep:xp,o[0][1]=f.externalIp,o[1][1]=`${f.externalPort}`,t.push({multiaddr:lt(`/${o.map(h=>[u_(h[0]).name,h[1]].join("/")).join("/")}`),verified:f.verified,type:"ip-mapping",expires:f.expires,lastVerified:f.lastVerified})}return t}confirm(e,t){const o=e.stringTuples()[0][1];let l=!1;for(const u of this.mappings.values())for(const f of u)f.externalIp===o&&(this.log("marking %s to %s IP mapping as verified",f.internalIp,f.externalIp),l=f.verified,f.verified=!0,f.expires=Date.now()+t,f.lastVerified=Date.now());return l}unconfirm(e,t){const r=e.stringTuples(),o=r[0][1]??"",l=r[1][0]===Sp?"tcp":"udp",u=parseInt(r[1][1]??"0");let f=!1;for(const h of this.mappings.values())for(let p=0;p<h.length;p++){const m=h[p];m.externalIp===o&&m.externalPort===u&&m.protocol===l&&(this.log("removing verification of %s:%s to %s:%s %s IP mapping",m.externalIp,m.externalPort,o,u,l),f=f||m.verified,m.verified=!1,m.expires=Date.now()+t)}return f}}function n9(n){try{for(const{code:e,value:t}of n.getComponents())if(e!==_a&&t!=null){if(e===ks)return t.startsWith("169.254.");if(e===zr)return t.toLowerCase().startsWith("fe80")}}catch{}return!1}function H_(n){try{for(const{code:e}of n.getComponents())if(e!==_a)return e===ks||e===zr}catch{}return!1}function Qf(n){try{if(!H_(n))return!1;const[[,e]]=n.stringTuples();return e==null?!1:kc(e)??!1}catch{}return!0}const r9={maxObservedAddresses:10};class i9{log;addresses;maxObservedAddresses;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:address-manager:observed-addresses"),this.addresses=qr({name:"libp2p_address_manager_observed_addresses",metrics:e.metrics}),this.maxObservedAddresses=t.maxObservedAddresses??r9.maxObservedAddresses}has(e){return this.addresses.has(e.toString())}removePrefixed(e){for(const t of this.addresses.keys())t.toString().startsWith(e)&&this.addresses.delete(t)}add(e){this.addresses.size!==this.maxObservedAddresses&&(Qf(e)||n9(e)||(this.log("adding observed address %a",e),this.addresses.set(e.toString(),{verified:!1,expires:0})))}getAll(){return Array.from(this.addresses).map(([e,t])=>({multiaddr:lt(e),verified:t.verified,type:"observed",expires:t.expires,lastVerified:t.lastVerified}))}remove(e){const t=this.addresses.get(e.toString())?.verified??!1;return this.log("removing observed address %a",e),this.addresses.delete(e.toString()),t}confirm(e,t){const r=e.toString(),o=this.addresses.get(r)??{verified:!1,expires:Date.now()+t,lastVerified:Date.now()},l=o.verified;return o.verified=!0,o.expires=Date.now()+t,o.lastVerified=Date.now(),this.log("marking observed address %a as verified",r),this.addresses.set(r,o),l}}const s9=[ks,zr,Ac,_c,Ta,Tc];function ex(n){try{for(const{code:e}of n.getComponents())if(e!==_a)return s9.includes(e)}catch{}return!1}const o9={maxObservedAddresses:10};class a9{log;addresses;maxObservedAddresses;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:address-manager:observed-addresses"),this.addresses=qr({name:"libp2p_address_manager_transport_addresses",metrics:e.metrics}),this.maxObservedAddresses=t.maxObservedAddresses??o9.maxObservedAddresses}get(e,t){if(Qf(e))return{multiaddr:e,verified:!0,type:"transport",expires:Date.now()+t,lastVerified:Date.now()};const r=this.toKey(e);let o=this.addresses.get(r);return o==null&&(o={verified:!ex(e),expires:0},this.addresses.set(r,o)),{multiaddr:e,verified:o.verified,type:"transport",expires:o.expires,lastVerified:o.lastVerified}}has(e){const t=this.toKey(e);return this.addresses.has(t)}remove(e){const t=this.toKey(e),r=this.addresses.get(t)?.verified??!1;return this.log("removing observed address %a",e),this.addresses.delete(t),r}confirm(e,t){const r=this.toKey(e),o=this.addresses.get(r)??{verified:!1,expires:0,lastVerified:0},l=o.verified;return o.verified=!0,o.expires=Date.now()+t,o.lastVerified=Date.now(),this.addresses.set(r,o),l}unconfirm(e,t){const r=this.toKey(e),o=this.addresses.get(r)??{verified:!1,expires:0},l=o.verified;return o.verified=!1,o.expires=Date.now()+t,this.addresses.set(r,o),l}toKey(e){if(ex(e)){const t=e.toOptions();return`${t.host}-${t.port}-${t.transport}`}return e.toString()}}const tx=6e4,nx={addressVerificationTTL:tx*10,addressVerificationRetry:tx*5},l9=n=>n;function Ap(n,e){const t=n.getPeerId();return t!=null&&_s(t).equals(e)&&(n=n.decapsulate(lt(`/p2p/${e.toString()}`))),n}class c9{log;components;listen;announce;appendAnnounce;announceFilter;observed;dnsMappings;ipMappings;transportAddresses;observedAddressFilter;addressVerificationTTL;addressVerificationRetry;constructor(e,t={}){const{listen:r=[],announce:o=[],appendAnnounce:l=[]}=t;this.components=e,this.log=e.logger.forComponent("libp2p:address-manager"),this.listen=r.map(u=>u.toString()),this.announce=new Set(o.map(u=>u.toString())),this.appendAnnounce=new Set(l.map(u=>u.toString())),this.observed=new i9(e,t),this.dnsMappings=new W7(e,t),this.ipMappings=new t9(e,t),this.transportAddresses=new a9(e,t),this.announceFilter=t.announceFilter??l9,this.observedAddressFilter=Sy(1024),this.addressVerificationTTL=t.addressVerificationTTL??nx.addressVerificationTTL,this.addressVerificationRetry=t.addressVerificationRetry??nx.addressVerificationRetry,this._updatePeerStoreAddresses=jp(this._updatePeerStoreAddresses.bind(this),1e3),e.events.addEventListener("transport:listening",()=>{this._updatePeerStoreAddresses()}),e.events.addEventListener("transport:close",()=>{this._updatePeerStoreAddresses()})}[Symbol.toStringTag]="@libp2p/address-manager";_updatePeerStoreAddresses(){const e=this.getAddresses().map(t=>t.getPeerId()===this.components.peerId.toString()?t.decapsulate(`/p2p/${this.components.peerId.toString()}`):t);this.components.peerStore.patch(this.components.peerId,{multiaddrs:e}).catch(t=>{this.log.error("error updating addresses",t)})}getListenAddrs(){return Array.from(this.listen).map(e=>lt(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>lt(e))}getAppendAnnounceAddrs(){return Array.from(this.appendAnnounce).map(e=>lt(e))}getObservedAddrs(){return this.observed.getAll().map(e=>e.multiaddr)}addObservedAddr(e){const t=e.stringTuples(),r=`${t[0][1]}:${t[1][1]}`;this.observedAddressFilter.has(r)||(this.observedAddressFilter.add(r),e=Ap(e,this.components.peerId),!this.ipMappings.has(e)&&(this.dnsMappings.has(e)||this.observed.add(e)))}confirmObservedAddr(e,t){e=Ap(e,this.components.peerId);let r=!0;(t?.type==="transport"||this.transportAddresses.has(e))&&!this.transportAddresses.confirm(e,t?.ttl??this.addressVerificationTTL)&&r&&(r=!1),(t?.type==="dns-mapping"||this.dnsMappings.has(e))&&!this.dnsMappings.confirm(e,t?.ttl??this.addressVerificationTTL)&&r&&(r=!1),(t?.type==="ip-mapping"||this.ipMappings.has(e))&&!this.ipMappings.confirm(e,t?.ttl??this.addressVerificationTTL)&&r&&(r=!1),(t?.type==="observed"||this.observed.has(e))&&(this.maybeUpgradeToIPMapping(e)?(this.ipMappings.confirm(e,t?.ttl??this.addressVerificationTTL),r=!1):!this.observed.confirm(e,t?.ttl??this.addressVerificationTTL)&&r&&(r=!1)),r||this._updatePeerStoreAddresses()}removeObservedAddr(e,t){e=Ap(e,this.components.peerId),this.observed.has(e)&&this.observed.remove(e),this.transportAddresses.has(e)&&this.transportAddresses.unconfirm(e,t?.ttl??this.addressVerificationRetry),this.dnsMappings.has(e)&&this.dnsMappings.unconfirm(e,t?.ttl??this.addressVerificationRetry),this.ipMappings.has(e)&&this.ipMappings.unconfirm(e,t?.ttl??this.addressVerificationRetry)}getAddresses(){const e=new Set,t=this.getAddressesWithMetadata().filter(r=>{if(!r.verified)return!1;const o=r.multiaddr.toString();return e.has(o)?!1:(e.add(o),!0)}).map(r=>r.multiaddr);return this.announceFilter(t.map(r=>{const o=lt(r);return o.getComponents().pop()?.value===this.components.peerId.toString()?o:o.encapsulate(`/p2p/${this.components.peerId.toString()}`)}))}getAddressesWithMetadata(){const e=this.getAnnounceAddrs();if(e.length>0)return this.components.transportManager.getListeners().forEach(o=>{o.updateAnnounceAddrs(e)}),e.map(o=>({multiaddr:o,verified:!0,type:"announce",expires:Date.now()+this.addressVerificationTTL,lastVerified:Date.now()}));let t=[];t=t.concat(this.components.transportManager.getAddrs().map(o=>this.transportAddresses.get(o,this.addressVerificationTTL)));const r=this.getAppendAnnounceAddrs();return r.length>0&&(this.components.transportManager.getListeners().forEach(o=>{o.updateAnnounceAddrs(r)}),t=t.concat(r.map(o=>({multiaddr:o,verified:!0,type:"announce",expires:Date.now()+this.addressVerificationTTL,lastVerified:Date.now()})))),t=t.concat(this.observed.getAll()),t=t.concat(this.ipMappings.getAll(t)),t=t.concat(this.dnsMappings.getAll(t)),t}addDNSMapping(e,t){this.dnsMappings.add(e,t)}removeDNSMapping(e){this.dnsMappings.remove(lt(`/dns/${e}`))&&this._updatePeerStoreAddresses()}addPublicAddressMapping(e,t,r,o=t,l="tcp"){this.ipMappings.add(e,t,r,o,l),this.observed.removePrefixed(`/ip${ua(r)?4:6}/${r}/${l}/${o}`)}removePublicAddressMapping(e,t,r,o=t,l="tcp"){this.ipMappings.remove(lt(`/ip${ua(r)?4:6}/${r}/${l}/${o}`))&&this._updatePeerStoreAddresses()}maybeUpgradeToIPMapping(e){if(this.ipMappings.has(e))return!1;const t=e.toOptions();if(t.family===6||t.host==="127.0.0.1"||kc(t.host)===!0)return!1;const r=this.components.transportManager.getListeners(),o=[l=>Ff.exactMatch(l)||bm.exactMatch(l),l=>mm.exactMatch(l),l=>ZL.exactMatch(l)];for(const l of o){if(!l(e))continue;const u=r.filter(p=>p.getAddrs().filter(m=>m.toOptions().family===4&&l(m)).length>0);if(u.length!==1)continue;const f=u[0].getAddrs().filter(p=>p.toOptions().host!=="127.0.0.1").pop();if(f==null)continue;const h=f.toOptions();return this.observed.remove(e),this.ipMappings.add(h.host,h.port,t.host,t.port,t.transport),!0}return!1}}var rx;(function(n){n.NOT_STARTED_YET="The libp2p node is not started yet",n.NOT_FOUND="Not found"})(rx||(rx={}));class u9 extends Error{constructor(e="Missing service"){super(e),this.name="MissingServiceError"}}class f9 extends Error{constructor(e="Unmet service dependencies"){super(e),this.name="UnmetServiceDependenciesError"}}class _p extends Error{constructor(e="No content routers available"){super(e),this.name="NoContentRoutersError"}}class ix extends Error{constructor(e="No peer routers available"){super(e),this.name="NoPeerRoutersError"}}class d9 extends Error{constructor(e="Should not try to find self"){super(e),this.name="QueriedForSelfError"}}class h9 extends Error{constructor(e="Unhandled protocol error"){super(e),this.name="UnhandledProtocolError"}}class g9 extends Error{constructor(e="Duplicate protocol handler error"){super(e),this.name="DuplicateProtocolHandlerError"}}class sx extends Error{constructor(e="Dial denied error"){super(e),this.name="DialDeniedError"}}class p9 extends Error{constructor(e="No transport was configured to listen on this address"){super(e),this.name="UnsupportedListenAddressError"}}class m9 extends Error{constructor(e="Configured listen addresses could not be listened on"){super(e),this.name="UnsupportedListenAddressesError"}}class y9 extends Error{constructor(e="No valid addresses"){super(e),this.name="NoValidAddressesError"}}class b9 extends Error{constructor(e="Connection intercepted"){super(e),this.name="ConnectionInterceptedError"}}class w9 extends Error{constructor(e="Connection denied"){super(e),this.name="ConnectionDeniedError"}}class Am extends Error{constructor(e="Stream is not multiplexed"){super(e),this.name="MuxerUnavailableError"}}class ff extends Error{constructor(e="Encryption failed"){super(e),this.name="EncryptionFailedError"}}class v9 extends Error{constructor(e="Transport unavailable"){super(e),this.name="TransportUnavailableError"}}class E9 extends Error{constructor(e="Max recursive depth reached"){super(e),this.name="RecursionLimitError"}}class x9{components={};_started=!1;constructor(e={}){this.components={};for(const[t,r]of Object.entries(e))this.components[t]=r;this.components.logger==null&&(this.components.logger=dd())}isStarted(){return this._started}async _invokeStartableMethod(e){await Promise.all(Object.values(this.components).filter(t=>Gm(t)).map(async t=>{await t[e]?.()}))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}}const S9=["metrics","connectionProtector","dns"],A9=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];function _9(n={}){const e=new x9(n);return new Proxy(e,{get(r,o,l){if(typeof o=="string"&&!A9.includes(o)){const u=e.components[o];if(u==null&&!S9.includes(o))throw new u9(`${o} not set`);return u}return Reflect.get(r,o,l)},set(r,o,l){return typeof o=="string"?e.components[o]=l:Reflect.set(r,o,l),!0}})}function T9(n){const e={};for(const t of Object.values(n.components))for(const r of k9(t))e[r]=!0;for(const t of Object.values(n.components))for(const r of C9(t))if(e[r]!==!0)throw new f9(`Service "${N9(t)}" required capability "${r}" but it was not provided by any component, you may need to add additional configuration when creating your node.`)}function k9(n){return Array.isArray(n?.[xf])?n[xf]:[]}function C9(n){return Array.isArray(n?.[v1])?n[v1]:[]}function N9(n){return n?.[Symbol.toStringTag]??n?.toString()??"unknown"}const B9=4,D9=41;function R9(n={}){return{denyDialPeer:async()=>!1,denyDialMultiaddr:async e=>{if(Ff.matches(e))return!1;const t=e.stringTuples();return t[0][0]===B9||t[0][0]===D9?!!kc(`${t[0][1]}`):!1},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0,...n}}const ox=()=>{const n=new Error("Delay aborted");return n.name="AbortError",n},M9=new WeakMap;function I9({clearTimeout:n,setTimeout:e}={}){return(t,{value:r,signal:o}={})=>{if(o?.aborted)return Promise.reject(ox());let l,u,f;const h=n??clearTimeout,p=()=>{h(l),f(ox())},m=()=>{o&&o.removeEventListener("abort",p)},y=new Promise((b,E)=>{u=()=>{m(),b(r)},f=E,l=(e??setTimeout)(u,t)});return o&&o.addEventListener("abort",p,{once:!0}),M9.set(y,()=>{h(l),l=null,u()}),y}}const O9=I9();class L9{memoryStorage;points;duration;blockDuration;execEvenly;execEvenlyMinDelayMs;keyPrefix;constructor(e={}){this.points=e.points??4,this.duration=e.duration??1,this.blockDuration=e.blockDuration??0,this.execEvenly=e.execEvenly??!1,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs??this.duration*1e3/this.points,this.keyPrefix=e.keyPrefix??"rlflx",this.memoryStorage=new U9}async consume(e,t=1,r={}){const o=this.getKey(e),l=this._getKeySecDuration(r);let u=this.memoryStorage.incrby(o,t,l);if(u.remainingPoints=Math.max(this.points-u.consumedPoints,0),u.consumedPoints>this.points)throw this.blockDuration>0&&u.consumedPoints<=this.points+t&&(u=this.memoryStorage.set(o,u.consumedPoints,this.blockDuration)),new d8("Rate limit exceeded",u);if(this.execEvenly&&u.msBeforeNext>0&&!u.isFirstInDuration){let f=Math.ceil(u.msBeforeNext/(u.remainingPoints+2));f<this.execEvenlyMinDelayMs&&(f=u.consumedPoints*this.execEvenlyMinDelayMs),await O9(f)}return u}penalty(e,t=1,r={}){const o=this.getKey(e),l=this._getKeySecDuration(r),u=this.memoryStorage.incrby(o,t,l);return u.remainingPoints=Math.max(this.points-u.consumedPoints,0),u}reward(e,t=1,r={}){const o=this.getKey(e),l=this._getKeySecDuration(r),u=this.memoryStorage.incrby(o,-t,l);return u.remainingPoints=Math.max(this.points-u.consumedPoints,0),u}block(e,t){const r=t*1e3,o=this.points+1;return this.memoryStorage.set(this.getKey(e),o,t),{remainingPoints:0,msBeforeNext:r===0?-1:r,consumedPoints:o,isFirstInDuration:!1}}set(e,t,r=0){const o=(r>=0?r:this.duration)*1e3;return this.memoryStorage.set(this.getKey(e),t,r),{remainingPoints:0,msBeforeNext:o===0?-1:o,consumedPoints:t,isFirstInDuration:!1}}get(e){const t=this.memoryStorage.get(this.getKey(e));return t!=null&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),t}delete(e){this.memoryStorage.delete(this.getKey(e))}_getKeySecDuration(e){return e?.customDuration!=null&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}}class U9{storage;constructor(){this.storage=new Map}incrby(e,t,r){const o=this.storage.get(e);if(o!=null){const l=o.expiresAt!=null?o.expiresAt.getTime()-new Date().getTime():-1;return o.expiresAt==null||l>0?(o.value+=t,{remainingPoints:0,msBeforeNext:l,consumedPoints:o.value,isFirstInDuration:!1}):this.set(e,t,r)}return this.set(e,t,r)}set(e,t,r){const o=r*1e3,l=this.storage.get(e);l!=null&&clearTimeout(l.timeoutId);const u={value:t,expiresAt:o>0?new Date(Date.now()+o):void 0};return this.storage.set(e,u),o>0&&(u.timeoutId=setTimeout(()=>{this.storage.delete(e)},o),u.timeoutId.unref!=null&&u.timeoutId.unref()),{remainingPoints:0,msBeforeNext:o===0?-1:o,consumedPoints:u.value,isFirstInDuration:!0}}get(e){const t=this.storage.get(e);if(t!=null)return{remainingPoints:0,msBeforeNext:t.expiresAt!=null?t.expiresAt.getTime()-new Date().getTime():-1,consumedPoints:t.value,isFirstInDuration:!1}}delete(e){const t=this.storage.get(e);return t!=null?(t.timeoutId!=null&&clearTimeout(t.timeoutId),this.storage.delete(e),!0):!1}}function q_(n){if(Po(n))return{peerId:n,multiaddrs:[]};let e=Array.isArray(n)?n:[n],t;if(e.length>0){const r=e[0].getPeerId();t=r==null?void 0:_s(r),e.forEach(o=>{if(!yd(o))throw new Km("Invalid multiaddr");const l=o.getPeerId();if(l==null){if(t!=null)throw new ge("Multiaddrs must all have the same peer id or have no peer id")}else{const u=_s(l);if(t?.equals(u)!==!0)throw new ge("Multiaddrs must all have the same peer id or have no peer id")}})}return e=e.filter(r=>!jL.exactMatch(r)),{peerId:t,multiaddrs:e}}const P9=["/ipfs/id/1.0.0","/ipfs/id/push/1.0.0","/libp2p/autonat/1.0.0","/libp2p/dcutr"];async function z9(n,e){const t=n?.streams?.map(o=>o.protocol)??[],r=e?.closableProtocols??P9;if(!(t.filter(o=>o!=null&&!r.includes(o)).length>0))try{await n?.close(e)}catch(o){n?.abort(o)}}function _m(n){try{let e;typeof n=="string"?e=lt(n):e=n;const t=new Set([...e.getComponents().map(r=>r.name)]);if(!t.has("ipcidr")){const o=t.has("ip6")?"/ipcidr/128":"/ipcidr/32";e=e.encapsulate(o)}return ML(e)}catch{throw new Error(`Can't convert to IpNet, Invalid multiaddr format: ${n}`)}}class V9{connectionManager;peerStore;allow;events;log;constructor(e,t={}){this.allow=(t.allow??[]).map(r=>_m(r)),this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager:connection-pruner"),this.maybePruneConnections=this.maybePruneConnections.bind(this)}start(){this.events.addEventListener("connection:open",this.maybePruneConnections)}stop(){this.events.removeEventListener("connection:open",this.maybePruneConnections)}maybePruneConnections(){this._maybePruneConnections().catch(e=>{this.log.error("error while pruning connections %e",e)})}async _maybePruneConnections(){const e=this.connectionManager.getConnections(),t=e.length,r=this.connectionManager.getMaxConnections();if(this.log("checking max connections limit %d/%d",t,r),t<=r)return;const o=new Ec;for(const h of e){const p=h.remotePeer;if(!o.has(p)){o.set(p,0);try{const m=await this.peerStore.get(p);o.set(p,[...m.tags.values()].reduce((y,b)=>y+b.value,0))}catch(m){m.name!=="NotFoundError"&&this.log.error("error loading peer tags",m)}}}const l=this.sortConnections(e,o),u=Math.max(t-r,0),f=[];for(const h of l)if(this.log("too many connections open - closing a connection to %p",h.remotePeer),this.allow.some(m=>m.contains(h.remoteAddr.nodeAddress().address))||f.push(h),f.length===u)break;await Promise.all(f.map(async h=>{await z9(h,{signal:AbortSignal.timeout(1e3)})})),this.events.safeDispatchEvent("connection:prune",{detail:f})}sortConnections(e,t){return e.sort((r,o)=>{const l=r.timeline.open,u=o.timeline.open;return l<u?1:l>u?-1:0}).sort((r,o)=>r.direction==="outbound"&&o.direction==="inbound"?1:r.direction==="inbound"&&o.direction==="outbound"?-1:0).sort((r,o)=>r.streams.length>o.streams.length?1:r.streams.length<o.streams.length?-1:0).sort((r,o)=>{const l=t.get(r.remotePeer)??0,u=t.get(o.remotePeer)??0;return l>u?1:l<u?-1:0})}}const F_=1e4,$9=1e4,Jf=1e4,K_=25,H9=5,q9=10,F9=5,K9="last-dial-failure",j9="last-dial-success",j_=500,G9=32,Y9=100,G_=50;class Z9 extends Wl{constructor(e={}){super({...e,sort:(t,r)=>t.options.priority>r.options.priority?-1:t.options.priority<r.options.priority?1:0})}}function X9(n){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(n)||/^::1$/.test(n)}function ax(n){if(!H_(n))return!1;const{address:e}=n.nodeAddress();return X9(e)}function Q9(n,e){const t=mm.exactMatch(n.multiaddr),r=mm.exactMatch(e.multiaddr);if(t&&!r)return-1;if(!t&&r)return 1;const o=bm.exactMatch(n.multiaddr),l=bm.exactMatch(e.multiaddr);if(o&&!l)return-1;if(!o&&l)return 1;const u=Ff.exactMatch(n.multiaddr),f=Ff.exactMatch(e.multiaddr);if(u&&!f)return-1;if(!u&&f)return 1;const h=LE.exactMatch(n.multiaddr),p=LE.exactMatch(e.multiaddr);if(h&&!p)return-1;if(!h&&p)return 1;const m=IE.exactMatch(n.multiaddr),y=IE.exactMatch(e.multiaddr);if(m&&!y)return-1;if(!m&&y)return 1;const b=OE.exactMatch(n.multiaddr),E=OE.exactMatch(e.multiaddr);return b&&!E?-1:!b&&E?1:0}function J9(n,e){const t=ax(n.multiaddr),r=ax(e.multiaddr);return t&&!r?1:!t&&r?-1:0}function W9(n,e){const t=Qf(n.multiaddr),r=Qf(e.multiaddr);return t&&!r?1:!t&&r?-1:0}function eP(n,e){return n.isCertified&&!e.isCertified?-1:!n.isCertified&&e.isCertified?1:0}function tP(n,e){const t=wm.exactMatch(n.multiaddr),r=wm.exactMatch(e.multiaddr);return t&&!r?1:!t&&r?-1:0}function nP(n){return n.sort(Q9).sort(eP).sort(tP).sort(W9).sort(J9)}async function Y_(n,e,t){const r=t.depth??0;if(r>(t.maxRecursiveDepth??G9))throw new E9("Max recursive depth reached");let o=!1;const l=[];for(const u of Object.values(e))if(u.canResolve(n)){o=!0;const f=await u.resolve(n,t);for(const h of f)l.push(...await Y_(h,e,{...t,depth:r+1}))}return o===!1&&l.push(n),l}const Ol={maxParallelDials:G_,maxDialQueueLength:j_,maxPeerAddrsToDial:K_,dialTimeout:F_,resolvers:{dnsaddr:Yy}};class rP{queue;components;addressSorter;maxPeerAddrsToDial;maxDialQueueLength;dialTimeout;shutDownController;connections;log;resolvers;constructor(e,t={}){this.addressSorter=t.addressSorter,this.maxPeerAddrsToDial=t.maxPeerAddrsToDial??Ol.maxPeerAddrsToDial,this.maxDialQueueLength=t.maxDialQueueLength??Ol.maxDialQueueLength,this.dialTimeout=t.dialTimeout??Ol.dialTimeout,this.connections=t.connections??new Ec,this.log=e.logger.forComponent("libp2p:connection-manager:dial-queue"),this.components=e,this.resolvers=t.resolvers??Ol.resolvers,this.shutDownController=new AbortController,this.shutDownController.signal,this.queue=new Z9({concurrency:t.maxParallelDials??Ol.maxParallelDials,metricName:"libp2p_dial_queue",metrics:e.metrics}),this.queue.addEventListener("failure",r=>{r.detail?.error.name!==ea.name&&this.log.error("error in dial queue - %e",r.detail)})}start(){this.shutDownController=new AbortController,this.shutDownController.signal}stop(){this.shutDownController.abort(),this.queue.abort()}async dial(e,t={}){const{peerId:r,multiaddrs:o}=q_(e),l=Array.from(this.connections.values()).flat().find(f=>t.force===!0||f.limits!=null?!1:f.remotePeer.equals(r)?!0:o.find(h=>h.equals(f.remoteAddr)));if(l?.status==="open")return this.log("already connected to %a",l.remoteAddr),t.onProgress?.(new Le("dial-queue:already-connected")),l;const u=this.queue.queue.find(f=>{if(r?.equals(f.options.peerId)===!0)return!0;const h=f.options.multiaddrs;if(h==null)return!1;for(const p of o)if(h.has(p.toString()))return!0;return!1});if(u!=null){this.log("joining existing dial target for %p",r);for(const f of o)u.options.multiaddrs.add(f.toString());return t.onProgress?.(new Le("dial-queue:already-in-dial-queue")),u.join(t)}if(this.queue.size>=this.maxDialQueueLength)throw new Zg("Dial queue is full");return this.log("creating dial target for %p",r,o.map(f=>f.toString())),t.onProgress?.(new Le("dial-queue:add-to-dial-queue")),this.queue.add(async f=>{f.onProgress?.(new Le("dial-queue:start-dial"));const h=Nt([this.shutDownController.signal,f.signal]);try{return await this.dialPeer(f,h)}finally{h.clear()}},{peerId:r,priority:t.priority??Z_,multiaddrs:new Set(o.map(f=>f.toString())),signal:t.signal??AbortSignal.timeout(this.dialTimeout),onProgress:t.onProgress})}async dialPeer(e,t){const r=e.peerId,o=e.multiaddrs,l=new Set;let u=e.multiaddrs.size===0,f=0,h=0;const p=[];for(this.log("starting dial to %p",r);u||o.size>0;){h++,u=!1;const m=[],y=new Set(e.multiaddrs);o.clear(),this.log("calculating addrs to dial %p from %s",r,[...y]);const b=await this.calculateMultiaddrs(r,y,{...e,signal:t});for(const E of b){if(l.has(E.multiaddr.toString())){this.log.trace("skipping previously failed multiaddr %a while dialing %p",E.multiaddr,r);continue}m.push(E)}this.log("%s dial to %p with %s",h===1?"starting":"continuing",r,m.map(E=>E.multiaddr.toString())),e?.onProgress?.(new Le("dial-queue:calculated-addresses",m));for(const E of m){if(f===this.maxPeerAddrsToDial)throw this.log("dialed maxPeerAddrsToDial (%d) addresses for %p, not trying any others",f,e.peerId),new Zg("Peer had more than maxPeerAddrsToDial");f++;try{const x=await this.components.transportManager.dial(E.multiaddr,{...e,signal:t});this.log("dial to %a succeeded",E.multiaddr);try{await this.components.peerStore.merge(x.remotePeer,{multiaddrs:[x.remoteAddr],metadata:{[j9]:de(Date.now().toString())}})}catch(k){this.log.error("could not update last dial failure key for %p",r,k)}return x}catch(x){if(this.log.error("dial failed to %a",E.multiaddr,x),l.add(E.multiaddr.toString()),r!=null)try{await this.components.peerStore.merge(r,{metadata:{[K9]:de(Date.now().toString())}})}catch(k){this.log.error("could not update last dial failure key for %p",r,k)}if(t.aborted)throw new a8(x.message);p.push(x)}}}throw p.length===1?p[0]:new AggregateError(p,"All multiaddr dials failed")}async calculateMultiaddrs(e,t=new Set,r={}){const o=[...t].map(y=>({multiaddr:lt(y),isCertified:!1}));if(e!=null){if(this.components.peerId.equals(e))throw new Zg("Tried to dial self");if(await this.components.connectionGater.denyDialPeer?.(e)===!0)throw new sx("The dial request is blocked by gater.allowDialPeer");if(o.length===0){this.log("loading multiaddrs for %p",e);try{const y=await this.components.peerStore.get(e);o.push(...y.addresses),this.log("loaded multiaddrs for %p",e,o.map(({multiaddr:b})=>b.toString()))}catch(y){if(y.name!=="NotFoundError")throw y}}if(o.length===0){this.log("looking up multiaddrs for %p in the peer routing",e);try{const y=await this.components.peerRouting.findPeer(e,r);this.log("found multiaddrs for %p in the peer routing",e,o.map(({multiaddr:b})=>b.toString())),o.push(...y.multiaddrs.map(b=>({multiaddr:b,isCertified:!1})))}catch(y){y.name==="NoPeerRoutersError"?this.log("no peer routers configured",e):this.log.error("looking up multiaddrs for %p in the peer routing failed - %e",e,y)}}}let l=(await Promise.all(o.map(async y=>{const b=await Y_(y.multiaddr,this.resolvers,{dns:this.components.dns,log:this.log,...r});return b.length===1&&b[0].equals(y.multiaddr)?y:b.map(E=>({multiaddr:E,isCertified:!1}))}))).flat();if(e!=null){const y=`/p2p/${e.toString()}`;l=l.map(b=>b.multiaddr.getComponents().pop()?.name!=="p2p"?{multiaddr:b.multiaddr.encapsulate(y),isCertified:b.isCertified}:b)}const u=l.filter(y=>{if(this.components.transportManager.dialTransportForMultiaddr(y.multiaddr)==null)return!1;const b=y.multiaddr.getPeerId();return e!=null&&b!=null?e.equals(b):!0}),f=new Map;for(const y of u){const b=y.multiaddr.toString(),E=f.get(b);if(E!=null){E.isCertified=E.isCertified||y.isCertified||!1;continue}f.set(b,y)}const h=[...f.values()];if(h.length===0)throw new y9("The dial request has no valid addresses");const p=[];for(const y of h)this.components.connectionGater.denyDialMultiaddr!=null&&await this.components.connectionGater.denyDialMultiaddr(y.multiaddr)||p.push(y);const m=this.addressSorter==null?nP(p):p.sort(this.addressSorter);if(m.length===0)throw new sx("The connection gater denied all addresses in the dial request");return this.log.trace("addresses for %p before filtering",e??"unknown peer",l.map(({multiaddr:y})=>y.toString())),this.log.trace("addresses for %p after filtering",e??"unknown peer",m.map(({multiaddr:y})=>y.toString())),m}async isDialable(e,t={}){Array.isArray(e)||(e=[e]);try{const r=await this.calculateMultiaddrs(void 0,new Set(e.map(o=>o.toString())),t);return t.runOnLimitedConnection===!1?r.find(o=>!wm.matches(o.multiaddr))!=null:!0}catch(r){this.log.trace("error calculating if multiaddr(s) were dialable",r)}return!1}}var Tp={},kp,lx;function iP(){if(lx)return kp;lx=1;function n(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return kp=n,n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var o=this;return this._timer=setTimeout(function(){o._attempts++,o._operationTimeoutCb&&(o._timeout=setTimeout(function(){o._operationTimeoutCb(o._attempts)},o._operationTimeout),o._options.unref&&o._timeout.unref()),o._fn(o._attempts)},r),this._options.unref&&this._timer.unref(),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},n.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,o=0;o<this._errors.length;o++){var l=this._errors[o],u=l.message,f=(e[u]||0)+1;e[u]=f,f>=r&&(t=l,r=f)}return t},kp}var cx;function sP(){return cx||(cx=1,(function(n){var e=iP();n.operation=function(t){var r=n.timeouts(t);return new e(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},n.timeouts=function(t){if(t instanceof Array)return[].concat(t);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var o in t)r[o]=t[o];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var l=[],u=0;u<r.retries;u++)l.push(this.createTimeout(u,r));return t&&t.forever&&!l.length&&l.push(this.createTimeout(u,r)),l.sort(function(f,h){return f-h}),l},n.createTimeout=function(t,r){var o=r.randomize?Math.random()+1:1,l=Math.round(o*Math.max(r.minTimeout,1)*Math.pow(r.factor,t));return l=Math.min(l,r.maxTimeout),l},n.wrap=function(t,r,o){if(r instanceof Array&&(o=r,r=null),!o){o=[];for(var l in t)typeof t[l]=="function"&&o.push(l)}for(var u=0;u<o.length;u++){var f=o[u],h=t[f];t[f]=(function(m){var y=n.operation(r),b=Array.prototype.slice.call(arguments,1),E=b.pop();b.push(function(x){y.retry(x)||(x&&(arguments[0]=y.mainError()),E.apply(this,arguments))}),y.attempt(function(){m.apply(t,b)})}).bind(t,h),t[f].options=r}}})(Tp)),Tp}var Cp,ux;function oP(){return ux||(ux=1,Cp=sP()),Cp}var aP=oP();const lP=ha(aP),cP=Object.prototype.toString,uP=n=>cP.call(n)==="[object Error]",fP=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function dP(n){return n&&uP(n)&&n.name==="TypeError"&&typeof n.message=="string"?n.message==="Load failed"?n.stack===void 0:fP.has(n.message):!1}class hP extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const fx=(n,e,t)=>{const r=t.retries-(e-1);return n.attemptNumber=e,n.retriesLeft=r,n};async function gP(n,e){return new Promise((t,r)=>{e={...e},e.onFailedAttempt??=()=>{},e.shouldRetry??=()=>!0,e.retries??=10;const o=lP.operation(e),l=()=>{o.stop(),r(e.signal?.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",l,{once:!0});const u=()=>{e.signal?.removeEventListener("abort",l),o.stop()};o.attempt(async f=>{try{const h=await n(f);u(),t(h)}catch(h){try{if(!(h instanceof Error))throw new TypeError(`Non-error was thrown: "${h}". You should only throw errors.`);if(h instanceof hP)throw h.originalError;if(h instanceof TypeError&&!dP(h))throw h;if(fx(h,f,e),await e.shouldRetry(h)||(o.stop(),r(h)),await e.onFailedAttempt(h),!o.retry(h))throw o.mainError()}catch(p){fx(p,f,e),u(),r(p)}}})})}class pP{log;queue;started;peerStore;retries;retryInterval;backoffFactor;connectionManager;events;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:reconnect-queue"),this.peerStore=e.peerStore,this.connectionManager=e.connectionManager,this.queue=new E2({concurrency:t.maxParallelReconnects??F9,metricName:"libp2p_reconnect_queue",metrics:e.metrics}),this.started=!1,this.retries=t.retries??5,this.backoffFactor=t.backoffFactor,this.retryInterval=t.retryInterval,this.events=e.events,e.events.addEventListener("peer:disconnect",r=>{this.maybeReconnect(r.detail).catch(o=>{this.log.error("failed to maybe reconnect to %p - %e",r.detail,o)})})}async maybeReconnect(e){if(!this.started)return;const t=await this.peerStore.get(e);dx(t)&&(this.queue.has(e)||this.queue.add(async r=>{await gP(async o=>{if(this.started)try{await this.connectionManager.openConnection(e,{signal:r?.signal})}catch(l){throw this.log("reconnecting to %p attempt %d of %d failed - %e",e,o,this.retries,l),l}},{signal:r?.signal,retries:this.retries,factor:this.backoffFactor,minTimeout:this.retryInterval})},{peerId:e}).catch(async r=>{this.log.error("failed to reconnect to %p - %e",e,r);const o={};[...t.tags.keys()].forEach(l=>{l.startsWith(h2)&&(o[l]=void 0)}),await this.peerStore.merge(e,{tags:o}),this.events.safeDispatchEvent("peer:reconnect-failure",{detail:e})}).catch(async r=>{this.log.error("failed to remove keep-alive tag from %p - %e",e,r)}))}start(){this.started=!0}async afterStart(){Promise.resolve().then(async()=>{const e=await this.peerStore.all({filters:[t=>dx(t)]});await Promise.all(e.map(async t=>{await this.connectionManager.openConnection(t.id).catch(r=>{this.log.error(r)})}))}).catch(e=>{this.log.error(e)})}stop(){this.started=!1,this.queue.abort()}}function dx(n){for(const e of n.tags.keys())if(e.startsWith(h2))return!0;return!1}const Z_=50,Np={maxConnections:Y9,inboundConnectionThreshold:H9,maxIncomingPendingConnections:q9};class mP{started;connections;allow;deny;maxIncomingPendingConnections;incomingPendingConnections;outboundPendingConnections;maxConnections;dialQueue;reconnectQueue;connectionPruner;inboundConnectionRateLimiter;peerStore;metrics;events;log;peerId;constructor(e,t={}){if(this.maxConnections=t.maxConnections??Np.maxConnections,this.maxConnections<1)throw new ge("Connection Manager maxConnections must be greater than 0");this.connections=new Ec,this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.metrics=e.metrics,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager"),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.allow=(t.allow??[]).map(r=>_m(r)),this.deny=(t.deny??[]).map(r=>_m(r)),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=t.maxIncomingPendingConnections??Np.maxIncomingPendingConnections,this.outboundPendingConnections=0,this.inboundConnectionRateLimiter=new L9({points:t.inboundConnectionThreshold??Np.inboundConnectionThreshold,duration:1}),this.connectionPruner=new V9({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{allow:t.allow?.map(r=>lt(r))}),this.dialQueue=new rP(e,{addressSorter:t.addressSorter,maxParallelDials:t.maxParallelDials??G_,maxDialQueueLength:t.maxDialQueueLength??j_,maxPeerAddrsToDial:t.maxPeerAddrsToDial??K_,dialTimeout:t.dialTimeout??F_,resolvers:t.resolvers??{dnsaddr:Yy},connections:this.connections}),this.reconnectQueue=new pP({events:e.events,peerStore:e.peerStore,logger:e.logger,connectionManager:this},{retries:t.reconnectRetries,retryInterval:t.reconnectRetryInterval,backoffFactor:t.reconnectBackoffFactor,maxParallelReconnects:t.maxParallelReconnects})}[Symbol.toStringTag]="@libp2p/connection-manager";async start(){this.metrics?.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,"inbound pending":this.incomingPendingConnections,outbound:0,"outbound pending":this.outboundPendingConnections};for(const t of this.connections.values())for(const r of t)e[r.direction]++;return e}}),this.metrics?.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const t of this.connections.values())for(const r of t)for(const o of r.streams){const l=`${o.direction} ${o.protocol??"unnegotiated"}`;e[l]=(e[l]??0)+1}return e}}),this.metrics?.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const r of this.connections.values())for(const o of r){const l={};for(const u of o.streams){const f=`${u.direction} ${u.protocol??"unnegotiated"}`;l[f]=(l[f]??0)+1}for(const[u,f]of Object.entries(l))e[u]=e[u]??[],e[u].push(f)}const t={};for(let[r,o]of Object.entries(e)){o=o.sort((u,f)=>u-f);const l=Math.floor(o.length*.9);t[r]=o[l]}return t}}),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),await hc(this.dialQueue,this.reconnectQueue,this.connectionPruner),this.started=!0,this.log("started")}async stop(){this.events.removeEventListener("connection:open",this.onConnect),this.events.removeEventListener("connection:close",this.onDisconnect),await gc(this.reconnectQueue,this.dialQueue,this.connectionPruner);const e=[];for(const t of this.connections.values())for(const r of t)e.push((async()=>{try{await r.close()}catch(o){this.log.error(o)}})());this.log("closing %d connections",e.length),await Promise.all(e),this.connections.clear(),this.log("stopped")}getMaxConnections(){return this.maxConnections}setMaxConnections(e){if(this.maxConnections<1)throw new ge("Connection Manager maxConnections must be greater than 0");let t=!1;e<this.maxConnections&&(t=!0),this.maxConnections=e,t&&this.connectionPruner.maybePruneConnections()}onConnect(e){this._onConnect(e).catch(t=>{this.log.error(t)})}async _onConnect(e){const{detail:t}=e;if(!this.started){await t.close();return}if(t.status!=="open")return;const r=t.remotePeer,o=!this.connections.has(r),l=this.connections.get(r)??[];l.push(t),this.connections.set(r,l),r.publicKey!=null&&r.type==="RSA"&&await this.peerStore.patch(r,{publicKey:r.publicKey}),o&&this.events.safeDispatchEvent("peer:connect",{detail:t.remotePeer})}onDisconnect(e){const{detail:t}=e,r=t.remotePeer,l=(this.connections.get(r)??[]).filter(u=>u.id!==t.id);this.connections.set(r,l),l.length===0&&(this.log.trace("peer %p disconnected, removing connection map entry",r),this.connections.delete(r),this.events.safeDispatchEvent("peer:disconnect",{detail:t.remotePeer}))}getConnections(e){if(e!=null)return this.connections.get(e)??[];let t=[];for(const r of this.connections.values())t=t.concat(r);return t}getConnectionsMap(){return this.connections}async openConnection(e,t={}){if(!this.started)throw new Ef("Not started");this.outboundPendingConnections++;try{t.signal?.throwIfAborted();const{peerId:r}=q_(e);if(this.peerId.equals(r))throw new y2("Can not dial self");if(r!=null&&t.force!==!0){this.log("dial %p",r);const f=this.getConnections(r).find(h=>h.limits==null);if(f!=null)return this.log("had an existing non-limited connection to %p as %a",r,f.remoteAddr),t.onProgress?.(new Le("dial-queue:already-connected")),f}const o=await this.dialQueue.dial(e,{...t,priority:t.priority??Z_});if(o.status!=="open")throw new m2("Remote closed connection during opening");let l=this.connections.get(o.remotePeer);l==null&&(l=[],this.connections.set(o.remotePeer,l));let u=!1;for(const f of l)if(f.id===o.id&&(u=!0),t.force!==!0&&f.id!==o.id&&f.remoteAddr.equals(o.remoteAddr))return o.abort(new Km("Duplicate multiaddr connection")),f;return u||l.push(o),o}finally{this.outboundPendingConnections--}}async closeConnections(e,t={}){const r=this.connections.get(e)??[];await Promise.all(r.map(async o=>{try{await o.close(t)}catch(l){o.abort(l)}}))}async acceptIncomingConnection(e){if(this.deny.some(o=>o.contains(e.remoteAddr.nodeAddress().address)))return this.log("connection from %a refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some(o=>o.contains(e.remoteAddr.nodeAddress().address)))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return this.log("connection from %a refused - incomingPendingConnections exceeded by host",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const o=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(o,1)}catch{return this.log("connection from %a refused - inboundConnectionThreshold exceeded by host %s",e.remoteAddr,o),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):(this.log("connection from %a refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){const e={queued:"queued",running:"active",errored:"error",complete:"success"};return this.dialQueue.queue.queue.map(t=>({id:t.id,status:e[t.status],peerId:t.options.peerId,multiaddrs:[...t.options.multiaddrs].map(r=>lt(r))}))}async isDialable(e,t={}){return this.dialQueue.isDialable(e,t)}}class Bp{movingAverage;variance;deviation;forecast;timeSpan;previousTime;constructor(e){this.timeSpan=e,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(e,t){return 1-Math.exp(-(e-t)/this.timeSpan)}push(e,t=Date.now()){if(this.previousTime!=null){const r=this.alpha(t,this.previousTime),o=e-this.movingAverage,l=r*o;this.movingAverage=r*e+(1-r)*this.movingAverage,this.variance=(1-r)*(this.variance+o*l),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+r*o}else this.movingAverage=e;this.previousTime=t}}const yP=1.2,bP=2,wP=5e3,vP=6e4,EP=5e3;class xP{success;failure;next;metric;timeoutMultiplier;failureMultiplier;minTimeout;maxTimeout;constructor(e={}){const t=e.interval??EP;this.success=new Bp(t),this.failure=new Bp(t),this.next=new Bp(t),this.failureMultiplier=e.failureMultiplier??bP,this.timeoutMultiplier=e.timeoutMultiplier??yP,this.minTimeout=e.minTimeout??wP,this.maxTimeout=e.maxTimeout??vP,e.metricName!=null&&(this.metric=e.metrics?.registerMetricGroup(e.metricName))}getTimeoutSignal(e={}){let t=Math.round(this.next.movingAverage*(e.timeoutFactor??this.timeoutMultiplier));t<this.minTimeout&&(t=this.minTimeout),t>this.maxTimeout&&(t=this.maxTimeout);const r=AbortSignal.timeout(t),o=Nt([e.signal,r]);return o.start=Date.now(),o.timeout=t,o}cleanUp(e){const t=Date.now()-e.start;e.aborted?(this.failure.push(t),this.next.push(t*this.failureMultiplier),this.metric?.update({failureMovingAverage:this.failure.movingAverage,failureDeviation:this.failure.deviation,failureForecast:this.failure.forecast,failureVariance:this.failure.variance,failure:t})):(this.success.push(t),this.next.push(t),this.metric?.update({successMovingAverage:this.success.movingAverage,successDeviation:this.success.deviation,successForecast:this.success.forecast,successVariance:this.success.variance,success:t}))}}class SP extends Error{name="UnexpectedEOFError";code="ERR_UNEXPECTED_EOF"}function X_(n,e){const t=k2();n.sink(t).catch(async u=>{await t.end(u)}),n.sink=async u=>{for await(const f of u)await t.push(f);await t.end()};let r=n.source;n.source[Symbol.iterator]!=null?r=n.source[Symbol.iterator]():n.source[Symbol.asyncIterator]!=null&&(r=n.source[Symbol.asyncIterator]());const o=new rt;return{read:async u=>{if(u?.signal?.throwIfAborted(),u?.bytes==null){const{done:h,value:p}=await lr(r.next(),u?.signal);return h===!0?null:p}for(;o.byteLength<u.bytes;){const{value:h,done:p}=await lr(r.next(),u?.signal);if(p===!0)throw new SP("unexpected end of input");o.append(h)}const f=o.sublist(0,u.bytes);return o.consume(u.bytes),f},write:async(u,f)=>{f?.signal?.throwIfAborted(),u instanceof Uint8Array?await t.push(u,f):await t.push(u.subarray(),f)},unwrap:()=>{if(o.byteLength>0){const u=n.source;n.source=(async function*(){e?.yieldBytes===!1?yield o:yield*o,yield*u})()}return n}}}const AP=1e4,_P="1.0.0",TP="ping",kP="ipfs",hx=32,CP=!0;class NP{protocol;components;log;heartbeatInterval;pingIntervalMs;abortController;timeout;abortConnectionOnPingFailure;constructor(e,t={}){this.components=e,this.protocol=`/${t.protocolPrefix??kP}/${TP}/${_P}`,this.log=e.logger.forComponent("libp2p:connection-monitor"),this.pingIntervalMs=t.pingInterval??AP,this.abortConnectionOnPingFailure=t.abortConnectionOnPingFailure??CP,this.timeout=new xP({...t.pingTimeout??{},metrics:e.metrics,metricName:"libp2p_connection_monitor_ping_time_milliseconds"})}[Symbol.toStringTag]="@libp2p/connection-monitor";[xf]=["@libp2p/connection-monitor"];start(){this.abortController=new AbortController,this.abortController.signal,this.heartbeatInterval=setInterval(()=>{this.components.connectionManager.getConnections().forEach(e=>{Promise.resolve().then(async()=>{let t=Date.now();try{const r=this.timeout.getTimeoutSignal({signal:this.abortController?.signal}),o=await e.newStream(this.protocol,{signal:r,runOnLimitedConnection:!0}),l=X_(o);t=Date.now(),await Promise.all([l.write(nc(hx),{signal:r}),l.read({bytes:hx,signal:r})]),e.rtt=Date.now()-t,await l.unwrap().close({signal:r})}catch(r){if(r.name!=="UnsupportedProtocolError")throw r;e.rtt=(Date.now()-t)/2}}).catch(t=>{this.log.error("error during heartbeat",t),this.abortConnectionOnPingFailure?(this.log.error("aborting connection due to ping failure"),e.abort(t)):this.log("connection ping failed, but not aborting due to abortConnectionOnPingFailure flag")})})},this.pingIntervalMs)}stop(){this.abortController?.abort(),this.heartbeatInterval!=null&&clearInterval(this.heartbeatInterval)}}class BP{routers;started;components;constructor(e,t){this.routers=t.routers??[],this.started=!1,this.components=e,this.findProviders=e.metrics?.traceFunction("libp2p.contentRouting.findProviders",this.findProviders.bind(this),{optionsIndex:1,getAttributesFromArgs:([r],o)=>({...o,cid:r.toString()}),getAttributesFromYieldedValue:(r,o)=>({...o,providers:[...Array.isArray(o.providers)?o.providers:[],r.id.toString()]})})??this.findProviders,this.provide=e.metrics?.traceFunction("libp2p.contentRouting.provide",this.provide.bind(this),{optionsIndex:1,getAttributesFromArgs:([r],o)=>({...o,cid:r.toString()})})??this.provide,this.cancelReprovide=e.metrics?.traceFunction("libp2p.contentRouting.cancelReprovide",this.cancelReprovide.bind(this),{optionsIndex:1,getAttributesFromArgs:([r],o)=>({...o,cid:r.toString()})})??this.cancelReprovide,this.put=e.metrics?.traceFunction("libp2p.contentRouting.put",this.put.bind(this),{optionsIndex:2,getAttributesFromArgs:([r])=>({key:Ee(r,"base36")})})??this.put,this.get=e.metrics?.traceFunction("libp2p.contentRouting.get",this.get.bind(this),{optionsIndex:1,getAttributesFromArgs:([r])=>({key:Ee(r,"base36")})})??this.get}[Symbol.toStringTag]="@libp2p/content-routing";isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,t={}){if(this.routers.length===0)throw new _p("No content routers available");const r=this,o=new Go;for await(const l of Vo(...r.routers.filter(u=>u.findProviders instanceof Function).map(u=>u.findProviders(e,t))))l!=null&&(l.multiaddrs.length>0&&await this.components.peerStore.merge(l.id,{multiaddrs:l.multiaddrs},t),!o.has(l.id)&&(o.add(l.id),yield l))}async provide(e,t={}){if(this.routers.length===0)throw new _p("No content routers available");await Promise.all(this.routers.filter(r=>r.provide instanceof Function).map(async r=>{await r.provide(e,t)}))}async cancelReprovide(e,t={}){if(this.routers.length===0)throw new _p("No content routers available");await Promise.all(this.routers.filter(r=>r.cancelReprovide instanceof Function).map(async r=>{await r.cancelReprovide(e,t)}))}async put(e,t,r){if(!this.isStarted())throw new Ef;await Promise.all(this.routers.filter(o=>o.put instanceof Function).map(async o=>{await o.put(e,t,r)}))}async get(e,t){if(!this.isStarted())throw new Ef;return Promise.any(this.routers.filter(r=>r.get instanceof Function).map(async r=>r.get(e,t)))}}const df=globalThis.CustomEvent??Event;async function*DP(n,e={}){let t=e.concurrency??1/0;t<1&&(t=1/0);const r=e.ordered??!1,o=new EventTarget,l=[];let u=We(),f=We(),h=!1,p,m=!1;o.addEventListener("task-complete",()=>{f.resolve()}),Promise.resolve().then(async()=>{try{for await(const x of n){if(l.length===t&&(u=We(),await u.promise),m)break;const k={done:!1};l.push(k),x().then(_=>{k.done=!0,k.ok=!0,k.value=_,o.dispatchEvent(new df("task-complete"))},_=>{k.done=!0,k.err=_,o.dispatchEvent(new df("task-complete"))})}h=!0,o.dispatchEvent(new df("task-complete"))}catch(x){p=x,o.dispatchEvent(new df("task-complete"))}});function y(){return r?l[0]?.done:!!l.find(x=>x.done)}function*b(){for(;l.length>0&&l[0].done;){const x=l[0];if(l.shift(),x.ok)yield x.value;else throw m=!0,u.resolve(),x.err;u.resolve()}}function*E(){for(;y();)for(let x=0;x<l.length;x++)if(l[x].done){const k=l[x];if(l.splice(x,1),x--,k.ok)yield k.value;else throw m=!0,u.resolve(),k.err;u.resolve()}}for(;;){if(y()||(f=We(),await f.promise),p!=null||(r?yield*b():yield*E(),p!=null))throw p;if(h&&l.length===0)break}}class RP{log;peerId;peerStore;routers;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:peer-routing"),this.peerId=e.peerId,this.peerStore=e.peerStore,this.routers=t.routers??[],this.findPeer=e.metrics?.traceFunction("libp2p.peerRouting.findPeer",this.findPeer.bind(this),{optionsIndex:1,getAttributesFromArgs:([r],o)=>({...o,peer:r.toString()})})??this.findPeer,this.getClosestPeers=e.metrics?.traceFunction("libp2p.peerRouting.getClosestPeers",this.getClosestPeers.bind(this),{optionsIndex:1,getAttributesFromArgs:([r],o)=>({...o,key:Ee(r,"base36")}),getAttributesFromYieldedValue:(r,o)=>({...o,peers:[...Array.isArray(o.peers)?o.peers:[],r.id.toString()]})})??this.getClosestPeers}[Symbol.toStringTag]="@libp2p/peer-routing";async findPeer(e,t){if(this.routers.length===0)throw new ix("No peer routers available");if(e.toString()===this.peerId.toString())throw new d9("Should not try to find self");const r=this,o=Vo(...this.routers.filter(l=>l.findPeer instanceof Function).map(l=>(async function*(){try{yield await l.findPeer(e,t)}catch(u){r.log.error(u)}})()));for await(const l of o)if(l!=null)return l.multiaddrs.length>0&&await this.peerStore.merge(l.id,{multiaddrs:l.multiaddrs},t),l;throw new Kn}async*getClosestPeers(e,t={}){if(this.routers.length===0)throw new ix("No peer routers available");const r=this,o=Sy(1024);for await(const l of DP((async function*(){const u=Vo(...r.routers.filter(f=>f.getClosestPeers instanceof Function).map(f=>f.getClosestPeers(e,t)));for await(let f of u)yield async()=>{if(f.multiaddrs.length===0)try{f=await r.findPeer(f.id,{...t,useCache:!1})}catch(h){r.log.error("could not find peer multiaddrs",h);return}return f}})()))l!=null&&(l.multiaddrs.length>0&&await this.peerStore.merge(l.id,{multiaddrs:l.multiaddrs},t),!o.has(l.id.toMultihash().bytes)&&(o.add(l.id.toMultihash().bytes),yield l))}}class MP extends Ss{peerRouting;log;walking;walkers;shutdownController;walkController;needNext;constructor(e){super(),this.log=e.logger.forComponent("libp2p:random-walk"),this.peerRouting=e.peerRouting,this.walkers=0,this.walking=!1,this.shutdownController=new AbortController,this.shutdownController.signal}[Symbol.toStringTag]="@libp2p/random-walk";start(){this.shutdownController=new AbortController,this.shutdownController.signal}stop(){this.shutdownController.abort()}async*walk(e){this.walking||this.startWalk(),this.walkers++;const t=Nt([this.shutdownController.signal,e?.signal]);try{for(;;)this.needNext?.resolve(),this.needNext=We(),yield(await ws(this,"walk:peer",t,{errorEvent:"walk:error"})).detail}finally{t.clear(),this.walkers--,this.walkers===0&&(this.walkController?.abort(),this.walkController=void 0)}}startWalk(){this.walking=!0,this.walkController=new AbortController,this.walkController.signal;const e=Nt([this.walkController.signal,this.shutdownController.signal]),t=Date.now();let r=0;Promise.resolve().then(async()=>{for(this.log("start walk");this.walkers>0;)try{const o=nc(32);let l=Date.now();for await(const u of this.peerRouting.getClosestPeers(o,{signal:e}))e.aborted&&this.log("aborting walk"),e.throwIfAborted(),this.log("found peer %p after %dms for %d walkers",u.id,Date.now()-l,this.walkers),r++,this.safeDispatchEvent("walk:peer",{detail:u}),this.walkers===1&&this.needNext!=null&&(this.log("wait for need next"),await lr(this.needNext.promise,e)),l=Date.now();this.log("walk iteration for %b and %d walkers finished, found %d peers",o,this.walkers,r)}catch(o){this.log.error("random walk errored",o),this.safeDispatchEvent("walk:error",{detail:o})}this.log("no walkers left, ended walk")}).catch(o=>{this.log.error("random walk errored",o)}).finally(()=>{this.log("finished walk, found %d peers after %dms",r,Date.now()-t),this.walking=!1})}}const Q_=32,J_=64;class IP{log;topologies;handlers;components;constructor(e){this.components=e,this.log=e.logger.forComponent("libp2p:registrar"),this.topologies=new Map,e.metrics?.registerMetricGroup("libp2p_registrar_topologies",{calculate:()=>{const t={};for(const[r,o]of this.topologies)t[r]=o.size;return t}}),this.handlers=qr({name:"libp2p_registrar_protocol_handlers",metrics:e.metrics}),this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onPeerIdentify=this._onPeerIdentify.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate),this.components.events.addEventListener("peer:identify",this._onPeerIdentify)}[Symbol.toStringTag]="@libp2p/registrar";getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(t==null)throw new h9(`No handler registered for protocol ${e}`);return t}getTopologies(e){const t=this.topologies.get(e);return t==null?[]:[...t.values()]}async handle(e,t,r){if(this.handlers.has(e)&&r?.force!==!0)throw new g9(`Handler already registered for protocol ${e}`);const o=Gy.bind({ignoreUndefined:!0})({maxInboundStreams:Q_,maxOutboundStreams:J_},r);this.handlers.set(e,{handler:t,options:o}),await this.components.peerStore.merge(this.components.peerId,{protocols:[e]},r)}async unhandle(e,t){(Array.isArray(e)?e:[e]).forEach(o=>{this.handlers.delete(o)}),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()},t)}async register(e,t){if(t==null)throw new ge("invalid topology");const r=`${(Math.random()*1e9).toString(36)}${Date.now()}`;let o=this.topologies.get(e);return o==null&&(o=new Map,this.topologies.set(e,o)),o.set(r,t),r}unregister(e){for(const[t,r]of this.topologies.entries())r.has(e)&&(r.delete(e),r.size===0&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail,r={signal:AbortSignal.timeout(5e3)};this.components.peerStore.get(t,r).then(o=>{for(const l of o.protocols){const u=this.topologies.get(l);if(u!=null)for(const f of u.values())f.filter?.has(t)!==!1&&(f.filter?.remove(t),f.onDisconnect?.(t))}}).catch(o=>{o.name!=="NotFoundError"&&this.log.error("could not inform topologies of disconnecting peer %p",t,o)})}_onPeerUpdate(e){const{peer:t,previous:r}=e.detail,o=(r?.protocols??[]).filter(l=>!t.protocols.includes(l));for(const l of o){const u=this.topologies.get(l);if(u!=null)for(const f of u.values())f.filter?.has(t.id)!==!1&&(f.filter?.remove(t.id),f.onDisconnect?.(t.id))}}_onPeerIdentify(e){const t=e.detail.protocols,r=e.detail.connection,o=e.detail.peerId;for(const l of t){const u=this.topologies.get(l);if(u!=null)for(const f of u.values())r.limits!=null&&f.notifyOnLimitedConnection!==!0||f.filter?.has(o)!==!0&&(f.filter?.add(o),f.onConnect?.(o,r))}}}class OP{log;components;transports;listeners;faultTolerance;started;constructor(e,t={}){this.log=e.logger.forComponent("libp2p:transports"),this.components=e,this.started=!1,this.transports=qr({name:"libp2p_transport_manager_transports",metrics:this.components.metrics}),this.listeners=qr({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=t.faultTolerance??Jl.FATAL_ALL}[Symbol.toStringTag]="@libp2p/transport-manager";add(e){const t=e[Symbol.toStringTag];if(t==null)throw new ge("Transport must have a valid tag");if(this.transports.has(t))throw new ge(`There is already a transport with the tag ${t}`);this.log("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){const e=this.components.addressManager.getListenAddrs();await this.listen(e)}async stop(){const e=[];for(const[t,r]of this.listeners)for(this.log("closing listeners for %s",t);r.length>0;){const o=r.pop();o!=null&&e.push(o.close())}await Promise.all(e),this.log("all listeners closed");for(const t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){const r=this.dialTransportForMultiaddr(e);if(r==null)throw new v9(`No transport available for address ${String(e)}`);return t?.onProgress?.(new Le("transport-manager:selected-transport",r[Symbol.toStringTag])),r.dial(e,{...t,upgrader:this.components.upgrader})}getAddrs(){let e=[];for(const t of this.listeners.values())for(const r of t)e=[...e,...r.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}dialTransportForMultiaddr(e){for(const t of this.transports.values())if(t.dialFilter([e]).length>0)return t}listenTransportForMultiaddr(e){for(const t of this.transports.values())if(t.listenFilter([e]).length>0)return t}async listen(e){if(!this.isStarted())throw new Ef("Not started");if(e==null||e.length===0){this.log("no addresses were provided for listening, this node is dial only");return}const t={errors:new Map,ipv4:{success:0,attempts:0},ipv6:{success:0,attempts:0}};e.forEach(l=>{t.errors.set(l.toString(),new p9)});const r=[];for(const[l,u]of this.transports.entries()){const f=u.listenFilter(e);for(const h of f){this.log("creating listener for %s on %a",l,h);const p=u.createListener({upgrader:this.components.upgrader});let m=this.listeners.get(l)??[];m==null&&(m=[],this.listeners.set(l,m)),m.push(p),p.addEventListener("listening",()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:p})}),p.addEventListener("close",()=>{const y=m.findIndex(b=>b===p);m.splice(y,1),this.components.events.safeDispatchEvent("transport:close",{detail:p})}),RE.matches(h)?t.ipv4.attempts++:ME.matches(h)&&t.ipv6.attempts++,r.push(p.listen(h).then(()=>{t.errors.delete(h.toString()),RE.matches(h)&&t.ipv4.success++,ME.matches(h)&&t.ipv6.success++},y=>{throw this.log.error("transport %s could not listen on address %a - %e",l,h,y),t.errors.set(h.toString(),y),y}))}}const o=await Promise.allSettled(r);if(!(o.length>0&&o.every(l=>l.status==="fulfilled"))){if(this.ipv6Unsupported(t)){this.log("all IPv4 addresses succeed but all IPv6 failed");return}if(this.faultTolerance===Jl.NO_FATAL){this.log("failed to listen on any address but fault tolerance allows this");return}throw new m9(`Some configured addresses failed to be listened on, you may need to remove one or more listen addresses from your configuration or set \`transportManager.faultTolerance\` to NO_FATAL:
${[...t.errors.entries()].map(([l,u])=>`
  ${l}: ${`${u.stack??u}`.split(`
`).join(`
  `)}
`).join("")}`)}}ipv6Unsupported(e){if(e.ipv4.attempts===0||e.ipv6.attempts===0)return!1;const t=e.ipv4.attempts===e.ipv4.success,r=e.ipv6.success===0;return t&&r}async remove(e){const t=this.listeners.get(e)??[];this.log.trace("removing transport %s",e);const r=[];for(this.log.trace("closing listeners for %s",e);t.length>0;){const o=t.pop();o!=null&&r.push(o.close())}await Promise.all(r),this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}const rn="/multistream/1.0.0",Zy=1024;class LP extends Error{name="InvalidMessageLengthError";code="ERR_INVALID_MSG_LENGTH"}class UP extends Error{name="InvalidDataLengthError";code="ERR_MSG_DATA_TOO_LONG"}class PP extends Error{name="InvalidDataLengthLengthError";code="ERR_MSG_LENGTH_TOO_LONG"}function Xy(n,e={}){const t=X_(n,e);e.maxDataLength!=null&&e.maxLengthLength==null&&(e.maxLengthLength=Xn(e.maxDataLength));const r=e?.lengthDecoder??Jm,o=e?.lengthEncoder??zo;return{read:async u=>{let f=-1;const h=new rt;for(;;){h.append(await t.read({...u,bytes:1}));try{f=r(h)}catch(p){if(p instanceof RangeError)continue;throw p}if(f<0)throw new LP("Invalid message length");if(e?.maxLengthLength!=null&&h.byteLength>e.maxLengthLength)throw new PP("message length length too long");if(f>-1)break}if(e?.maxDataLength!=null&&f>e.maxDataLength)throw new UP("message length too long");return t.read({...u,bytes:f})},write:async(u,f)=>{await t.write(new rt(o(u.byteLength),u),f)},writeV:async(u,f)=>{const h=new rt(...u.flatMap(p=>[o(p.byteLength),p]));await t.write(h,f)},unwrap:()=>t.unwrap()}}const zP=de(`
`);async function ql(n,e,t){await n.write(e,t)}async function VP(n,e,t){await n.writeV(e,t)}async function $P(n,e){const t=await n.read(e);if(t.byteLength===0||t.get(t.byteLength-1)!==zP[0])throw e.log.error("Invalid mss message - missing newline",t),new o8("Missing newline");return t.sublist(0,-1)}async function Jo(n,e){const t=await $P(n,e);return Ee(t.subarray())}async function Tm(n,e,t){if(e=Array.isArray(e)?[...e]:[e],e.length===1&&t.negotiateFully===!1)return HP(n,e[0],t);const r=Xy(n,{...t,maxDataLength:Zy}),o=e.shift();if(o==null)throw new Error("At least one protocol must be specified");t.log.trace('select: write ["%s", "%s"]',rn,o);const l=de(`${rn}
`),u=de(`${o}
`);await VP(r,[l,u],t),t.log.trace("select: reading multistream-select header");let f=await Jo(r,t);if(t.log.trace('select: read "%s"',f),f===rn&&(t.log.trace("select: reading protocol response"),f=await Jo(r,t),t.log.trace('select: read "%s"',f)),f===o)return{stream:r.unwrap(),protocol:o};for(const h of e){t.log.trace('select: write "%s"',h),await ql(r,de(`${h}
`),t),t.log.trace("select: reading protocol response");const p=await Jo(r,t);if(t.log.trace('select: read "%s" for "%s"',p,h),p===h)return{stream:r.unwrap(),protocol:h}}throw new b2("protocol selection failed")}function HP(n,e,t){const r=n.sink.bind(n),o=n.source;let l=!1,u=!1;const f=We();let h=!1,p=!1;const m=We();let y=!1,b=!1;const E=We(),x=Xy({sink:r,source:o},{...t,maxDataLength:Zy});n.sink=async j=>{const{sink:C}=x.unwrap();await C((async function*(){let Z=!1;for await(const Q of j){if(p&&await m.promise,h)yield Q;else{p=!0,t.log.trace('optimistic: write ["%s", "%s", data(%d)] in sink',rn,e,Q.byteLength);const re=`${e}
`;yield new rt(Uint8Array.from([19]),de(`${rn}
`),zo(re.length),de(re),Q).subarray(),t.log.trace('optimistic: wrote ["%s", "%s", data(%d)] in sink',rn,e,Q.byteLength),h=!0,p=!1,m.resolve(),k().catch(oe=>{t.log.error("could not finish optimistic protocol negotiation of %s",e,oe)})}Z=!0}Z||await k()})())};async function k(){if(u){t.log.trace("optimistic: already negotiating %s stream",e),await f.promise;return}u=!0;try{h||(t.log.trace("optimistic: doing send protocol for %s stream",e),await _()),y||(t.log.trace("optimistic: doing read protocol for %s stream",e),await R())}finally{u=!1,l=!0,f.resolve()}}async function _(){if(p){await m.promise;return}p=!0;try{t.log.trace('optimistic: write ["%s", "%s", data] in source',rn,e),await x.writeV([de(`${rn}
`),de(`${e}
`)]),t.log.trace('optimistic: wrote ["%s", "%s", data] in source',rn,e)}finally{h=!0,p=!1,m.resolve()}}async function R(){if(b){await E.promise;return}b=!0;try{t.log.trace("optimistic: reading multistream select header");let j=await Jo(x,t);if(t.log.trace('optimistic: read multistream select header "%s"',j),j===rn&&(j=await Jo(x,t)),t.log.trace('optimistic: read protocol "%s", expecting "%s"',j,e),j!==e)throw new b2("protocol selection failed")}finally{y=!0,b=!1,E.resolve()}}if(n.source=(async function*(){await k(),t.log.trace('optimistic: reading data from "%s" stream',e),yield*x.unwrap().source})(),n.closeRead!=null){const j=n.closeRead.bind(n);n.closeRead=async C=>{l||await k().catch(Z=>{t.log.error("could not negotiate protocol before close read",Z)}),await j(C)}}if(n.closeWrite!=null){const j=n.closeWrite.bind(n);n.closeWrite=async C=>{l||await k().catch(Z=>{t.log.error("could not negotiate protocol before close write",Z)}),await j(C)}}if(n.close!=null){const j=n.close.bind(n);n.close=async C=>{const Z=[];p&&Z.push(m.promise),b&&Z.push(E.promise),Z.length>0?await lr(Promise.all(Z),C?.signal):(l=!0,u=!1,f.resolve()),await j(C)}}return{stream:n,protocol:e}}async function km(n,e,t){e=Array.isArray(e)?e:[e],t.log.trace("handle: available protocols %s",e);const r=Xy(n,{...t,maxDataLength:Zy,maxLengthLength:2});for(;;){t.log.trace("handle: reading incoming string");const o=await Jo(r,t);if(t.log.trace('handle: read "%s"',o),o===rn){t.log.trace('handle: respond with "%s" for "%s"',rn,o),await ql(r,de(`${rn}
`),t),t.log.trace('handle: responded with "%s" for "%s"',rn,o);continue}if(e.includes(o))return t.log.trace('handle: respond with "%s" for "%s"',o,o),await ql(r,de(`${o}
`),t),t.log.trace('handle: responded with "%s" for "%s"',o,o),{stream:r.unwrap(),protocol:o};if(o==="ls"){const l=new rt(...e.map(u=>T2.single(de(`${u}
`))),de(`
`));t.log.trace('handle: respond with "%s" for %s',e,o),await ql(r,l,t),t.log.trace('handle: responded with "%s" for %s',e,o);continue}t.log.trace('handle: respond with "na" for "%s"',o),await ql(r,de(`na
`),t),t.log('handle: responded with "na" for "%s"',o)}}const qP=500;class FP{id;remoteAddr;remotePeer;direction;timeline;multiplexer;encryption;status;limits;log;tags;maConn;muxer;components;outboundStreamProtocolNegotiationTimeout;inboundStreamProtocolNegotiationTimeout;constructor(e,t){this.components=e,this.id=t.id,this.remoteAddr=t.maConn.remoteAddr,this.remotePeer=t.remotePeer,this.direction=t.direction??"outbound",this.status="open",this.timeline=t.maConn.timeline,this.encryption=t.encryption,this.limits=t.limits,this.maConn=t.maConn,this.log=t.maConn.log,this.outboundStreamProtocolNegotiationTimeout=t.outboundStreamProtocolNegotiationTimeout??Jf,this.inboundStreamProtocolNegotiationTimeout=t.inboundStreamProtocolNegotiationTimeout??Jf,this.remoteAddr.getPeerId()==null&&(this.remoteAddr=this.remoteAddr.encapsulate(`/p2p/${this.remotePeer}`)),this.tags=[],t.muxerFactory!=null&&(this.multiplexer=t.muxerFactory.protocol,this.muxer=t.muxerFactory.createStreamMuxer({direction:this.direction,log:this.log,onIncomingStream:r=>{this.onIncomingStream(r)}}),Promise.all([this.muxer.sink(this.maConn.source),this.maConn.sink(this.muxer.source)]).catch(r=>{this.log.error("error piping data through muxer - %e",r)}))}[Symbol.toStringTag]="Connection";[r8]=!0;get streams(){return this.muxer?.streams??[]}newStream=async(e,t={})=>{if(this.status==="closing")throw new i8("the connection is being closed");if(this.status==="closed")throw new m2("the connection is closed");if(Array.isArray(e)||(e=[e]),this.limits!=null&&t?.runOnLimitedConnection!==!0)throw new w1("Cannot open protocol stream on limited connection");if(this.muxer==null)throw new Am("Connection is not multiplexed");this.log.trace("starting new stream for protocols %s",e);const r=await this.muxer.newStream();this.log.trace("started new stream %s for protocols %s",r.id,e);try{if(t.signal==null){r.log("no abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e);const h=AbortSignal.timeout(this.outboundStreamProtocolNegotiationTimeout);t={...t,signal:h}}r.log.trace("selecting protocol from protocols %s",e);const{stream:o,protocol:l}=await Tm(r,e,{...t,log:r.log,yieldBytes:!0});r.log("selected protocol %s",l);const u=GP(l,this.components.registrar,t),f=gx(l,"outbound",this);if(f>=u){const h=new c8(`Too many outbound protocol streams for protocol "${l}" - ${f}/${u}`);throw r.abort(h),h}return await this.components.peerStore.merge(this.remotePeer,{protocols:[l]}),r.source=o.source,r.sink=o.sink,r.protocol=l,o.closeWrite!=null&&(r.closeWrite=o.closeWrite),o.closeRead!=null&&(r.closeRead=o.closeRead),o.close!=null&&(r.close=o.close),this.components.metrics?.trackProtocolStream(r,this),r.direction="outbound",r}catch(o){throw this.log.error("could not create new outbound stream on connection %s %a for protocols %s - %e",this.direction==="inbound"?"from":"to",this.remoteAddr,e,o),r.timeline.close==null&&r.abort(o),o}};onIncomingStream(e){const t=AbortSignal.timeout(this.inboundStreamProtocolNegotiationTimeout);Promise.resolve().then(async()=>{const r=this.components.registrar.getProtocols(),{stream:o,protocol:l}=await km(e,r,{signal:t,log:e.log,yieldBytes:!1});this.log("incoming %s stream opened",l);const u=jP(l,this.components.registrar);if(gx(l,"inbound",this)===u){const m=new l8(`Too many inbound protocol streams for protocol "${l}" - limit ${u}`);throw e.abort(m),m}e.source=o.source,e.sink=o.sink,e.protocol=l,o.closeWrite!=null&&(e.closeWrite=o.closeWrite),o.closeRead!=null&&(e.closeRead=o.closeRead),o.close!=null&&(e.close=o.close),await this.components.peerStore.merge(this.remotePeer,{protocols:[l]},{signal:t}),this.components.metrics?.trackProtocolStream(e,this);const{handler:h,options:p}=this.components.registrar.getHandler(l);if(this.limits!=null&&p.runOnLimitedConnection!==!0)throw new w1("Cannot open protocol stream on limited connection");await h({connection:this,stream:e})}).catch(async r=>{this.log.error("error handling incoming stream id %s - %e",e.id,r),e.abort(r)})}async close(e={}){if(!(this.status==="closed"||this.status==="closing")){if(this.log("closing connection to %a",this.remoteAddr),this.status="closing",e.signal==null){const t=AbortSignal.timeout(qP);e={...e,signal:t}}try{this.log.trace("closing underlying transport"),await this.muxer?.close(e),await this.maConn.close(e),this.log.trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now()}catch(t){this.log.error("error encountered during graceful close of connection to %a",this.remoteAddr,t),this.abort(t)}}}abort(e){this.status!=="closed"&&(this.log.error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this.muxer?.abort(e),this.maConn.abort(e),this.status="closed",this.timeline.close=Date.now())}}function KP(n,e){return new FP(n,e)}function jP(n,e){try{const{options:t}=e.getHandler(n);return t.maxInboundStreams}catch(t){if(t.name!=="UnhandledProtocolError")throw t}return Q_}function GP(n,e,t={}){try{const{options:r}=e.getHandler(n);if(r.maxOutboundStreams!=null)return r.maxOutboundStreams}catch(r){if(r.name!=="UnhandledProtocolError")throw r}return t.maxOutboundStreams??J_}function gx(n,e,t){let r=0;return t.streams.forEach(o=>{o.direction===e&&o.protocol===n&&r++}),r}class YP{components;connectionEncrypters;streamMuxers;inboundUpgradeTimeout;inboundStreamProtocolNegotiationTimeout;outboundStreamProtocolNegotiationTimeout;events;metrics;constructor(e,t){this.components=e,this.connectionEncrypters=qr({name:"libp2p_upgrader_connection_encrypters",metrics:this.components.metrics}),t.connectionEncrypters.forEach(r=>{this.connectionEncrypters.set(r.protocol,r)}),this.streamMuxers=qr({name:"libp2p_upgrader_stream_multiplexers",metrics:this.components.metrics}),t.streamMuxers.forEach(r=>{this.streamMuxers.set(r.protocol,r)}),this.inboundUpgradeTimeout=t.inboundUpgradeTimeout??$9,this.inboundStreamProtocolNegotiationTimeout=t.inboundStreamProtocolNegotiationTimeout??Jf,this.outboundStreamProtocolNegotiationTimeout=t.outboundStreamProtocolNegotiationTimeout??Jf,this.events=e.events,this.metrics={dials:e.metrics?.registerCounterGroup("libp2p_connection_manager_dials_total"),errors:e.metrics?.registerCounterGroup("libp2p_connection_manager_dial_errors_total"),inboundErrors:e.metrics?.registerCounterGroup("libp2p_connection_manager_dials_inbound_errors_total"),outboundErrors:e.metrics?.registerCounterGroup("libp2p_connection_manager_dials_outbound_errors_total")}}[Symbol.toStringTag]="@libp2p/upgrader";async shouldBlockConnection(e,...t){const r=this.components.connectionGater[e];if(r==null)return;if(await r.apply(this.components.connectionGater,t)===!0)throw new b9(`The multiaddr connection is blocked by gater.${e}`)}createInboundAbortSignal(e){return Nt([AbortSignal.timeout(this.inboundUpgradeTimeout),e])}async upgradeInbound(e,t){let r=!1;const o=this.createInboundAbortSignal(t.signal);try{if(this.metrics.dials?.increment({inbound:!0}),r=await lr(this.components.connectionManager.acceptIncomingConnection(e),o),!r)throw new w9("Connection denied");await lr(this.shouldBlockConnection("denyInboundConnection",e),o),await this._performUpgrade(e,"inbound",{...t,signal:o})}catch(l){throw this.metrics.errors?.increment({inbound:!0}),this.metrics.inboundErrors?.increment({[l.name??"Error"]:!0}),l}finally{o.clear(),r&&this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(e,t){try{this.metrics.dials?.increment({outbound:!0});const r=e.remoteAddr.getPeerId();let o;r!=null&&(o=_s(r),await lr(this.shouldBlockConnection("denyOutboundConnection",o,e),t.signal));let l="outbound";return t.initiator===!1&&(l="inbound"),await this._performUpgrade(e,l,t)}catch(r){throw this.metrics.errors?.increment({outbound:!0}),this.metrics.outboundErrors?.increment({[r.name??"Error"]:!0}),r}}async _performUpgrade(e,t,r){let o,l,u,f,h;const p=`${parseInt(String(Math.random()*1e9)).toString(36)}${Date.now()}`;e.log=e.log.newScope(`${t}:${p}`),this.components.metrics?.trackMultiaddrConnection(e),e.log.trace("starting the %s connection upgrade",t);let m=e;if(r?.skipProtection!==!0){const b=this.components.connectionProtector;b!=null&&(e.log("protecting the %s connection",t),m=await b.protect(e,r))}try{if(o=m,r?.skipEncryption!==!0){r?.onProgress?.(new Le(`upgrader:encrypt-${t}-connection`)),{conn:o,remotePeer:l,protocol:h,streamMuxer:f}=await(t==="inbound"?this._encryptInbound(m,r):this._encryptOutbound(m,r));const b={...m,...o};await this.shouldBlockConnection(t==="inbound"?"denyInboundEncryptedConnection":"denyOutboundEncryptedConnection",l,b)}else{const b=e.remoteAddr.getPeerId();if(b==null)throw new Km(`${t} connection that skipped encryption must have a peer id`);const E=_s(b);h="native",l=E}if(l.equals(this.components.peerId)){const b=new y2("Can not dial self");throw e.abort(b),b}if(u=o,r?.muxerFactory!=null)f=r.muxerFactory;else if(f==null&&this.streamMuxers.size>0){r?.onProgress?.(new Le(`upgrader:multiplex-${t}-connection`));const b=await(t==="inbound"?this._multiplexInbound({...m,...o},this.streamMuxers,r):this._multiplexOutbound({...m,...o},this.streamMuxers,r));f=b.muxerFactory,u=b.stream}}catch(b){throw e.log.error("failed to upgrade inbound connection %s %a - %e",t==="inbound"?"from":"to",e.remoteAddr,b),b}await this.shouldBlockConnection(t==="inbound"?"denyInboundUpgradedConnection":"denyOutboundUpgradedConnection",l,e);const y=this._createConnection({id:p,cryptoProtocol:h,direction:t,maConn:e,upgradedConn:u,muxerFactory:f,remotePeer:l,limits:r?.limits});return y.log("successfully upgraded %s connection",t),y}_createConnection(e){const{id:t,cryptoProtocol:r,direction:o,maConn:l,upgradedConn:u,remotePeer:f,muxerFactory:h,limits:p}=e;let m;const y=l.timeline;return l.timeline=new Proxy(y,{set:(...b)=>(b[1]==="close"&&b[2]!=null&&y.close==null&&(async()=>{try{m.status==="open"&&await m.close()}catch(E){m.log.error("error closing connection after timeline close %e",E)}finally{this.events.safeDispatchEvent("connection:close",{detail:m})}})().catch(E=>{m.log.error("error thrown while dispatching connection:close event %e",E)}),Reflect.set(...b))}),l.timeline.upgraded=Date.now(),m=KP(this.components,{id:t,maConn:u,remotePeer:f,direction:o,muxerFactory:h,encryption:r,limits:p,outboundStreamProtocolNegotiationTimeout:this.outboundStreamProtocolNegotiationTimeout,inboundStreamProtocolNegotiationTimeout:this.inboundStreamProtocolNegotiationTimeout}),this.events.safeDispatchEvent("connection:open",{detail:m}),m}async _encryptInbound(e,t){const r=Array.from(this.connectionEncrypters.keys());try{const{stream:o,protocol:l}=await km(e,r,{...t,log:e.log}),u=this.connectionEncrypters.get(l);if(u==null)throw new ff(`no crypto module found for ${l}`);return e.log("encrypting inbound connection to %a using %s",e.remoteAddr,l),{...await u.secureInbound(o,t),protocol:l}}catch(o){throw e.log.error("encrypting inbound connection from %a failed",e.remoteAddr,o),new ff(o.message)}}async _encryptOutbound(e,t){const r=Array.from(this.connectionEncrypters.keys());try{e.log.trace("selecting encrypter from %s",r);const{stream:o,protocol:l}=await Tm(e,r,{...t,log:e.log,yieldBytes:!0}),u=this.connectionEncrypters.get(l);if(u==null)throw new ff(`no crypto module found for ${l}`);return e.log("encrypting outbound connection to %a using %s",e.remoteAddr,l),{...await u.secureOutbound(o,t),protocol:l}}catch(o){throw e.log.error("encrypting outbound connection to %a failed",e.remoteAddr,o),new ff(o.message)}}async _multiplexOutbound(e,t,r){const o=Array.from(t.keys());e.log("outbound selecting muxer %s",o);try{e.log.trace("selecting stream muxer from %s",o);const{stream:l,protocol:u}=await Tm(e,o,{...r,log:e.log,yieldBytes:!0});e.log("selected %s as muxer protocol",u);const f=t.get(u);return{stream:l,muxerFactory:f}}catch(l){throw e.log.error("error multiplexing outbound connection",l),new Am(String(l))}}async _multiplexInbound(e,t,r){const o=Array.from(t.keys());e.log("inbound handling muxers %s",o);try{const{stream:l,protocol:u}=await km(e,o,{...r,log:e.log}),f=t.get(u);return{stream:l,muxerFactory:f}}catch(l){throw e.log.error("error multiplexing inbound connection",l),new Am(String(l))}}getConnectionEncrypters(){return this.connectionEncrypters}getStreamMuxers(){return this.streamMuxers}}const W_="2.10.0",eT="js-libp2p";function tT(n,e){return`${n??eT}/${e??W_} browser/${globalThis.navigator.userAgent}`}class nT extends Ss{peerId;peerStore;contentRouting;peerRouting;metrics;services;logger;status;components;log;constructor(e){super(),this.status="stopped";const t=new Ss,r=t.dispatchEvent.bind(t);t.dispatchEvent=p=>{const m=r(p),y=this.dispatchEvent(new CustomEvent(p.type,{detail:p.detail}));return m||y},this.peerId=e.peerId,this.logger=e.logger??dd(),this.log=this.logger.forComponent("libp2p"),this.services={};const o=e.nodeInfo?.name??eT,l=e.nodeInfo?.version??W_,u=this.components=_9({peerId:e.peerId,privateKey:e.privateKey,nodeInfo:{name:o,version:l,userAgent:e.nodeInfo?.userAgent??tT(o,l)},logger:this.logger,events:t,datastore:e.datastore??new I_,connectionGater:R9(e.connectionGater),dns:e.dns});e.metrics!=null&&(this.metrics=this.configureComponent("metrics",e.metrics(this.components))),this.peerStore=this.configureComponent("peerStore",G7(u,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore})),u.events.addEventListener("peer:update",p=>{if(p.detail.previous==null){const m={id:p.detail.peer.id,multiaddrs:p.detail.peer.addresses.map(y=>y.multiaddr)};u.events.safeDispatchEvent("peer:discovery",{detail:m})}}),e.connectionProtector!=null&&this.configureComponent("connectionProtector",e.connectionProtector(u)),this.components.upgrader=new YP(this.components,{connectionEncrypters:(e.connectionEncrypters??[]).map((p,m)=>this.configureComponent(`connection-encryption-${m}`,p(this.components))),streamMuxers:(e.streamMuxers??[]).map((p,m)=>this.configureComponent(`stream-muxers-${m}`,p(this.components))),inboundUpgradeTimeout:e.connectionManager?.inboundUpgradeTimeout,inboundStreamProtocolNegotiationTimeout:e.connectionManager?.inboundStreamProtocolNegotiationTimeout??e.connectionManager?.protocolNegotiationTimeout,outboundStreamProtocolNegotiationTimeout:e.connectionManager?.outboundStreamProtocolNegotiationTimeout??e.connectionManager?.protocolNegotiationTimeout}),this.configureComponent("transportManager",new OP(this.components,e.transportManager)),this.configureComponent("connectionManager",new mP(this.components,e.connectionManager)),e.connectionMonitor?.enabled!==!1&&this.configureComponent("connectionMonitor",new NP(this.components,e.connectionMonitor)),this.configureComponent("registrar",new IP(this.components)),this.configureComponent("addressManager",new c9(this.components,e.addresses));const f=(e.peerRouters??[]).map((p,m)=>this.configureComponent(`peer-router-${m}`,p(this.components)));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new RP(this.components,{routers:f}));const h=(e.contentRouters??[]).map((p,m)=>this.configureComponent(`content-router-${m}`,p(this.components)));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new BP(this.components,{routers:h})),this.configureComponent("randomWalk",new MP(this.components)),(e.peerDiscovery??[]).forEach((p,m)=>{this.configureComponent(`peer-discovery-${m}`,p(this.components)).addEventListener("peer",b=>{this.#e(b)})}),e.transports?.forEach((p,m)=>{this.components.transportManager.add(this.configureComponent(`transport-${m}`,p(this.components)))}),e.services!=null)for(const p of Object.keys(e.services)){const m=e.services[p],y=m(this.components);if(y==null){this.log.error("service factory %s returned null or undefined instance",p);continue}this.services[p]=y,this.configureComponent(p,y),y[Xl]!=null&&(this.log("registering service %s for content routing",p),h.push(y[Xl])),y[Ql]!=null&&(this.log("registering service %s for peer routing",p),f.push(y[Ql])),y[b1]!=null&&(this.log("registering service %s for peer discovery",p),y[b1].addEventListener?.("peer",b=>{this.#e(b)}))}T9(u)}configureComponent(e,t){return t==null&&this.log.error("component %s was null or undefined",e),this.components[e]=t,t}async start(){if(this.status==="stopped"){this.status="starting",this.log("libp2p is starting");try{await this.components.beforeStart?.(),await this.components.start(),await this.components.afterStart?.(),this.status="started",this.safeDispatchEvent("start",{detail:this}),this.log("libp2p has started")}catch(e){throw this.log.error("An error occurred starting libp2p",e),this.status="started",await this.stop(),e}}}async stop(){this.status==="started"&&(this.log("libp2p is stopping"),this.status="stopping",await this.components.beforeStop?.(),await this.components.stop(),await this.components.afterStop?.(),this.status="stopped",this.safeDispatchEvent("stop",{detail:this}),this.log("libp2p has stopped"))}getConnections(e){return this.components.connectionManager.getConnections(e)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){const e=new Go;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e,t={}){return this.components.connectionManager.openConnection(e,{priority:75,...t})}async dialProtocol(e,t,r={}){if(t==null)throw new ge("no protocols were provided to open a stream");if(t=Array.isArray(t)?t:[t],t.length===0)throw new ge("no protocols were provided to open a stream");return(await this.dial(e,r)).newStream(t,r)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e,t={}){yd(e)&&(e=_s(e.getPeerId()??"")),await this.components.connectionManager.closeConnections(e,t)}async getPublicKey(e,t={}){if(this.log("getPublicKey %p",e),e.publicKey!=null)return e.publicKey;try{const u=await this.peerStore.get(e,t);if(u.id.publicKey!=null)return u.id.publicKey}catch(u){if(u.name!=="NotFoundError")throw u}const r=fr([de("/pk/"),e.toMultihash().bytes]),o=await this.contentRouting.get(r,t),l=cd(o);return await this.peerStore.patch(e,{publicKey:l},t),l}async handle(e,t,r){Array.isArray(e)||(e=[e]),await Promise.all(e.map(async o=>{await this.components.registrar.handle(o,t,r)}))}async unhandle(e,t){Array.isArray(e)||(e=[e]),await Promise.all(e.map(async r=>{await this.components.registrar.unhandle(r,t)}))}async register(e,t,r){return this.components.registrar.register(e,t,r)}unregister(e){this.components.registrar.unregister(e)}async isDialable(e,t={}){return this.components.connectionManager.isDialable(e,t)}#e(e){const{detail:t}=e;if(t.id.toString()===this.peerId.toString()){this.log.error("peer discovery mechanism discovered self");return}this.components.peerStore.merge(t.id,{multiaddrs:t.multiaddrs}).catch(r=>{this.log.error(r)})}}async function ZP(n={}){n.privateKey??=await US("Ed25519");const e=new nT({...await k7(n),peerId:KS(n.privateKey)});return n.start!==!1&&await e.start(),e}const XP=["dial","dialProtocol","hangUp","handle","unhandle","getMultiaddrs","getProtocols"];function QP(n){return n==null?!1:n instanceof nT?!0:XP.every(e=>typeof n[e]=="function")}var Dp,px;function JP(){if(px)return Dp;px=1;function n(t){return t>=55296&&t<=56319}function e(t){return t>=56320&&t<=57343}return Dp=function(r,o,l){if(typeof o!="string")throw new Error("Input must be string");for(var u=o.length,f=0,h,p,m=0;m<u;m+=1){if(h=o.charCodeAt(m),p=o[m],n(h)&&e(o.charCodeAt(m+1))&&(m+=1,p+=o[m]),f+=r(p),f===l)return o.slice(0,m+1);if(f>l)return o.slice(0,m-p.length+1)}return o},Dp}var Rp,mx;function WP(){if(mx)return Rp;mx=1;function n(t){return t>=55296&&t<=56319}function e(t){return t>=56320&&t<=57343}return Rp=function(r){if(typeof r!="string")throw new Error("Input must be string");for(var o=r.length,l=0,u=null,f=null,h=0;h<o;h++)u=r.charCodeAt(h),e(u)?f!=null&&n(f)?l+=1:l+=3:u<=127?l+=1:u>=128&&u<=2047?l+=2:u>=2048&&u<=65535&&(l+=3),f=u;return l},Rp}var Mp,yx;function ez(){if(yx)return Mp;yx=1;var n=JP(),e=WP();return Mp=n.bind(null,e),Mp}var Ip,bx;function tz(){if(bx)return Ip;bx=1;var n=ez(),e=/[\/\?<>\\:\*\|"]/g,t=/[\x00-\x1f\x80-\x9f]/g,r=/^\.+$/,o=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,l=/[\. ]+$/;function u(f,h){if(typeof f!="string")throw new Error("Input must be string");var p=f.replace(e,h).replace(t,h).replace(r,h).replace(o,h).replace(l,h);return n(p,255)}return Ip=function(f,h){var p=h&&h.replacement||"",m=u(f,p);return p===""?m:u(m,"")},Ip}var nz=tz();const rz=ha(nz),Op={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function rT(n){const e="AES-GCM";let t=16;const r=12,o="SHA-256",l=16,u=32767,f=Zt.get();t*=8;async function h(y,b){const E=f.getRandomValues(new Uint8Array(l)),x=f.getRandomValues(new Uint8Array(r)),k={name:e,iv:x};typeof b=="string"&&(b=de(b));let _;if(b.length===0){_=await f.subtle.importKey("jwk",Op,{name:"AES-GCM"},!0,["encrypt"]);try{const j={name:"PBKDF2",salt:E,iterations:u,hash:{name:o}},C=await f.subtle.importKey("raw",b,{name:"PBKDF2"},!1,["deriveKey"]);_=await f.subtle.deriveKey(j,C,{name:e,length:t},!0,["encrypt"])}catch{_=await f.subtle.importKey("jwk",Op,{name:"AES-GCM"},!0,["encrypt"])}}else{const j={name:"PBKDF2",salt:E,iterations:u,hash:{name:o}},C=await f.subtle.importKey("raw",b,{name:"PBKDF2"},!1,["deriveKey"]);_=await f.subtle.deriveKey(j,C,{name:e,length:t},!0,["encrypt"])}const R=await f.subtle.encrypt(k,_,y);return fr([E,k.iv,new Uint8Array(R)])}async function p(y,b){const E=y.subarray(0,l),x=y.subarray(l,l+r),k=y.subarray(l+r),_={name:e,iv:x};typeof b=="string"&&(b=de(b));let R;if(b.length===0)try{const C={name:"PBKDF2",salt:E,iterations:u,hash:{name:o}},Z=await f.subtle.importKey("raw",b,{name:"PBKDF2"},!1,["deriveKey"]);R=await f.subtle.deriveKey(C,Z,{name:e,length:t},!0,["decrypt"])}catch{R=await f.subtle.importKey("jwk",Op,{name:"AES-GCM"},!0,["decrypt"])}else{const C={name:"PBKDF2",salt:E,iterations:u,hash:{name:o}},Z=await f.subtle.importKey("raw",b,{name:"PBKDF2"},!1,["deriveKey"]);R=await f.subtle.deriveKey(C,Z,{name:e,length:t},!0,["decrypt"])}const j=await f.subtle.decrypt(_,R,k);return new Uint8Array(j)}return{encrypt:h,decrypt:p}}/*!
 * MIT License
 * 
 * Copyright (c) 2017-2024 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const iz="[object ArrayBuffer]";class Xe{static isArrayBuffer(e){return Object.prototype.toString.call(e)===iz}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=Xe.toUint8Array(e),o=Xe.toUint8Array(t);if(r.length!==o.byteLength)return!1;for(let l=0;l<r.length;l++)if(r[l]!==o[l])return!1;return!0}static concat(...e){let t;Array.isArray(e[0])&&!(e[1]instanceof Function)||Array.isArray(e[0])&&e[1]instanceof Function?t=e[0]:e[e.length-1]instanceof Function?t=e.slice(0,e.length-1):t=e;let r=0;for(const u of t)r+=u.byteLength;const o=new Uint8Array(r);let l=0;for(const u of t){const f=this.toUint8Array(u);o.set(f,l),l+=f.length}return e[e.length-1]instanceof Function?this.toView(o,e[e.length-1]):o.buffer}}const Lp="string",sz=/^[0-9a-f\s]+$/i,oz=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,az=/^[a-zA-Z0-9-_]+$/;class wx{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r.buffer}static toString(e){const t=Xe.toUint8Array(e);let r="";for(let l=0;l<t.length;l++)r+=String.fromCharCode(t[l]);return decodeURIComponent(escape(r))}}class sr{static toString(e,t=!1){const r=Xe.toArrayBuffer(e),o=new DataView(r);let l="";for(let u=0;u<r.byteLength;u+=2){const f=o.getUint16(u,t);l+=String.fromCharCode(f)}return l}static fromString(e,t=!1){const r=new ArrayBuffer(e.length*2),o=new DataView(r);for(let l=0;l<e.length;l++)o.setUint16(l*2,e.charCodeAt(l),t);return r}}class ht{static isHex(e){return typeof e===Lp&&sz.test(e)}static isBase64(e){return typeof e===Lp&&oz.test(e)}static isBase64Url(e){return typeof e===Lp&&az.test(e)}static ToString(e,t="utf8"){const r=Xe.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return sr.toString(r,!0);case"utf16":case"utf16be":return sr.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return sr.fromString(e,!0);case"utf16":case"utf16be":return sr.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=Xe.toUint8Array(e);if(typeof btoa<"u"){const r=this.ToString(t,"binary");return btoa(r)}else return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ht.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ht.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=ht.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return wx.fromString(e);case"utf16":case"utf16be":return sr.fromString(e);case"utf16le":case"usc2":return sr.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=ht.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return wx.toString(e);case"utf16":case"utf16be":return sr.toString(e);case"utf16le":case"usc2":return sr.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let o=0;o<t;o++)r[o]=e.charCodeAt(o);return r.buffer}static ToBinary(e){const t=Xe.toUint8Array(e);let r="";for(let o=0;o<t.length;o++)r+=String.fromCharCode(t[o]);return r}static ToHex(e){const t=Xe.toUint8Array(e);let r="";const o=t.length;for(let l=0;l<o;l++){const u=t[l];u<16&&(r+="0"),r+=u.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ht.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let o=0;o<t.length;o=o+2){const l=t.slice(o,o+2);r[o/2]=parseInt(l,16)}return r.buffer}static ToUtf16String(e,t=!1){return sr.toString(e,t)}static FromUtf16String(e,t=!1){return sr.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return e?.replace(/[\n\r\t ]/g,"")||""}}ht.DEFAULT_UTF8_ENCODING="utf8";/*!
 Copyright (c) Peculiar Ventures, LLC
*/function da(n,e){let t=0;if(n.length===1)return n[0];for(let r=n.length-1;r>=0;r--)t+=n[n.length-1-r]*Math.pow(2,e*r);return t}function Ns(n,e,t=-1){const r=t;let o=n,l=0,u=Math.pow(2,e);for(let f=1;f<8;f++){if(n<u){let h;if(r<0)h=new ArrayBuffer(f),l=f;else{if(r<f)return new ArrayBuffer(0);h=new ArrayBuffer(r),l=r}const p=new Uint8Array(h);for(let m=f-1;m>=0;m--){const y=Math.pow(2,m*e);p[l-m-1]=Math.floor(o/y),o-=p[l-m-1]*y}return h}u*=Math.pow(2,e)}return new ArrayBuffer(0)}function Cm(...n){let e=0,t=0;for(const l of n)e+=l.length;const r=new ArrayBuffer(e),o=new Uint8Array(r);for(const l of n)o.set(l,t),t+=l.length;return o}function iT(){const n=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const f=n[0]===255&&n[1]&128,h=n[0]===0&&(n[1]&128)===0;(f||h)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),t=new Uint8Array(e);for(let f=0;f<this.valueHex.byteLength;f++)t[f]=0;t[0]=n[0]&128;const r=da(t,8),o=new ArrayBuffer(this.valueHex.byteLength),l=new Uint8Array(o);for(let f=0;f<this.valueHex.byteLength;f++)l[f]=n[f];return l[0]&=127,da(l,8)-r}function lz(n){const e=n<0?n*-1:n;let t=128;for(let r=1;r<8;r++){if(e<=t){if(n<0){const u=t-e,f=Ns(u,8,r),h=new Uint8Array(f);return h[0]|=128,f}let o=Ns(e,8,r),l=new Uint8Array(o);if(l[0]&128){const u=o.slice(0),f=new Uint8Array(u);o=new ArrayBuffer(o.byteLength+1),l=new Uint8Array(o);for(let h=0;h<u.byteLength;h++)l[h+1]=f[h];l[0]=0}return o}t*=Math.pow(2,8)}return new ArrayBuffer(0)}function cz(n,e){if(n.byteLength!==e.byteLength)return!1;const t=new Uint8Array(n),r=new Uint8Array(e);for(let o=0;o<t.length;o++)if(t[o]!==r[o])return!1;return!0}function bn(n,e){const t=n.toString(10);if(e<t.length)return"";const r=e-t.length,o=new Array(r);for(let u=0;u<r;u++)o[u]="0";return o.join("").concat(t)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function Wf(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Qy(n){let e=0,t=0;for(let o=0;o<n.length;o++){const l=n[o];e+=l.byteLength}const r=new Uint8Array(e);for(let o=0;o<n.length;o++){const l=n[o];r.set(new Uint8Array(l),t),t+=l.byteLength}return r.buffer}function Kr(n,e,t,r){return e instanceof Uint8Array?e.byteLength?t<0?(n.error="Wrong parameter: inputOffset less than zero",!1):r<0?(n.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-t-r<0?(n.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(n.error="Wrong parameter: inputBuffer has zero length",!1):(n.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class Jy{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return Qy(this.items)}}const Ll=[new Uint8Array([1])],vx="0123456789",Ca="",Qn=new ArrayBuffer(0),Wy=new Uint8Array(0),fc="EndOfContent",sT="OCTET STRING",oT="BIT STRING";function jr(n){var e;return e=class extends n{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(r){this.valueHexView=new Uint8Array(r)}constructor(...r){var o;super(...r);const l=r[0]||{};this.isHexOnly=(o=l.isHexOnly)!==null&&o!==void 0?o:!1,this.valueHexView=l.valueHex?Xe.toUint8Array(l.valueHex):Wy}fromBER(r,o,l){const u=r instanceof ArrayBuffer?new Uint8Array(r):r;if(!Kr(this,u,o,l))return-1;const f=o+l;return this.valueHexView=u.subarray(o,f),this.valueHexView.length?(this.blockLength=l,f):(this.warnings.push("Zero buffer length"),o)}toBER(r=!1){return this.isHexOnly?r?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Qn)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:ht.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class Us{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t=Ca,warnings:r=[],valueBeforeDecode:o=Wy}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=Xe.toUint8Array(o)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:ht.ToHex(this.valueBeforeDecodeView)}}}Us.NAME="baseBlock";class on extends Us{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}on.NAME="valueBlock";class aT extends jr(Us){constructor({idBlock:e={}}={}){var t,r,o,l;super(),e?(this.isHexOnly=(t=e.isHexOnly)!==null&&t!==void 0?t:!1,this.valueHexView=e.valueHex?Xe.toUint8Array(e.valueHex):Wy,this.tagClass=(r=e.tagClass)!==null&&r!==void 0?r:-1,this.tagNumber=(o=e.tagNumber)!==null&&o!==void 0?o:-1,this.isConstructed=(l=e.isConstructed)!==null&&l!==void 0?l:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Qn}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const o=new Uint8Array(1);if(!e){let l=this.tagNumber;l&=31,t|=l,o[0]=t}return o.buffer}if(!this.isHexOnly){const o=Ns(this.tagNumber,7),l=new Uint8Array(o),u=o.byteLength,f=new Uint8Array(u+1);if(f[0]=t|31,!e){for(let h=0;h<u-1;h++)f[h+1]=l[h]|128;f[u]=l[u-1]}return f.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=t|31,!e){const o=this.valueHexView;for(let l=0;l<o.length-1;l++)r[l+1]=o[l]|128;r[this.valueHexView.byteLength]=o[o.length-1]}return r.buffer}fromBER(e,t,r){const o=Xe.toUint8Array(e);if(!Kr(this,o,t,r))return-1;const l=o.subarray(t,t+r);if(l.length===0)return this.error="Zero buffer length",-1;switch(l[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(l[0]&32)===32,this.isHexOnly=!1;const f=l[0]&31;if(f!==31)this.tagNumber=f,this.blockLength=1;else{let h=1,p=this.valueHexView=new Uint8Array(255),m=255;for(;l[h]&128;){if(p[h-1]=l[h]&127,h++,h>=l.length)return this.error="End of input reached before message was fully decoded",-1;if(h===m){m+=255;const b=new Uint8Array(m);for(let E=0;E<p.length;E++)b[E]=p[E];p=this.valueHexView=new Uint8Array(m)}}this.blockLength=h+1,p[h-1]=l[h]&127;const y=new Uint8Array(h);for(let b=0;b<h;b++)y[b]=p[b];p=this.valueHexView=new Uint8Array(h),p.set(y),this.blockLength<=9?this.tagNumber=da(p,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}aT.NAME="identificationBlock";class lT extends Us{constructor({lenBlock:e={}}={}){var t,r,o;super(),this.isIndefiniteForm=(t=e.isIndefiniteForm)!==null&&t!==void 0?t:!1,this.longFormUsed=(r=e.longFormUsed)!==null&&r!==void 0?r:!1,this.length=(o=e.length)!==null&&o!==void 0?o:0}fromBER(e,t,r){const o=Xe.toUint8Array(e);if(!Kr(this,o,t,r))return-1;const l=o.subarray(t,t+r);if(l.length===0)return this.error="Zero buffer length",-1;if(l[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=l[0]===128,this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(l[0]&128),this.longFormUsed===!1)return this.length=l[0],this.blockLength=1,t+this.blockLength;const u=l[0]&127;if(u>8)return this.error="Too big integer",-1;if(u+1>l.length)return this.error="End of input reached before message was fully decoded",-1;const f=t+1,h=o.subarray(f,f+u);return h[u-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=da(h,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=u+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const o=Ns(this.length,8);if(o.byteLength>127)return this.error="Too big length",Qn;if(t=new ArrayBuffer(o.byteLength+1),e)return t;const l=new Uint8Array(o);r=new Uint8Array(t),r[0]=o.byteLength|128;for(let u=0;u<o.byteLength;u++)r[u+1]=l[u];return t}return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}lT.NAME="lengthBlock";const he={};class Qt extends Us{constructor({name:e=Ca,optional:t=!1,primitiveSchema:r,...o}={},l){super(o),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new aT(o),this.lenBlock=new lT(o),this.valueBlock=l?new l(o):new on(o)}fromBER(e,t,r){const o=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return o===-1?(this.error=this.valueBlock.error,o):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),o)}toBER(e,t){const r=t||new Jy;t||cT(this);const o=this.idBlock.toBER(e);if(r.write(o),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const l=this.valueBlock.toBER(e);this.lenBlock.length=l.byteLength;const u=this.lenBlock.toBER(e);r.write(u),r.write(l)}return t?Qn:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():ht.ToHex(this.toBER())}onAsciiEncoding(){const e=this.constructor.NAME,t=ht.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${t}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const t=this.toBER(),r=e.toBER();return cz(t,r)}}Qt.NAME="BaseBlock";function cT(n){var e;if(n instanceof he.Constructed)for(const t of n.valueBlock.value)cT(t)&&(n.lenBlock.isIndefiniteForm=!0);return!!(!((e=n.lenBlock)===null||e===void 0)&&e.isIndefiniteForm)}class uT extends Qt{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e=Ca,...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){const o=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return o===-1?(this.error=this.valueBlock.error,o):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),o)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}uT.NAME="BaseStringBlock";class fT extends jr(on){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}fT.NAME="PrimitiveValueBlock";var dT;class hT extends Qt{constructor(e={}){super(e,fT),this.idBlock.isConstructed=!1}}dT=hT;he.Primitive=dT;hT.NAME="PRIMITIVE";function uz(n,e){if(n instanceof e)return n;const t=new e;return t.idBlock=n.idBlock,t.lenBlock=n.lenBlock,t.warnings=n.warnings,t.valueBeforeDecodeView=n.valueBeforeDecodeView,t}function Td(n,e=0,t=n.length){const r=e;let o=new Qt({},on);const l=new Us;if(!Kr(l,n,e,t))return o.error=l.error,{offset:-1,result:o};if(!n.subarray(e,e+t).length)return o.error="Zero buffer length",{offset:-1,result:o};let f=o.idBlock.fromBER(n,e,t);if(o.idBlock.warnings.length&&o.warnings.concat(o.idBlock.warnings),f===-1)return o.error=o.idBlock.error,{offset:-1,result:o};if(e=f,t-=o.idBlock.blockLength,f=o.lenBlock.fromBER(n,e,t),o.lenBlock.warnings.length&&o.warnings.concat(o.lenBlock.warnings),f===-1)return o.error=o.lenBlock.error,{offset:-1,result:o};if(e=f,t-=o.lenBlock.blockLength,!o.idBlock.isConstructed&&o.lenBlock.isIndefiniteForm)return o.error="Indefinite length form used for primitive encoding form",{offset:-1,result:o};let h=Qt;switch(o.idBlock.tagClass){case 1:if(o.idBlock.tagNumber>=37&&o.idBlock.isHexOnly===!1)return o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:o};switch(o.idBlock.tagNumber){case 0:if(o.idBlock.isConstructed&&o.lenBlock.length>0)return o.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:o};h=he.EndOfContent;break;case 1:h=he.Boolean;break;case 2:h=he.Integer;break;case 3:h=he.BitString;break;case 4:h=he.OctetString;break;case 5:h=he.Null;break;case 6:h=he.ObjectIdentifier;break;case 10:h=he.Enumerated;break;case 12:h=he.Utf8String;break;case 13:h=he.RelativeObjectIdentifier;break;case 14:h=he.TIME;break;case 15:return o.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:o};case 16:h=he.Sequence;break;case 17:h=he.Set;break;case 18:h=he.NumericString;break;case 19:h=he.PrintableString;break;case 20:h=he.TeletexString;break;case 21:h=he.VideotexString;break;case 22:h=he.IA5String;break;case 23:h=he.UTCTime;break;case 24:h=he.GeneralizedTime;break;case 25:h=he.GraphicString;break;case 26:h=he.VisibleString;break;case 27:h=he.GeneralString;break;case 28:h=he.UniversalString;break;case 29:h=he.CharacterString;break;case 30:h=he.BmpString;break;case 31:h=he.DATE;break;case 32:h=he.TimeOfDay;break;case 33:h=he.DateTime;break;case 34:h=he.Duration;break;default:{const p=o.idBlock.isConstructed?new he.Constructed:new he.Primitive;p.idBlock=o.idBlock,p.lenBlock=o.lenBlock,p.warnings=o.warnings,o=p}}break;case 2:case 3:case 4:default:h=o.idBlock.isConstructed?he.Constructed:he.Primitive}return o=uz(o,h),f=o.fromBER(n,e,o.lenBlock.isIndefiniteForm?t:o.lenBlock.length),o.valueBeforeDecodeView=n.subarray(r,r+o.blockLength),{offset:f,result:o}}function Up(n){if(!n.byteLength){const e=new Qt({},on);return e.error="Input buffer has zero length",{offset:-1,result:e}}return Td(Xe.toUint8Array(n).slice(),0,n.byteLength)}function fz(n,e){return n?1:e}class Ri extends on{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const o=Xe.toUint8Array(e);if(!Kr(this,o,t,r))return-1;if(this.valueBeforeDecodeView=o.subarray(t,t+r),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),t;let l=t;for(;fz(this.isIndefiniteForm,r)>0;){const u=Td(o,l,r);if(u.offset===-1)return this.error=u.result.error,this.warnings.concat(u.result.warnings),-1;if(l=u.offset,this.blockLength+=u.result.blockLength,r-=u.result.blockLength,this.value.push(u.result),this.isIndefiniteForm&&u.result.constructor.NAME===fc)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===fc?this.value.pop():this.warnings.push("No EndOfContent block encoded")),l}toBER(e,t){const r=t||new Jy;for(let o=0;o<this.value.length;o++)this.value[o].toBER(e,r);return t?Qn:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}Ri.NAME="ConstructedValueBlock";var gT;class Na extends Qt{constructor(e={}){super(e,Ri),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const o=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return o===-1?(this.error=this.valueBlock.error,o):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),o)}onAsciiEncoding(){const e=[];for(const r of this.valueBlock.value)e.push(r.toString("ascii").split(`
`).map(o=>`  ${o}`).join(`
`));const t=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join(`
`)}`:`${t} :`}}gT=Na;he.Constructed=gT;Na.NAME="CONSTRUCTED";class pT extends on{fromBER(e,t,r){return t}toBER(e){return Qn}}pT.override="EndOfContentValueBlock";var mT;class yT extends Qt{constructor(e={}){super(e,pT),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}mT=yT;he.EndOfContent=mT;yT.NAME=fc;var bT;class ed extends Qt{constructor(e={}){super(e,on),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const o=new Uint8Array(r);o[0]=5,o[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}bT=ed;he.Null=bT;ed.NAME="NULL";class wT extends jr(on){get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=Xe.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){const o=Xe.toUint8Array(e);return Kr(this,o,t,r)?(this.valueHexView=o.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,iT.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}wT.NAME="BooleanValueBlock";var vT;let ET=class extends Qt{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,wT),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}};vT=ET;he.Boolean=vT;ET.NAME="BOOLEAN";class xT extends jr(Ri){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let o=0;if(this.isConstructed){if(this.isHexOnly=!1,o=Ri.prototype.fromBER.call(this,e,t,r),o===-1)return o;for(let l=0;l<this.value.length;l++){const u=this.value[l].constructor.NAME;if(u===fc){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(u!==sT)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,o=super.fromBER(e,t,r),this.blockLength=r;return o}toBER(e,t){return this.isConstructed?Ri.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}xT.NAME="OctetStringValueBlock";var e0;class Uo extends Qt{constructor({idBlock:e={},lenBlock:t={},...r}={}){var o,l;(o=r.isConstructed)!==null&&o!==void 0||(r.isConstructed=!!(!((l=r.value)===null||l===void 0)&&l.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},xT),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,r===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const l=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(l.byteLength){const u=Td(l,0,l.byteLength);u.offset!==-1&&u.offset===r&&(this.valueBlock.value=[u.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Na.prototype.onAsciiEncoding.call(this);const e=this.constructor.NAME,t=ht.ToHex(this.valueBlock.valueHexView);return`${e} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof e0&&e.push(t.valueBlock.valueHexView);return Xe.concat(e)}}e0=Uo;he.OctetString=e0;Uo.NAME=sT;class ST extends jr(Ri){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let o=-1;if(this.isConstructed){if(o=Ri.prototype.fromBER.call(this,e,t,r),o===-1)return o;for(const f of this.value){const h=f.constructor.NAME;if(h===fc){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(h!==oT)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const p=f.valueBlock;if(this.unusedBits>0&&p.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=p.unusedBits}return o}const l=Xe.toUint8Array(e);if(!Kr(this,l,t,r))return-1;const u=l.subarray(t,t+r);if(this.unusedBits=u[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const f=u.subarray(1);try{if(f.byteLength){const h=Td(f,0,f.byteLength);h.offset!==-1&&h.offset===r-1&&(this.value=[h.result])}}catch{}}return this.valueHexView=u.subarray(1),this.blockLength=u.length,t+r}toBER(e,t){if(this.isConstructed)return Ri.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Qn;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}ST.NAME="BitStringValueBlock";var AT;class _T extends Qt{constructor({idBlock:e={},lenBlock:t={},...r}={}){var o,l;(o=r.isConstructed)!==null&&o!==void 0||(r.isConstructed=!!(!((l=r.value)===null||l===void 0)&&l.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},ST),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Na.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const u of t)e.push(u.toString(2).padStart(8,"0"));const r=e.join(""),o=this.constructor.NAME,l=r.substring(0,r.length-this.valueBlock.unusedBits);return`${o} : ${l}`}}}AT=_T;he.BitString=AT;_T.NAME=oT;var TT;function dz(n,e){const t=new Uint8Array([0]),r=new Uint8Array(n),o=new Uint8Array(e);let l=r.slice(0);const u=l.length-1,f=o.slice(0),h=f.length-1;let p=0;const m=h<u?u:h;let y=0;for(let b=m;b>=0;b--,y++){switch(!0){case y<f.length:p=l[u-y]+f[h-y]+t[0];break;default:p=l[u-y]+t[0]}switch(t[0]=p/10,!0){case y>=l.length:l=Cm(new Uint8Array([p%10]),l);break;default:l[u-y]=p%10}}return t[0]>0&&(l=Cm(t,l)),l}function Ex(n){if(n>=Ll.length)for(let e=Ll.length;e<=n;e++){const t=new Uint8Array([0]);let r=Ll[e-1].slice(0);for(let o=r.length-1;o>=0;o--){const l=new Uint8Array([(r[o]<<1)+t[0]]);t[0]=l[0]/10,r[o]=l[0]%10}t[0]>0&&(r=Cm(t,r)),Ll.push(r)}return Ll[n]}function hz(n,e){let t=0;const r=new Uint8Array(n),o=new Uint8Array(e),l=r.slice(0),u=l.length-1,f=o.slice(0),h=f.length-1;let p,m=0;for(let y=h;y>=0;y--,m++)switch(p=l[u-m]-f[h-m]-t,!0){case p<0:t=1,l[u-m]=p+10;break;default:t=0,l[u-m]=p}if(t>0)for(let y=u-h+1;y>=0;y--,m++)if(p=l[u-m]-t,p<0)t=1,l[u-m]=p+10;else{t=0,l[u-m]=p;break}return l.slice()}class t0 extends jr(on){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=iT.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(lz(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,o=0){const l=this.fromBER(e,t,r);if(l===-1)return l;const u=this.valueHexView;return u[0]===0&&(u[1]&128)!==0?this.valueHexView=u.subarray(1):o!==0&&u.length<o&&(o-u.length>1&&(o=u.length+1),this.valueHexView=u.subarray(o-u.length)),l}toDER(e=!1){const t=this.valueHexView;switch(!0){case(t[0]&128)!==0:{const r=new Uint8Array(this.valueHexView.length+1);r[0]=0,r.set(t,1),this.valueHexView=r}break;case(t[0]===0&&(t[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,t,r){const o=super.fromBER(e,t,r);return o===-1||this.setValueHex(),o}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=this.valueHexView.length*8-1;let t=new Uint8Array(this.valueHexView.length*8/3),r=0,o;const l=this.valueHexView;let u="",f=!1;for(let h=l.byteLength-1;h>=0;h--){o=l[h];for(let p=0;p<8;p++){if((o&1)===1)switch(r){case e:t=hz(Ex(r),t),u="-";break;default:t=dz(t,Ex(r))}r++,o>>=1}}for(let h=0;h<t.length;h++)t[h]&&(f=!0),f&&(u+=vx.charAt(t[h]));return f===!1&&(u+=vx.charAt(0)),u}}TT=t0;t0.NAME="IntegerValueBlock";Object.defineProperty(TT.prototype,"valueHex",{set:function(n){this.valueHexView=new Uint8Array(n),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var Yl;class Wo extends Qt{constructor(e={}){super(e,t0),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return Wf(),BigInt(this.valueBlock.toString())}static fromBigInt(e){Wf();const t=BigInt(e),r=new Jy,o=t.toString(16).replace(/^-/,""),l=new Uint8Array(ht.FromHex(o));if(t<0){const f=new Uint8Array(l.length+(l[0]&128?1:0));f[0]|=128;const p=BigInt(`0x${ht.ToHex(f)}`)+t,m=Xe.toUint8Array(ht.FromHex(p.toString(16)));m[0]|=128,r.write(m)}else l[0]&128&&r.write(new Uint8Array([0])),r.write(l);return new Yl({valueHex:r.final()})}convertToDER(){const e=new Yl({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Yl({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Yl=Wo;he.Integer=Yl;Wo.NAME="INTEGER";var kT;class CT extends Wo{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}kT=CT;he.Enumerated=kT;CT.NAME="ENUMERATED";class Nm extends jr(on){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const o=Xe.toUint8Array(e);if(!Kr(this,o,t,r))return-1;const l=o.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let f=0;f<r&&(this.valueHexView[f]=l[f]&127,this.blockLength++,(l[f]&128)!==0);f++);const u=new Uint8Array(this.blockLength);for(let f=0;f<this.blockLength;f++)u[f]=this.valueHexView[f];return this.valueHexView=u,(l[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=da(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){Wf();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let o=0;o<r.length;o++)r[o]=parseInt(t.slice(o*7,o*7+7),2)+(o+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const o=this.valueHexView,l=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)l[u]=o[u]|128;return l[this.blockLength-1]=o[this.blockLength-1],l.buffer}const t=Ns(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",Qn;const r=new Uint8Array(t.byteLength);if(!e){const o=new Uint8Array(t),l=t.byteLength-1;for(let u=0;u<l;u++)r[u]=o[u]|128;r[l]=o[l]}return r}toString(){let e="";if(this.isHexOnly)e=ht.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Nm.NAME="sidBlock";class NT extends on{constructor({value:e=Ca,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let o=t;for(;r>0;){const l=new Nm;if(o=l.fromBER(e,o,r),o===-1)return this.blockLength=0,this.error=l.error,o;this.value.length===0&&(l.isFirstSid=!0),this.blockLength+=l.blockLength,r-=l.blockLength,this.value.push(l)}return o}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const o=this.value[r].toBER(e);if(o.byteLength===0)return this.error=this.value[r].error,Qn;t.push(o)}return Qy(t)}fromString(e){this.value=[];let t=0,r=0,o="",l=!1;do if(r=e.indexOf(".",t),r===-1?o=e.substring(t):o=e.substring(t,r),t=r+1,l){const u=this.value[0];let f=0;switch(u.valueDec){case 0:break;case 1:f=40;break;case 2:f=80;break;default:this.value=[];return}const h=parseInt(o,10);if(isNaN(h))return;u.valueDec=h+f,l=!1}else{const u=new Nm;if(o>Number.MAX_SAFE_INTEGER){Wf();const f=BigInt(o);u.valueBigInt=f}else if(u.valueDec=parseInt(o,10),isNaN(u.valueDec))return;this.value.length||(u.isFirstSid=!0,l=!0),this.value.push(u)}while(r!==-1)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let o=this.value[r].toString();r!==0&&(e=`${e}.`),t?(o=`{${o}}`,this.value[r].isFirstSid?e=`2.{${o} - 80}`:e+=o):e+=o}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}NT.NAME="ObjectIdentifierValueBlock";var BT;class ds extends Qt{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,NT),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}BT=ds;he.ObjectIdentifier=BT;ds.NAME="OBJECT IDENTIFIER";class Bm extends jr(Us){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(r===0)return t;const o=Xe.toUint8Array(e);if(!Kr(this,o,t,r))return-1;const l=o.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let f=0;f<r&&(this.valueHexView[f]=l[f]&127,this.blockLength++,(l[f]&128)!==0);f++);const u=new Uint8Array(this.blockLength);for(let f=0;f<this.blockLength;f++)u[f]=this.valueHexView[f];return this.valueHexView=u,(l[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=da(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const o=this.valueHexView,l=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)l[u]=o[u]|128;return l[this.blockLength-1]=o[this.blockLength-1],l.buffer}const t=Ns(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",Qn;const r=new Uint8Array(t.byteLength);if(!e){const o=new Uint8Array(t),l=t.byteLength-1;for(let u=0;u<l;u++)r[u]=o[u]|128;r[l]=o[l]}return r.buffer}toString(){let e="";return this.isHexOnly?e=ht.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}Bm.NAME="relativeSidBlock";class DT extends on{constructor({value:e=Ca,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let o=t;for(;r>0;){const l=new Bm;if(o=l.fromBER(e,o,r),o===-1)return this.blockLength=0,this.error=l.error,o;this.blockLength+=l.blockLength,r-=l.blockLength,this.value.push(l)}return o}toBER(e,t){const r=[];for(let o=0;o<this.value.length;o++){const l=this.value[o].toBER(e);if(l.byteLength===0)return this.error=this.value[o].error,Qn;r.push(l)}return Qy(r)}fromString(e){this.value=[];let t=0,r=0,o="";do{r=e.indexOf(".",t),r===-1?o=e.substring(t):o=e.substring(t,r),t=r+1;const l=new Bm;if(l.valueDec=parseInt(o,10),isNaN(l.valueDec))return!0;this.value.push(l)}while(r!==-1);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let o=this.value[r].toString();r!==0&&(e=`${e}.`),t&&(o=`{${o}}`),e+=o}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}DT.NAME="RelativeObjectIdentifierValueBlock";var RT;class MT extends Qt{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,DT),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}RT=MT;he.RelativeObjectIdentifier=RT;MT.NAME="RelativeObjectIdentifier";var IT;class Hn extends Na{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}IT=Hn;he.Sequence=IT;Hn.NAME="SEQUENCE";var OT;let LT=class extends Na{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};OT=LT;he.Set=OT;LT.NAME="SET";class UT extends jr(on){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Ca}toJSON(){return{...super.toJSON(),value:this.value}}}UT.NAME="StringValueBlock";class PT extends UT{}PT.NAME="SimpleStringValueBlock";class En extends uT{constructor({...e}={}){super(e,PT)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,Xe.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let o=0;o<t;o++)r[o]=e.charCodeAt(o);this.valueBlock.value=e}}En.NAME="SIMPLE STRING";class zT extends En{fromBuffer(e){this.valueBlock.valueHexView=Xe.toUint8Array(e);try{this.valueBlock.value=ht.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=ht.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(ht.FromUtf8String(e)),this.valueBlock.value=e}}zT.NAME="Utf8StringValueBlock";var VT;class Ps extends zT{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}VT=Ps;he.Utf8String=VT;Ps.NAME="UTF8String";class $T extends En{fromBuffer(e){this.valueBlock.value=ht.ToUtf16String(e),this.valueBlock.valueHexView=Xe.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(ht.FromUtf16String(e))}}$T.NAME="BmpStringValueBlock";var HT;class qT extends $T{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}HT=qT;he.BmpString=HT;qT.NAME="BMPString";class FT extends En{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let o=0;o<r.length;o+=4)r[o]=r[o+3],r[o+1]=r[o+2],r[o+2]=0,r[o+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t*4);for(let o=0;o<t;o++){const l=Ns(e.charCodeAt(o),8),u=new Uint8Array(l);if(u.length>4)continue;const f=4-u.length;for(let h=u.length-1;h>=0;h--)r[o*4+h+f]=u[h]}this.valueBlock.value=e}}FT.NAME="UniversalStringValueBlock";var KT;class jT extends FT{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}KT=jT;he.UniversalString=KT;jT.NAME="UniversalString";var GT;class YT extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}GT=YT;he.NumericString=GT;YT.NAME="NumericString";var ZT;class XT extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}ZT=XT;he.PrintableString=ZT;XT.NAME="PrintableString";var QT;class JT extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}QT=JT;he.TeletexString=QT;JT.NAME="TeletexString";var WT;class ek extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}WT=ek;he.VideotexString=WT;ek.NAME="VideotexString";var tk;class nk extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}tk=nk;he.IA5String=tk;nk.NAME="IA5String";var rk;class ik extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}rk=ik;he.GraphicString=rk;ik.NAME="GraphicString";var sk;class n0 extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}sk=n0;he.VisibleString=sk;n0.NAME="VisibleString";var ok;class ak extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}ok=ak;he.GeneralString=ok;ak.NAME="GeneralString";var lk;class ck extends En{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}lk=ck;he.CharacterString=lk;ck.NAME="CharacterString";var uk;class r0 extends n0{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let o=0;o<e.length;o++)this.valueBlock.valueHexView[o]=e.charCodeAt(o)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,Xe.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const r=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(r===null){this.error="Wrong input string for conversion";return}const o=parseInt(r[1],10);o>=50?this.year=1900+o:this.year=2e3+o,this.month=parseInt(r[2],10),this.day=parseInt(r[3],10),this.hour=parseInt(r[4],10),this.minute=parseInt(r[5],10),this.second=parseInt(r[6],10)}toString(e="iso"){if(e==="iso"){const t=new Array(7);return t[0]=bn(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=bn(this.month,2),t[2]=bn(this.day,2),t[3]=bn(this.hour,2),t[4]=bn(this.minute,2),t[5]=bn(this.second,2),t[6]="Z",t.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}uk=r0;he.UTCTime=uk;r0.NAME="UTCTime";var fk;class dk extends r0{constructor(e={}){var t;super(e),(t=this.millisecond)!==null&&t!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){const e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(e)}fromString(e){let t=!1,r="",o="",l=0,u,f=0,h=0;if(e[e.length-1]==="Z")r=e.substring(0,e.length-1),t=!0;else{const y=new Number(e[e.length-1]);if(isNaN(y.valueOf()))throw new Error("Wrong input string for conversion");r=e}if(t){if(r.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(r.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let y=1,b=r.indexOf("+"),E="";if(b===-1&&(b=r.indexOf("-"),y=-1),b!==-1){if(E=r.substring(b+1),r=r.substring(0,b),E.length!==2&&E.length!==4)throw new Error("Wrong input string for conversion");let x=parseInt(E.substring(0,2),10);if(isNaN(x.valueOf()))throw new Error("Wrong input string for conversion");if(f=y*x,E.length===4){if(x=parseInt(E.substring(2,4),10),isNaN(x.valueOf()))throw new Error("Wrong input string for conversion");h=y*x}}}let p=r.indexOf(".");if(p===-1&&(p=r.indexOf(",")),p!==-1){const y=new Number(`0${r.substring(p)}`);if(isNaN(y.valueOf()))throw new Error("Wrong input string for conversion");l=y.valueOf(),o=r.substring(0,p)}else o=r;switch(!0){case o.length===8:if(u=/(\d{4})(\d{2})(\d{2})/ig,p!==-1)throw new Error("Wrong input string for conversion");break;case o.length===10:if(u=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let y=60*l;this.minute=Math.floor(y),y=60*(y-this.minute),this.second=Math.floor(y),y=1e3*(y-this.second),this.millisecond=Math.floor(y)}break;case o.length===12:if(u=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let y=60*l;this.second=Math.floor(y),y=1e3*(y-this.second),this.millisecond=Math.floor(y)}break;case o.length===14:if(u=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){const y=1e3*l;this.millisecond=Math.floor(y)}break;default:throw new Error("Wrong input string for conversion")}const m=u.exec(o);if(m===null)throw new Error("Wrong input string for conversion");for(let y=1;y<m.length;y++)switch(y){case 1:this.year=parseInt(m[y],10);break;case 2:this.month=parseInt(m[y],10);break;case 3:this.day=parseInt(m[y],10);break;case 4:this.hour=parseInt(m[y],10)+f;break;case 5:this.minute=parseInt(m[y],10)+h;break;case 6:this.second=parseInt(m[y],10);break;default:throw new Error("Wrong input string for conversion")}if(t===!1){const y=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=y.getUTCFullYear(),this.month=y.getUTCMonth(),this.day=y.getUTCDay(),this.hour=y.getUTCHours(),this.minute=y.getUTCMinutes(),this.second=y.getUTCSeconds(),this.millisecond=y.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){const t=[];return t.push(bn(this.year,4)),t.push(bn(this.month,2)),t.push(bn(this.day,2)),t.push(bn(this.hour,2)),t.push(bn(this.minute,2)),t.push(bn(this.second,2)),this.millisecond!==0&&(t.push("."),t.push(bn(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}fk=dk;he.GeneralizedTime=fk;dk.NAME="GeneralizedTime";var hk;class gk extends Ps{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}hk=gk;he.DATE=hk;gk.NAME="DATE";var pk;class mk extends Ps{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}pk=mk;he.TimeOfDay=pk;mk.NAME="TimeOfDay";var yk;class bk extends Ps{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}yk=bk;he.DateTime=yk;bk.NAME="DateTime";var wk;class vk extends Ps{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}wk=vk;he.Duration=wk;vk.NAME="Duration";var Ek;class xk extends Ps{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Ek=xk;he.TIME=Ek;xk.NAME="TIME";const gz=16,Dm=32,Rm=1e4;async function kd(n,e){const r=await rT().encrypt(n,e);return Fr.encode(r)}async function xx(n,e,t){if(n.type==="RSA")return bz(n,e,t);if(n.type==="Ed25519")return pz(n,e,t);if(n.type==="secp256k1")return mz(n,e,t);if(n.type==="ECDSA")return yz(n,e,t);throw new ya}async function pz(n,e,t="libp2p-key"){if(t==="libp2p-key")return kd(vc(n),e);throw new ge(`export format '${t}' is not supported`)}async function mz(n,e,t="libp2p-key"){if(t==="libp2p-key")return kd(vc(n),e);throw new ge("Export format is not supported")}async function yz(n,e,t="libp2p-key"){if(t==="libp2p-key")return kd(vc(n),e);throw new ge(`export format '${t}' is not supported`)}async function bz(n,e,t="pkcs-8"){if(t==="pkcs-8")return wz(n,e);if(t==="libp2p-key")return kd(vc(n),e);throw new ge("Export format is not supported")}async function wz(n,e){const t=Zt.get(),o=new Hn({value:[new Wo({value:0}),new Hn({value:[new ds({value:"1.2.840.113549.1.1.1"}),new ed]}),new Uo({valueHex:n.raw})]}).toBER(),l=new Uint8Array(o,0,o.byteLength),u=nc(gz),f=await YS(vy,e,u,{c:Rm,dkLen:Dm}),h=nc(16),p=await t.subtle.importKey("raw",f,"AES-CBC",!1,["encrypt"]),m=await t.subtle.encrypt({name:"AES-CBC",iv:h},p,l),y=new Hn({value:[new Uo({valueHex:u}),new Wo({value:Rm}),new Wo({value:Dm}),new Hn({value:[new ds({value:"1.2.840.113549.2.11"}),new ed]})]}),b=new Hn({value:[new ds({value:"1.2.840.113549.1.5.13"}),new Hn({value:[new Hn({value:[new ds({value:"1.2.840.113549.1.5.12"}),y]}),new Hn({value:[new ds({value:"2.16.840.1.101.3.4.1.42"}),new Uo({valueHex:h})]})]})]}),x=new Hn({value:[b,new Uo({valueHex:m})]}).toBER(),k=new Uint8Array(x,0,x.byteLength);return["-----BEGIN ENCRYPTED PRIVATE KEY-----",...Ee(k,"base64pad").split(/(.{64})/).filter(Boolean),"-----END ENCRYPTED PRIVATE KEY-----"].join(`
`)}async function Sx(n,e){try{const t=await vz(n,e);return by(t)}catch{}if(!n.includes("BEGIN"))throw new ge("Encrypted key was not a libp2p-key or a PEM file");return Ez(n,e)}async function vz(n,e){const t=Fr.decode(n);return rT().decrypt(t,e)}async function Ez(n,e){const t=Zt.get();let r;if(n.includes("-----BEGIN ENCRYPTED PRIVATE KEY-----")){const l=de(n.replace("-----BEGIN ENCRYPTED PRIVATE KEY-----","").replace("-----END ENCRYPTED PRIVATE KEY-----","").replace(/\n/g,"").trim(),"base64pad"),{result:u}=Up(l),{iv:f,salt:h,iterations:p,keySize:m,cipherText:y}=xz(u),b=await YS(vy,e,h,{c:p,dkLen:m}),E=await t.subtle.importKey("raw",b,"AES-CBC",!1,["decrypt"]),x=Zl(await t.subtle.decrypt({name:"AES-CBC",iv:f},E,y)),{result:k}=Up(x);r=Ax(k)}else if(n.includes("-----BEGIN PRIVATE KEY-----")){const l=de(n.replace("-----BEGIN PRIVATE KEY-----","").replace("-----END PRIVATE KEY-----","").replace(/\n/g,"").trim(),"base64pad"),{result:u}=Up(l);r=Ax(u)}else throw new ge("Could not parse private key from PEM data");const o=zR(r);if(o.type!=="RSA")throw new ge("Could not parse RSA private key from PEM data");return o}function xz(n){const e=n.valueBlock.value[0];if(e.valueBlock.value[0].toString()!=="OBJECT IDENTIFIER : 1.2.840.113549.1.5.13")throw new ge("Only pkcs5PBES2 encrypted private keys are supported");const r=e.valueBlock.value[1].valueBlock.value[0];if(r.valueBlock.value[0].toString()!=="OBJECT IDENTIFIER : 1.2.840.113549.1.5.12")throw new ge("Only pkcs5PBKDF2 key derivation functions are supported");const l=r.valueBlock.value[1],u=Zl(l.valueBlock.value[0].getValue());let f=Rm,h=Dm;if(l.valueBlock.value.length===3)f=Number(l.valueBlock.value[1].toBigInt()),h=Number(l.valueBlock.value[2].toBigInt());else if(l.valueBlock.value.length===2)throw new ge("Could not derive key size and iterations from PEM file - please use @libp2p/rsa to re-import your key");const p=e.valueBlock.value[1].valueBlock.value[1],m=p.valueBlock.value[0].toString();if(m!=="OBJECT IDENTIFIER : 1.2.840.113549.3.7"){if(m!=="OBJECT IDENTIFIER : 1.3.14.3.2.7"){if(m!=="OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.2"){if(m!=="OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.22"){if(m!=="OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.42")throw new ge("Only AES-CBC encryption schemes are supported")}}}}const y=Zl(p.valueBlock.value[1].getValue());return{cipherText:Zl(n.valueBlock.value[1].getValue()),salt:u,iterations:f,keySize:h,iv:y}}function Ax(n){return Zl(n.valueBlock.value[2].getValue())}function Zl(n){return new Uint8Array(n,0,n.byteLength)}const Sz="/pkcs8/",Mm="/info/",Ul=new WeakMap,as={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},Pp={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function Ro(n){return n==null||typeof n!="string"?!1:n===rz(n.trim())&&n.length>0}async function It(){const t=Math.random()*800+200;await new Promise(r=>setTimeout(r,t))}function ls(n){return new ot(Sz+n)}function Mo(n){return new ot(Mm+n)}async function Az(n){const e=vc(n),t=await na.digest(e);return St.encode(t.bytes).substring(1)}class _z{components;init;log;self;constructor(e,t){if(this.components=e,this.log=e.logger.forComponent("libp2p:keychain"),this.init=Gy(Pp,t),this.self=t.selfKey??"self",this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<as.minKeyLength)throw new Error(`dek.keyLength must be least ${as.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<as.minSaltLength)throw new Error(`dek.saltLength must be least ${as.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<as.minIterationCount)throw new Error(`dek.iterationCount must be least ${as.minIterationCount}`);const r=this.init.pass!=null&&this.init.dek?.salt!=null?nE(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";Ul.set(this,{dek:r})}[Symbol.toStringTag]="@libp2p/keychain";[xf]=["@libp2p/keychain"];static generateOptions(){const e=Object.assign({},Pp),t=Math.ceil(as.minSaltLength/3)*3;return e.dek.salt=Ee(nc(t),"base64"),e}static get options(){return Pp}async findKeyByName(e){if(!Ro(e))throw await It(),new ge(`Invalid key name '${e}'`);const t=Mo(e);try{const r=await this.components.datastore.get(t);return JSON.parse(Ee(r))}catch(r){throw await It(),this.log.error(r),new Kn(`Key '${e}' does not exist.`)}}async findKeyById(e){try{const t={prefix:Mm};for await(const r of this.components.datastore.query(t)){const o=JSON.parse(Ee(r.value));if(o.id===e)return o}throw new ge(`Key with id '${e}' does not exist.`)}catch(t){throw await It(),t}}async importKey(e,t){if(!Ro(e))throw await It(),new ge(`Invalid key name '${e}'`);if(t==null)throw await It(),new ge("Key is required");const r=ls(e);if(await this.components.datastore.has(r))throw await It(),new ge(`Key '${e}' already exists`);let l,u;try{l=await Az(t);const p=Ul.get(this);if(p==null)throw new ge("dek missing");const m=p.dek;u=await xx(t,m,t.type==="RSA"?"pkcs-8":"libp2p-key")}catch(p){throw await It(),p}const f={name:e,id:l},h=this.components.datastore.batch();return h.put(r,de(u)),h.put(Mo(e),de(JSON.stringify(f))),await h.commit(),f}async exportKey(e){if(!Ro(e))throw await It(),new ge(`Invalid key name '${e}'`);const t=ls(e);try{const r=await this.components.datastore.get(t),o=Ee(r),l=Ul.get(this);if(l==null)throw new ge("dek missing");const u=l.dek;return await Sx(o,u)}catch(r){throw await It(),r}}async removeKey(e){if(!Ro(e)||e===this.self)throw await It(),new ge(`Invalid key name '${e}'`);const t=ls(e),r=await this.findKeyByName(e),o=this.components.datastore.batch();return o.delete(t),o.delete(Mo(e)),await o.commit(),r}async listKeys(){const e={prefix:Mm},t=[];for await(const r of this.components.datastore.query(e))t.push(JSON.parse(Ee(r.value)));return t}async renameKey(e,t){if(!Ro(e)||e===this.self)throw await It(),new ge(`Invalid old key name '${e}'`);if(!Ro(t)||t===this.self)throw await It(),new ge(`Invalid new key name '${t}'`);const r=ls(e),o=ls(t),l=Mo(e),u=Mo(t);if(await this.components.datastore.has(o))throw await It(),new ge(`Key '${t}' already exists`);try{const h=await this.components.datastore.get(r),p=await this.components.datastore.get(l),m=JSON.parse(Ee(p));m.name=t;const y=this.components.datastore.batch();return y.put(o,h),y.put(u,de(JSON.stringify(m))),y.delete(r),y.delete(l),await y.commit(),m}catch(h){throw await It(),h}}async rotateKeychainPass(e,t){if(typeof e!="string")throw await It(),new ge(`Invalid old pass type '${typeof e}'`);if(typeof t!="string")throw await It(),new ge(`Invalid new pass type '${typeof t}'`);if(t.length<20)throw await It(),new ge(`Invalid pass length ${t.length}`);this.log("recreating keychain");const r=Ul.get(this);if(r==null)throw new ge("dek missing");const o=r.dek;this.init.pass=t;const l=t!=null&&this.init.dek?.salt!=null?nE(t,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";Ul.set(this,{dek:l});const u=await this.listKeys();for(const f of u){const h=await this.components.datastore.get(ls(f.name)),p=Ee(h),m=await Sx(p,o),y=l.toString(),b=await xx(m,y,m.type==="RSA"?"pkcs-8":"libp2p-key"),E=this.components.datastore.batch(),x={name:f.name,id:f.id};E.put(ls(f.name),de(b)),E.put(Mo(f.name),de(JSON.stringify(x))),await E.commit()}this.log("keychain reconstructed")}}function Sk(n={}){return e=>new _z(e,n)}async function Tz(n,e={}){const t=e.selfKey??"self",r=Sk(e)({datastore:n,logger:dd()});let o;return await n.has(new ot(`/pkcs8/${t}`))?o=await r.exportKey(t):(o=await US(e.keyType??"Ed25519"),await r.importKey(t,o)),o}function kz(n={}){const e=`@helia/http ${tT()}`;return{privateKey:n.privateKey,dns:n.dns,nodeInfo:{userAgent:e},addresses:{listen:[]},transports:[],connectionEncrypters:[],streamMuxers:[],peerDiscovery:[],services:{delegatedRouting:()=>HU("https://delegated-ipfs.dev",{filterAddrs:["https"],filterProtocols:["transport-ipfs-gateway-http"]}),keychain:Sk(n.keychain)}}}async function Cz(n){const e=n.libp2p??{};e.privateKey==null&&n.datastore!=null&&(e.privateKey=await Tz(n.datastore,n.keychain));const t=kz(e);return t.datastore=t.datastore??n.datastore,await ZP({...t,...e,start:!1})}async function Nz(n={}){const e=n.datastore??new I_,t=n.blockstore??new g7;let r;return QP(n.libp2p)?r=n.libp2p:r=await Cz({...n,libp2p:{dns:n.dns,...n.libp2p,start:void 0},datastore:e}),{...n,libp2p:r,datastore:e,blockstore:t,blockBrokers:n.blockBrokers??[cU()],routers:n.routers??[h7(r),f7()],metrics:r.metrics}}async function Bz(n={}){const e=await Nz(n),t=new MO(e);return e.start!==!1&&await t.start(),t}const Dz=60*1e3,Rz=365*24*60*60*1e3;function Ak(n){return n?KS(n).toCID().toString(cr):""}async function Mz(n){try{const e=[async()=>{const t=await fetch(`https://ipfs.io/ipns/${n}`,{method:"HEAD"});if(t.ok){const r=t.headers.get("X-Ipfs-Roots");if(r)return r.trim()}throw new Error(`Gateway header resolution failed: ${t.status}`)},async()=>{const t=await fetch(`https://cloudflare-ipfs.com/ipns/${n}`,{method:"HEAD"});if(t.ok){const r=t.headers.get("X-Ipfs-Roots");if(r)return r.trim()}throw new Error(`Cloudflare gateway failed: ${t.status}`)}];for(const t of e)try{return{success:!0,ipfsHash:await t(),ipnsName:n}}catch(r){console.warn("⚠️ Resolution method failed:",r);continue}return{success:!1,ipnsName:n,error:"All resolution methods failed"}}catch(e){return console.error("❌ IPNS resolve failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown IPNS resolve error"}}}async function Iz(n){try{const e=by(de(n,"base64"));if(e.type!=="Ed25519")throw new Error("Only libp2p Ed25519 keys are supported");const t=Ak(e),r=[async()=>{const o=await fetch(`https://ipfs.io/ipns/${t}`,{method:"HEAD"});if(o.ok){const l=o.headers.get("X-Ipfs-Roots");if(l)return l.trim()}throw new Error(`Gateway header resolution failed: ${o.status}`)},async()=>{const o=await fetch(`https://cloudflare-ipfs.com/ipns/${t}`,{method:"HEAD"});if(o.ok){const l=o.headers.get("X-Ipfs-Roots");if(l)return l.trim()}throw new Error(`Cloudflare gateway failed: ${o.status}`)}];for(const o of r)try{return{success:!0,ipfsHash:await o(),ipnsName:t}}catch(l){console.warn("⚠️ Resolution method failed:",l);continue}return{success:!1,ipnsName:t,error:"All resolution methods failed"}}catch(e){return console.error("❌ IPNS resolve failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown IPNS resolve error"}}}async function _k(n,e){let t;try{t=await Bz();const r=by(de(e,"base64"));if(r.type!=="Ed25519")throw new Error("Only libp2p Ed25519 keys are supported");const o=Se.parse(n),l=Ak(r),u=BigInt(Date.now()),p=await BU(r,o,u,Rz,{ttlNs:BigInt(Dz)*1000000n}),m=Ky(p),y=jy(r.publicKey.toMultihash());return await t.routing.put(y,m),{success:!0,ipnsName:l}}catch(r){return console.error("❌ IPNS update failed:",r),{success:!1,error:r instanceof Error?r.message:"Unknown IPNS update error"}}finally{if(t)try{await t.stop()}catch(r){console.warn("⚠️  Warning: Error stopping Helia:",r)}}}function Tk(n){return n?.ipnsPrivateKey||null}async function kk(n,e,t,r,o){const l=await o(n,e,r);if(!l.success||!l.ipfsHash)return{ipfsResult:l};const u=Tk(t);if(!u)return{ipfsResult:l};const f=await _k(l.ipfsHash,u);return{ipfsResult:l,ipnsResult:f}}const _x=Object.freeze(Object.defineProperty({__proto__:null,getIPNSPrivateKeyFromConfig:Tk,resolveIPNSFromPrivateKey:Iz,resolveIPNSFromPublicKey:Mz,updateIPNSRecord:_k,uploadAndUpdateIPNS:kk},Symbol.toStringTag,{value:"Module"}));function Oz({configEnvs:n,environmentName:e,ipnsPublicKey:t,environmentConfig:r,fetchedConfig:o,currentIPFSHash:l,loading:u,onFetch:f,onAddKey:h,onRemoveKey:p,onUpdateKey:m,onUpdateEntireConfig:y,onUpdateValue:b}){const[E,x]=ae.useState(""),[k,_]=ae.useState(""),[R,j]=ae.useState(!1),[C,Z]=ae.useState(""),[Q,re]=ae.useState(!1),[oe,H]=ae.useState(null),B=()=>{E.trim()&&k.trim()&&(h(e,E.trim(),k.trim()),x(""),_(""))};ae.useEffect(()=>{if(o){const M=JSON.stringify(o.reduce((D,S)=>(D[S.key]=S.value,D),{}),null,2);Z(M)}else C||Z("")},[o]);const G=()=>{try{const M=JSON.parse(C);o&&Object.keys(o).forEach(D=>p(e,D)),Object.entries(M).forEach(([D,S])=>{h(e,D,String(S))}),H("✅ Changes saved locally!")}catch(M){alert(`Invalid JSON: ${M instanceof Error?M.message:"Unknown error"}`)}},te=async()=>{let M;if(o)M=o.reduce((D,S)=>(D[S.key]=S.value,D),{});else try{M=JSON.parse(C)}catch(D){H(`❌ Invalid JSON: ${D instanceof Error?D.message:"Unknown error"}`);return}re(!0),H(null);try{const{ipfsResult:D,ipnsResult:S}=await kk(M,e,r,n.quickNodeApiKey,n8);if(D.success&&D.ipfsHash){let I=`✅ Uploaded to IPFS! Hash: ${D.ipfsHash}`;S?S.success&&S.ipnsName?(I+=`
🔗 IPNS Updated! Name: ${S.ipnsName}`,I+=`
🌐 Access: https://ipfs.io/ipns/${S.ipnsName}`):I+=`
❌ IPNS update failed: ${S.error}`:I+=`
⚠️ No IPNS private key found - IPFS upload only`,H(I)}else H(`❌ Upload failed: ${D.error}`)}catch(D){H(`❌ Error: ${D instanceof Error?D.message:"Unknown error"}`)}finally{re(!1)}},Y=M=>{try{const D=JSON.parse(M),S=Object.entries(D).map(([I,L])=>({key:I,value:L}));y(S)}catch(D){console.error("Error updating JSON",D)}},U=()=>{j(M=>{const D=!M;return D||Y(C),D})};return K.jsx("div",{className:"space-y-6",children:K.jsxs(Lm,{children:[K.jsxs(Um,{children:[K.jsxs(Pm,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[K.jsxs("span",{className:"text-lg font-semibold",children:[e," Environment"]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[K.jsxs(Mr,{onClick:f,disabled:u,size:"sm",className:"w-full sm:w-auto",children:[K.jsx(c3,{className:"h-4 w-4 mr-2"}),u?"Fetching...":"Fetch from IPNS"]}),K.jsxs(Mr,{variant:"outline",size:"sm",onClick:U,className:"w-full sm:w-auto",children:[K.jsx(jx,{className:"h-4 w-4 mr-2"}),R?"Hide":"Show"," JSON"]}),K.jsxs(Mr,{onClick:te,disabled:Q||!ko(n.quickNodeApiKey)||R&&!C.trim(),size:"sm",className:"w-full sm:w-auto",title:ko(n.quickNodeApiKey)?"Upload to IPFS and publish via IPNS":"Add quickNodeApiKey to _env section in config or create .env file with VITE_QUICKNODE_API_KEY",children:[K.jsx(wf,{className:"h-4 w-4 mr-2"}),Q?"Publishing...":ko(n.quickNodeApiKey)?"Upload & Publish":"Configure QuickNode"]})]})]}),K.jsxs(zm,{className:"space-y-2",children:[K.jsx("div",{className:"text-sm",children:"IPNS Key:"}),K.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded block font-mono break-all overflow-wrap-anywhere",children:t}),l&&K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"text-sm",children:"Current IPFS Hash:"}),K.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded block font-mono break-all overflow-wrap-anywhere",children:l})]})]})]}),K.jsxs(Vm,{children:[oe&&K.jsx("div",{className:"mb-4 p-3 rounded-lg bg-muted text-sm font-mono whitespace-pre-wrap",children:oe}),!o&&!u&&!R&&K.jsx("p",{className:"text-muted-foreground text-center py-8",children:'Click "Fetch from IPNS" to load configuration data, or "Show JSON" to enter manually.'}),u&&K.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Fetching configuration from IPNS..."}),(o||R)&&!R&&K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[300px_1fr_120px] gap-3 px-1",children:[K.jsx(us,{className:"text-sm font-medium text-muted-foreground",children:"Key"}),K.jsx(us,{className:"text-sm font-medium text-muted-foreground",children:"Value"}),K.jsx(us,{className:"text-sm font-medium text-muted-foreground",children:"Actions"})]}),K.jsx("div",{className:"space-y-2",children:o?.map((M,D)=>{let S=M.value;if(typeof M.value=="string"&&M.value.includes("{"))try{S=JSON.parse(M.value)}catch(I){console.log("error",I)}else S=JSON.stringify(M.value);return K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[320px_1fr_120px] gap-3 items-center px-1",children:[K.jsx(Pl,{value:M.key,onChange:I=>{const L=I.target.value;L!==M.key&&L.trim()&&m?.(M.key,L)},className:"font-mono text-sm truncate",placeholder:"Key name"}),K.jsx(Pl,{value:String(S),onChange:I=>{const L=I.target.value;try{const ie=JSON.parse(L);b?.(M.key,ie)}catch{b?.(M.key,L)}},className:"font-mono text-sm truncate",placeholder:"Value"}),K.jsx(Mr,{variant:"outline",size:"sm",onClick:()=>p(e,M.key),className:"w-full",children:"Remove"})]},D)})}),K.jsx(Fp,{}),K.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-3",children:[K.jsx(us,{className:"text-sm font-medium mb-3 block",children:"Add New Key-Value Pair"}),K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[300px_1fr_120px] gap-3 items-center",children:[K.jsx(Pl,{placeholder:"Enter key name",value:E,onChange:M=>x(M.target.value),className:"font-mono text-sm"}),K.jsx(Pl,{placeholder:"Enter value",value:k,onChange:M=>_(M.target.value),className:"font-mono text-sm"}),K.jsx(Mr,{onClick:B,disabled:!E.trim()||!k.trim(),className:"w-full",children:"Add"})]})]})]}),R&&K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsx(us,{className:"text-sm font-medium",children:"Raw JSON"}),K.jsxs("div",{className:"flex gap-2",children:[K.jsxs(Mr,{onClick:G,size:"sm",variant:"outline",children:[K.jsx(d3,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),C.trim()&&K.jsxs(Mr,{onClick:te,disabled:Q||!ko(n.quickNodeApiKey),size:"sm",title:ko(n.quickNodeApiKey)?"Upload to IPFS and publish via IPNS":"Add quickNodeApiKey to _env section in config or create .env file with VITE_QUICKNODE_API_KEY",children:[K.jsx(wf,{className:"h-4 w-4 mr-2"}),Q?"Publishing...":ko(n.quickNodeApiKey)?"Upload & Publish":"Configure QuickNode"]})]})]}),K.jsx(qx,{value:C,onChange:M=>Z(M.target.value),className:"font-mono text-sm min-h-[400px] resize-y",placeholder:o?"Edit JSON configuration here...":"Paste or create JSON configuration here..."})]})]})]})})}function Lz({configStructure:n,configEnvs:e,fetchedConfigs:t,currentIPFSHashes:r,loading:o,activeTab:l,error:u,onTabChange:f,onFetch:h,onUpdateValue:p,onUpdateKey:m,onAddKey:y,onRemoveKey:b,onReset:E,onUpdateEntireConfig:x}){return K.jsxs("div",{className:"w-full space-y-6",children:[K.jsxs(Lm,{children:[K.jsxs(Um,{children:[K.jsxs(Pm,{className:"flex items-center gap-2",children:[K.jsx(g3,{className:"h-5 w-5"}),"Configuration Manager"]}),K.jsx(zm,{children:"Manage your IPFS/IPNS configuration across environments"})]}),K.jsx(Vm,{children:K.jsx(Mr,{variant:"outline",onClick:E,className:"mb-4",children:"Load Different Configuration"})})]}),K.jsxs(Z3,{value:l,onValueChange:f,children:[K.jsx("div",{className:"overflow-x-auto",children:K.jsx(X3,{className:"inline-flex h-10 items-center justify-start rounded-md bg-muted p-1 text-muted-foreground min-w-full",children:Object.keys(n).filter(k=>k!=="_env").map(k=>K.jsxs(Q3,{value:k,className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm min-w-fit gap-2",children:[K.jsx("span",{className:"truncate max-w-[120px]",children:k}),t[k]&&K.jsx(e8,{variant:"secondary",className:"text-xs",children:Object.keys(t[k]).length})]},k))})}),Object.entries(n).map(([k,_])=>K.jsx(J3,{value:k,children:K.jsx(Oz,{configEnvs:e,environmentName:k,ipnsPublicKey:_.ipnsPublicKey,environmentConfig:_,configStructure:n,fetchedConfig:t[k],currentIPFSHash:r[k],loading:o[k]||!1,onFetch:()=>h(k,_.ipnsPublicKey),onUpdateValue:(R,j)=>p(k,R,j),onUpdateKey:(R,j)=>m(k,R,j),onAddKey:y,onRemoveKey:b,onUpdateEntireConfig:R=>x(k,R)})},k))]}),u&&K.jsx(Hp,{variant:"destructive",children:K.jsx(qp,{children:u})})]})}function Uz(){const[n,e]=ae.useState(),[t,r]=ae.useState(null),[o,l]=ae.useState({}),[u,f]=ae.useState({}),[h,p]=ae.useState({}),[m,y]=ae.useState(null),[b,E]=ae.useState(""),x=re=>{e(re.__env),re.__env&&e(re.__env);const{__env:oe,...H}=re;r(H),l({}),f({}),y(null);const G=Object.keys(H).map(te=>te)[0];G&&E(G)},k=async(re,oe)=>{p(G=>({...G,[re]:!0})),y(null);const H=t?.[re];try{let G;if(H?.ipnsPrivateKey){const{resolveIPNSFromPrivateKey:te}=await a1(async()=>{const{resolveIPNSFromPrivateKey:Y}=await Promise.resolve().then(()=>_x);return{resolveIPNSFromPrivateKey:Y}},void 0);G=await te(H.ipnsPrivateKey)}else{const{resolveIPNSFromPublicKey:te}=await a1(async()=>{const{resolveIPNSFromPublicKey:Y}=await Promise.resolve().then(()=>_x);return{resolveIPNSFromPublicKey:Y}},void 0);G=await te(oe)}G.success&&G.ipfsHash?f(te=>({...te,[re]:G.ipfsHash})):console.warn(`⚠️ Could not resolve IPNS: ${G.error}`)}catch(G){console.warn("⚠️ Error resolving IPNS:",G)}const B=await m3(oe);B.success&&B.data?(l(G=>({...G,[re]:Object.entries(B.data??{}).map(([te,Y])=>({key:te,value:Y}))??[]})),B.ipfsHash&&!t?.[re]?.ipnsPrivateKey&&f(G=>({...G,[re]:B.ipfsHash}))):y(`Failed to fetch ${re}: ${B.error}`),p(G=>({...G,[re]:!1}))},_=(re,oe,H)=>{l(B=>({...B,[re]:B[re].map(G=>G.key===oe?{...G,value:H}:G)}))},R=(re,oe,H)=>{oe!==H&&l(B=>{const te=[...B[re]].map(Y=>Y.key===oe?{...Y,key:H}:Y);return{...B,[re]:te}})},j=(re,oe,H)=>{oe.trim()&&l(B=>({...B,[re]:[...B[re]||[],{key:oe,value:H}]}))},C=(re,oe)=>{l(H=>{const G=[...H[re]].filter(te=>te.key!==oe);return{...H,[re]:G}})},Z=()=>{r(null),l({}),f({}),y(null),E("")},Q=(re,oe)=>{l(H=>({...H,[re]:oe}))};return!t||!n?K.jsx(b3,{onConfigLoaded:x}):K.jsx(Lz,{configEnvs:n,configStructure:t,fetchedConfigs:o,currentIPFSHashes:u,loading:h,activeTab:b,error:m,onTabChange:E,onFetch:k,onUpdateValue:_,onUpdateKey:R,onAddKey:j,onRemoveKey:C,onReset:Z,onUpdateEntireConfig:Q})}function Pz(){return K.jsx("div",{className:"min-h-screen bg-background",children:K.jsxs("div",{className:"container mx-auto py-4 px-4 sm:py-8",children:[K.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 sm:mb-8",children:"🚀 IPFS Configuration Manager"}),K.jsx(Uz,{})]})})}s4.createRoot(document.getElementById("root")).render(K.jsx(ae.StrictMode,{children:K.jsx(Pz,{})}));
